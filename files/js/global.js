(function(){function e(e){var t=true;var i=false;var a=null;var n={text:true,search:true,url:true,tel:true,email:true,password:true,number:true,date:true,month:true,week:true,time:true,datetime:true,"datetime-local":true};function s(e){if(e&&e!==document&&e.nodeName!=="HTML"&&e.nodeName!=="BODY"&&"classList"in e&&"contains"in e.classList){return true}return false}function r(e){var t=e.type;var i=e.tagName;if(i==="INPUT"&&n[t]&&!e.readOnly){return true}if(i==="TEXTAREA"&&!e.readOnly){return true}if(e.isContentEditable){return true}return false}function o(e){if(e.classList.contains("focus-visible")){return}e.classList.add("focus-visible");e.setAttribute("data-focus-visible-added","")}function l(e){if(!e.hasAttribute("data-focus-visible-added")){return}e.classList.remove("focus-visible");e.removeAttribute("data-focus-visible-added")}function c(i){if(i.metaKey||i.altKey||i.ctrlKey){return}if(s(e.activeElement)){o(e.activeElement)}t=true}function u(e){t=false}function d(e){if(!s(e.target)){return}if(t||r(e.target)){o(e.target)}}function f(e){if(!s(e.target)){return}if(e.target.classList.contains("focus-visible")||e.target.hasAttribute("data-focus-visible-added")){i=true;window.clearTimeout(a);a=window.setTimeout((function(){i=false}),100);l(e.target)}}function h(e){if(document.visibilityState==="hidden"){if(i){t=true}p()}}function p(){document.addEventListener("mousemove",g);document.addEventListener("mousedown",g);document.addEventListener("mouseup",g);document.addEventListener("pointermove",g);document.addEventListener("pointerdown",g);document.addEventListener("pointerup",g);document.addEventListener("touchmove",g);document.addEventListener("touchstart",g);document.addEventListener("touchend",g)}function m(){document.removeEventListener("mousemove",g);document.removeEventListener("mousedown",g);document.removeEventListener("mouseup",g);document.removeEventListener("pointermove",g);document.removeEventListener("pointerdown",g);document.removeEventListener("pointerup",g);document.removeEventListener("touchmove",g);document.removeEventListener("touchstart",g);document.removeEventListener("touchend",g)}function g(e){if(e.target.nodeName&&e.target.nodeName.toLowerCase()==="html"){return}t=false;m()}document.addEventListener("keydown",c,true);document.addEventListener("mousedown",u,true);document.addEventListener("pointerdown",u,true);document.addEventListener("touchstart",u,true);document.addEventListener("visibilitychange",h,true);p();e.addEventListener("focus",d,true);e.addEventListener("blur",f,true);if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host){e.host.setAttribute("data-js-focus-visible","")}else if(e.nodeType===Node.DOCUMENT_NODE){document.documentElement.classList.add("js-focus-visible");document.documentElement.setAttribute("data-js-focus-visible","")}}if(typeof window!=="undefined"&&typeof document!=="undefined"){window.applyFocusVisiblePolyfill=e;var t;try{t=new CustomEvent("focus-visible-polyfill-ready")}catch(e){t=document.createEvent("CustomEvent");t.initCustomEvent("focus-visible-polyfill-ready",false,false,{})}window.dispatchEvent(t)}if(typeof document!=="undefined"){e(document)}})();
/*! iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */(function(e,t,i){var a=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)};var n=function(){var a={};var n=t.createElement("div").style;var s=function(){var e=["t","webkitT","MozT","msT","OT"],t,i=0,a=e.length;for(;i<a;i++){t=e[i]+"ransform";if(t in n)return e[i].substr(0,e[i].length-1)}return false}();function r(e){if(s===false)return false;if(s==="")return e;return s+e.charAt(0).toUpperCase()+e.substr(1)}a.getTime=Date.now||function e(){return(new Date).getTime()};a.extend=function(e,t){for(var i in t){e[i]=t[i]}};a.addEvent=function(e,t,i,a){e.addEventListener(t,i,!!a)};a.removeEvent=function(e,t,i,a){e.removeEventListener(t,i,!!a)};a.prefixPointerEvent=function(t){return e.MSPointerEvent?"MSPointer"+t.charAt(9).toUpperCase()+t.substr(10):t};a.momentum=function(e,t,a,n,s,r){var o=e-t,l=i.abs(o)/a,c,u;r=r===undefined?6e-4:r;c=e+l*l/(2*r)*(o<0?-1:1);u=l/r;if(c<n){c=s?n-s/2.5*(l/8):n;o=i.abs(c-e);u=o/l}else if(c>0){c=s?s/2.5*(l/8):0;o=i.abs(e)+c;u=o/l}return{destination:i.round(c),duration:u}};var o=r("transform");a.extend(a,{hasTransform:o!==false,hasPerspective:r("perspective")in n,hasTouch:"ontouchstart"in e,hasPointer:e.PointerEvent||e.MSPointerEvent,hasTransition:r("transition")in n});a.isBadAndroid=/Android /.test(e.navigator.appVersion)&&!/Chrome\/\d/.test(e.navigator.appVersion);a.extend(a.style={},{transform:o,transitionTimingFunction:r("transitionTimingFunction"),transitionDuration:r("transitionDuration"),transitionDelay:r("transitionDelay"),transformOrigin:r("transformOrigin")});a.hasClass=function(e,t){var i=new RegExp("(^|\\s)"+t+"(\\s|$)");return i.test(e.className)};a.addClass=function(e,t){if(a.hasClass(e,t)){return}var i=e.className.split(" ");i.push(t);e.className=i.join(" ")};a.removeClass=function(e,t){if(!a.hasClass(e,t)){return}var i=new RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(i," ")};a.offset=function(e){var t=-e.offsetLeft,i=-e.offsetTop;while(e=e.offsetParent){t-=e.offsetLeft;i-=e.offsetTop}return{left:t,top:i}};a.preventDefaultException=function(e,t){for(var i in t){if(t[i].test(e[i])){return true}}return false};a.extend(a.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});a.extend(a.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return i.sqrt(1- --e*e)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(e){var t=4;return(e=e-1)*e*((t+1)*e+t)+1}},bounce:{style:"",fn:function(e){if((e/=1)<1/2.75){return 7.5625*e*e}else if(e<2/2.75){return 7.5625*(e-=1.5/2.75)*e+.75}else if(e<2.5/2.75){return 7.5625*(e-=2.25/2.75)*e+.9375}else{return 7.5625*(e-=2.625/2.75)*e+.984375}}},elastic:{style:"",fn:function(e){var t=.22,a=.4;if(e===0){return 0}if(e==1){return 1}return a*i.pow(2,-10*e)*i.sin((e-t/4)*(2*i.PI)/t)+1}}});a.tap=function(e,i){var a=t.createEvent("Event");a.initEvent(i,true,true);a.pageX=e.pageX;a.pageY=e.pageY;e.target.dispatchEvent(a)};a.click=function(e){var i=e.target,a;if(!/(SELECT|INPUT|TEXTAREA)/i.test(i.tagName)){a=t.createEvent("MouseEvents");a.initMouseEvent("click",true,true,e.view,1,i.screenX,i.screenY,i.clientX,i.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null);a._constructed=true;i.dispatchEvent(a)}};return a}();function s(e,i){this.wrapper=typeof e=="string"?t.querySelector(e):e;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.options={startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:"",preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true};for(var a in i){this.options[a]=i[a]}this.translateZ=this.options.HWCompositing&&n.hasPerspective?" translateZ(0)":"";this.options.useTransition=n.hasTransition&&this.options.useTransition;this.options.useTransform=n.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=="vertical"?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=="horizontal"?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=="string"?n.ease[this.options.bounceEasing]||n.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap="tap"}this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable()}s.prototype={version:"5.1.3",_init:function(){this._initEvents()},destroy:function(){this._initEvents(true);this._execEvent("destroy")},_transitionEnd:function(e){if(e.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent("scrollEnd")}},_start:function(e){if(n.eventType[e.type]!=1){if(e.button!==0){return}}if(!this.enabled||this.initiated&&n.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault&&!n.isBadAndroid&&!n.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault()}var t=e.touches?e.touches[0]:e,a;this.initiated=n.eventType[e.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=n.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;a=this.getComputedPosition();this._translate(i.round(a.x),i.round(a.y));this._execEvent("scrollEnd")}else if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent("scrollEnd")}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=t.pageX;this.pointY=t.pageY;this._execEvent("beforeScrollStart")},_move:function(e){if(!this.enabled||n.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault){e.preventDefault()}var t=e.touches?e.touches[0]:e,a=t.pageX-this.pointX,s=t.pageY-this.pointY,r=n.getTime(),o,l,c,u;this.pointX=t.pageX;this.pointY=t.pageY;this.distX+=a;this.distY+=s;c=i.abs(this.distX);u=i.abs(this.distY);if(r-this.endTime>300&&(c<10&&u<10)){return}if(!this.directionLocked&&!this.options.freeScroll){if(c>u+this.options.directionLockThreshold){this.directionLocked="h"}else if(u>=c+this.options.directionLockThreshold){this.directionLocked="v"}else{this.directionLocked="n"}}if(this.directionLocked=="h"){if(this.options.eventPassthrough=="vertical"){e.preventDefault()}else if(this.options.eventPassthrough=="horizontal"){this.initiated=false;return}s=0}else if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal"){e.preventDefault()}else if(this.options.eventPassthrough=="vertical"){this.initiated=false;return}a=0}a=this.hasHorizontalScroll?a:0;s=this.hasVerticalScroll?s:0;o=this.x+a;l=this.y+s;if(o>0||o<this.maxScrollX){o=this.options.bounce?this.x+a/3:o>0?0:this.maxScrollX}if(l>0||l<this.maxScrollY){l=this.options.bounce?this.y+s/3:l>0?0:this.maxScrollY}this.directionX=a>0?-1:a<0?1:0;this.directionY=s>0?-1:s<0?1:0;if(!this.moved){this._execEvent("scrollStart")}this.moved=true;this._translate(o,l);if(r-this.startTime>300){this.startTime=r;this.startX=this.x;this.startY=this.y}},_end:function(e){if(!this.enabled||n.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault&&!n.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault()}var t=e.changedTouches?e.changedTouches[0]:e,a,s,r=n.getTime()-this.startTime,o=i.round(this.x),l=i.round(this.y),c=i.abs(o-this.startX),u=i.abs(l-this.startY),d=0,f="";this.isInTransition=0;this.initiated=0;this.endTime=n.getTime();if(this.resetPosition(this.options.bounceTime)){return}this.scrollTo(o,l);if(!this.moved){if(this.options.tap){n.tap(e,this.options.tap)}if(this.options.click){n.click(e)}this._execEvent("scrollCancel");return}if(this._events.flick&&r<200&&c<100&&u<100){this._execEvent("flick");return}if(this.options.momentum&&r<300){a=this.hasHorizontalScroll?n.momentum(this.x,this.startX,r,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:o,duration:0};s=this.hasVerticalScroll?n.momentum(this.y,this.startY,r,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:l,duration:0};o=a.destination;l=s.destination;d=i.max(a.duration,s.duration);this.isInTransition=1}if(o!=this.x||l!=this.y){if(o>0||o<this.maxScrollX||l>0||l<this.maxScrollY){f=n.ease.quadratic}this.scrollTo(o,l,d,f);return}this._execEvent("scrollEnd")},_resize:function(){var e=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout((function(){e.refresh()}),this.options.resizePolling)},resetPosition:function(e){var t=this.x,i=this.y;e=e||0;if(!this.hasHorizontalScroll||this.x>0){t=0}else if(this.x<this.maxScrollX){t=this.maxScrollX}if(!this.hasVerticalScroll||this.y>0){i=0}else if(this.y<this.maxScrollY){i=this.maxScrollY}if(t==this.x&&i==this.y){return false}this.scrollTo(t,i,e,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},refresh:function(){var e=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=n.offset(this.wrapper);this._execEvent("refresh");this.resetPosition()},on:function(e,t){if(!this._events[e]){this._events[e]=[]}this._events[e].push(t)},off:function(e,t){if(!this._events[e]){return}var i=this._events[e].indexOf(t);if(i>-1){this._events[e].splice(i,1)}},_execEvent:function(e){if(!this._events[e]){return}var t=0,i=this._events[e].length;if(!i){return}for(;t<i;t++){this._events[e][t].apply(this,[].slice.call(arguments,1))}},scrollBy:function(e,t,i,a){e=this.x+e;t=this.y+t;i=i||0;this.scrollTo(e,t,i,a)},scrollTo:function(e,t,i,a){a=a||n.ease.circular;this.isInTransition=this.options.useTransition&&i>0;if(!i||this.options.useTransition&&a.style){this._transitionTimingFunction(a.style);this._transitionTime(i);this._translate(e,t)}else{this._animate(e,t,i,a.fn)}},scrollToElement:function(e,t,a,s,r){e=e.nodeType?e:this.scroller.querySelector(e);if(!e){return}var o=n.offset(e);o.left-=this.wrapperOffset.left;o.top-=this.wrapperOffset.top;if(a===true){a=i.round(e.offsetWidth/2-this.wrapper.offsetWidth/2)}if(s===true){s=i.round(e.offsetHeight/2-this.wrapper.offsetHeight/2)}o.left-=a||0;o.top-=s||0;o.left=o.left>0?0:o.left<this.maxScrollX?this.maxScrollX:o.left;o.top=o.top>0?0:o.top<this.maxScrollY?this.maxScrollY:o.top;t=t===undefined||t===null||t==="auto"?i.max(i.abs(this.x-o.left),i.abs(this.y-o.top)):t;this.scrollTo(o.left,o.top,t,r)},_transitionTime:function(e){e=e||0;this.scrollerStyle[n.style.transitionDuration]=e+"ms";if(!e&&n.isBadAndroid){this.scrollerStyle[n.style.transitionDuration]="0.001s"}},_transitionTimingFunction:function(e){this.scrollerStyle[n.style.transitionTimingFunction]=e},_translate:function(e,t){if(this.options.useTransform){this.scrollerStyle[n.style.transform]="translate("+e+"px,"+t+"px)"+this.translateZ}else{e=i.round(e);t=i.round(t);this.scrollerStyle.left=e+"px";this.scrollerStyle.top=t+"px"}this.x=e;this.y=t},_initEvents:function(t){var i=t?n.removeEvent:n.addEvent,a=this.options.bindToWrapper?this.wrapper:e;i(e,"orientationchange",this);i(e,"resize",this);if(this.options.click){i(this.wrapper,"click",this,true)}if(!this.options.disableMouse){i(this.wrapper,"mousedown",this);i(a,"mousemove",this);i(a,"mousecancel",this);i(a,"mouseup",this)}if(n.hasPointer&&!this.options.disablePointer){i(this.wrapper,n.prefixPointerEvent("pointerdown"),this);i(a,n.prefixPointerEvent("pointermove"),this);i(a,n.prefixPointerEvent("pointercancel"),this);i(a,n.prefixPointerEvent("pointerup"),this)}if(n.hasTouch&&!this.options.disableTouch){i(this.wrapper,"touchstart",this);i(a,"touchmove",this);i(a,"touchcancel",this);i(a,"touchend",this)}i(this.scroller,"transitionend",this);i(this.scroller,"webkitTransitionEnd",this);i(this.scroller,"oTransitionEnd",this);i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var t=e.getComputedStyle(this.scroller,null),i,a;if(this.options.useTransform){t=t[n.style.transform].split(")")[0].split(", ");i=+(t[12]||t[4]);a=+(t[13]||t[5])}else{i=+t.left.replace(/[^-\d.]/g,"");a=+t.top.replace(/[^-\d.]/g,"")}return{x:i,y:a}},_animate:function(e,t,i,s){var r=this,o=this.x,l=this.y,c=n.getTime(),u=c+i;function d(){var f=n.getTime(),h,p,m;if(f>=u){r.isAnimating=false;r._translate(e,t);if(!r.resetPosition(r.options.bounceTime)){r._execEvent("scrollEnd")}return}f=(f-c)/i;m=s(f);h=(e-o)*m+o;p=(t-l)*m+l;r._translate(h,p);if(r.isAnimating){a(d)}}this.isAnimating=true;d()},handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);break;case"click":if(!e._constructed){e.preventDefault();e.stopPropagation()}break}}};s.utils=n;if(typeof module!="undefined"&&module.exports){module.exports=s}else{e.IScroll=s}})(window,document,Math);var g_localTime=new Date;var g_blogimages={};function MessageBox(e,t){e.find(".wh-message-box").remove();var i=$("<div></div>");i.hide();i.addClass("wh-message-box");i.html('<div class="message">'+t+'</div><div class="close" title="Click on this box to close it"></div>');i.click((function(){$(this).fadeOut()}));e.append(i[0]);i.fadeIn()}function Rectangle(e,t,i,a){this.l=e;this.t=t;this.r=e+i;this.b=t+a}Rectangle.prototype={intersectWith:function(e){return!(this.l>=e.r||e.l>=this.r||this.t>=e.b||e.t>=this.b)},contains:function(e){return this.l<=e.l&&this.t<=e.t&&this.r>=e.r&&this.b>=e.b},containedIn:function(e){return e.contains(this)}};WH.aE(window,"load",(function(){if(!(window.JSON&&WH.LocalStorage.isSupported())){return}var e=WH.LocalStorage.get("lvBrowse");if(!e)return;e=window.JSON.parse(e);if(!e)return;var t=/^\/[-a-z]+=\d+/i;var i=t.exec(location.pathname);if(!i)return;i=i[0];var a=function(e,t){if(!t){return WH.ce("i",{className:"fa fa-"+e})}return WH.ce("a",{className:"fa fa-"+e,href:t})};for(var n=0;n<e.length;n++){var s=e[n].urls;for(var r=0;r<s.length;r++){if(s[r]==i){var o=r>0?s[r-1]:false;var l=r+1<s.length?s[r+1]:false;var c=e[n].path+e[n].hash;var u=WH.qs(".breadcrumb");if(!u){return}var d=WH.ce("div",{className:"breadcrumb-browse"});WH.ae(u,d);var f=a("arrow-circle-up",c);WH.Tooltip.simple(f,WH.TERMS.backtolist,"q2",undefined,undefined,true);WH.ae(d,a("arrow-circle-left",o));WH.ae(d,f);WH.ae(d,a("arrow-circle-right",l));return}}}}));WH.smoothScroll=function(e,t){switch(typeof e){case"string":case"object":case"jQuery":var i=$(e).offset();if(!i){return}e=i.top;break;case"number":break;default:return}if(WH.Layout.Responsive.isZulInMobileMode()){e-=50}else{e-=10}$("html, body").animate({scrollTop:e},t||500)};WH.getReputationPlusAchievementText=function(e,t,i,a){var n=WH.getAchievementText(e,t,i,true);var s=$("<span>").addClass("wsach-pts");s.mouseover((function(e){WH.Tooltip.showAtCursor(e,WH.TERMS.reputationtip,0,0,"q")})).mousemove((function(e){WH.Tooltip.cursorUpdate(e)})).mouseout((function(){WH.Tooltip.hide()}));s.addClass("q1");s.text(WH.numberFormat(a));var r=$("<span>");r.append(" (");r.append(s);r.append(" &ndash; ");r.append(n);r.append(") ");return r};WH.getAchievementText=function(e,t,i,a){var n=$("<span>").addClass("wsach-pts");n.mouseover((function(e){WH.Tooltip.showAtCursor(e,WH.TERMS.userachcount_tip,0,0,"q")})).mousemove((function(e){WH.Tooltip.cursorUpdate(e)})).mouseout((function(){WH.Tooltip.hide()}));var s=" ";if(!a){s+=" ("}if(e){s+="<i>"+e+"</i>"+"&middot;"}if(t){s+="<b>"+t+"</b>"+"&middot;"}if(!i){i=0}s+="<u>"+i+"</u>";if(!a){s+=")"}n.html(s);return n};WH.formatTimeElapsed=function(e){const t={abbreviated:[WH.TERMS.year_abbrev,WH.TERMS.month_abbrev,WH.TERMS.week_abbrev,WH.TERMS.day_abbrev,WH.TERMS.hour_abbrev,WH.TERMS.minute_abbrev,WH.TERMS.second_abbrev],singular:[WH.TERMS.year_lc,WH.TERMS.month_lc,WH.TERMS.week_lc,WH.TERMS.day_lc,WH.TERMS.hour_lc,WH.TERMS.minute_lc,WH.TERMS.second_lc],plural:[WH.TERMS.years_lc,WH.TERMS.months_lc,WH.TERMS.weeks_lc,WH.TERMS.days_lc,WH.TERMS.hours_lc,WH.TERMS.minutes_lc,WH.TERMS.seconds_lc]};function i(e,i,a){if(a){return e+" "+t.abbreviated[i]}else{return e+" "+(e==1?t.singular[i]:t.plural[i])}}var a=[31557600,2629800,604800,86400,3600,60,1];var n=[1,3,3,-1,5,-1,-1];e=Math.max(e,1);for(var s=3,r=a.length;s<r;++s){if(e>=a[s]){var o=s;var l=Math.floor(e/a[o]);if(n[o]!=-1){var c=n[o];e%=a[o];var u=Math.floor(e/a[c]);if(u>0){return i(l,o,1)+" "+i(u,c,1)}}return i(l,o,0)}}return"(n/a)"};WH.formatDate=function(e,t,i,a,n){var s=new Date;var r=new Date;r.setTime(s.getTime()-1e3*t);var o;var l=new Date(r.getYear(),r.getMonth(),r.getDate());var c=new Date(s.getYear(),s.getMonth(),s.getDate());var u=c.getTime()-l.getTime();u/=1e3;u/=86400;u=Math.round(u);if(t>=2592e3){o=WH.TERMS.on_lc+WH.formatDateSimple(i,a)}else if(u>1){o=WH.sprintf(WH.TERMS.daysago_format,u);if(e){var d=new Date;d.setTime(i.getTime()+(g_localTime-WH.getServerTime()));e.className+=" tip";e.title=d.toLocaleString()}}else if(t>=43200){if(s.getDay()==r.getDay()){o=WH.TERMS.today_lc}else{o=WH.TERMS.yesterday_lc}o=WH.formatTimeSimple(r,o);if(e){var d=new Date;d.setTime(i.getTime()+(g_localTime-WH.getServerTime()));e.className+=" tip";e.title=d.toLocaleString()}}else{o=WH.sprintf(WH.TERMS.ago2_format,WH.formatTimeElapsed(t));if(e){var d=new Date;d.setTime(i.getTime()+(g_localTime-WH.getServerTime()));e.className+=" tip";e.title=d.toLocaleString()}}if(n==1){o=o.substr(0,1).toUpperCase()+o.substr(1)}if(e){WH.ae(e,WH.ct(o))}else{return o}};WH.formatDateSimple=function(e,t){function i(e){return e<10?"0"+e:e}var a="",n=e.getDate(),s=e.getMonth()+1,r=e.getFullYear();if(r<=1970){a+=WH.TERMS.unknowndate_stc}else{a+=WH.sprintf(WH.TERMS.date3_format,i(n),i(s),r)}if(t!=null){a=WH.formatTimeSimple(e,a)}return a};WH.formatTimeSimple=function(e,t,i){function a(e){return e<10?"0"+e:e}var n=e.getHours(),s=e.getMinutes();if(t==null){t=""}t+=i?" ":WH.TERMS.at_lc;if(n==12){t+=WH.TERMS.noon_lc}else if(n==0){t+=WH.TERMS.midnight_lc}else if(n>12){t+=n-12+":"+a(s)+" "+WH.TERMS.pm}else{t+=n+":"+a(s)+" "+WH.TERMS.am}return t};WH.formatStartEndDates=function(e,t){if(!e&&!t){return""}var i=false;var a=false;if(e)i=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate());if(t)a=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate());var n="";if(!a){n=WH.TERMS.starts+" "+i.toLocaleDateString()}else if(!i){n=WH.TERMS.ends+" "+a.toLocaleDateString()}else{var s=function(){try{(new Date).toLocaleDateString("i")}catch(e){return e.name==="RangeError"}return false}();var r={month:"long",year:"numeric"};var o="",l="",c=0;if(s&&i.getDate()==1){o=i.toLocaleDateString(undefined,r);c++}else{o=i.toLocaleDateString()}if(s&&new Date(a.valueOf()+36*60*60*1e3).getMonth()!=a.getMonth()){l=a.toLocaleDateString(undefined,r);c++}else{l=a.toLocaleDateString()}if(o==l){n=o}else if(c==1){n=i.toLocaleDateString()+" - "+a.toLocaleDateString()}else{n=o+" - "+l}}return n};WH.createTextGlow=function(e,t){var i=WH.ce("span");for(var a=-1;a<=1;++a){for(var n=-1;n<=1;++n){var s=WH.ce("div");s.style.position="absolute";s.style.whiteSpace="nowrap";s.style.left=a+"px";s.style.top=n+"px";if(a==0&&n==0){s.style.zIndex=4}else{s.style.color="black";s.style.zIndex=2}s.innerHTML=e;WH.ae(i,s)}}i.style.position="relative";i.className="glow"+(t!=null?" "+t:"");var r=WH.ce("span");r.style.visibility="hidden";r.innerHTML+=e;WH.ae(i,r);return i};WH.createProgressBar=function(e){if(e==null)e={};if(typeof e.text=="undefined"){e.text=" "}if(e.color==null){e.color="rep0"}if(e.width==null||e.width>100){e.width=100}var t,i;if(e.hoverText){t=WH.ce("a");t.href="javascript:"}else{t=WH.ce("span")}t.className="progressbar";if(e.text||e.hoverText){i=WH.ce("div");i.className="progressbar-text";if(e.text){var a=WH.ce("del");WH.ae(a,WH.ct(e.text));WH.ae(i,a)}if(e.hoverText){var n=WH.ce("ins");WH.ae(n,WH.ct(e.hoverText));WH.ae(i,n)}WH.ae(t,i)}i=WH.ce("div");i.className="progressbar-"+e.color;i.style.width=e.width+"%";if(e.height){i.style.height=e.height}WH.ae(i,WH.ct(WH.Strings.nbsp));WH.ae(t,i);if(e.text){var i=WH.ce("div");i.className="progressbar-text progressbar-hidden";WH.ae(i,WH.ct(e.text));WH.ae(t,i)}return t};WH.createReputationBar=function(e,t){if(!t){t=0}var i=WH.getReputationProgress(t);var a=i.length>0?i[i.length-1][1]+999:0;if(!e)e=0;if(e<0){e=0}else if(e>a){e=a}var n=e,s=0,r,o=a;if(a!=0){while(s<i.length){if(e<i[s][1]){break}++s}--s;n-=i[s][1];o=s+1<i.length?i[s+1][1]-i[s][1]:999}if(t){r=g_friendship_reactions[WH.sprintf("$1-$2",t,s)]}else{r=g_reputation_standings[s]}var l={text:r,hoverText:n+" / "+o,color:"rep"+s,width:parseInt(n/o*100)};return WH.createProgressBar(l)};WH.getReputationProgress=function(e){if(window.g_friendships_thresholds&&Array.isArray(g_friendships_thresholds[e])){return g_friendships_thresholds[e]}return[[0,0],[0,36e3],[0,39e3],[0,42e3],[0,45e3],[0,51e3],[0,63e3],[0,84e3]]};WH.createAchievementBar=function(e,t,i,a){if(!e){e=0}var n={text:e+(a>0?"(+"+a+")":"")+(t>0?" / "+t:""),color:i?"rep7":"ach"+(t>0?0:1),width:t>0?parseInt(e/t*100):100};return WH.createProgressBar(n)};WH.addCompletionIcons=function(e,t,i,a){var n=0;let s;if(t==="transmog-set"){s=typeof i==="object"?i:WH.getPageData("transmog-set-detail-completion")}for(var r in g_user.lists){if(!g_user.lists.hasOwnProperty(r)){continue}let o=g_user.lists[r];if(!o.character){continue}let l=0;if(t==="transmog-set"){l=WH.Wow.TransmogSet.getCompletionAmount(s,o.id);if(l==null){continue}}else{if(!(o.id in g_completion[t])){continue}l=WH.inArray(g_completion[t][o.id],i)!=-1?1:0}if(a&&!l){continue}WH.ae(e,WH.createCompletionIcon(o,l));n++}if(t==="quest"&&g_user.characterProfiles&&g_user.characterProfiles.length){for(var o,r=0;o=g_user.characterProfiles[r];r++){var l=WH.inArray(o.quests,i)!=-1;if(a&&!l){continue}WH.ae(e,WH.createCompletionIcon({classs:o["class"],character:o.name,realm:o.realm},l?1:0));n++}}return n};WH.createCompletionIcon=function(e,t,i){var a=WH.ce("a");if(e.url){a.href="/list="+e.id+"/"+e.url}a.className="progress-icon progress-"+(t?Math.max(1,Math.floor(t*8)):0);WH.Tooltip.simple(a,WH.getCompletionTooltip(e,t),"",true);if(i){a.rel=i}return a};WH.getCompletionTooltip=function(e,t){let i=WH.ce("div");WH.ae(i,WH.ce("span",{className:"q"},WH.ct((t>=1?WH.TERMS.complete:WH.TERMS.incomplete)+WH.TERMS.colon_punct)));WH.ae(i,WH.ce("br"));let a=WH.ce("span",{style:{whiteSpace:"nowrap"}});WH.ae(i,a);WH.ae(a,WH.ce("b",{className:"c"+e.classs},WH.ct(e.character)));let n=[WH.Strings.nbsp,e.realm];if(e.hasOwnProperty("region")){n.push(e.region)}WH.ae(a,WH.ce("span",{className:"q0"},WH.ct(n.join(" "))));if(t>0&&t<1){WH.ae(a,WH.ct(WH.Strings.sprintf(WH.TERMS.parens_format,"",Math.round(t*100)+"%")))}return i.innerHTML};WH.getCompletionFlags=function(e,t){var i=0;var a=g_user.lists||[];for(var n=a.length-1;n>=0;n--){var s=a[n];if(!(s.id in g_completion[e])||!s.character){continue}i=i<<1|(WH.inArray(g_completion[e][s.id],t)!=-1?1:0)}if(e==="quest"&&g_user.characterProfiles&&g_user.characterProfiles.length){for(var n=g_user.characterProfiles.length-1;n>=0;n--){var r=g_user.characterProfiles[n];var o=WH.inArray(r.quests,t)!=-1;i=i<<1|(o?1:0)}}return i};WH.preventPageScroll=function(e){var t=e.originalEvent&&e.originalEvent.wheelDelta||e.originalEvent&&-e.originalEvent.detail||e.wheelDelta||-e.detail;this.scrollTop+=(t<0?1:-1)*100;e.preventDefault()};WH.pickerWheel=function(e){e.preventDefault();if(e.deltaY>0){this.scrollTop+=100}else{this.scrollTop-=100}};WH.setSelectedLink=function(e,t){if(!WH.setSelectedLink.groups){WH.setSelectedLink.groups={}}var i=WH.setSelectedLink.groups;if(i[t]){i[t].className=i[t].className.replace("selected","")}e.className+=" selected";i[t]=e};WH.addPagination=function(e,t){function i(e,i){var a;if(e==t.page){a=WH.ce("span");a.className="selected"}else{a=WH.ce("a");a.href=e>1?t.url+t.sep+e+t.pound:t.url+t.pound}WH.ae(a,WH.ct(i!=null?i:e));return a}if(!t.pound){t.pound=""}if(!t.sep){t.sep="."}if(t.allOrNothing&&t.nPages<=1){return}var a=t.align&&t.align=="left";var n=WH.ce("div"),s,r=WH.ce("var");n.className="pages";if(a){n.className+=" pages-left"}if(t.nPages>1){s=WH.ce("div");s.className="pages-numbers";var o=Math.max(2,t.page-2);var l=Math.min(t.nPages-1,t.page+2);var c=[];if(t.page!=t.nPages){c.push(i(t.page+1,String.fromCharCode(187)))}c.push(i(t.nPages));if(l<t.nPages-1){var u=WH.ce("span");WH.ae(u,WH.ct("..."));c.push(u)}for(var d=l;d>=o;--d){c.push(i(d))}if(o>2){var u=WH.ce("span");WH.ae(u,WH.ct("..."));c.push(u)}c.push(i(1));if(t.page!=1){c.push(i(t.page-1,String.fromCharCode(171)))}if(a){c.reverse()}for(var d=0,f=c.length;d<f;++d){WH.ae(s,c[d])}s.firstChild.style.marginRight="0";s.lastChild.style.marginLeft="0"}var r=WH.ce("var");WH.ae(r,WH.ct(WH.Strings.sprintf(WH.TERMS[t.wording[t.nItems==1?0:1]],t.nItems)));if(t.nPages>1){var u=WH.ce("span");WH.ae(u,WH.ct(String.fromCharCode(8211)));WH.ae(r,u);var h=WH.ce("a");h.className="go-to-page fa fa-files-o";h.href="javascript:";h.onclick=function(){var e=prompt(WH.sprintf(WH.TERMS.gotopage_format,1,t.nPages),t.page);if(e!=null){e|=0;if(e!=t.page&&e>=1&&e<=t.nPages){document.location.href=e>1?t.url+t.sep+e+t.pound:t.url+t.pound}}};h.onmouseover=function(e){WH.Tooltip.showAtCursor(e,WH.TERMS.gotopage_tip,0,0,"q2")};h.onmousemove=WH.Tooltip.cursorUpdate;h.onmouseout=WH.Tooltip.hide;WH.ae(r,h)}if(a){WH.ae(n,r);if(s){WH.ae(n,s)}}else{if(s){WH.ae(n,s)}WH.ae(n,r)}WH.ae(e,n)};WH.disclose=function(e,t){let i=WH.toggleDisplay(e,true);t.classList.remove("disclosure-"+(i?"off":"on"));t.classList.add("disclosure-"+(i?"on":"off"));return false};WH.toggle=function(e){let t=WH.toggleDisplay(e,true);this.classList.remove("toggler-"+(t?"off":"on"));this.classList.add("toggler-"+(t?"on":"off"));return false};WH.setupChangeWarning=function(e,t,i){if(!e){return}function a(){return i}e.submit((function(){window.onbeforeunload=null}));var n=[];for(var s in t){var r=t[s];if(!r){continue}n[s]=r.val();r.keydown((function(){for(var e in t){var i=t[e];if(!i){continue}if(i.val()!=n[e]){window.onbeforeunload=a;return}window.onbeforeunload=null}}))}};$(document).ready((function(){WH.qsa("dfn[title]").forEach((function(e){let t=e.title;e.removeAttribute("title");e.classList.add("tip");WH.Tooltip.simple(e,t,"q",undefined,undefined,undefined,250)}));$(".text").bind("copy",(function(){$("*[unselectable]",this).each((function(e,t){var i=$(t).text();$(t).text("");setTimeout((function(){$(t).text(i)}),1)}))}))}));$(document).ready((function(){$("input").each((function(){var e=$(this).attr("maxlength");var t=$(this).attr("data-charwarning");var i=t?$("#"+t):null;if(!e||!i){return}var a=function(){i.hide()};var n=function(t){var a=e-t;var n=t/e;var s=parseInt(n>=.5?255:n*2*255).toString(16);var r=parseInt(n<.5?255:255-(n-.5)*2*255).toString(16);if(s.length==1){s="0"+s}if(r.length==1){r="0"+r}i.text(WH.sprintf(WH.TERMS.charactersremaining_format,a));i.show();i.css("color","#"+s+r+"00")};$(this).focus((function(){n($(this).val().length)})).blur((function(){a()})).keyup((function(){n($(this).val().length)}))}))}));WH.getN5=function(e){var t=Math.abs(e);if(t<1e4){return WH.numberFormat(e)}if(t<1e5){return Math.round(e/100)/10+"k"}if(t<1e6){return Math.round(e/1e3)+"k"}if(t<1e7){return Math.round(e/1e3/10)/100+"m"}if(t<1e8){return Math.round(e/1e3/100)/10+"m"}if(t<1e9){return Math.round(e/1e3/1e3)+"m"}if(t<1e10){return Math.round(e/1e3/1e3/10)/100+"b"}if(t<1e10){return Math.round(e/1e3/1e3/100)/10+"b"}return Math.round(e/1e3/1e3/1e3)+"b"};WH.debug=function(e){if(!WH.isDev()&&!WH.User.hasRole(U_GROUP_ADMIN)){WH.debug=function(){};return}WH.debug=function(){var e=["DEBUG:"];var t=null;try{var i=(new Error).stack.split("\n");if(typeof i[2]==="string"){var a=i[2].replace(/^ *at /,"");t=a.match(/(.*) \(([^()]+)\)$/);if(t){if(WH.suppressExternalDebug()&&t[2].indexOf(WH.staticUrl)===-1){return}e.push(t[1])}else{e.push(a)}}}catch(e){}e=e.concat(Array.prototype.slice.call(arguments));if(t){e.push(t[2])}console.debug.apply(console.debug,e)};WH.debug.apply(WH,Array.prototype.slice.call(arguments))};WH.decodeNumber=function(e,t){var i=0;e=e+"";var a=1;while(e.length>0){var n=e.charAt(e.length-1);var s=t.indexOf(n);if(s===-1){return null}i+=s*a;a*=t.length;e=e.substr(0,e.length-1)}return i};WH.encodeNumber=function(e,t){var i=t.length;var a=[e];while(a[0]>i){var n=Math.floor(a[0]/i);a[0]=a[0]-n*i;a.unshift(n)}var s="";for(var r=0,o=a.length;r<o;r++){s+=t.charAt(a[r])}return s};WH.getThrownErrorMessage=function(e){if(typeof e==="string"){return e}return e&&[e.name,e.message].filter(Boolean).join(": ")||"Unknown error"};WH.userIsLoggedIn=function(){return typeof g_user=="object"&&g_user.id};WH.getElementViewportOffset=function(e){if(!(e instanceof jQuery)){e=$(e)}var t=e.offset().top;var i=t+e.outerHeight();var a=$(window);var n=a.scrollTop();var s=n+a.height();if(i>s){return i-s}if(t<n){return t-n}return 0};WH.onLoad=function(e){if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",e)}else{requestAnimationFrame(e)}};WH.onMutate=function(e,t,i){i=i||{};if(typeof MutationObserver==="undefined"){if(i.fallbackTimer!==false){let a=i.triggerOnce?setTimeout:setInterval;a(t.bind(e),i.fallbackTimer||150)}return}var a={observer:null};var n=i.triggerOnce?function(){a.observer.disconnect();t.apply(e)}:t.bind(e);var s={characterData:true,childList:true,subtree:true};var r=["attributes","characterData","childList","subtree"];for(var o=0,l=r.length;o<l;o++){if(i.hasOwnProperty(r[o])){s[r[o]]=i[r[o]]}}var c=new MutationObserver(n);a.observer=c;c.observe(e,s)};WH.getMajorHeading=function(e,t,i,a){if(isNaN(t)||t<1||t>6){t=2}if(isNaN(i)||i<1||i>6){i=t}var n=["heading-size-"+i];return WH.constructHeading("h"+t,e,n,a)};WH.getImitationHeading=function(e,t,i){if(isNaN(t)||t<1||t>6){t=2}var a=["imitation-heading","heading-size-"+t];return WH.constructHeading("div",e,a,i)};WH.constructHeading=function(e,t,i,a){if(typeof a!="object"){a={}}if(typeof a.classes=="string"){i.push(a.classes)}var n=WH.ce(e);n.className=i.join(" ");if(typeof a.styles=="string"){n.style=a.styles}if(typeof a.id=="string"){n.id=a.id}if(typeof t=="string"){n.innerHTML=t}else if(t.nodeType===Node.ELEMENT_NODE||t.nodeType===Node.TEXT_NODE){n.appendChild(t)}else{$(n).append(t)}return n};WH.clickToCopy=function(e,t,i){i=i||{};WH.aE(e,"click",WH.clickToCopy.copy.bind(null,e,t,i));WH.preventSelectStart(e);e.classList.add("click-to-copy");if(i.modifyTooltip){e._fixTooltip=function(e){return e+"<br>"+WH.ce("span",{className:"q2",innerHTML:WH.clickToCopy.getTooltip(false,i)}).outerHTML};i.overrideOtherTooltips=false}WH.Tooltip.simple(e,WH.clickToCopy.getTooltip.bind(null,false,i),undefined,i.attachToElement,i.overrideOtherTooltips)};WH.clickToCopy.copy=function(e,t,i,a){a.preventDefault();a.stopPropagation();if(t===undefined){if(!e.childNodes[0]||!e.childNodes[0].textContent){let t="Could not find text to copy.";WH.error(t,e);if(i.attachToElement){WH.Tooltip.show(e,t,undefined,undefined,"q10")}else{WH.Tooltip.showAtCursor(a,t,undefined,undefined,"q10")}return}t=e.childNodes[0].textContent}else if(typeof t==="function"){t=t()}WH.copyToClipboard(t);if(i.attachToElement){WH.Tooltip.show(e,WH.clickToCopy.getTooltip(true,i))}else{WH.Tooltip.showAtCursor(a,WH.clickToCopy.getTooltip(true,i))}};WH.clickToCopy.getTooltip=function(e,t){let i="";let a=undefined;if(e){i=" "+WH.TERMS.copied;a={className:"q1 fa fa-check"}}else{i=WH.TERMS.clickToCopy}let n=WH.ce("div",a,WH.ct(i));if(t.prefix){n.style.marginTop="10px";let e=typeof t.prefix==="function"?t.prefix():t.prefix;return e+n.outerHTML}return n.outerHTML};WH.copyToClipboard=function(e,t){if(!WH.copyToClipboard.hiddenInput){WH.copyToClipboard.hiddenInput=WH.ce("textarea",{className:"hidden-element"});WH.ae(document.body,WH.copyToClipboard.hiddenInput)}WH.copyToClipboard.hiddenInput.value=e;let i=WH.copyToClipboard.hiddenInput.value==="";if(i){WH.copyToClipboard.hiddenInput.value=WH.TERMS.nothingToCopy_tip}WH.copyToClipboard.hiddenInput.focus();WH.copyToClipboard.hiddenInput.select();if(!document.execCommand("copy")){prompt(null,e)}WH.copyToClipboard.hiddenInput.blur();if(t){if(i){WH.Tooltip.showFadingTooltipAtCursor(WH.TERMS.nothingToCopy_tip,t,"q10")}else{let e=WH.ce("span",{className:"q1 fa fa-check"},WH.ct(" "+WH.TERMS.copied));WH.Tooltip.showFadingTooltipAtCursor(e.outerHTML,t)}}};WH.createRange=function(e,t){var i={};for(var a=e;a<=t;++a){i[a]=a}return i};WH.isElementInView=function(e,t){var i=e.getBoundingClientRect();var a=document.documentElement.scrollTop;var n=a+window.innerHeight;var s=i.top+a;var r=s+i.height;if(t===true){return a<s&&n>r}else{return s<=n&&r>=a}};WH.objectToArray=function(e,t){var i=[];for(var a in e){if(e.hasOwnProperty(a)){i.push({property:a,value:e[a]})}}if(t){i.sort((function(e,i){return WH.stringCompare(e[t],i[t])}))}return i};WH.sortIdArray=function(e,t,i){e.sort(i?function(e,a){return WH.stringCompare(t[e][i],t[a][i])}:function(e,i){return WH.stringCompare(t[e],t[i])})};WH.sortJsonArray=function(e,t,i,a){var n=[];for(var s in e){if(e.hasOwnProperty(s)&&t[s]&&(a==null||a(t[s]))){n.push(s)}}if(i!=null){n.sort(i)}else{WH.sortIdArray(n,t)}return n};WH.sortObjectArray=function(e,t){for(var i=0,a;a=t[i];i++){var n=1;if(a.substr(0,1)==="-"){n=-1;a=a.substr(1)}e.sort(function(e,t,i,a){if(i[e]===a[e]){return 1*t}if(typeof i[e]==="string"||typeof a[e]==="string"){return WH.stringCompare(""+i[e],""+a[e])*t}return(i[e]>a[e]?1:-1)*t}.bind(null,a,n))}};WH.isEqualSimpleObject=function(e,t){for(var i in e){if(typeof e[i]=="object"){if(typeof t[i]!="object")return false;if(!WH.isEqualSimpleObject(e[i],t[i]))return false}else{if(e[i]!==t[i])return false}}for(var a in t){if(typeof t[a]=="object"){if(typeof e[a]!="object")return false;if(!WH.isEqualSimpleObject(e[a],t[a]))return false}else{if(e[a]!==t[a])return false}}return true};WH.deUrlize=function(e){var t=e.split("-");var i="";for(var a=0;a<t.length;a++){if(i){i+=" "}i+=WH.ucfirst(t[a])}return i};WH.ensureUrlProtocol=function(e,t){if(typeof e!=="string"){WH.error("Supplied URL was not a string.",e);e=""}if(t){if(!t.match(/:$/)){t+=":"}return e.replace(/^https?:/,t).replace(/^(\/[^\/])/,t+"//"+location.host+"$1").replace(/^(\/\/)/,t+"$1")}else{return e.replace(/^(\/[^\/])/,location.protocol+"//"+location.host+"$1").replace(/^(\/\/)/,location.protocol+"$1")}};WH.getTinyIconUrl=function(e){return e.indexOf("/")===-1?WH.Icon.getIconUrl(e,WH.Icon.TINY):e};WH.removeAccents=function(e){var t=e;var i=[["ß","á","ä","à","â","è","ê","é","ë","í","î","ì","ï","ñ","ò","ó","ö","ô","ú","ü","û","ù","œ","Á","Ä","À","Â","È","Ê","É","Ë","Í","Î","Ì","Ï","Ñ","Ò","Ó","Ö","Ô","Ú","Ü","Û","Ù","œ"],["ss","a","a","a","a","e","e","e","e","i","i","i","i","n","o","o","o","o","u","u","u","u","oe","A","A","A","A","E","E","E","E","I","I","I","I","N","O","O","O","O","U","U","U","U","Oe"]];for(var a=0;a<i[0].length;a++){t=t.replace(new RegExp(i[0][a],"g"),i[1][a])}return t};WH.isDateValid=function(e){return/^(20[0-2]\d)-([01]\d)-([0-3]\d) ([0-2]\d):([0-5]\d):([0-5]\d)$/.exec(e)};WH.isIpAddress=function(e){return/[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+/.test(e)};WH.isEmailValid=function(e){if(e.length>64){return false}return e.match(/^([a-z0-9._-]+)(\+[a-z0-9._-]+)?(@[a-z0-9.-]+\.[a-z]{2,})$/i)!=null};WH.getCurrentDomain=function(){if(WH.getCurrentDomain.CACHE){return WH.getCurrentDomain.CACHE}var e=location.hostname;if(!WH.isIpAddress(e)){var t=e.split(".");if(t.length>2){t.splice(0,t.length-2)}e=t.join(".")}WH.getCurrentDomain.CACHE=e;return e};WH.isExternalUrl=function(e){return!(!e||e.indexOf("http")!=0&&e.indexOf("//")!=0||e.indexOf("wowhead.com")!=-1||e.indexOf("wowheadnews.")!=-1||e.indexOf(WH.getCurrentDomain())!=-1)};WH.getRelativeHostPrefix=function(){var e=true;if(WH.isDev()){e=location.protocol==="https:"}var t=e?"_https":"_http";if(!WH.getRelativeHostPrefix.CACHE){WH.getRelativeHostPrefix.CACHE={}}if(t in WH.getRelativeHostPrefix.CACHE){return WH.getRelativeHostPrefix.CACHE[t]}var i="";if(e!==(location.protocol==="https:")&&!/^[0-9\.]+$/.test(location.hostname)){var a=/^([\w\W]*)\.[^\.]+\.com$/.exec(location.hostname);a=a?a[1]:"www";var n="";if(location.port){n=location.port}if(n.substr(0,1)!==":"){n=":"+n}if(n===":80"||n===":"){n=""}i="https://"+a+".wowhead.com"+n}if(!e){i=i.replace(/^https:/,"http:")}WH.getRelativeHostPrefix.CACHE[t]=i;return i};WH.fixWowheadHttps=function(e){return e.replace(/\bhttp:(\/\/(?:[^\/:]+\.)?(?:wowhead\.com|zamimg\.com)[:\/])/g,"https:$1")};WH.goToLoginPage=function(e){window.location=WH.Url.getLoginPath(e)};WH.createOrRegex=function(e,t){e=e.replace(/(\(|\)|\|\+|\*|\?|\$|\^)/g,"\\$1");var i=e.split(" "),a="";for(var n=0,s=i.length;n<s;++n){if(n>0){a+="|"}a+=i[n]}return new RegExp((t!=null?"("+t+")?":"")+"("+a+")","gi")};WH.getHash=function(){return"#"+decodeURIComponent(location.href.split("#")[1]||"")};WH.modifyUrl=function(e,t,i,a){if(!i){i=$.noop}var n="";if(e.match(/(#.+)$/)){n=RegExp.$1;e=e.replace(n,"")}if(typeof i.custom=="function"){e=i.custom(e,a)}if(i.returnAfterCustom){return e+n}$.each(t,(function(t,a){var n;var s;var r;var o=e.match(new RegExp("(&|\\?)?"+t+"=?([^&]+)?"));if(o!=null){n=o[0];s=o[1];r=decodeURIComponent(o[2])}if(a==null){if(!n)return;r=null}else if(a.substr(0,2)=="+="){if(r&&i.onAppendCollision){r=i.onAppendCollision(r,a.substr(2),i.menuUrl)}else if(!r&&i.onAppendEmpty){r=i.onAppendEmpty(a.substr(2),i.menuUrl)}else{if(!r)r="";r+=$.trim(a.substr(2))}}else{r=a}if(n){var l="";if(s){l+=s}if(r!=null){l+=t;if(r){l+="="+WH.urlEncodeHref(r)}}e=e.replace(n,l)}else if(r||a==null||a.substr(0,2)!="+="){e+=(/[&?]/.test(e)?"&":"?")+t;if(r){e+="="+WH.urlEncodeHref(r)}}}));e=e.replace("?&","?");e=e.replace(/&&/g,"&");e=e.replace(/\/\?/g,"/");e=e.replace(/(&|\?)+$/,"");return e+n};WH.pageWasReloaded=function(){if(window.performance){if(performance.getEntriesByType){var e=performance.getEntriesByType("navigation");for(var t=0;t<e.length;t++){if(e[t].type==="reload"){return true}}}else if(performance.navigation){return performance.navigation.type===1}}return false};WH.getPreferredTransmogRace=function(){var e=WH.LocalStorage.get("transmog_racegender");if(!e&&g_user&&g_user.settings&&g_user.settings.defaultModel){e=[g_user.settings.defaultModel.race,g_user.settings.defaultModel.gender].join(",")}if(!e||(""+e).indexOf(",")<0){e="1,2"}e=e.split(",");if(e[0]==25||e[0]==26){e[0]=24}if(!parseInt(e[0],10)){e[0]=1}if(!parseInt(e[1],10)){e[1]=2}if(!WH.Wow.Race.isPlayableRace(e[0])){e[0]=WH.Wow.Race.ID_HUMAN}return{race:parseInt(e[0]),gender:parseInt(e[1])}};WH.isBlizzardReferral=function(){var e=false;if(typeof WH.getGets().brl!=="undefined"){e="brl"}else{e=!!(document.referrer&&document.referrer.match(/^https?:\/\/[^\/]*\bbattle\.net\//))}WH.isBlizzardReferral=function(e){return e}.bind(null,e);return e};WH.prepInfobox=function(){$(".infobox").each((function(){var e=$(this);if(e.data("infobox-completion-info-added")!==true&&g_user.lists&&typeof g_pageInfo=="object"&&g_types[g_pageInfo.type]&&typeof g_pageInfo.typeId=="number"){var t=$(".compact-completion-display",e);if(t.length){var i=$("span",t);if(i.length){var a=0;i.each((function(){var e=$(this);var t=e.html();try{t=JSON.parse(t)}catch(e){return}var i;for(var n=0,s;s=g_user.lists[n];n++){if(s.id==t.id){i=s;break}}if(i){e.parent().append(WH.createCompletionIcon(i,t.completed?1:0,t.rel));e.remove();a++}}));if(a){t.parent().parent().show()}}else{if(t.is(":empty")&&WH.addCompletionIcons(t.get(0),g_types[g_pageInfo.type],g_pageInfo.typeId)){t.parent().parent().show()}}}e.data("infobox-completion-info-added",true)}}))};WH.enhanceTextarea=function(e,t){if(!(e instanceof jQuery)){e=$(e)}if(e.data("wh-enhanced")||e.prop("tagName")!="TEXTAREA"){return}if(typeof t!="object"){t={}}var i=function(e){if(!e.dynamicResizeOption){return true}if(WH.LocalStorage.get("dynamic-textarea-resizing")==="true"){return true}if(WH.LocalStorage.get("dynamic-textarea-resizing")==="false"){return false}return!e.hasOwnProperty("dynamicSizing")||e.dynamicSizing}.bind(null,t);var a=e.height()||500;var n=$("<div/>",{class:"enhanced-textarea-wrapper"}).insertBefore(e).append(e);if(!t.hasOwnProperty("color")){n.addClass("enhanced-textarea-dark")}else if(t.color){n.addClass("enhanced-textarea-"+t.color)}if(!t.hasOwnProperty("dynamicSizing")||t.dynamicSizing||t.dynamicResizeOption){var s=$("<div/>",{class:"enhanced-textarea-expander"}).prependTo(n);s.css("width",s.parent().width()+"px");var r=function(e,t,i,a){if(!a()){return}var n=e.val()||e.attr("placeholder")||"";if(n){n=WH.htmlEntities(n)}t.html(n.replace(/\n/g,"<br>")+"<br>");var s=t.height()+(i?14:34);e.css("height",s+"px")};e.bind("keydown keyup change",r.bind(this,e,s,t.exactLineHeights,i));r(e,s,t.exactLineHeights,i);setTimeout(r.bind(this,e,s,t.exactLineHeights,i),100);if(!t.dynamicResizeOption||t.dynamicResizeOption&&i()){n.addClass("enhanced-textarea-dynamic-sizing")}}if(!t.hasOwnProperty("focusChanges")||t.focusChanges){n.addClass("enhanced-textarea-focus-changes")}if(t.markup){var o=$("<div/>",{class:"enhanced-textarea-markup-wrapper"}).prependTo(n);var l=$("<div/>",{class:"enhanced-textarea-markup"}).appendTo(o);var c=$("<div/>",{class:"enhanced-textarea-markup-segment"}).appendTo(l);var u=$("<div/>",{class:"enhanced-textarea-markup-segment"}).appendTo(l);if(t.markup==="inline"){WH.markup.Toolbar.addInline(e.get(0),c.get(0),u.get(0))}else{WH.markup.Toolbar.addStandard(e.get(0),c.get(0),u.get(0))}if(t.dynamicResizeOption){var d=$("<div/>",{class:"enhanced-textarea-markup-segment"}).appendTo(l);var f=$("<label/>").appendTo(d);var h=$("<input/>",{type:"checkbox",checked:i()}).appendTo(f);h.change(function(e,t,i,a,n,s){var r=this.is(":checked");WH.LocalStorage.set("dynamic-textarea-resizing",JSON.stringify(r));if(r){t.addClass("enhanced-textarea-dynamic-sizing");s(i,e.exactLineHeights,a)}else{t.removeClass("enhanced-textarea-dynamic-sizing");i.css("height",n+"px")}}.bind(h,t,n,e,i,a,r));$("<span/>",{text:WH.TERMS.autoresizetextbox}).appendTo(f)}if(t.scrollingMarkup){if(WH.enhanceTextarea.scrollerCount){WH.enhanceTextarea.scrollerCount++}else{WH.enhanceTextarea.scrollerCount=1}var p="fixable-markup-controls-"+WH.enhanceTextarea.scrollerCount;var m="fixed-markup-controls-"+WH.enhanceTextarea.scrollerCount;var g=function(e){var t=e.css("backgroundColor");if(t=="rgba(0, 0, 0, 0)"||t=="transparent"){return g(e.parent())}else{return t}};var H=g(l);for(var W,v=0;(W=window.document.styleSheets[v])&&W.href;v++){}if(!W){window.document.head.appendChild(document.createElement("style"));W=window.document.styleSheets[v]}var _="."+m+" ."+p+" .enhanced-textarea-markup";W.insertRule(_+" {background:"+H+";padding-bottom:5px;padding-top:10px;position:fixed;top:0;z-index:3}",W.cssRules.length);W.insertRule("body.has-mobile-zul-bar"+_+" {padding-top:50px}",W.cssRules.length);o.addClass(p);var T=function(e,t,i){var a=WH.Layout.Responsive.isZulInMobileMode()?40:0;var n=this.scrollY||this.pageYOffset||0;if(n>e.offset().top-10-a&&n<t.offset().top+t.height()-100-a){$("body").addClass(i)}else{$("body").removeClass(i)}};var b=$(window);b.scroll(T.bind(window,o,n,m));T.call(window,o,n,m);var E=function(e,t){t.css("width",e.width()+"px");e.css("height",t.height()+"px")}.bind(null,o,l);E();b.on("resize",E);$((function(){setTimeout(E,2e3)}))}}e.data("wh-enhanced",true)};WH.createOptionsMenuWidget=function(e,t,i){var a=0;var n=1;var s=2;var r=3;var o=WH.createOptionsMenuWidget.chevron;if(i.noChevron){o=""}var l=WH.ce("span");l.id="options-menu-widget-"+e;l.className="options-menu-widget "+l.id;l.innerHTML=t+o;if(i.id){l.id=i.id}if(i.className){l.className+=" "+i.className}if(i.options instanceof Array){var c=[];for(var u=0,d;d=i.options[u];u++){var f=[u,d[n]];if((typeof i.selected=="number"||typeof i.selected=="string")&&i.selected==d[a]){l.innerHTML=d[n]+o;if(d[r]){switch(typeof d[r].className){case"string":$.data(l,"options-menu-widget-class",d[r].className);l.className+=" "+d[r].className;break;case"function":$.data(l,"options-menu-widget-class",d[r].className(d,true));l.className+=" "+d[r].className(d,true);break}}}if(d[s]){f.push(function(e,t,i,a){switch(typeof i[s]){case"string":window.location=i[s];break;case"function":if(typeof a.updateWidgetText=="undefined"||a.updateWidgetText){t.innerHTML=i[n]+e;var o=$.data(t,"options-menu-widget-class");if(o){t.className=t.className.replace(new RegExp(" *\\b"+o+"\\b"),"")}if(i[r]){switch(typeof i[r].className){case"string":$.data(t,"options-menu-widget-class",i[r].className);t.className+=" "+i[r].className;break;case"function":$.data(t,"options-menu-widget-class",i[r].className(i,true));t.className+=" "+i[r].className(i,true);break}}}i[s](t,i);break}}.bind(null,o,l,d,i))}else if(!d[r]||!d[r].menu){f[0]=null}f[Menu.ITEM_OPTIONS]={};if(d[r]){switch(typeof d[r].className){case"string":f[Menu.ITEM_OPTIONS].className=d[r].className;break;case"function":f[Menu.ITEM_OPTIONS].className=d[r].className.bind(null,d,false);break}switch(typeof d[r].column){case"number":case"string":f[Menu.ITEM_OPTIONS].column=d[r].column;break;case"function":f[Menu.ITEM_OPTIONS].column=d[r].column.bind(null,d);break}switch(typeof d[r].tinyIcon){case"string":f[Menu.ITEM_OPTIONS].tinyIcon=d[r].tinyIcon;break;case"function":f[Menu.ITEM_OPTIONS].tinyIcon=d[r].tinyIcon.bind(null,d);break}switch(typeof d[r].fontIcon){case"string":f[Menu.ITEM_OPTIONS].fontIcon=d[r].fontIcon;break;case"function":f[Menu.ITEM_OPTIONS].fontIcon=d[r].fontIcon.bind(null,d);break}if(typeof d[r].isChecked=="function"){f[Menu.ITEM_OPTIONS].checkedFunc=d[r].isChecked.bind(null,d)}if(typeof d[r].menu=="object"&&d[r].menu instanceof Array){Menu.setSubmenu(f,d[r].menu)}}c.push(f)}l.menu=c;if(i.menuOnClick){l.onmousedown=WH.rf;Menu.add(l,c,{showAtElement:true})}else{Menu.add(l,c)}}if(i.target){$(i.target).append(l)}else{return l}};WH.createOptionsMenuWidget.chevron=' <i class="fa fa-chevron-down fa-color-gray"></i>';WH.setupSmoothNavClicks=function(e){var t=$(".smooth-nav-inner > a",e);if(!t.length){setTimeout(WH.setupSmoothNavClicks.bind(null,e),9);return}t.each((function(){var e=this.href.replace(new RegExp("^"+location.href.replace(/#.*/,"")),"");if(e&&e.substr(0,1)==="#"){$(this).click(function(e,t){if(t.which===2){return}var i=e==="#top"?0:$(e).offset().top-20;if(isNaN(i)){return}if(Platform.isTouch()){i-=37}$("html, body").stop().animate({scrollTop:i},"500","swing");return false}.bind(null,e))}}))};WH.countdownClock=function(e){var t=$(e.element||"#countdown-clock-"+e.id);if(!t.length){return}var i;if(e.url){i=$("<a/>",{href:e.url,target:"_blank"})}else{i=$("<div/>")}i.addClass("countdown-clock-content").css({"background-image":"url("+e.bg+")"});var a=$("<div/>",{class:"countdown-clock-content-inner"}).appendTo(i);if(e.impressionImage){$("<img>",{src:e.impressionImage,css:{bottom:0,height:"1px",position:"absolute",right:0,width:"1px"}}).appendTo(i)}if(e.text){a.append($("<span/>",{class:"countdown-clock-text",html:e.text}))}var n=$("<span/>",{class:"countdown-clock-time"}).appendTo(a);var s=$("<table/>").appendTo(n);var r=$("<tr/>").appendTo(s);var o=$("<tr/>").appendTo(s);$("<td/>").appendTo(r);$("<td/>",{html:":"}).appendTo(r);$("<td/>").appendTo(r);$("<td/>",{html:":"}).appendTo(r);$("<td/>").appendTo(r);$("<td/>",{html:WH.TERMS.days_lc}).appendTo(o);$("<td/>").appendTo(o);$("<td/>",{html:WH.TERMS.hours_lc}).appendTo(o);$("<td/>").appendTo(o);$("<td/>",{html:WH.TERMS.minutes_lc}).appendTo(o);t.addClass("countdown-clock").append(i);var l={days:0,hours:0,minutes:0};var c=(new Date).getTime();var u=c;if(typeof e.time==="string"){u=new Date(e.time).getTime()}else if(typeof e.time==="object"){var d=new Date;if(!e.time.hasOwnProperty("year")){e.time.year=d.getFullYear()}if(!e.time.hasOwnProperty("month")){e.time.month=d.getMonth+1}if(!e.time.hasOwnProperty("day")){e.time.day=d.getDay()}if(!e.time.hasOwnProperty("hour")){e.time.hour=0}if(!e.time.hasOwnProperty("minute")){e.time.minute=0}if(!e.time.hasOwnProperty("second")){e.time.second=0}u=new Date(e.time.year,e.time.month-1,e.time.day,e.time.hour,e.time.minute,e.time.second).getTime()}var f=parseInt((u-c)/1e3);var h=60;var p=h*60;var m=p*24;l.days=parseInt(f/m);f=f-l.days*24*60*60;l.hours=parseInt(f/p);f=f-l.hours*60*60;l.minutes=parseInt(f/h);var g=function(e,t,i){if(t.days<=0&&t.hours<=0&&t.minutes<=0){e.html(i.completionText).parent().parent().addClass("countdown-clock-complete");return}$("tr:first-child > td:nth-child(1)",e).html(t.days);$("tr:last-child > td:nth-child(1)",e).html(t.days===1?WH.TERMS.day_lc:WH.TERMS.days_lc);$("tr:first-child > td:nth-child(3)",e).html(t.hours);$("tr:last-child > td:nth-child(3)",e).html(t.hours===1?WH.TERMS.hour_lc:WH.TERMS.hours_lc);$("tr:first-child > td:nth-child(5)",e).html(t.minutes);$("tr:last-child > td:nth-child(5)",e).html(WH.TERMS.minute_abbrev);t.minutes--;if(t.minutes<0){if(t.hours>0||t.days>0){t.minutes=59}else{t.minutes=0}t.hours--}if(t.hours<0){if(t.days>0){t.hours=23}else{t.hours=0}t.days--}if(t.days<0){t.days=0}setTimeout(g.bind(null,e,t,i),6e4)};g(n,l,e)};WH.createTweetDiv=function(e){var t=new Date;if(!e.id||!e.text){return document.createTextNode("")}var i=WH.ce("div");i.className="full-tweet";if(e.repliedTo){var a=WH.createTweetDiv(e.repliedTo);a.className+=" replied";WH.ae(i,a)}if(e.quoted){var a=WH.createTweetDiv(e.quoted);a.className+=" replied quoted";WH.ae(i,a)}var n=WH.ce("div");WH.ae(i,n);n.className="tweet";var s=WH.ce("a");WH.ae(n,s);s.className="avatar";s.style.backgroundImage="url("+e.author.avatar.replace(/^http:/,"")+")";s.href="https://twitter.com/"+e.author.username;var r=WH.ce("div");WH.ae(n,r);r.className="main";var o=WH.ce("div");WH.ae(r,o);o.className="top";var s=WH.ce("a");WH.ae(o,s);s.href="https://twitter.com/"+e.author.username;var l=WH.ce("span");WH.ae(s,l);l.className="author-name";WH.st(l,e.author.name);var l=WH.ce("span");WH.ae(s,l);l.className="author-username";WH.st(l,"@"+e.author.username);let c="https://twitter.com/"+e.author.username+"/status/"+e.id;var s=WH.ce("a");WH.ae(o,s);s.className="timestamp";s.href=c;var u=(t.getTime()-Date.parse(e.timestamp))/1e3;if(u<60){WH.st(s,""+u+"s")}else if(u<60*60){WH.st(s,""+Math.floor(u/60)+"m")}else if(u<60*60*24){WH.st(s,""+Math.floor(u/60/60)+"h")}else if(u<60*60*24*3){WH.st(s,""+Math.floor(u/60/60/24)+"d")}else{u=new Date(e.timestamp).toString().split(" ");WH.st(s,""+u[1]+" "+u[2])}var o=WH.ce("div");WH.ae(r,o);o.className="status";var d=e.text;var f,h,p,m,g;if(e.hasOwnProperty("entities")&&e.entities!==null){if(Array.isArray(e.entities.media)){let t=e.extended_entities&&e.extended_entities.media||e.entities.media;for(let i,a=0;i=t[a];a++){d=d.replace(e.text.substr(i.indices[0],i.indices[1]-i.indices[0]),"");let t=function(e,t){let i=e.extended_entities&&e.extended_entities.media&&e.extended_entities.media[t];if(!i||i.type!=="video"&&i.type!=="animated_gif"){return false}if(i.additional_media_info&&i.additional_media_info.embeddable===false){return false}if(!i.video_info||!i.video_info.aspect_ratio){return false}let a=i.type==="animated_gif";let n;let s=i.video_info.variants;s.sort((function(e,t){return(t.bitrate||0)-(e.bitrate||0)}));for(let e=0;e<s.length;e++){if(s[e].bitrate){n=s[e];break}}if(!n){if(a&&s[0]){n=s[0]}else{return false}}let o=WH.ce("video");let l=i.video_info.aspect_ratio;o.width=Math.min(Platform.getViewportWidth()-102,375);o.height=Math.ceil(o.width/l[0]*l[1]);o.controls=true;o.poster=i.media_url_https||i.media_url.replace(/^http:/,"");o.src=n.url;if(a){o.loop=true}WH.ae(r,o);return true}(e,a);if(!t&&i.type==="photo"){var H="",W=0;for(var v in i.sizes){if(i.sizes[v].w>=250&&(W==0||i.sizes[v].w<W)){H=v;W=i.sizes[v].w}}if(H!=""){if(W>375){W=375}let e=WH.ce("a",{href:c+"/photo/"+(a+1)});WH.ae(r,e);var _=WH.ce("img");WH.ae(e,_);_.className="photo";_.width=W;_.height=Math.floor(i.sizes[H].h*(W/i.sizes[H].w));_.src=i.media_url_https||i.media_url.replace(/^http:/,"")+":"+H}}}}if(Array.isArray(e.entities.urls)){f=[];g=e.quoted?WH.sprintf("https://twitter.com/$1/status/$2",e.quoted.author.username,e.quoted.id):false;for(m in e.entities.urls){p=e.entities.urls[m];h=e.text.substr(p.indices[0],p.indices[1]-p.indices[0]);if(WH.inArray(f,h)>=0){continue}f.push(h);if(g&&p.expanded_url.indexOf(g)==0){d=d.replace(h,"")}else{d=d.replace(h,'<a href="'+p.url+'" class="entity-url">'+p.display_url+"</a>","g")}}}if(Array.isArray(e.entities.user_mentions)){f=[];for(m in e.entities.user_mentions){p=e.entities.user_mentions[m];h=e.text.substr(p.indices[0],p.indices[1]-p.indices[0]).toLowerCase();if(WH.inArray(f,h)>=0){continue}f.push(h);d=d.replace(h,'<a href="https://twitter.com/'+p.screen_name+'" class="entity-mention">@'+p.screen_name+"</a>","gi")}}if(Array.isArray(e.entities.hashtags)){f=[];for(m in e.entities.hashtags){p=e.entities.hashtags[m];h=e.text.substr(p.indices[0],p.indices[1]-p.indices[0]).toLowerCase();if(WH.inArray(f,h)>=0){continue}f.push(h);d=d.replace(h,'<a href="https://twitter.com/search?q=#'+p.text+'" class="entity-hashtag">#'+p.text+"</a>","gi")}}}o.innerHTML=d;var T=WH.ce("div");WH.ae(r,T);T.className="bottom";var s=WH.ce("a");WH.ae(T,s);s.className="widget reply";s.href="https://twitter.com/intent/tweet?in_reply_to="+e.id;s.target="whtwitter";WH.st(s,"Reply");s.insertBefore(WH.ce("span"),s.firstChild);var s=WH.ce("a");WH.ae(T,s);s.className="widget retweet";s.href="https://twitter.com/intent/retweet?tweet_id="+e.id;s.target="whtwitter";WH.st(s,"Retweet");s.insertBefore(WH.ce("span"),s.firstChild);var s=WH.ce("a");WH.ae(T,s);s.className="widget favorite";s.href="https://twitter.com/intent/favorite?tweet_id="+e.id;s.target="whtwitter";WH.st(s,"Favorite");s.insertBefore(WH.ce("span"),s.firstChild);return i};WH.slashHashEvent=null;try{WH.slashHashEvent=new Event("slashhash")}catch(e){try{WH.slashHashEvent=document.createEvent("Event");WH.slashHashEvent.initEvent("slashhash",true,true)}catch(e){}}WH.getSlashHash=function(e){var t=""+location.href;var i=t.indexOf(e);if(i==-1){return location.hash?(""+location.hash).replace(/^#/,""):""}var a=t.substr(0,i+e.length);return t.substr(a.length+1)};WH.setSlashHash=function(e,t,i){var a=""+location.href;var n=a.indexOf(e);if(n==-1){alert("Bad hash update: No root found!");return}var s=a.substr(0,n+e.length);var r=a.substr(s.length+1);if(t.substr(0,1)=="#"){t=t.substr(1)}var o=t?"/"+t:"";if(i){history.pushState({},"",s+o);if(WH.slashHashEvent){dispatchEvent(WH.slashHashEvent)}}else{history.replaceState({},"",s+o);if(WH.slashHashEvent){dispatchEvent(WH.slashHashEvent)}}return r};WH.setHash=function(e,t){var i=""+location.hash;if(e.substr(0,1)!="#"){e="#"+e}if(e=="#."){WH.clearHash(t||false)}else{if(t){history.pushState({},"",location.pathname+e)}else{history.replaceState({},"",location.pathname+e)}}return i};WH.clearHash=function(e){var t=""+location.hash;var i=(""+location.href).replace(/#.*/,"");if(e){if(window.history&&window.history.pushState){window.history.pushState({},"",i)}else{location.hash="#."}}else{if(window.history&&window.history.replaceState){window.history.replaceState({},"",i)}else{location.replace("#.")}}return t};WH.selectText=function(e){var t=document,i=t.getElementById(e),a,n;if(t.body.createTextRange){a=document.body.createTextRange();a.moveToElementText(i);a.select()}else if(window.getSelection){n=window.getSelection();a=document.createRange();a.selectNodeContents(i);n.removeAllRanges();n.addRange(a)}};WH.ucfirst=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};WH.loadAssets=function(e,t){var i=function(e){var t=WH.ce("link");t.rel="stylesheet";if(WH.PageMeta.scriptVersionQueryString){if(e.indexOf("?")<0){e+="?"+WH.PageMeta.scriptVersionQueryString}else{e=e.replace(/\?/,"?"+WH.PageMeta.scriptVersionQueryString+"&")}}t.href=e;WH.ae(document.getElementsByTagName("head")[0],t)};var a=function(e,t,i){var a=WH.ce("script");a.type="text/javascript";if(i&&WH.PageMeta.scriptVersionQueryString){if(e.indexOf("?")<0){e+="?"+WH.PageMeta.scriptVersionQueryString}else{e=e.replace(/\?/,"?"+WH.PageMeta.scriptVersionQueryString+"&")}}a.src=e;if(t){WH.aE(a,"load",t)}WH.ae(document.getElementsByTagName("head")[0],a)};switch(e){case"artifact-weapon-calc":if(WH.isSet("ArtifactCalc")){if(t){t()}return}i(WH.staticUrl+"/css/tools/artifact-calc.css?"+WH.getDataBuild());var n=WH.staticUrl+"/js/ArtifactCalc.js?"+WH.getDataBuild();if(WH.isSet("g_artifact_textures")){a(n,t,true)}else{var s=WH.Url.getDataPageUrl("artifact-calc");a(s,a.bind(null,n,t,true))}break;case"azerite-finder":if(WH.Wow.AzeriteFinder){if(t){t()}return}i(WH.staticUrl+"/css/tools/azerite-finder.css");a(WH.staticUrl+"/js/WH/Wow/AzeriteFinder.js",t,true);break;case"diablo-2-skill-calc":if(WH.D2.hasOwnProperty("SkillCalc")){if(t){t()}break}WH.Layout.loadFont("Exocet");i(WH.STATIC_URL+"/css/d2/skill-calc.css");a(WH.Url.getDataPageUrl("diablo2-skills",WH.dataEnv.MAIN),(function(){a(WH.STATIC_URL+"/js/WH/D2/SkillCalc.js",t,true)}));break;case"gear-planner":let c=WH.isTbcTree()?"GearPlannerTbc":"GearPlanner";if(WH.Wow[c]){if(t){t()}break}WH.loadAssets("talent-calc-classic",(function(){i(WH.staticUrl+"/css/tools/gear-planner.css");t=a.bind(null,WH.staticUrl+"/js/WH/Wow/"+c+".js",t,true);t=a.bind(null,WH.staticUrl+"/js/WH/Listview/Templates/item.js",t,true);t=a.bind(null,WH.Url.getDataPageUrl("gear-planner"),t,false);t=a.bind(null,WH.Url.getDataPageUrl("weight-presets"),t,false);if(c==="GearPlannerTbc"&&!WH.applyStatModifications.ScalingData){t=a.bind(null,WH.Url.getDataPageUrl("item-scaling"),t,false)}t()}));break;case"heart-of-azeroth-calc":if(WH.Wow.HeartOfAzerothCalc){if(t){t()}break}i(WH.staticUrl+"/css/tools/heart-of-azeroth-calc.css");var r=a.bind(null,WH.staticUrl+"/js/WH/Wow/HeartOfAzerothCalc.js",t,true);if(!WH.Wow.AzeriteEssence){a(WH.staticUrl+"/js/WH/Wow/AzeriteEssence.js",a.bind(null,WH.Url.getDataPageUrl("azerite-essence"),r,false),true)}else{r()}break;case"mythic-damage-calc":if(WH.Wow.MythicDamageCalc){if(t){t()}break}i(WH.staticUrl+"/css/tools/mythic-damage-calc.css");a(WH.staticUrl+"/js/WH/Wow/MythicDamageCalc.js",(function(){a(WH.Url.getDataPageUrl("mythic-damage-calc"),t)}),true);break;case"pvp-talent-calc":if(WH.isSet("PvpTalentCalc")){if(t){t()}return}i(WH.staticUrl+"/css/tools/pvp-calc.css?"+WH.getDataBuild());var o=WH.staticUrl+"/js/talent-pvp.js?"+WH.getDataBuild();if(WH.isSet("g_talents_pvp")){a(o,t,true)}else{a(WH.Url.getDataPageUrl("talents-pvp"),a.bind(null,o,t,true))}break;case"soulbind-calc":if(WH.Wow.SoulbindCalc){if(t){t()}break}i(WH.staticUrl+"/css/tools/soulbind-calc.css");a(WH.staticUrl+"/js/WH/Wow/SoulbindCalc.js",t,true);break;case"talent-calc":if(WH.isSet("TalentCalc")){if(t){t()}return}i(WH.staticUrl+"/css/tools/talent-calc.css?"+WH.getDataBuild());var l=WH.staticUrl+"/js/WH/Wow/TalentCalc.js?"+WH.getDataBuild();if(WH.isSet("g_glyphs")){a(l,t,true)}else{a(WH.Url.getDataPageUrl("glyphs"),a.bind(null,l,t,true))}break;case"talent-calc-classic":if(WH.Wow.hasOwnProperty("TalentCalcClassic")){if(t){t()}return}i(WH.staticUrl+"/css/"+WH.Theme.getThemePath()+"tools/talent-calc-classic.css");a(WH.staticUrl+"/js/WH/Wow/TalentCalcClassic.js",(function(){a(WH.Url.getDataPageUrl("talents-classic"),t)}),true);break;default:alert('Tried to load unknown asset set "'+String(e)+'".')}};WH.isInt=function(e){return typeof e==="number"&&parseFloat(e)==parseInt(e)&&!isNaN(e)};WH.ensureObjectPath=function(e,t){var i=Array.prototype.slice.call(arguments,1);if(typeof i[0]!="string"){return e}if(typeof e[i[0]]!="object"){e[i[0]]={}}if(i[1]){e[i[0]]=WH.ensureObjectPath.apply(this,[e[i[0]]].concat(i.slice(1)))}return e};WH.preventDefault=function(e){if(e&&e.preventDefault){e.preventDefault()}};WH.preventTyping=function(e){if(e&&e.preventDefault){var t="which"in e?e.which:e.keyCode;var i=t>=48&&t<=57||t>=65&&t<=90||t>=96&&t<=105||t>=106&&t<=111||t>=186&&t<=192||t>=219&&t<=222;var a=e.altKey||e.ctrlKey||e.shiftKey||e.metaKey;if(i&&!a){e.preventDefault()}}};WH.leadingZeroes=function(e,t){var i=e+"";while(i.length<t)i="0"+i;return i};$(document).ready((function(){$("a.wsach").each((function(){var e=$(this).text();var t=$(this).attr("title");var i=parseInt($(this).attr("data-earned"));var a=$(this).attr("data-user");var n=$(this).parent().parent().attr("id")=="user-achievement-list";var s=$(this).attr("data-progress");var r=$(this).attr("data-quality");var o=$(this).attr("data-count");$(this).attr("title","");var l=$("<div>");l.append('<table><tr><td style="padding-bottom: 0.35em"><b class="q" data-quality="'+r+'"></b></td></tr><tr><td><span></span></td></tr></table>');l.find("b").text(e);l.find("span").text(t);if(i){var c=null;var u=(new Date).getTime()/1e3;if(a){if(i>31*24*60*60){l.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime4_format:WH.TERMS.earnedwsatime4_format,a,WH.formatDateSimple(new Date((u-i)*1e3)))+"</span>")}else{l.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime2_format:WH.TERMS.earnedwsatime2_format,a,WH.formatTimeElapsed(i))+"</span>")}}else if(!n){if(i>31*24*60*60){l.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime3_format:WH.TERMS.earnedwsatime3_format,WH.formatDateSimple(new Date((u-i)*1e3)))+"</span>")}else{l.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime_format:WH.TERMS.earnedwsatime_format,WH.formatTimeElapsed(i))+"</span>")}}if(c){l.append('<span class="q0"><br />'+c+"</span>")}}else if(!n&&s){l.append('<span class="q0"><br /><small></small>'+WH.TERMS.progress_format.replace("%s",s)+"</td></tr>")}WH.Tooltip.simple(this,l.html())}))}));WH.User=new function(){const e=this;const t="TOMRUS";this.disableDebug=function(){g_user.debug=false};this.getCommentRoleClass=function(e,i){if(e&U_GROUP_ADMIN){return"comment-role-admin"}else if(e&U_GROUP_GREEN_TEXT&&i!==t){return"comment-role-moderator"}else if(e&U_GROUP_VIP){return"comment-role-vip"}else if(e&U_GROUP_PREMIUMISH){return"comment-role-premium"}return null};this.getDebug=function(){return e.hasRole(U_GROUP_STAFF)&&(g_user.debug||WH.getGets().debug!=null)};this.getId=function(){return g_user.id};this.getPath=function(){if(!WH.User.isLoggedIn()){return null}return"/user="+encodeURIComponent(WH.User.getUsername())};this.getReputation=function(){return g_user.reputation||0};this.getUsername=function(){return g_user.name||""};this.hasRole=function(e){if(!e){return true}return!!(g_user.roles&e)};this.isLoggedIn=function(){return g_user.id>0};this.isPremium=function(){return!!g_user.premium};this.isUsernameValid=function(e){return e.match(/[^a-z0-9]/i)==null&&e.length>=4&&e.length<=16};this.saveOption=function(e,t,i){let a={method:"POST",json:{key:e,value:t}};if(typeof i==="function"){a.success=i}WH.fetch("/account/save-option",a)}};var U_GROUP_TESTER=1;var U_GROUP_ADMIN=2;var U_GROUP_EDITOR=4;var U_GROUP_MOD=8;var U_GROUP_BUREAU=16;var U_GROUP_DEV=32;var U_GROUP_VIP=64;var U_GROUP_BLOGGER=128;var U_GROUP_PREMIUM=256;var U_GROUP_LOCALIZER=512;var U_GROUP_SALESAGENT=1024;var U_GROUP_SCREENSHOT=2048;var U_GROUP_VIDEO=4096;var U_GROUP_APIONLY=8192;var U_GROUP_PENDING=16384;var U_GROUP_STAFF=U_GROUP_ADMIN|U_GROUP_EDITOR|U_GROUP_MOD|U_GROUP_BUREAU|U_GROUP_DEV|U_GROUP_BLOGGER|U_GROUP_LOCALIZER|U_GROUP_SALESAGENT;var U_GROUP_EMPLOYEE=U_GROUP_ADMIN|U_GROUP_BUREAU|U_GROUP_DEV;var U_GROUP_GREEN_TEXT=U_GROUP_MOD|U_GROUP_BUREAU|U_GROUP_DEV;var U_GROUP_PREMIUMISH=U_GROUP_PREMIUM|U_GROUP_EDITOR;var U_GROUP_MODERATOR=U_GROUP_ADMIN|U_GROUP_MOD|U_GROUP_BUREAU;var U_GROUP_COMMENTS_MODERATOR=U_GROUP_MODERATOR|U_GROUP_LOCALIZER|U_GROUP_EDITOR;var U_GROUP_PREMIUM_PERMISSIONS=U_GROUP_PREMIUM|U_GROUP_STAFF|U_GROUP_VIP|U_GROUP_EDITOR;var g_users={};var g_completion={quest:{},spell:{},npc:{},achievement:{},title:{},item:{},follower:{},ship:{}};WH.LocalStorage=new function(){this.clear=function(){if(!WH.LocalStorage.isSupported()){return}localStorage.clear()};this.isSupported=function(){var e;try{e="localStorage"in window&&window["localStorage"]!==null}catch(t){e=false}if(e){try{localStorage.setItem("test","123");e=localStorage.getItem("test")=="123";localStorage.removeItem("test")}catch(t){e=false}}WH.LocalStorage.isSupported=function(e){return e}.bind(null,e);return e};this.jsonGet=function(e){if(!WH.LocalStorage.isSupported()){return undefined}try{return JSON.parse(localStorage.getItem(e))}catch(t){let i;try{i=localStorage.getItem(e)}catch(e){i="Error with getItem(): "+WH.getThrownErrorMessage(e)}WH.error("Failed to parse local storage data that should have been JSON.",e,i);return undefined}};this.jsonSet=function(e,t){if(!WH.LocalStorage.isSupported()){return}let i;try{i=JSON.stringify(t)}catch(i){WH.error("Failed to stringify local storage data.",WH.getThrownErrorMessage(i),e,t);return}localStorage.setItem(e,i)};this.set=function(e,t){if(!WH.LocalStorage.isSupported()){return}localStorage.setItem(e,t)};this.get=function(e){if(!WH.LocalStorage.isSupported()){return}return localStorage.getItem(e)};this.remove=function(e){if(!WH.LocalStorage.isSupported()){return}localStorage.removeItem(e)}};WH.SessionStorage=new function(){this.isSupported=function(){var e;try{e="sessionStorage"in window&&window["sessionStorage"]!==null}catch(t){e=false}if(e){try{sessionStorage.setItem("test","123");e=sessionStorage.getItem("test")=="123";sessionStorage.removeItem("test")}catch(t){e=false}}WH.SessionStorage.isSupported=function(e){return e}.bind(null,e);return e};this.set=function(e,t){if(!WH.SessionStorage.isSupported()){return}sessionStorage.setItem(e,t)};this.get=function(e){if(!WH.SessionStorage.isSupported()){return}return sessionStorage.getItem(e)};this.remove=function(e){if(!WH.SessionStorage.isSupported()){return}sessionStorage.removeItem(e)}};WH.Time=new function(){const e=this;this.DAYS_PER_WEEK=7;this.MS_SEC=1e3;this.MS_MIN=this.MS_SEC*60;this.MS_HOUR=this.MS_MIN*60;this.MS_DAY=this.MS_HOUR*24;this.SEC_MIN=60;this.SEC_HOUR=this.SEC_MIN*60;this.SEC_DAY=this.SEC_HOUR*24;const t=[WH.TERMS.january,WH.TERMS.february,WH.TERMS.march,WH.TERMS.april,WH.TERMS.may,WH.TERMS.june,WH.TERMS.july,WH.TERMS.august,WH.TERMS.september,WH.TERMS.october,WH.TERMS.november,WH.TERMS.december];const i={ABBR:{SECOND:WH.TERMS.second_abbrev,MINUTE:WH.TERMS.minute_abbrev,HOUR:WH.TERMS.hour_abbrev,DAY:WH.TERMS.day_abbrev,WEEK:WH.TERMS.week_abbrev,MONTH:WH.TERMS.month_abbrev,YEAR:WH.TERMS.year_abbrev},PLURAL:{SECOND:WH.TERMS.seconds_lc,MINUTE:WH.TERMS.minutes_lc,HOUR:WH.TERMS.hours_lc,DAY:WH.TERMS.days_lc,WEEK:WH.TERMS.weeks_lc,MONTH:WH.TERMS.months_lc,YEAR:WH.TERMS.years_lc},SINGULAR:{SECOND:WH.TERMS.second_lc,MINUTE:WH.TERMS.minute_lc,HOUR:WH.TERMS.hour_lc,DAY:WH.TERMS.day_lc,WEEK:WH.TERMS.week_lc,MONTH:WH.TERMS.month_lc,YEAR:WH.TERMS.year_lc},SYMBOL:{SECOND:WH.TERMS.second_short_abbrev,MINUTE:WH.TERMS.minute_short_abbrev,HOUR:WH.TERMS.hour_short_abbrev,DAY:WH.TERMS.day_short_abbrev,WEEK:WH.TERMS.week_short_abbrev,MONTH:WH.TERMS.month_short_abbrev,YEAR:WH.TERMS.year_short_abbrev}};const a=[WH.TERMS.sunday,WH.TERMS.monday,WH.TERMS.tuesday,WH.TERMS.wednesday,WH.TERMS.thursday,WH.TERMS.friday,WH.TERMS.saturday];this.formatDeltaWithSymbols=function(t){let a;if(t<e.SEC_MIN){let e=Math.floor(e);a=e+i.SYMBOL.SECOND}else if(t<e.SEC_HOUR){let e=Math.floor(t/60);a=e+i.SYMBOL.MINUTE}else if(t<e.SEC_DAY){let n=Math.floor(t/e.SEC_HOUR);let s=Math.floor((t-n*e.SEC_HOUR)/e.SEC_MIN);a=n+i.SYMBOL.HOUR;if(s>0){a+=WH.TERMS.wordspace_punct+s+i.SYMBOL.MINUTE}}else{let n=Math.floor(t/e.SEC_DAY);let s=Math.floor((t-n*e.SEC_DAY)/e.SEC_HOUR);a=n+i.SYMBOL.DAY;if(s>0){a+=WH.TERMS.wordspace_punct+s+i.SYMBOL.HOUR}}return a};this.formatFutureTimeAndDay=function(n,s){let r;let o=new Date;let l=o.getTime()/e.MS_SEC;let c=n.getTime()/e.MS_SEC;if(c-e.SEC_HOUR<l){let t=Math.floor((c-l)/e.SEC_MIN);r=t+WH.TERMS.wordspace_punct+(t===1?i.SINGULAR.MINUTE:i.PLURAL.MINUTE)}else if(c-e.SEC_HOUR*8<l){let t=Math.floor((c-l)/e.SEC_MIN);let a=Math.floor(t/60);t-=a*60;let o=a+WH.TERMS.wordspace_punct+(a===1?i.SINGULAR.HOUR:i.PLURAL.HOUR);if(t>0){o+=WH.TERMS.wordspace_punct+t+WH.TERMS.wordspace_punct+(t===1?i.SINGULAR.MINUTE:i.PLURAL.MINUTE)}r=o+WH.TERMS.wordspace_punct+WH.TERMS.openparenthesis_punct+e.formatTimeOfDay(n,s)+WH.TERMS.closedparenthesis_punct}else{if(n.toDateString()===o.toDateString()){r=e.formatTimeOfDay(n,s)}else{let i;if(n<=new Date(o.getFullYear(),o.getMonth(),o.getDate()+6,23,59)){i=n.getDate()-1===o.getDate()?WH.TERMS.tomorrow:a[n.getDay()]}else{i=a[n.getDay()]+WH.TERMS.wordspace_punct+t[n.getMonth()]+WH.TERMS.wordspace_punct+n.getDate()}r=e.formatTimeOfDay(n,s)+WH.TERMS.wordspace_punct+i}}return r};this.formatTimeOfDay=function(e,t){let i=e.getHours();let a=WH.leadingZeroes(e.getMinutes(),2);let n;if(t===true){n=i+":"+a}else{let e=i>=12?WH.TERMS.pm:WH.TERMS.am;if(i>12){n=i-12}else if(i===0){n=12}else{n=i}n+=":"+a+WH.TERMS.wordspace_punct+e}return n};this.getMonthName=function(e){return t[e]};this.getWeekdayName=function(e){return a[e]};this.unix=function(){return Math.floor((new Date).getTime()/1e3)}};WH.Admin=new function(){this.foo="test"};function Ajax(e,t){if(!e){return}var i;try{i=new XMLHttpRequest}catch(e){return}this.request=i;WH.cO(this,t);this.method=this.method||this.params&&"POST"||"GET";i.open(this.method,e,this.async==null?true:this.async);i.onreadystatechange=Ajax.onReadyStateChange.bind(this);if(this.method.toUpperCase()=="POST"){i.setRequestHeader("Content-Type",(this.contentType||"application/x-www-form-urlencoded")+"; charset="+(this.encoding||"UTF-8"))}i.send(this.params)}Ajax.onReadyStateChange=function(){if(this.request.readyState==4){if(this.request.status==0||this.request.status>=200&&this.request.status<300){this.onSuccess!=null&&this.onSuccess(this.request,this)}else{this.onFailure!=null&&this.onFailure(this.request,this)}if(this.onComplete!=null){this.onComplete(this.request,this)}}};WH.Announcement=function(e){const t=this;const i={allowMarkup:undefined,class:undefined,elements:{innerDiv:undefined},id:undefined,mobileText:undefined,parent:undefined,text:undefined};this.hide=function(){i.parentDiv.dataset.animation="hide";setTimeout((function(){i.parentDiv.classList.remove("show");delete i.parentDiv.dataset.animation}),200)};this.markRead=function(){WH.Track.interactiveEvent("Announcements","Close",""+i.name);if(!r()){let e=WH.LocalStorage.get(WH.Announcement.getLocalStorageKey())||"";e=e.split(",").filter((function(e){return!!e}));e.push(i.id);WH.LocalStorage.set(WH.Announcement.getLocalStorageKey(),e.join(","))}t.hide()};this.setClass=function(e){i.class=e;i.parentDiv.className=n()};this.setStyle=function(e){i.elements.innerDiv.setAttribute("style",e?WH.fixWowheadHttps(e):"")};this.setText=function(e,t){i.text=e;i.mobiletext=t;a(i.parent+"-markup",i.text);a(i.parent+"-markup-responsive",t||e)};this.show=function(){i.parentDiv.classList.add("show");WH.Track.nonInteractiveEvent("Announcements","Show",""+i.name)};function a(e,t){let a=WH.ge(e);if(i.allowMarkup){WH.markup.printHtml(t,a.id,{allow:WH.markup.CLASS.STAFF})}else{WH.st(a,t)}WH.Track.addClickEvents(a,{category:"Announcements",actions:{"Follow link":function(){return true}}},i.id)}function n(){let e="announcement announcement-";switch(i.mode){case 2:e+="fixed";break;case 0:e+="pagetop";break;case 1:default:e+="contenttop"}if(i.class){i.class.split(" ").forEach((function(t){e+=" announcement-styling-"+t}))}return e}function s(e){if(WH.UserAgent.isWebCrawler()){return}if(!e||!e.hasOwnProperty("id")||!["number","string","undefined"].includes(typeof e.id)||typeof e.parent!=="string"||typeof e.text!=="string"){WH.error("Announcement initialized with invalid options.",e);return}i.id=e.id;i.parent=e.parent;i.text=e.text;if(!e.admin&&r()){return}i.allowMarkup=typeof e.allowMarkup==="boolean"?e.allowMarkup:true;i.parentDiv=e.parentDiv||WH.ge(i.parent);i.parentDiv.dataset.announcementId=i.id;WH.displayNone(i.parentDiv);i.class=e.class;i.parentDiv.className=n();let a=i.elements.innerDiv=WH.ce("div",{className:"announcement-inner text"});if(e.style){t.setStyle(e.style)}let s=typeof e.id==="string";if(WH.User.hasRole(U_GROUP_ADMIN|U_GROUP_BUREAU)>0&&!s){let t="/admin=announcements&id="+i.id;if(e.admin){let i=WH.ce("a",{href:t+"&status=2",style:{cssFloat:"right"}},WH.ct(WH.TERMS.delete));WH.aE(i,"click",(function(t){if(!confirm("Are you sure you want to delete "+e.name+"?")){t.preventDefault()}}));WH.ae(a,WH.ce("small",undefined,i));let n=e.status==1?"Disable":"Enable";let s=WH.ce("a",{href:t+"&status="+(e.status==1?0:1),style:{cssFloat:"right",marginRight:"10px"}},WH.ct(n));WH.aE(s,"click",(function(t){if(!confirm("Are you sure you want to "+n.toLowerCase()+" "+e.name+"?")){t.preventDefault()}}));WH.ae(a,WH.ce("small",undefined,s))}else{let e=WH.ce("a",{className:"fa fa-pencil",href:t+"&edit"});WH.Tooltip.simpleNonTouch(e,WH.TERMS.edit,"q2");WH.ae(a,e)}}WH.ae(a,WH.ce("div",{className:"announcement-markup",id:i.parent+"-markup"}));WH.ae(a,WH.ce("div",{className:"announcement-markup-responsive",id:i.parent+"-markup-responsive"}));if(!s&&!e.admin){let i=WH.ce("a",{className:"fa fa-times announcement-close",id:"closeannouncement"});WH.aE(i,"click",e.nocookie?t.hide:t.markRead);WH.ae(a,i);WH.Tooltip.simpleNonTouch(i,WH.TERMS.close,"q2")}WH.ae(a,WH.ce("div",{style:{clear:"both"}}));WH.ae(i.parentDiv,a);t.setText(e.text,e.mobiletext);setTimeout(t.show,500)}function r(){if(!i.id){return false}let e=(WH.LocalStorage.get(WH.Announcement.getLocalStorageKey())||"").split(",");return e.includes(i.id.toString())}s(e)};WH.Announcement.forgetRead=function(){WH.LocalStorage.remove(WH.Announcement.getLocalStorageKey());let e=WH.ge("announcetext");if(e){WH.ee(e);WH.ae(e,WH.ct(WH.TERMS.purgesuccess_tip));e.className="q2"}else{alert(WH.TERMS.purgesuccess_tip)}};WH.Announcement.getLocalStorageKey=function(){let e="announcements-closed";let t=WH.User.getId();if(t){e+="-"+t}return e};var g_audiocontrols={__windowloaded:false,__rewardedAchievement:false};var g_audioplaylist={};if(!window.JSON){window.JSON={parse:function(sJSON){return eval("("+sJSON+")")},stringify:function(e){if(e instanceof Object){var t="";if(e.constructor===Array){for(var i=0;i<e.length;t+=this.stringify(e[i])+",",i++);return"["+t.substr(0,t.length-1)+"]"}if(e.toString!==Object.prototype.toString){return'"'+e.toString().replace(/"/g,"\\$&")+'"'}for(var a in e){t+='"'+a.replace(/"/g,"\\$&")+'":'+this.stringify(e[a])+","}return"{"+t.substr(0,t.length-1)+"}"}return typeof e==="string"?'"'+e.replace(/"/g,"\\$&")+'"':String(e)}}}AudioControls=function(){const e=WH.Strings;const t={addAllTracks:false,list:undefined};var i=-1;var a=false;var n=false;var s=false;var r={};var o=[];function l(){if(g_audiocontrols.__rewardedAchievement)return;if(!(WH.isSet("g_user")&&g_user.id))return;$.ajax({url:"/website-achievement-explored",data:{trigger:"playsound"},success:function(){AchievementCheck()},type:"POST"});g_audiocontrols.__rewardedAchievement=true}function c(e,n,c){var f=WH.ce("audio");f.preload="none";f.controls="true";$(f).click((function(e){e.stopPropagation()}));WH.aE(f,"ended",l);f.style.marginTop="5px";r.audio.parentNode.replaceChild(f,r.audio);r.audio=f;WH.aE(r.audio,"ended",d.bind(e));if(c){f.preload="auto";s=true;WH.aE(r.audio,"canplaythrough",u.bind(this))}if(!a)r.table.style.visibility="visible";var h;do{i+=n;if(i>o.length-1){i=0;if(!a){WH.de(r.table);WH.de('a[href="/sound&playlist"].btn');return}}if(i<0)i=o.length-1;h=o[i]}while(r.audio.canPlayType(h.type)=="");var p=WH.ce("source");p.src=h.url;p.type=h.type;WH.ae(r.audio,p);if(t.list){t.list.childNodes.forEach((function(e){e.dataset.current=JSON.stringify(e.dataset.track===h.title)}))}if(r.hasOwnProperty("trackDisplay")){WH.st(r.trackDisplay,i+1+" / "+o.length)}if(!a){a=true;for(let e=i+1;e<=o.length-1;e++){if(r.audio.canPlayType(o[e].type)){WH.qsa("a",r.controls).forEach((function(e){delete e.dataset.disabled}));break}}}if(r.hasOwnProperty("addbutton")){delete r.addbutton.dataset.disabled;WH.st(r.addbutton,WH.TERMS.playlist)}}function u(){if(!s)return;s=false;r.audio.play()}this.init=function(i,a,s){if(!Array.isArray(i)){return}if(i.length===0){return}if(a.id===""||g_audiocontrols.hasOwnProperty(a.id)){a.id=e.guid()}g_audiocontrols[a.id]=this;if(typeof s=="undefined"){s={}}t.list=s.list;n=!!s.loop;o=i;r.div=a;r.controls=WH.ce("div",{className:"audio-controls-controls"});if(!s.listview){var l=WH.ce("table",{className:"audio-controls"});r.table=l;r.table.style.visibility="hidden";WH.ae(r.div,l);var c=WH.ce("tr");WH.ae(l,c);var u=WH.ce("td");WH.ae(c,u);r.audio=WH.ce("div");WH.ae(u,r.audio);WH.ae(u,r.controls);let e=f(WH.TERMS.previous,"step-backward",true);WH.ae(r.controls,e);WH.aE(e,"click",this.btnPrevTrack.bind(this));r.trackDisplay=WH.ce("div",{className:"audio-controls-track"});WH.ae(r.controls,r.trackDisplay);let t=f(WH.TERMS.next,"step-forward",true);WH.ae(r.controls,t);WH.aE(t,"click",this.btnNextTrack.bind(this))}else{t.addAllTracks=true;let e=WH.ce("div",{className:"audio-controls"});r.table=e;WH.ae(r.div,e);r.audio=WH.ce("div");WH.ae(e,r.audio);r.trackDisplay=s.trackDisplay;WH.ae(e,r.controls)}r.table.dataset.tracks=""+o.length;r.trackDisplay.dataset.tracks=""+o.length;if(g_audioplaylist.isEnabled()&&!s.fromPlaylist){let e=f(WH.TERMS.playlist,"plus");WH.ae(r.controls,e);WH.aE(e,"click",this.btnAddToPlaylist.bind(this,e));r.addbutton=e}if(g_audiocontrols.__windowloaded)this.btnNextTrack()};function d(){c(this,1,n||i<o.length-1)}this.btnNextTrack=function(){c(this,1,a&&r.audio.readyState>1&&!r.audio.paused)};this.btnPrevTrack=function(){c(this,-1,a&&r.audio.readyState>1&&!r.audio.paused)};this.btnAddToPlaylist=function(e){if(t.addAllTracks){for(let e=0;e<o.length;e++){g_audioplaylist.addSound(o[e])}}else{g_audioplaylist.addSound(o[i])}e.dataset.disabled="true";e.classList.remove("fa-plus");e.classList.add("fa-check");WH.st(e,WH.TERMS.added)};this.isPlaying=function(){return!r.audio.paused};this.removeSelf=function(){r.table.parentNode.removeChild(r.table);delete g_audiocontrols[r.div]};function f(e,t,i){let a=WH.ce("a",{className:"audio-controls-control page-action fa fa-"+t,href:"javascript:"},WH.ct(e));if(i){a.dataset.disabled="true"}return a}};WH.aE(window,"load",(function(){g_audiocontrols.__windowloaded=true;for(var e in g_audiocontrols)if(e.substr(0,2)!="__")g_audiocontrols[e].btnNextTrack()}));AudioPlaylist=function(){var e=false;var t=[];var i,a;var n=false;this.init=function(){if(!WH.LocalStorage.isSupported()){return}e=true;var i=WH.LocalStorage.get("AudioPlaylist");if(i){t=JSON.parse(i)}};this.savePlaylist=function(){if(!e)return false;WH.LocalStorage.set("AudioPlaylist",JSON.stringify(t))};this.isEnabled=function(){return e};this.addSound=function(i){if(!e)return false;this.init();t.push(i);this.savePlaylist();s()};this.deleteSound=function(e){if(e<0){t=[]}else{t.splice(e,1)}this.savePlaylist();if(!i.isPlaying()){i.removeSelf();this.setAudioControls(a)}if(t.length==0)WH.Tooltip.hide()};this.getList=function(){var e=[];for(var i=0;i<t.length;i++)e.push(t[i].title);return e};this.setAudioControls=function(n){if(!e)return false;a=n;i=new AudioControls;i.init(t,a,{loop:true,fromPlaylist:true})};function s(){if(n)return;if(!(WH.isSet("g_user")&&g_user.id))return;if(t.length<2)return;$.ajax({url:"/sound&playlist",data:{achievement:1},success:function(){AchievementCheck()},type:"POST"});n=true}};g_audioplaylist=new AudioPlaylist;g_audioplaylist.init();WH.BlizzardApi=new function(){const e={us:"northamerican_abbrev",eu:"european_abbrev",cn:"chinese_abbrev",tw:"taiwanese_abbrev",kr:"korean_abbrev"};var t={us:"us.api.blizzard.com",eu:"eu.api.blizzard.com",kr:"kr.api.blizzard.com",tw:"tw.api.blizzard.com"};var i=false;var a={};var n=[];this.apiCall=function(e,i,n){e=e.toLowerCase();if(!t.hasOwnProperty(e)){WH.error("Invalid region passed to Blizzard API:",e);return}if(!a.token||a.hasOwnProperty("expires")&&a.expires<new Date){if(a.failed){var s=["error","complete"];for(var r,o=0;r=s[o];o++){if(typeof n[r]==="function"){n[r]=[n[r]]}if(Array.isArray(n[r])){while(n[r].length){n[r].shift()({status:400},"abort")}}}}else{this.getNewToken(this.apiCall.bind(this,e,i,n))}return}n.url="https://"+t[e]+i;if(0){if(!n.hasOwnProperty("headers")){n.headers={}}n.headers.Authorization="Bearer "+a.token}else{if(!n.hasOwnProperty("data")){n.data={}}n.data.access_token=a.token}$.ajax(n)};this.characterExists=function(e,t,a,n){if(!WH.LocalStorage.isSupported()||!(JSON&&"stringify"in JSON)){n(true);return}var s=t.toLowerCase().replace(/[^\w -]/,"").replace(" ","-");var r=(e+"|"+s+"|"+a).toLowerCase();if(!i){i={};try{i=JSON.parse(WH.LocalStorage.get("BattleNetCharCache"));if(i==null){i={}}}catch(e){i={}}}if(i.hasOwnProperty(r)){if(parseInt(i[r].substr(1),10)>Math.floor((Date.now()-1e3*60*60*24*4)/1e3)){n(i[r].substr(0,1)=="t");return}}var o=function(e){i[r]=(e&&e.is_valid?"t":"f")+Math.floor(Date.now()/1e3);WH.LocalStorage.set("BattleNetCharCache",JSON.stringify(i));n(e&&e.name)};WH.Wow.Realm.fetchData(function(){var i=WH.Wow.Realm.getSlugByName(e,t);if(!i){o(false)}else{this.apiCall(e,WH.Strings.sprintf("/profile/wow/character/%s/%s/status?namespace=profile-%s",encodeURIComponent(i),encodeURIComponent(a.toLocaleLowerCase()),e.toLowerCase()),{dataType:"json",method:"GET",success:o,error:o.bind(null,false)})}}.bind(this))};this.getCharacterThumbnailUrl=function(e,t){return"https://render-"+e.toLowerCase()+".worldofwarcraft.com/character/"+t};this.getNewToken=function(e){n.push(e);if(n.length>1){return}var t=$.ajax.bind($,{url:"/blizzard-api/token",dataType:"json",method:"GET",success:this.setToken,error:function(e){WH.error("Could not get Blizzard API token from Wowhead",e);this.setToken(null)}.bind(this)});if(!a.hasOwnProperty("token")&&document.readyState=="loading"&&document.addEventListener){var i=function(){document.removeEventListener("readystatechange",i,false);if(!a.hasOwnProperty("token")){t()}};document.addEventListener("readystatechange",i,false)}else{t()}};this.getNotFoundMessage=function(){let e=document.createDocumentFragment();WH.ae(e,WH.ct(WH.TERMS.characterDoesNotExist_tip));let t=WH.ce("ul");WH.ae(e,t);WH.ae(t,WH.ce("li",{},WH.ct(WH.TERMS.characterHasBeenAccessedRecently_tip)));WH.ae(t,WH.ce("li",{innerHTML:WH.Strings.sprintf(WH.TERMS.yourBlizzardSettingsSetToEnabled_format,WH.ce("a",{href:"https://account.blizzard.com/privacy"},WH.ct(WH.TERMS.gameDataAndProfilePrivacy)).outerHTML)}));let i=WH.ce("div",{innerHTML:WH.Strings.sprintf(WH.TERMS.furtherIssues_format,WH.ce("a",{href:"javascript:"},WH.ct(WH.TERMS.feedback)).outerHTML)});WH.aE(i.querySelector("a"),"click",ContactTool.show.bind(ContactTool,undefined));while(i.hasChildNodes()){WH.ae(e,i.removeChild(i.firstChild))}return e};this.getRegionAbbreviation=function(t){return WH.TERMS[e[t.toLowerCase()]]};this.setToken=function(e){if(!e||!e.hasOwnProperty("token")){a={failed:true};while(n.length){n.shift()()}a={};return}a=e;a.expires=new Date(Date.now()+a.expires*1e3);while(n.length){n.shift()()}}};WH.CommentReplies=new function(){this.setupReplies=function(a,n,s){e(a,n,s,false);t(a,n,s);a.find(".comment-reply-row").each((function(){i($(this),n,s)}));a.find(".comment-reply-row").hover((function(){$(this).find("span").attr("data-hover","true")}),(function(){$(this).find("span").attr("data-hover","false")}))};function e(e,t,i,a){let n=null;let s=null;let r=null;let o=null;let l=null;let c=null;let u=WH.getPageData("guide.author")===WH.User.getUsername()?WH.Comments.MAX_LENGTH_COMMENT:WH.Comments.MAX_LENGTH_REPLY;let d=WH.Comments.MIN_LENGTH;let f=null;let h=false;let p=false;let m=false;let g=false;let H=e.find(".comment-replies > table");let W=e.find(".add-reply");let v=t.replies.length;if(a){T()}else{W.click((function(){T()}))}function _(){if(h){return}h=true;let i=$("<tr/>");if(a){i.addClass("comment-reply-row").addClass("reply-edit-row")}i.html('<td style="width: 0"></td>'+'<td class="comment-form"><form><table>'+"<form>"+"<table><tr>"+'<td style="width: 600px">'+'<textarea required="required" name="body" cols="68" rows="3"></textarea>'+"</td>"+"<td>"+'<input type="submit" value="'+(a?WH.TERMS.save:WH.TERMS.addreply)+'" />'+'<img src="'+WH.staticUrl+'/images/icons/ajax.gif" class="ajax-loader" />'+"</td>"+"</tr>"+'<tr><td colspan="2">'+'<span class="text-counter">Text counter placeholder</span>'+"</td></tr></table>"+"</form>"+"</td>");r=i.find(".comment-form textarea");n=i.find(".comment-form input[type=submit]");f=i.find(".comment-form span.text-counter");l=i.find(".comment-form form");s=i.find(".comment-form .ajax-loader");c=i.find(".comment-form");l.submit((function(){E();return false}));N();r.keyup((function(e){N()}));r.keydown((function(e){if(e.keyCode==27){b();return false}}));r.keypress((function(e){if(e.keyCode==13){E();return false}}));if(a){e.after(i);e.hide();l.find("textarea").text(t.replies[e.attr("data-idx")].body)}else{H.append(i)}o=i;WH.safeFocus(l.find("textarea"))}function T(){if(!h){_()}p=true;if(!a){W.hide();e.find(".comment-replies").show();c.show()}}function b(){p=false;if(a){if(o){o.remove()}e.show();return}W.show();c.hide();if(v==0){e.find(".comment-replies").hide()}}function E(){if(!p||g){return}if(r.val().length<d||r.val().length>u){if(!m){m=true;f.animate({opacity:"0.0"},150);f.animate({opacity:"1.0"},150,null,(function(){m=false}))}return false}y();$.ajax({type:"POST",url:a?"/comment/edit-reply":"/comment/add-reply",data:{commentId:t.id,replyId:a?e.attr("data-replyid"):0,body:r.val()},success:function(e){w(e)},dataType:"json",error:function(e){I(e.responseText)}});return true}function y(){g=true;s.show();n.prop("disabled",true);c.find(".wh-message-box").remove()}function S(){g=false;s.hide();n.prop("disabled",false)}function w(e){t.replies=e;Listview.templates.comment.updateReplies.call(i,t)}function I(e){S();MessageBox(c,e)}function N(){let e="(error)";let t="q0";let i=r.val().replace(/(\s+)/g," ").replace(/^\s*/,"").replace(/\s*$/,"").length;let a=u-i;if(i==0){e=WH.sprintf(WH.TERMS.replylength1_format,d)}else if(i<d){e=WH.sprintf(WH.TERMS.replylength2_format,d-i)}else{e=WH.sprintf(WH.term(a===1?"replylength4_format":"replylength3_format"),a);if(a<120){t="chars-left-none"}else if(a<240){t="chars-left-some"}else if(a<360){t="chars-left-many"}}f.html(e).attr("class",t)}}function t(e,t,i){var a=e.find(".show-more-replies");var n=e.find(".comment-replies");a.click((function(){s()}));function s(){a.hide();n.append($("<img>",{class:"ajax-loader",alt:"",src:WH.staticUrl+"/images/icons/ajax.gif"}));$.ajax({type:"GET",url:"/comment/show-replies",data:{id:t.id},success:function(e){t.replies=e;Listview.templates.comment.updateReplies.call(i,t)},dataType:"json",error:function(){r()}})}function r(){a.show();n.find(".ajax-loader").remove();MessageBox(n,"There was an error fetching the comments. Try refreshing the page.")}}function i(t,i,a){var n=t.attr("data-replyid");var s=t.find(".reply-upvote");var r=t.find(".reply-downvote");var o=t.find(".reply-report");var l=t.find(".reply-rating");var c=t.find(".reply-controls");var u=t.find(".reply-delete");var d=t.find(".reply-edit");var f=false;var h=false;d.click((function(){e(t,i,a,true)}));o.click((function(){if(f||!confirm(WH.TERMS.replyreportwarning_tip))return;f=true;$.ajax({type:"POST",url:"/comment/vote-reply",data:{id:n,action:"report"},success:function(){m()},error:function(e){H(e.responseText)}})}));s.click((function(){if(s.attr("data-hasvoted")=="true"||s.attr("data-canvote")!="true"||f)return;f=true;$.ajax({type:"POST",url:"/comment/vote-reply",data:{id:n,action:"up"},success:function(){p(1)},error:function(e){H(e.responseText)}})}));r.click((function(){if(r.attr("data-hasvoted")=="true"||r.attr("data-canvote")!="true"||f)return;f=true;$.ajax({type:"POST",url:"/comment/vote-reply",data:{id:n,action:"down"},success:function(){p(-1)},error:function(e){H(e.responseText)}})}));u.click((function(){if(h)return;if(!confirm(WH.TERMS.deletereplyconfirmation_tip))return;h=true;$.ajax({type:"POST",url:"/comment/delete-reply",data:{id:n},success:function(){g()},error:function(e){H(e.responseText)}})}));function p(e){var t=parseInt(l.text());t+=e;l.text(t);if(e>0)s.attr("data-hasvoted","true");else r.attr("data-hasvoted","true");s.attr("data-canvote","false");r.attr("data-canvote","false");if(e>0){o.remove()}f=false}function m(){f=false;o.remove()}function g(){t.remove();h=false}function H(e){f=false;h=false;if(!e)e="An error has occurred. Try refreshing the page.";MessageBox(c,e)}}};WH.Comments=new function(){const e=this;this.MIN_LENGTH=15;this.MAX_LENGTH_COMMENT=1e5;this.MAX_LENGTH_REPLY=600;this.EDIT_MODE_EDIT_FORUM_POST=-1;this.EDIT_MODE_EDIT_COMMENT=0;this.EDIT_MODE_ADD_COMMENT=1;this.EDIT_MODE_USER_DESCRIPTION=2;this.EDIT_MODE_ADD_FORUM_REPLY=3;this.EDIT_MODE_USER_SIGNATURE=4;this.LOW_RATING_THRESHOLD=-4;var t=1;var i=2;this.appendImportedSubject=function(e,t){if(!t){return}var i=t.replace(/^\s*Re\b|\bRe\s*$/,"").replace(/\s/,"");if(!i||!i.match(/[^:]/)){return}var a=WH.ce("span");WH.st(a,'"'+t+'"');var n=WH.ce("span",{className:"comment-imported-subject"});WH.st(n,WH.TERMS.subject_colon);WH.ae(n,a);e.append(n)};this.getColorClass=function(t,i,a,n){switch(i){case e.EDIT_MODE_EDIT_FORUM_POST:var s=null;if(!a){s=t.divPost.childNodes[1].className.match(/comment-([a-z-]+)/)}else{s=t.divBody[0].className.match(/comment-([a-z-]+)/)}if(s!=null){return" comment-"+s[1]}break;case e.EDIT_MODE_ADD_FORUM_REPLY:if(t.roles&U_GROUP_PREMIUMISH){return" comment-role-premium"}case e.EDIT_MODE_USER_SIGNATURE:let i=WH.User.getCommentRoleClass(t.roles,t.user);if(i){return" "+i}break}if(t.roles&U_GROUP_ADMIN){return" comment-role-admin"}if(n){return" comment-guide-author"}if(t.commentv2&&t.sticky||t.roles&U_GROUP_GREEN_TEXT||t.rating>=10){return" comment-high-rating"}if(t.rating&&t.rating<-2){return" comment-low-rating"}if(t.roles&U_GROUP_PREMIUMISH){return" comment-role-premium"}return""};this.edit=function(t,i,n){if(n){t.divBody.hide();t.divResponse.hide()}var s=$("<div/>");s.addClass("comment-edit");t.divEdit=s[0];if(i===e.EDIT_MODE_EDIT_FORUM_POST){if(g_users[t.user]!=null){t.roles=g_users[t.user].roles}}var r=e.editAppend(s,t,i,n);var o=$("<div/>");o.addClass("comment-edit-buttons");var l=$("<button/>",{text:WH.TERMS.save});l.click(a.bind(this,true,t,i,n));o.append(l);o.append(WH.ct(" "));l=$("<button/>",{text:WH.TERMS.cancel});l.click(a.bind(this,false,t,i,n));o.append(l);s.append(o);s.insertAfter(t.divBody);WH.safeFocus(r)};this.editAppend=function(a,o,l,c,u,d){var f=e.getCharLimit(l);if(o.body===null){o.body=""}if(l===e.EDIT_MODE_ADD_COMMENT||l===e.EDIT_MODE_ADD_FORUM_REPLY||l===e.EDIT_MODE_USER_SIGNATURE){o.user=g_user.name;o.roles=g_user.roles;o.rating=1}else if(l===e.EDIT_MODE_USER_DESCRIPTION){o.roles=g_user.roles;o.rating=1}if(u){o.roles&=~U_GROUP_PENDING}if(l===e.EDIT_MODE_EDIT_FORUM_POST||l===e.EDIT_MODE_EDIT_COMMENT){var h=$("<div/>",{text:WH.TERMS.mode_colon});h.addClass("comment-edit-modes");var p=$("<a/>",{href:"javascript:",text:WH.TERMS.edit});p.click(s.bind(p[0],t,l,o));p.addClass("selected");h.append(p);h.append(WH.ct("|"));var m=$("<a/>",{href:"javascript:",text:WH.TERMS.preview});m.click(s.bind(m[0],i,l,o));h.append(m);a.append(h)}var g=$("<div/>",{css:{display:"none"}});g.addClass("text comment-body"+e.getColorClass(o,l,c));var H=$("<div/>");H.addClass("comment-edit-body");var W=$('<div style="float: left" />');W.addClass("toolbar");var v=$('<div style="float: left" />');v.addClass("menu-buttons");var _=$("<textarea/>",{val:o.body,rows:10,css:{clear:"left"}});_.addClass("comment-editbox");switch(l){case e.EDIT_MODE_ADD_COMMENT:_.attr("name","commentbody");break;case e.EDIT_MODE_USER_DESCRIPTION:_.attr({name:"desc",originalValue:o.body});break;case e.EDIT_MODE_ADD_FORUM_REPLY:_.attr("name","body");break;case e.EDIT_MODE_USER_SIGNATURE:_.attr({name:"sig",originalValue:o.body,rows:3});_.css("height","auto");break}if(l!==e.EDIT_MODE_EDIT_FORUM_POST&&l!==e.EDIT_MODE_EDIT_COMMENT){var T=$("<a/>"),b=$("<div/>"),E=$("<div/>"),y=screen.availWidth<=480;var S=n.bind(e,o,l,_[0],b[0]);T.addClass("disclosure-"+(y?"off":"on"));T.text(WH.TERMS.livepreview);T.attr("href","javascript:");T.click((function(){S(1);var e=WH.toggleDisplay(b);T.toggleClass("disclosure-on",e);T.toggleClass("disclosure-off",!e)}));E.addClass("pad");g.append(WH.getMajorHeading(T,3,null,{classes:"first"}));g.append(b);g.append(E);WH.onAfterTyping(_[0],S,50);_.focus((function(){S();g.css("display",y?"none":"");if(l!==e.EDIT_MODE_USER_SIGNATURE&&!d){_.css("height","22em")}}))}else if(l!==e.EDIT_MODE_USER_SIGNATURE&&!d){_.focus((function(){_.css("height","22em")}))}var w=[{id:"b",icon:"bold",title:WH.TERMS.bold,pre:"[b]",post:"[/b]"},{id:"i",icon:"italic",title:WH.TERMS.italic,pre:"[i]",post:"[/i]"},{id:"u",icon:"underline",title:WH.TERMS.underline,pre:"[u]",post:"[/u]"},{id:"s",icon:"strikethrough",title:WH.TERMS.strikethrough,pre:"[s]",post:"[/s]"},{id:"small",icon:"text-height",title:WH.TERMS.smalltext_stc,pre:"[small]",post:"[/small]"},{id:"url",icon:"link",title:WH.TERMS.link,nopending:true,onclick:function(){var e=prompt(WH.TERMS.linkurl_tip,"https://");if(e){WH.insertTag(_[0],"[url="+e+"]","[/url]")}}},{id:"quote",icon:"quote-left",title:WH.TERMS.quotebox_stc,pre:"[quote]",post:"[/quote]"},{id:"code",icon:"code",title:WH.TERMS.codebox_stc,pre:"[code]",post:"[/code]"},{id:"ul",icon:"list-ul",title:WH.TERMS.unorderedlistbullets_stc,pre:"[ul]\n[li]",post:"[/li]\n[/ul]",rep:function(e){return e.replace(/\n/g,"[/li]\n[li]")}},{id:"ol",icon:"list-ol",title:WH.TERMS.orderedlistnumbers_stc,pre:"[ol]\n[li]",post:"[/li]\n[/ol]",rep:function(e){return e.replace(/\n/g,"[/li]\n[li]")}},{id:"li",icon:"circle",title:WH.TERMS.listitem_stc,pre:"[li]",post:"[/li]"}];if(!c){for(var I=0,N=w.length;I<N;++I){var R=w[I];if(l===e.EDIT_MODE_USER_SIGNATURE&&R.id=="quote"){break}if(g_user.roles&U_GROUP_PENDING&&R.nopending){continue}var M=$("<button/>",{click:function(e,t){t.preventDefault();(e.onclick!=null?e.onclick:WH.insertTag.bind(0,_[0],e.pre,e.post,e.rep))()}.bind(null,R)});M[0].setAttribute("type","button");M.attr("title",R.title);var A=$("<i/>",{class:"fa fa-"+R.icon});M.append(A);W.append(M)}}else{for(var I=0,N=w.length;I<N;++I){var R=w[I];if(g_user.rolls&U_GROUP_PENDING&&R.nopending){continue}var k="tb-"+R.id;var M=$("<button/>",{click:function(e,t){t.preventDefault();(e.onclick!=null?e.onclick:WH.insertTag.bind(0,_[0],e.pre,e.post,e.rep))()}.bind(null,R),class:k,title:R.title});M[0].setAttribute("type","button");M.append("<ins/>");W.append(M)}W.addClass("formatting")}let C=[];let L;for(let e in WH.markup.tags){if(!WH.markup.tags.hasOwnProperty(e)){continue}if(L=WH.markup.tags[e].entityType){let t=[L,WH.Types.getUpperSingular(L)+WH.TERMS.ellipsis_punct,WH.markup.insertEntityTag.bind(null,_[0],WH.Types.getLowerSingular(L),e)];let i=WH.Types.getRequiredTrees(L);if(i){t.push(null,{requiredTrees:i})}C.push(t)}}C.sort((function(e,t){return e[1].localeCompare(t[1])}));let O=[Menu.createItem({label:WH.TERMS.links,submenu:C})];H.append(W);H.append(v);H.append($('<div style="clear: left" />'));H.append(_);H.append($("<br/>"));Menu.addButtons(v[0],O);if(l===e.EDIT_MODE_USER_SIGNATURE){H.append(WH.ct(WH.sprintf(WH.TERMS.uptoxcharactersorlines_format,f.toLocaleString(),3)))}else{H.append(WH.ct(WH.sprintf(WH.TERMS.uptoxcharacters_format,f.toLocaleString())))}var D=$('<span class="comment-remaining"> '+WH.sprintf(WH.TERMS.xcharactersremaining_format,(f-o.body.length).toLocaleString())+"</span>");H.append(D);_.keyup(r.bind(e,_,D,f));_.keydown(r.bind(e,_,D,f));if((l===e.EDIT_MODE_EDIT_FORUM_POST||l===e.EDIT_MODE_EDIT_COMMENT)&&g_user.roles&U_GROUP_MODERATOR){var x=$("<div/>",{class:"pad"});var P=$("<div/>",{text:(g_user.roles&U_GROUP_ADMIN?"Admin":"Moderator")+" response"});var U=$("<textarea/>",{val:o.response,rows:3,css:{height:"6em"}});H.append(x);H.append(P);H.append(U)}a.append(H);a.append(g);$("<div/>").append('<div class="pad"/>').append(WH.getMajorHeading($('<a class="disclosure-off"/>').text(WH.TERMS.formattinghelp).click((function(){WH.disclose(this.parentNode.nextSibling,this)})),3,null,{classes:"first"})).append($('<div style="display: none"/>').append(WH.markup.getDomFragment("[markupdoc help=user]"))).insertAfter(a.parent());return _};this.getCharLimit=function(t){if(t===e.EDIT_MODE_USER_DESCRIPTION){return 7500}if(t===e.EDIT_MODE_USER_SIGNATURE){return 250}if(g_user.roles&U_GROUP_STAFF){return 1e5}var i=WH.User.isPremium()?3:1;switch(t){case e.EDIT_MODE_EDIT_COMMENT:case e.EDIT_MODE_ADD_COMMENT:return 7500*i;case e.EDIT_MODE_EDIT_FORUM_POST:case e.EDIT_MODE_ADD_FORUM_REPLY:return 15e3*i}return 0};this.updateLastEdit=function(e){var t=e.divLastEdit;if(!t){return}if(e.lastEdit!=null){var i=e.lastEdit;t.childNodes[1].firstChild.nodeValue=i[2];t.childNodes[1].href="/user="+i[2];var a=new Date(i[0]);var n=(WH.getServerTime()-a)/1e3;if(t.childNodes[3].firstChild){WH.de(t.childNodes[3].firstChild)}WH.formatDate(t.childNodes[3],n,a);var s="";if(e.rating!=null){s+=WH.sprintf(WH.TERMS.patchparens_format,WH.Wow.getVersionStringFromTimestamp(a))}if(i[1]>1){s+=WH.TERMS.dash_punct+WH.sprintf(WH.TERMS.editcount_format,i[1])}t.childNodes[4].nodeValue=s;t.style.display=""}else{t.style.display="none"}};this.validate=function(t,i){i|=0;var a=i===e.EDIT_MODE_EDIT_FORUM_POST||i===e.EDIT_MODE_ADD_FORUM_REPLY;if(a){if(WH.trim(t.value).length<1){alert(WH.TERMS.postempty_tip);return false}}else{if(WH.trim(t.value).length<1){alert(WH.TERMS.messagetooshort_tip);return false}}var n=e.getCharLimit(i);if(t.value.length>n){return confirm(WH.sprintf(a?WH.TERMS.postlength_format:WH.TERMS.commentlength_format,n,t.value.substring(n-30,n)))}return true};function a(t,i,a,n){if(t){var s=WH.gE(i.divEdit,"textarea");var r=s[0];if(!e.validate(r,a)){return}if(r.value!=i.body||s[1]&&s[1].value!=i.response){var o=0;if(i.lastEdit!=null){o=i.lastEdit[1]}++o;i.lastEdit=[WH.getServerTime(),o,g_user.name];if(!i.commentv2){e.updateLastEdit(i)}var l=e.getCharLimit(a);var c=WH.markup.rolesToClass(i.roles);var u=WH.markup.getDomFragment(r.value.length>l?r.value.substring(0,l):r.value,{allow:c,mode:WH.markup.MODE.COMMENT,roles:i.roles});var d=s[1]&&s[1].value.length>0?WH.markup.getDomFragment("[div][/div][wowheadresponse="+g_user.name+" roles="+g_user.roles+"]"+s[1].value+"[/wowheadresponse]",{allow:WH.markup.CLASS.STAFF,mode:WH.markup.MODE.COMMENT,roles:g_user.roles}):document.createDocumentFragment();if(i.commentv2){i.body=r.value;if(g_user.roles&U_GROUP_MODERATOR&&s[1]){i.response=s[1].value}Listview.templates.comment.updateCommentCell.call(this,i)}else{if(!n){$(i.divBody).empty().append(u);$(i.divResponse).empty().append(d)}else{i.divBody.empty().append(u);i.divResponse.empty().append(d)}i.body=r.value;if(g_user.roles&U_GROUP_MODERATOR&&s[1]){i.response=s[1].value}}var f={postId:i.id,body:i.body};var h="body="+WH.urlEncode(i.body);if(i.response!==undefined){h+="&response="+WH.urlEncode(i.response);f.response=i.response}if(a===e.EDIT_MODE_EDIT_FORUM_POST){$.ajax({url:"/forums/edit-post",method:"post",data:f})}else{new Ajax("/comment=edit&id="+i.id,{method:"POST",params:h})}}}if(i.commentv2){Listview.templates.comment.updateCommentCell.call(this,i)}else if(!n){i.divBody.style.display="";i.divResponse.style.display="";i.divLinks.firstChild.style.display=""}else{i.divBody.show();i.divResponse.show()}if(!i.commentv2){WH.de(i.divEdit);i.divEdit=null}}function n(t,i,a,n){if(n.style.display=="none"){return}var s=e.getCharLimit(i);var r=a.value.length>s?a.value.substring(0,s):a.value;if(i===e.EDIT_MODE_USER_SIGNATURE){var o;if((o=r.indexOf("\n"))!=-1&&(o=r.indexOf("\n",o+1))!=-1&&(o=r.indexOf("\n",o+1))!=-1){r=r.substring(0,o)}}var l=WH.markup.rolesToClass(t.roles);var c=WH.markup.getDomFragment(r,{allow:l,mode:WH.markup.MODE.COMMENT,roles:t.roles});if(c.hasChildNodes()){$(n).empty().append(c)}else{n.innerHTML='<span class="q6">...</span>'}}function s(a,n,s){var r=e.getCharLimit(n);var o=WH.markup.MODE.COMMENT;WH.arrayWalk(WH.gE(this.parentNode,"a"),(function(e){e.className=""}));this.className="selected";var l=WH.gE(this.parentNode.parentNode,"textarea");var c=l[0];var u=c.parentNode;var d=$(".comment-body",u.parentNode)[0];if(n===e.EDIT_MODE_USER_SIGNATURE){o=WH.markup.MODE.SIGNATURE}switch(a){case t:u.style.display="";d.style.display="none";WH.safeFocus(u.firstChild);break;case i:u.style.display="none";var f=c.value.length>r?c.value.substring(0,r):c.value;if(n===e.EDIT_MODE_USER_SIGNATURE){var h;if((h=f.indexOf("\n"))!=-1&&(h=f.indexOf("\n",h+1))!=-1&&(h=f.indexOf("\n",h+1))!=-1){f=f.substring(0,h)}}var p=WH.markup.rolesToClass(s.roles);var m=WH.markup.getDomFragment(f,{allow:p,mode:o,roles:s.roles});if(l[1]&&l[1].value.length>0){m.appendChild(WH.markup.getDomFragment("[div][/div][wowheadresponse="+g_user.name+" roles="+g_user.roles+"]"+l[1].value+"[/wowheadresponse]",{allow:WH.markup.CLASS.STAFF,mode:o,roles:g_user.roles}))}$(d).empty().append(m);d.style.display="";break}}function r(e,t,i){var a=$(e).val();if(a.length>i){$(e).val(a.substring(0,i))}else{$(t).html(" "+WH.sprintf(WH.TERMS.xcharactersremaining_format,(i-a.length).toLocaleString())).removeClass("q10");if(a.length===i){$(t).addClass("q10")}}}};function co_addYourComment(){tabsContribute.focus(0);var e=WH.gE(document.forms["addcomment"],"textarea")[0];WH.safeFocus(e)}function co_validateForm(e){var t=WH.gE(e,"textarea")[0];var i=false;if(WH.isSet("tabsContribute")){for(var a=0;a<tabsContribute.tabs.length;a++){if(tabsContribute.tabs[a].id=="suggest-a-video"){i=a;break}}}if(i!==false&&t.value.length<350){var n;for(var a in vi_sitevalidation){if(!vi_sitevalidation.hasOwnProperty(a)){continue}if(n=vi_sitevalidation[a].exec(t.value)){break}}if(n&&!confirm(WH.TERMS.commentasvideo_tip)){tabsContribute.show(i);$('#tab-suggest-a-video input[name="videourl"]').attr("value",n[0]);return false}}return WH.Comments.validate(t)}$(document).ready((function(){WH.setupChangeWarning($("form[name=addcomment]"),[$("textarea[name=commentbody]")],WH.TERMS.messagestarted_tip)}));WH.Cookies=new function(){const e=this;this.available=function(){if(!t()){return false}return i()};this.getDomain=function(){return WH.Url.getHost("cookies").replace(/^cookies\./,"")};function t(){if(typeof window.OptanonActiveGroups!=="string"){return true}return window.OptanonActiveGroups.split(",").indexOf("C0001")!==-1}function i(){WH.setCookie("enabledTest",1,"1",undefined,undefined,location.protocol==="https:");let e=WH.getCookies("enabledTest")==="1";if(e){WH.deleteCookie("enabledTest",undefined,undefined,location.protocol==="https:")}i=function(){return e};return e}};WH.D2={};var Dialog=function(){var e=this,t,i=null,a,n={},s,r=false,o=WH.ce("form"),l={};o.onsubmit=function(){p();return false};this.show=function(l,u){if(l){a=l;t=WH.cOr({},Dialog.templates[a]);e.template=t}else return;if(t.onInit&&!r)t.onInit.bind(e,o,u)();if(u.onBeforeShow)n.onBeforeShow=u.onBeforeShow.bind(e,o);if(t.onBeforeShow)t.onBeforeShow=t.onBeforeShow.bind(e,o);if(u.onShow)n.onShow=u.onShow.bind(e,o);if(t.onShow)t.onShow=t.onShow.bind(e,o);if(u.onHide)n.onHide=u.onHide.bind(e,o);if(t.onHide)t.onHide=t.onHide.bind(e,o);if(u.onSubmit)n.onSubmit=u.onSubmit;if(t.onSubmit)i=t.onSubmit.bind(e,o);if(u.data){r=false;s={};WH.cO(s,u.data)}e.data=s;Lightbox.show("dialog-"+a,{onShow:c,onHide:h})};this.getValue=function(e){return g(e)};this.setValue=function(e,t){H(e,t)};this.getSelectedValue=function(e){return W(e)};this.getCheckedValue=function(e){return v(e)};function c(e,i){if(i||!r)d(e);if(t.onBeforeShow)t.onBeforeShow();if(n.onBeforeShow)n.onBeforeShow();Lightbox.setSize(t.width);e.className+=" dialog";f();if(t.onShow)t.onShow();if(n.onShow)n.onShow();window.setTimeout(u,5)}function u(){for(var e=0,i,a;i=t.fields[e];e++){if(WH.inArray(["text","number"],i.type)>=0){l[i.id].focus();break}}}function d(i){WH.ee(i);WH.ee(o);var a=WH.ce("div");a.className="lightbox-content text";WH.ae(i,a);WH.ae(a,o);if(t.title){WH.ae(o,WH.getImitationHeading(WH.ct(t.title),1))}var n=WH.ce("table"),c=WH.ce("tbody"),u=false;var d;var f;var h;WH.ae(n,c);WH.ae(o,n);for(var m=0,g=t.fields.length;m<g;++m){var H=t.fields[m],W;if(!u){d=WH.ce("tr");f=WH.ce("th");h=WH.ce("td")}H.__tr=d;if(s[H.id]==null)s[H.id]=H.value?H.value:"";var v;if(H.options){v=[];if(H.optorder)WH.cO(v,H.optorder);else{for(var _ in H.options)v.push(_)}if(H.sort)v.sort((function(e,t){return H.sort*WH.stringCompare(H.options[e],H.options[t])}))}switch(H.type){case"caption":f.colSpan=2;f.style.textAlign="left";f.style.padding=0;if(H.compute)H.compute.bind(e,null,s[H.id],o,f,d)();else if(H.label)WH.ae(f,WH.ct(H.label));WH.ae(d,f);WH.ae(c,d);continue;break;case"textarea":var T=W=WH.ce("textarea");T.name=H.id;if(H.disabled)T.disabled=true;T.rows=H.size[0];T.cols=H.size[1];h.colSpan=2;if(H.label){f.colSpan=2;f.style.textAlign="left";f.style.padding=0;h.style.padding=0;WH.ae(f,WH.ct(H.label));WH.ae(d,f);WH.ae(c,d);d=WH.ce("tr")}WH.ae(h,T);break;case"select":var T=W=WH.ce("select");T.name=H.id;if(H.size)T.size=H.size;if(H.disabled)T.disabled=true;if(H.multiple)T.multiple=true;if(H.onchange){T.onchange=H.onchange.bind(e,T)}for(var _=0,b=v.length;_<b;++_){var E=WH.ce("option");E.value=v[_];WH.ae(E,WH.ct(H.options[v[_]]));WH.ae(T,E)}WH.ae(h,T);break;case"dynamic":h.colSpan=2;h.style.textAlign="left";h.style.padding=0;if(H.compute)H.compute.bind(e,null,s[H.id],o,h,d)();WH.ae(d,h);WH.ae(c,d);W=h;break;case"checkbox":case"radio":var y=0;W=[];for(var _=0,b=v.length;_<b;++_){var S=WH.ce("span"),T,w,I="sdfler46"+H.id+"-"+v[_];if(_>0&&!H.noInputBr)WH.ae(h,WH.ce("br"));w=WH.ce("label");w.setAttribute("for",I);w.onmousedown=WH.rf;T=WH.ce("input");T.setAttribute("type",H.type);T.name=H.id;T.value=v[_];T.id=I;if(H.disabled)T.disabled=true;if(H.onchange){T.onchange=H.onchange.bind(e,T)}if(H.submitOnDblClick)w.ondblclick=T.ondblclick=function(e){p()};if(H.compute)H.compute.bind(e,T,s[H.id],o,h,d,w)();WH.ae(w,T);WH.ae(w,WH.ct(H.options[v[_]]));WH.ae(h,w);W.push(T)}break;default:var T=W=WH.ce("input");T.name=H.id;if(H.size)T.size=H.size;if(H.disabled)T.disabled=true;if(H.submitOnEnter){T.onkeypress=function(e){if(e.keyCode===13){p()}}}T.setAttribute("type",H.type);WH.ae(h,T);break}if(H.label){if(H.type=="textarea"){if(H.labelAlign)h.style.textAlign=H.labelAlign;h.colSpan=2}else{if(H.labelAlign)f.style.textAlign=H.labelAlign;WH.ae(f,WH.ct(H.label));WH.ae(d,f)}}if(H.placeholder){T.placeholder=H.placeholder}if(H.type!="checkbox"&&H.type!="radio"){if(H.width)T.style.width=H.width;if(H.compute&&H.type!="caption"&&H.type!="dynamic")H.compute.bind(e,T,s[H.id],o,h,d)()}if(H.caption){var S=WH.ce("small");if(H.type!="textarea")S.style.paddingLeft="2px";WH.ae(S,WH.ct(H.caption));WH.ae(h,S)}if(H.style&&typeof T!=="undefined"){for(var N in H.style){T.style[N]=H.style[N]}}WH.ae(d,h);WH.ae(c,d);u=H.mergeCell;l[H.id]=W}var R={arrow:"external-link",check:"check",question:"question",x:"times"};for(var m=t.buttons.length;m>0;--m){var M=t.buttons[m-1],A=WH.ce("a");A.onclick=p.bind(A,M[0]);A.className="dialog-option fa fa-"+(R[M[0]]||"circle fa-size-xs");A.href="javascript:";WH.ae(A,WH.ct(M[1]));WH.ae(i,A)}r=true}function f(){for(var i=0,a=t.fields.length;i<a;++i){var n=t.fields[i],r=l[n.id];switch(n.type){case"caption":break;case"select":for(let e=0,t=r.options.length;e<t;e++){r.options[e].selected=r.options[e].value==s[n.id]||s[n.id]instanceof Array&&WH.inArray(s[n.id],r.options[e].value)!==-1}break;case"checkbox":case"radio":for(let e=0,t=r.length;e<t;e++){r[e].checked=r[e].value==s[n.id]||Array.isArray(s[n.id])&&WH.inArray(s[n.id],r[e].value)!=-1}break;default:r.value=s[n.id];break}if(n.update)n.update.bind(e,null,s[n.id],o,r)()}}function h(){if(t.onHide)t.onHide();if(n.onHide)n.onHide()}function p(e){if(e=="x")return Lightbox.hide();for(var i=0,a=t.fields.length;i<a;++i){var n=t.fields[i],r;switch(n.type){case"caption":continue;case"select":r=W(n.id);break;case"checkbox":case"radio":r=v(n.id);break;case"dynamic":if(n.getValue){r=n.getValue(n,s,o);break}default:r=g(n.id);break}if(n.validate){if(!n.validate(r,s,o))return}if(r&&typeof r=="string")r=WH.trim(r);s[n.id]=r}m(e)}function m(e){var t;if(i)t=i(s,e,o);if(n.onSubmit)t=n.onSubmit(s,e,o);if(t===undefined||t)Lightbox.hide();return false}function g(e){return l[e].value}function H(e,t){l[e].value=t}function W(e){var t=[],i=l[e];for(var a=0,n=i.options.length;a<n;a++){if(i.options[a].selected)t.push(parseInt(i.options[a].value)==i.options[a].value?parseInt(i.options[a].value):i.options[a].value)}if(t.length==1)t=t[0];return t}function v(e){var t=[],i=l[e];for(var a=0,n=i.length;a<n;a++){if(i[a].checked)t.push(parseInt(i[a].value)==i[a].value?parseInt(i[a].value):i[a].value)}return t}};Dialog.prompt=function(e,t){let i=new Dialog;t=t||{};i.show("prompt",{promptOptions:{callback:e,caption:t.caption,initial:t.initial,label:t.label,placeholder:t.placeholder,size:t.size,text:t.text,title:t.title}})};Dialog.templates={prompt:{buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"topText",type:"caption"},{id:"inputField",type:"text",size:40,submitOnEnter:true}],onInit:function(e,t){this.template.title=t.promptOptions.title;this.template.fields[0].label=t.promptOptions.text||"";this.template.fields[1].label=t.promptOptions.label||"";this.template.fields[1].caption=t.promptOptions.caption||"";this.template.fields[1].placeholder=t.promptOptions.placeholder||"";let i=parseInt(t.promptOptions.size);if(i){this.template.fields[1].size=i}let a=t.promptOptions.callback;this.template.onSubmit=e=>a(e.inputField.value);t.data={};if(t.promptOptions.initial!=null){t.data.inputField=t.promptOptions.initial}delete t.promptOptions},onShow:function(e){setTimeout((()=>e.inputField.focus()),50);setTimeout(Lightbox.reveal,100)}}};Dialog.extraFields={};WH.DOM=new function(){const e=this;const t={lazyCssObserver:undefined};this.addScriptOnce=function(e,t){if(WH.qs('script[src="'+e+'"]')){return}t=t||{};t.src=e;let i=WH.ce("script",t);WH.ae(document.head,i);return i};this.createImitationSelect=function(t){t=t||{};let n=WH.ce("a",{className:"imitation-select",href:"javascript:",tabIndex:0},WH.ct(t.text||""));if(t.native){n.dataset.native=1;Menu.add(n,i.bind(e,n),{showAtElement:true});WH.ae(n,WH.ce("span",{className:"imitation-select-width"}));let t=new MutationObserver(a.bind(e,n));t.observe(n,{childList:true,subtree:true,characterData:true});let s=0;Object.defineProperty(n,"selectedIndex",{get:function(){return s},set:function(e){let t=WH.qsa("option",n);s=parseInt(e);if(isNaN(s)){s=0}s=Math.max(s,0);if(t.length===0){s=0;WH.ee(n);n.style.backgroundImage="";delete n.dataset.icon;return}s=Math.min(t.length-1,s);WH.st(n,t[s].label);let i=t[s].dataset.tinyIcon;if(i){n.dataset.icon=i;n.style.backgroundImage='url("'+WH.Icon.getIconUrl(i,WH.Icon.MEDIUM)+'")'}else{n.style.backgroundImage="";delete n.dataset.icon}}});Object.defineProperty(n,"options",{get:function(){return WH.qsa("option",n)}})}else if(t.menu){Menu.add(n,t.menu,{showAtElement:true})}return n};this.dispatchEvent=function(e,t){e.dispatchEvent(new Event(t))};this.getInnerHeight=function(e){return parseFloat(getComputedStyle(e,null).height.replace("px",""))};this.getInnerWidth=function(e){return parseFloat(getComputedStyle(e,null).width.replace("px",""))};this.lazyLoadBackground=function(e){if(!t.lazyCssObserver){return}if(!e.style.backgroundImage){WH.warn("Element does not have a background image to lazy-load.",e);return}e.classList.add("lazy-load-background");t.lazyCssObserver.observe(e)};this.isEmpty=function(e){for(let t=0,i;i=e.childNodes[t];t++){if(i.nodeType===Node.ELEMENT_NODE||i.nodeType===Node.TEXT_NODE&&i.textContent.trim()){return false}}return true};this.isVisible=function(e){return!(e.offsetWidth===0&&e.offsetHeight===0)};this.setLoading=function(e,t){e.dataset.loading=t?"true":"false"};this.setRelativeHeight=function(e,t,i){e.style.paddingTop=i/t*100+"%"};this.setTemporaryIcon=function(e,t,i){if(i){e.classList.remove("fa-"+i)}else{e.classList.add("fa")}e.classList.add("fa-"+t);clearTimeout(e.temporaryIconTimer);e.temporaryIconTimer=setTimeout((function(){e.classList.remove("fa-"+t);if(i){e.classList.add("fa-"+i)}else{e.classList.remove("fa")}}),2500)};this.styleRangeElement=function(e){if(!e.style.setProperty){return}let t=function(){e.style.setProperty("--min",e.min);e.style.setProperty("--max",e.max);e.style.setProperty("--val",e.value)};WH.aE(e,"input",t);let i=Object.getPrototypeOf(e);["value","min","max"].forEach((function(a){let n=Object.getOwnPropertyDescriptor(i,a);Object.defineProperty(e,a,{get:function(){return n.get.apply(this,arguments)},set:function(){n.set.apply(this,arguments);t();return this[a]}})}));t()};function i(e){let t=[];let i;let a;let n=0;WH.qsa("option, optgroup",e).forEach((function(s){if(s.nodeName==="OPTGROUP"){i=s;a=[];t.push(Menu.createItem({label:s.label,submenu:a,options:{checkedFunc:function(t){return t[Menu.ITEM_SUBMENU].some((function(t){return t[Menu.ITEM_CRUMB]===e.selectedIndex}))}}}));return}if(n===0&&!s.label){n++;return}if(i&&s.parentNode!==i){a=undefined;i=undefined}let r={checkedFunc:function(t){return t[Menu.ITEM_CRUMB]===e.selectedIndex}};if(s.dataset.tinyIcon){r.tinyIcon=s.dataset.tinyIcon}if(s.className){r.className=s.className}(a||t).push(Menu.createItem({crumb:n,label:s.dataset.menuLabel||s.label,url:function(t){e.selectedIndex=t;e.dispatchEvent(new Event("change"))}.bind(null,n),options:r}));n++}));return t}function a(e,t){let i=false;let a=WH.qs(".imitation-select-width",e);if(!a){WH.ae(e,a=WH.ce("span",{className:"imitation-select-width"}));i=true}for(let a,n=0;a=t[n];n++){let t=a.type==="characterData"?a.target.parentNode:a.target;if(t.nodeName!=="OPTION"&&t.nodeName!=="OPTGROUP"){continue}WH.qsa("option",e).forEach((function(t,a){if(t.label){i=true}if(t.selected){e.selectedIndex=a}}));break}if(i){WH.ee(a);WH.qsa("option",e).forEach((function(e,t){if(e.label){WH.ae(a,WH.ct(e.label));WH.ae(a,WH.ce("br"))}}))}}function n(){WH.aE(document,"selectstart",(function(e){let t=e.target;while(t){if(t.nodeName==="LABEL"||t.dataset&&t.dataset.preventSelectStart==="true"){e.preventDefault();break}t=t.parentNode}}));WH.onLoad(s)}function s(){if(document.body.dataset.lazyLoading){return}if(typeof IntersectionObserver==="undefined"){WH.qsa(".lazy-load-background").forEach((function(e){e.classList.remove("lazy-load-background")}));document.body.dataset.lazyLoading="disabled";return}t.lazyCssObserver=new IntersectionObserver((function(e){let i=[];e.forEach((function(e){if(!e.isIntersecting||i.includes(e.target)){return}i.push(e.target);e.target.classList.remove("lazy-load-background");t.lazyCssObserver.unobserve(e.target)}))}));WH.qsa('[style*="url("]').forEach((function(e){if(e.style.backgroundImage){e.classList.add("lazy-load-background")}}));WH.qsa(".lazy-load-background").forEach((function(e){t.lazyCssObserver.observe(e)}));document.body.dataset.lazyLoading="ready"}n()};WH.addCss=function(e){WH.ae(document.head,WH.ce("style",{type:"text/css"},WH.ct(e)))};WH.setTextNodes=function(e,t){if(e.nodeType==3){e.nodeValue=t}else{for(var i=0;i<e.childNodes.length;++i){WH.setTextNodes(e.childNodes[i],t)}}};WH.setInnerHtml=function(e,t,i){if(e.nodeName.toLowerCase()==i){e.innerHTML=t}else{for(var a=0;a<e.childNodes.length;++a){WH.setInnerHtml(e.childNodes[a],t,i)}}};WH.getFirstTextContent=function(e){for(var t=0;t<e.childNodes.length;++t){if(e.childNodes[t].nodeName=="#text"){return e.childNodes[t].nodeValue}var i=WH.getFirstTextContent(e.childNodes[t]);if(i){return i}}return false};WH.getTextContent=function(e){var t="";for(var i=0;i<e.childNodes.length;++i){if(e.childNodes[i].nodeValue){t+=e.childNodes[i].nodeValue}else if(e.childNodes[i].nodeName=="BR"){t+="\n"}t+=WH.getTextContent(e.childNodes[i])}return t};WH.toggleDisplay=function(e,t){var i=$(e);var a=i.is(":visible");if(t){i.slideToggle(150)}else{i.toggle()}if(!a){WH.Tools.Bloodmallet.updateChartsSizes(e)}return!a};WH.preventScroll=function(e,t){if(e){if(typeof t==="string"){t=WH.qs(t)}WH.preventScroll.allowedScrollArea=t;WH.aE(document,"wheel",WH.preventScroll.cancelScroll,{passive:false,capture:false});WH.aE(document.body,"touchmove",WH.preventScroll.cancelScroll)}else{WH.dE(document,"wheel",WH.preventScroll.cancelScroll,{passive:false,capture:false});WH.dE(document.body,"touchmove",WH.preventScroll.cancelScroll)}};WH.preventScroll.cancelScroll=function(e){if(WH.preventScroll.allowedScrollArea&&WH.preventScroll.allowedScrollArea.contains(e.target)){return}e.preventDefault();e.stopPropagation()};WH.safeFocus=function(e){if(!Platform.isTouch()){$(e).focus()}};WH.safeSelect=function(e){if(!Platform.isTouch()){$(e).select()}};WH.setCaretPosition=function(e,t){if(!e){return}if(e.createTextRange){var i=e.createTextRange();i.move("character",t);i.select()}else if(e.selectionStart!=undefined){e.focus();e.setSelectionRange(t,t)}else{e.focus()}};WH.insertTag=function(e,t,i,a){if(i==null){i=""}var n=WH.ge(e);n.focus();if(n.selectionStart!=null){var s=n.selectionStart,r=n.selectionEnd,o=n.scrollLeft,l=n.scrollTop;var c=n.value.substring(s,r);if(typeof a==="function"){c=a(c)}n.value=n.value.substr(0,s)+t+c+i+n.value.substr(r);n.selectionStart=n.selectionEnd=r+t.length;n.scrollLeft=o;n.scrollTop=l}else if(document.selection&&document.selection.createRange){var u=document.selection.createRange();if(u.parentElement()!=n){return}var c=u.text;if(typeof a==="function"){c=a(c)}u.text=t+c+i}if(n.onkeyup)n.onkeyup()};WH.onAfterTyping=function(e,t,i){let a;WH.aE(e,"keyup",(function(){if(a){clearTimeout(a)}a=setTimeout(t,i)}))};WH.isLeftClick=function(e){return!!(e&&e.button===0)};WH.preventEmptyFormSubmission=function(){if(!$.trim(this.elements[0].value)){return false}};var Draggable=new function(){var e={},t={},i,a;function n(t){if(this._handle){let e=t.target;let i=false;let a=0;while(e&&a<=3){if(e==this._handle){i=true;break}e=e.parentNode;a++}if(!i){return false}}i=this;e=WH.getCursorPos(t);WH.aE(document,"mousemove",s);WH.aE(document,"mouseup",r);if(i.onClick){i.onClick(t,i)}return false}function s(n){var s=WH.getCursorPos(n);if(i){if(Math.abs(s.x-e.x)>5||Math.abs(s.y-e.y)>5){o(n,i);i=null}}if(!a||!a._bounds)return false;var r=d(a),l=s.x-e.x,u=s.y-e.y;l=Math.max(a._bounds.x1-t.x,Math.min(a._bounds.x2-t.x-(r.x2-r.x1),l));u=Math.max(a._bounds.y1-t.y,Math.min(a._bounds.y2-t.y-(r.y2-r.y1),u));c(l,u);return false}function r(e){i=null;if(a)l(e)}function o(e,i){if(a)l(e);var n=WH.ac(i);t.x=n[0];t.y=n[1];if(i._targets.length){a=i.cloneNode(true);a._orig=i;WH.ae(document.body,a);c(-2323,-2323)}else a=i;WH.Tooltip.disabled=true;WH.Tooltip.hide();if(i.onDrag)i.onDrag(e,a,i);a._bounds=d(i._container);a.className+=" dragged"}function l(e){var t=false,i=WH.getCursorPos(e);if(a._orig&&a._orig._targets.length){u();var n={x1:a._x,x2:a._x+parseInt(a.offsetWidth),y1:a._y,y2:a._y+parseInt(a.offsetHeight)};WH.de(a);a=a._orig;for(var o=0,l=a._targets.length;o<l;++o){var c=a._targets[o],f=d(c);if(n.x2>=f.x1&&n.x1<f.x2&&n.y2>=f.y1&&n.y1<f.y2){t=true;if(a.onDrop)a.onDrop(e,a,c,i.x>=f.x1&&i.x<=f.x2&&i.y>=f.y1&&i.y<=f.y2);else WH.ae(c,a)}}}if(!t&&a.onDrop)a.onDrop(e,a,null);WH.dE(document,"mousemove",s);WH.dE(document,"mouseup",r);WH.Tooltip.disabled=false;a.className=a.className.replace(/dragged/,"");a=null}function c(e,i){a.style.position="absolute";a.style.left=t.x+e+"px";a.style.top=t.y+i+"px";a._x=t.x+e;a._y=t.y+i}function u(){a.style.left="-2323px";a.style.top="-2323px"}function d(e){var t=WH.ac(e);return{x1:t[0],x2:t[0]+parseInt(e.offsetWidth),y1:t[1],y2:t[1]+parseInt(e.offsetHeight)}}this.init=function(e,t){e.onmousedown=n;if(!e._targets)e._targets=[];if(!e._container)e._container=document.body;if(t!=null){if(t.targets){for(var i=0,a=t.targets.length;i<a;++i)e._targets.push(WH.ge(t.targets[i]))}if(t.container)e._container=WH.ge(t.container);if(t.onClick)e.onClick=t.onClick;if(t.onDrop)e.onDrop=t.onDrop;if(t.onDrag)e.onDrag=t.onDrag}}};WH.DynamicFixedElement=new function(){const e={elements:{}};this.checkAll=function(){for(let i in e.elements){if(e.elements.hasOwnProperty(i)){t(i,true)}}};this.init=function(i,a,n){n=n||{};if(typeof a==="string"){a=WH.qs(a)}if(!a||a.nodeType!==Node.ELEMENT_NODE){WH.error("Could not find element to set up a dynamic fixed position.",i,a,n);return}if(a.dataset.dynamicFixedElementInitialized){WH.error("Element is already set up for a dynamic fixed position.",i,a,n);return}let s=["left","right"].includes(n.side)?n.side:"right";let r=getComputedStyle(a);e.elements[i]={checkCallback:n.checkCallback,defaultSide:parseInt(r.getPropertyValue(s))||0,defaultTop:parseInt(r.getPropertyValue("top"))||0,element:a,fixed:false,minWidth:n.minWidth,offset:false,parent:a.parentNode,side:s};WH.aE(window,"scroll",t.bind(null,i));WH.aE(window,"resize",t.bind(null,i,true));t(i);a.dataset.dynamicFixedElementInitialized="true"};function t(t,r){let o=e.elements[t];if(o.minWidth&&window.innerWidth<o.minWidth){i(t);a(t);return}let l=o.parent.getBoundingClientRect();let c=10;if(WH.Layout.Responsive.isZulInMobileMode()){c+=40}else{let e=WH.Layout.getElement("header-wrapper");if(e){c+=e.getBoundingClientRect().height}}if(l.top<c-o.defaultTop){let e=(o.parent.offsetHeight||0)-(o.element.offsetHeight||0);let u=l.top*-1+c;if(u<e){a(t);n(t,c,r)}else{i(t);e=(o.parent.offsetHeight||0)-(o.element.offsetHeight||0);s(t,Math.min(u,e),r)}}else{i(t);a(t)}if(o.checkCallback){o.checkCallback(o)}}function i(t){let i=e.elements[t];if(i.fixed){i.element.classList.remove("fixed-"+t,"scrollable-"+t);i.element.style[i.side]=null;i.element.style.top=null;i.fixed=false}}function a(t){let i=e.elements[t];if(i.offset){i.element.style.marginTop=null;i.offset=false}}function n(t,i,n){let s=e.elements[t];let r=WH.getOffset(s.parent);if(!s.fixed||n===true){a(t);let e=s.side==="left"?r.left+s.defaultSide:document.documentElement.getBoundingClientRect().width-r.left-s.parent.offsetWidth+s.defaultSide;s.element.classList.add("fixed-"+t);s.element.style[s.side]=e+"px";s.element.style.top=i+"px";if(s.element.offsetHeight+10+i>window.innerHeight){s.element.classList.add("scrollable-"+t)}s.fixed=true}}function s(t,i,a){let n=e.elements[t];if(!n.offset||a===true){n.element.style.marginTop=i-n.defaultTop+"px";n.offset=true}}};WH.Entity=new function(){const e=this;var t=[WH.Types.ADVENTURE_COMBATANT_ABILITY,WH.Types.AZERITE_ESSENCE,WH.Types.AZERITE_ESSENCE_POWER,WH.Types.GEAR_SET,WH.Types.RESOURCE,WH.Types.STORYLINE];this.getLink=function(t,i){let a=WH.Gatherer.getName(t,i);let n=WH.ce("a",{href:WH.Entity.getPath(t,i,a||false)},WH.ct(a||e.getUnknownName(t,i)));let s=WH.Gatherer.get(t,i);if(s){if(s.icon){n.classList.add("icontinyl");n.style.backgroundImage="url("+WH.Icon.getIconUrl(s.icon,WH.Icon.TINY)+")"}if(s.quality!=null&&s.quality!==-1){n.classList.add("q"+s.quality)}}return n};this.getPath=function(e,n,s,r){var o;var l;switch(e){case WH.Types.CLASS:l=WH.Wow.PlayerClass.getSlug(n);break;case WH.Types.RACE:l=WH.Wow.Race.getSlug(n);break}if(l){o="/"+l}else if(t.indexOf(e)!==-1){o=a(e,n,s)}else{o=i(e,n,s)}if(typeof r==="string"){if(r!==""){o+="?"+r}}else if(r&&typeof r==="object"){r=WH.Url.buildQuery(r);if(r){o+="?"+r}}return o};this.getUnknownName=function(e,t){return WH.term("unknownEntityName_format",WH.Types.getUpperSingular(e),t)};this.isReference=function(e){return/^[a-z-]+=-?\d+$/.test(e)};function i(e,t,i){var a="/"+g_types[e]+"="+t;if(!i&&i!==false){i=WH.Gatherer.getName(e,t)}if(i){a+="/"+WH.Strings.slug(i,true)}return a}function a(e,t,i){var a="/"+g_types[e]+"/";if(!i&&i!==false){i=WH.Gatherer.getName(e,t)}if(i){a+=WH.Strings.slug(i,true)+"-"+t}else{a+=t}return a}};var Facebook={getCurrentOpenGraphUrl:function(){return $("head meta[property='og:url']").attr("content")},createLikeButton:function(e,t){if(!t)t={};var i,a,n;if(t.simple){a=90;n=21;i="button_count"}else{a=400;n=23;i="standard"}return $("<iframe/>",{src:"//www.facebook.com/plugins/like.php?href="+WH.urlEncode(e)+"&locale=en_US&layout="+i+"&show_faces=false&action=like&font=arial&colorscheme=dark&width="+a+"&height="+n,scrolling:"no",frameborder:"0",allowtransparency:"true",css:{border:"none",overflow:"hidden",width:a+"px",height:n+"px",display:"none"}}).on("load",(function(){$(this).show()}))}};WH.Favorites=new function(){const e=this;const t={favorites:null,pageType:null,pageId:null,pageStar:null};this.pageInit=function(e,i,a){if(typeof e==="string"){e=WH.qs(e)}if(!e||typeof i!=="number"||typeof a!=="number"){return}t.pageType=i;t.pageId=a;u(e)};this.hasFavorites=function(){return t.favorites.length>0};this.getMenu=function(){o();let e=[];let i=0;let a=0;for(let n=0;n<t.favorites.length;n++){let s=t.favorites[n];if(!s.entities.length){continue}i++;let r=[];for(let e=0;e<s.entities.length;e++){let t=s.entities[e];let i=t[2]||WH.Entity.getPath(s.id,t[0]);r.push([t[0],t[1],i]);a++}Menu.sort(r);e.push([s.id,WH.Types.getUpperPlural(s.id),[],r])}Menu.sort(e);if(i===1&&a<=45||i===2&&i+a<=30||i>2&&i+a<=15){let t=[];for(let i=0;i<e.length;i++){let a=e[i];t.push([undefined,a[Menu.ITEM_LABEL]]);let n=Menu.getSubmenu(a);for(let e=0;e<n.length;e++){let i=n[e];let a=[i[Menu.ITEM_CRUMB],i[Menu.ITEM_LABEL],i[Menu.ITEM_URL]];if(i[Menu.ITEM_OPTIONS]){a[Menu.ITEM_OPTIONS]=i[Menu.ITEM_OPTIONS]}t.push(a)}}e=t}if(e.length&&WH.Theme.isStandardType()){e.unshift([0,WH.TERMS.favorites,null,null,{heading:true}])}return e};this.refreshMenu=function(){let t=WH.qs(".header-user-favorites");if(!t){return}let i=e.getMenu();if(!i.length){t.style.display="none";return}Menu.add(t,i,{padded:true});t.style.display=""};function i(i,n,s,o){let l=r(i,true);if(l===-1){return}let u=t.favorites[l].entities;for(let e=0;e<u.length;e++){if(!o&&u[e][0]===n){alert(WH.TERMS.entityalreadyfavorited_format.replace("%s",WH.Types.getLowerSingular(i)));return}}t.favorites[l].entities.push([n,s]);e.refreshMenu();if(!o){a("add",i,n,c.bind(null,i,n,s,true))}}function a(e,t,i,a){WH.fetch("/account/favorites",{method:"POST",json:{action:e,type:t,id:i,_csrf:g_user.sessionKey},error:function(n,s,r){a();WH.error("Error executing favorites action:",e,t,i,s,r);f(t,i)}})}function n(){let e=typeof g_pageInfo==="object"&&typeof g_pageInfo.type==="number"&&typeof g_pageInfo.typeId==="number"?WH.qs("#main-contents .heading-size-1"):null;if(!e){if(document.readyState!=="complete"){setTimeout(n,9)}return}o();t.pageType=g_pageInfo.type;t.pageId=g_pageInfo.typeId;u(e)}function s(e){for(let i=0;i<t.favorites.length;i++){if(t.favorites[i].id===e){return i}}return null}function r(e,i){let a=s(e);if(a!==null){return a}if(!i){return-1}t.favorites.push({id:e,entities:[]});t.favorites.sort((function(e,t){return WH.stringCompare(WH.Types.getUpperPlural(e.id),WH.Types.getUpperPlural(t.id))}));return s(e)}function o(){if(t.favorites===null){t.favorites=WH.getPageData("user.favorites")||[]}}function l(e,i){let a=r(e);if(a===-1){return false}let n=t.favorites[a].entities;for(let e=0;e<n.length;e++){if(n[e][0]===i){return true}}return false}function c(n,s,o,l){let c=r(n);if(c===-1){return}let u=t.favorites[c].entities;for(let r=0;r<u.length;r++){let d=u[r];if(d[0]===s){u.splice(r,1);if(!u.length){t.favorites.splice(c,1)}e.refreshMenu();if(!l){a("remove",n,s,i.bind(null,n,s,o,true))}break}}}function u(e){t.pageStar=WH.ce("span",{className:"fa fav-star"});WH.ae(e,t.pageStar);if(WH.userIsLoggedIn()&&g_user.sessionKey){t.pageStar.classList.add("fa-star"+(l(t.pageType,t.pageId)?"":"-o"));WH.aE(t.pageStar,"click",function(e,t,i){d(e,t,i);f(e,t);WH.Tooltip.hide()}.bind(null,t.pageType,t.pageId,e.textContent.trim().replace(/(.+)<.*/,"$1")));WH.Tooltip.simpleNonTouch(t.pageStar,(function(){let e=this.classList.contains("fa-star-o")?WH.TERMS.addtofavorites:WH.TERMS.removefromfavorites;return'<div class="no-wrap">'+e+"</div>"}),"q2",true)}else{t.pageStar.classList.add("fa-star-o");WH.aE(t.pageStar,"click",(function(){WH.goToLoginPage()}));WH.Tooltip.simpleNonTouch(t.pageStar,WH.TERMS.logintosavefavorites_tip+'<div class="q2" style="margin-top:10px">'+WH.TERMS.clicktologin_stc+"</div>","",true)}}function d(e,t,a){if(l(e,t)){c(e,t,a)}else{i(e,t,a)}}function f(e,i){if(!t.pageStar){return}let a="fa-star-o";let n="fa-star";if(!l(e,i)){a="fa-star";n="fa-star-o"}t.pageStar.classList.remove(a);t.pageStar.classList.add(n)}n()};var ContactTool=new function(){const e=this;this.MODE_COMMENT=1;this.MODE_POST=2;const t=10;this.general=0;this.comment=1;this.post=2;this.screenshot=3;this.video=5;this.guide=6;var i;var a={0:[[1,true],[9,true],[2,true],[8,true],[3,true],[4,true],[5,true],[6,true],[7,true]],1:[[15,function(e){return(e.roles&U_GROUP_MODERATOR)==0}],[16,true],[18,function(e){return(e.roles&U_GROUP_MODERATOR)==0}],[19,function(e){return(e.roles&U_GROUP_MODERATOR)==0}],[20,function(e){return(e.roles&U_GROUP_MODERATOR)==0}]],2:[[30,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[37,function(e){return(e.roles&U_GROUP_MODERATOR)==0&&g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0&&g_users[e.user].avatar==2}],[31,true],[32,true],[33,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[34,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0&&e.op&&!e.sticky}],[35,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[36,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}]],3:[[45,true],[46,true],[47,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[48,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}]],5:[[45,true],[46,true],[47,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[48,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}]],6:[[45,true],[46,true],[48,true]]};var n={1:WH.TERMS.captchaerror_tip,2:WH.TERMS.shortdescription_tip,3:WH.TERMS.contactreason_tip,7:WH.TERMS.alreadyreported_tip};var s=null;this.displayError=function(e,t){alert(t)};this.onShow=function(){if(location.hash&&location.hash!="#contact"){s=location.hash}if(this.data.mode==0){location.replace("#contact")}};this.onHide=function(){if(s&&(s.indexOf("screenshots:")==-1||s.indexOf("videos:")==-1)){WH.setHash(s)}else{WH.clearHash()}};this.onSubmit=function(e,t,i){if(e.submitting){return false}for(var a=0;a<i.elements.length;++a){i.elements[a].disabled=true}var s=["contact=1","mode="+WH.urlEncode(e.mode),"reason="+WH.urlEncode(e.reason),"desc="+WH.urlEncode(e.description),"ua="+WH.urlEncode(navigator.userAgent),"appname="+WH.urlEncode(navigator.appName),"page="+WH.urlEncode(e.currenturl)];if(e.mode==0){if(e.relatedurl){s.push("relatedurl="+WH.urlEncode(e.relatedurl))}if(e.email){s.push("email="+WH.urlEncode(e.email))}}else if(e.mode==1){s.push("id="+WH.urlEncode(e.comment.id))}else if(e.mode==2){s.push("id="+WH.urlEncode(e.post.id))}else if(e.mode==3){s.push("id="+WH.urlEncode(e.screenshot.id))}else if(e.mode==5){s.push("id="+WH.urlEncode(e.video.id))}else if(e.mode==6){s.push("id="+WH.urlEncode(e.guide))}if(e.reason===1||e.reason===9){var r="";if(!WH.WAS){r="Ads class not found. User may have ad blocking enabled. No ad log available."}else{var o=WH.WAS.getDfpLog();if(o&&o.length){r+="<br><b><i>DFP LOG</i></b><br>";for(var l=0,c;c=o[l];l++){r+="<br><b>"+c._time+"</b><br>";r+="<b>Unit:</b> "+c._env+" "+c._slot+"<br>";r+="<b>Channel:</b> "+c._channelName+" ("+c._channelGroup+")<br>";if(c._error){r+='<span style="color:'+WH.Wow.Item.getQualityColor(WH.Wow.Item.QUALITY_FAIL)+'"><b>Error:</b> '+c._error+"</span><br>"}delete c._time;delete c._env;delete c._slot;delete c._channelName;delete c._channelGroup;delete c._error;var u=WH.objectToArray(c,"property");for(var d=0,f;f=u[d];d++){r+="<b>"+f.property+":</b> "+JSON.stringify(f.value)+"<br>"}}}}if(!r){r="No ad data. Probably blocked by user."}s.push("adinfo="+encodeURIComponent(r));let e=WH.LocalStorage.get("zafusr");if(e){s.push("zafusr="+encodeURIComponent(e))}}e.submitting=true;var h="/contactus";new Ajax(h,{method:"POST",params:s.join("&"),onSuccess:function(e,t){var i=e.responseText;if(i==0){if(g_user.name){alert(WH.sprintf(WH.TERMS.contactreceived_format,g_user.name))}else{alert(WH.TERMS.contactthanks_tip)}Lightbox.hide()}else{if(n[i]){alert(n[i])}else{alert("Error: "+i)}}},onFailure:function(e,t){alert("Failure submitting contact request: "+e.statusText)},onComplete:function(t,a){for(var n=0;n<i.elements.length;++n){i.elements[n].disabled=false}e.submitting=false}});return false};this.show=function(t){if(!t){t={}}let n={mode:0};WH.cO(n,t);n.reasons=a[n.mode];if(location.href.indexOf("#contact")!==-1){n.currenturl=location.href.substr(0,location.href.indexOf("#contact"))}else{n.currenturl=location.href}let s="contactus";if(n.mode!==0){s="reportform"}if(!i){e.init()}i.show(s,{data:n,onShow:e.onShow,onHide:e.onHide,onSubmit:e.onSubmit})};this.checkPound=function(){if(location.hash&&location.hash=="#contact"){ContactTool.show()}};this.init=function(){i=new Dialog;Dialog.templates.contactusEmailOnly={title:WH.TERMS.contactwowhead,width:550,buttons:[["x",WH.TERMS.cancel]],fields:[{id:"noemailwarning",type:"caption",compute:function(e,t,i,a){$(a).html('<b id="contact-emailwarn">'+WH.TERMS.contactDialogEmailOnly_tip.replace("%1$s",'<a href="mailto:feedback@wowhead.com">').replace("%2$s","</a>")+"</b>").css("white-space","normal").css("padding","0 4px")}}],onInit:function(e){},onShow:function(e){setTimeout(Lightbox.reveal,250)}};Dialog.templates.contactus={title:WH.TERMS.contactwowhead,width:550,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"reason",type:"select",label:WH.TERMS.reason_colon,required:1,options:[],compute:function(e,t,i,a){WH.ee(e);for(var n=0;n<this.data.reasons.length;++n){var s=this.data.reasons[n][0];var r=this.data.reasons[n][1];var o=false;if(typeof r=="function"){o=r(this.extra)}else{o=r}if(!o){continue}var l=WH.ce("option");l.value=s;if(t&&t==s){l.selected=true}WH.ae(l,WH.ct(g_contact_reasons[s]));WH.ae(e,l)}e.onchange=function(){if(this.value==1||this.value==2||this.value==3){i.currenturl.parentNode.parentNode.style.display="";i.relatedurl.parentNode.parentNode.style.display=""}else if(this.value==9){i.currenturl.parentNode.parentNode.style.display="";i.relatedurl.parentNode.parentNode.style.display="none"}else{i.currenturl.parentNode.parentNode.style.display="none";i.relatedurl.parentNode.parentNode.style.display="none"}}.bind(e);a.style.width="98%"},validate:function(e,t,i){var a="";if(!e||e.length==0){a=WH.TERMS.contactreason_tip}if(a==""){return true}ContactTool.displayError(i.reason,a);WH.safeFocus(i.reason);return false}},{id:"currenturl",type:"text",disabled:true,label:WH.TERMS.currenturl_colon,size:40},{id:"relatedurl",type:"text",label:WH.TERMS.relatedurl_colon,caption:WH.TERMS.optional,size:40,validate:function(e,t,i){var a="";var n=/^(http(s?)\:\/\/|\/)?([\w]+:\w+@)?([a-zA-Z]{1}([\w\-]+\.)+([\w]{2,5}))(:[\d]{1,5})?((\/?\w+\/)+|\/?)(\w+\.[\w]{3,4})?((\?\w+=\w+)?(&\w+=\w+)*)?/;e=e.trim();if(e.length>=250){a=WH.TERMS.relatedurl_tip}else if(e.length>0&&!n.test(e)){a=WH.TERMS.entervalidurl_tip}if(a==""){return true}ContactTool.displayError(i.relatedurl,a);WH.safeFocus(i.relatedurl);return false}},{id:"email",type:"text",label:WH.TERMS.emailaddress_colon,caption:WH.TERMS.emailcontact_tip,compute:function(e,t,i,a,n){var s=function(){$("#contact-emailwarn").css("display",WH.isEmailValid($(i.email).val())?"none":"");Lightbox.reveal()};$(e).keyup(s).blur(s)},validate:function(e,t,i){var a="";e=e.trim();if(e.length>=100){a=WH.TERMS.emailaddresslength_tip}else if(e.length>0&&!WH.isEmailValid(e)){a=WH.TERMS.entervalidemail_tip}if(a==""){return true}ContactTool.displayError(i.email,a);WH.safeFocus(i.email);return false}},{id:"description",type:"textarea",caption:WH.TERMS.bespecific_tip,width:"98%",required:1,size:[10,30],validate:function(e,i,a){var n="";e=e.trim();if(e.length<t||e.length>1e5){n=WH.TERMS.shortdescription_tip}if(n==""){return true}ContactTool.displayError(a.description,n);WH.safeFocus(a.description);return false}},{id:"noemailwarning",type:"caption",compute:function(e,t,i,a){$(a).html('<span id="contact-emailwarn" class="q10">'+WH.TERMS.noemailwarning_tip+"</span>").css("white-space","normal").css("padding","0 4px")}}],onInit:function(e){},onShow:function(e){if(this.data.focus&&e[this.data.focus]){setTimeout(WH.setCaretPosition.bind(null,e[this.data.focus],e[this.data.focus].value.length),100)}else if(e["reason"]&&!e.reason.value){setTimeout(e.reason.focus.bind(e.reason),10)}else if(e["relatedurl"]&&!e.relatedurl.value){setTimeout(e.relatedurl.focus.bind(e.relatedurl),10)}else if(e["email"]&&!e.email.value){setTimeout(e.email.focus.bind(e.email),10)}else if(e["description"]&&!e.description.value){setTimeout(e.description.focus.bind(e.description),10)}setTimeout(Lightbox.reveal,250)}};Dialog.templates.reportform={title:WH.TERMS.report,width:550,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"reason",type:"select",label:WH.TERMS.reason_colon,options:[],compute:function(e,t,i,a){switch(this.data.mode){case 1:i.firstChild.innerHTML=WH.sprintf(WH.TERMS.reportcomment_format,'<a href="/user='+this.data.comment.user+'">'+this.data.comment.user+"</a>");break;case 2:var n='<a href="/user='+this.data.post.user+'">'+this.data.post.user+"</a>";if(this.data.post.op){i.firstChild.innerHTML=WH.sprintf(WH.TERMS.reporttopic_format,n)}else{i.firstChild.innerHTML=WH.sprintf(WH.TERMS.reportpost_format,n)}break;case 3:i.firstChild.innerHTML=WH.sprintf(WH.TERMS.screenshotreport_format,'<a href="/user='+this.data.screenshot.user+'">'+this.data.screenshot.user+"</a>");break;case 5:i.firstChild.innerHTML=WH.sprintf(WH.TERMS.videoreport_format,'<a href="/user='+this.data.video.user+'">'+this.data.video.user+"</a>");break;case 6:i.firstChild.innerHTML="Report guide";break}i.firstChild.setAttribute("style","");WH.ee(e);var s;if(this.data.mode==1){s=this.data.comment}else if(this.data.mode==2){s=this.data.post}else if(this.data.mode==3){s=this.data.screenshot}else if(this.data.mode==5){s=this.data.video}else if(this.data.mode==6){s=this.data.guide}WH.ae(e,WH.ce("option",{selected:!t,value:-1}));for(var r=0;r<this.data.reasons.length;++r){var o=this.data.reasons[r][0];var l=this.data.reasons[r][1];var c=false;if(typeof l=="function"){c=l(s)}else{c=l}if(!c){continue}var u=WH.ce("option");u.value=o;if(t&&t==o){u.selected=true}WH.ae(u,WH.ct(g_contact_reasons[o]));WH.ae(e,u)}a.style.width="98%"},validate:function(e,t,i){var a="";if(!e||e==-1||e.length==0){a=WH.TERMS.contactreason_tip}if(a==""){return true}ContactTool.displayError(i.reason,a);WH.safeFocus(i.reason);return false}},{id:"description",type:"textarea",caption:WH.TERMS.bespecific_tip,width:"98%",required:1,size:[10,30],validate:function(e,i,a){var n="";e=e.trim();if(e.length<t||e.length>1e4){n=WH.TERMS.shortdescription_tip}if(n==""){return true}ContactTool.displayError(a.description,n);WH.safeFocus(a.description);return false}}],onInit:function(e){},onShow:function(e){let t=WH.qs('*[name="reason"]',e);let i=WH.qs('*[name="description"]',e);if(this.data.focus&&e[this.data.focus]){setTimeout(WH.setCaretPosition.bind(null,e[this.data.focus],e[this.data.focus].value.length),100)}else if(!t.value){setTimeout(t.focus.bind(t),10)}else if(!i.value){setTimeout(i.focus.bind(i),10)}}}};WH.onLoad(this.checkPound)};WH.Gatherer=new function(){var requested={};this.addData=function(e,t,i){var a=g_gathered_types[e];for(var n in i){if(!i.hasOwnProperty(n)){continue}if(t===WH.getDataEnv()){if(!a.hasOwnProperty(n)){a[n]=i[n]}else{WH.cO(a[n],i[n])}}else{var s=getEnvKey(t);if(!a.hasOwnProperty(n)){a[n]=i[n];a[n][s]=WH.cO({},i[n])}else{if(!a[n].hasOwnProperty(s)){a[n][s]={}}WH.cO(a[n][s],i[n]);for(var r in i[n]){if(!i[n].hasOwnProperty(r)){continue}if(!a[n].hasOwnProperty(r)){a[n][r]=i[n][r]}}}}}};this.fetchItems=function(e,t){fetchData("items",e,t)};this.fetchSpells=function(e,t){fetchData("spells",e,t)};this.get=function(e,t,i,a){if(!g_gathered_types.hasOwnProperty(e)){return undefined}var n=g_gathered_types[e][t];if(n===undefined||!i||i===WH.getDataEnv()){return n}var s=getEnvKey(i);var r=a?undefined:n;return n.hasOwnProperty(s)?n[s]:r};this.getIconName=function(e,t){return g_gathered_types[e]&&g_gathered_types[e][t]&&g_gathered_types[e][t].icon||WH.Icon.UNKNOWN};this.getName=function(e,t){if(!g_gathered_types[e]||!g_gathered_types[e][t]){switch(e){case WH.Types.RACE:return window.g_chr_races&&g_chr_races[t]||null;case WH.Types.CLASS:return WH.Wow.PlayerClass.getName(t);case WH.Types.CURRENCY:return WH.Wow.Currency.getName(t);case WH.Types.ZONE:return WH.Wow.Area.getName(t);case WH.Types.PET:return WH.Wow.Pet.getName(t);case WH.Types.SKILL:return WH.Wow.Skill.getName(t)}return null}if(g_gathered_types[e][t].name){return g_gathered_types[e][t].name}return g_gathered_types[e][t]["name_"+Locale.getName()]||null};function fetchData(type,entityIDs,options){if(!options){options={}}var entityArray=prepareEntityArray(type,entityIDs,options);if(!entityArray.length){switch(typeof options.onSuccess){case"string":eval(options.onSuccess+"()");break;case"function":options.onSuccess();break}return}entityArray.sort();var url="/gatherer?"+type+"="+entityArray.join(",");if(typeof options.onSuccess=="string"){url+="&callback="+options.onSuccess}var callback=typeof options.onSuccess=="function"?options.onSuccess:null;$.getScript(url,callback)}function getEnvKey(e){return"_dataEnv_"+WH.dataEnvKey[e]}function prepareEntityArray(e,t,i){if(!requested[e]){requested[e]={}}if(t instanceof Array){var a=[];for(var n=0,s;s=t[n];n++){if(validateID(s)){if(requested[e][s]&&!i.forceRequest){}else{requested[e][s]=true;a.push(s)}}}return a}else if(validateID(t)){if(requested[e][t]&&!i.forceRequest){return[]}else{requested[e][t]=true;return[t]}}else{WH.error("Gatherer requires an array of IDs or single ID.");return[]}}function validateID(e){return typeof e=="number"||typeof e=="string"&&!e.match(/[^0-9]/)}};WH.GlobalStrings=WH.GlobalStrings||{};(function(){if(typeof Proxy!=="function"){return}var e=WH.GlobalStrings;WH.GlobalStrings=new Proxy(e,{get:function(e,t){return e[t]||t}})})();WH.Guide=new function(){const e=WH.getPageData("guides.statusNames");this.getStatusName=function(t){return(e||[])[t]}};function GetStars(e,t,i,a){var n=5;var s=e;if(i){e=i}e=Math.round(e*2)/2;var r=Math.round(e);var o=$("<span>").addClass("stars").addClass("max-"+n).addClass("stars-"+r);if(!g_user.id){t=false}if(t){o.addClass("ratable")}if(i){o.addClass("rated")}var l="<span>";var c=e;for(var u=1;u<=n;++u){if(c<1&&c>0){l+='<b class="stars-half">'}else if(c<=0){l+='<b class="stars-empty">'}else{l+='<b class="stars-full">'}c--;l+='<i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star-half"></i>'}for(var u=1;u<=n;++u){l+="</b>"}l+="</span>";o.append(l);if(t){var d=0;$("b",o).each((function(){var e=++d;$("> i",this).click((function(){VoteGuide(a,s,e);return false}))}))}if(i){var f=$("<span>").addClass("clear fa fa-times-circle").click((function(){VoteGuide(a,s,0)}));o.append(f)}if(e>=0)o.mouseover((function(t){WH.Tooltip.showAtCursor(t,"Rating:&nbsp;"+e+"&nbsp;/&nbsp;"+n,0,0,"q")})).mousemove((function(e){WH.Tooltip.cursorUpdate(e)})).mouseout((function(){WH.Tooltip.hide()}));return o}function VoteGuide(guideId,oldRating,newRating){$("#guiderating").html(GetStars(oldRating,true,newRating,guideId));$.ajax({cache:false,url:"/guide=vote",type:"POST",error:function(){$("#guiderating").html(GetStars(oldRating,true,0,guideId));alert("Voting failed. Try again later.")},success:function(json){var data=eval("("+json+")");$("#guiderating-value").text(data.rating);$("#guiderating-votes").text(WH.getN5(data.nvotes))},data:{id:guideId,rating:newRating}})}WH.Highlight=function(e,t,i,a){const n={buttonSize:undefined,class:undefined,closeButtonText:undefined,contents:undefined,elements:{target:undefined,wrapper:undefined},extraButtons:[],fixedPosition:false,position:undefined,storageKey:"highlight-"+e,useLocalStorage:true};function s(e,t,i){i=i||{};if(i.hasOwnProperty("useLocalStorage")){n.useLocalStorage=i.useLocalStorage}if(n.useLocalStorage){let e=WH.LocalStorage.get(n.storageKey);if(e){try{e=JSON.parse(e)}catch(e){}if(e===true){return}}}else{let e=WH.qs(".element-highlight#"+n.storageKey);if(e){WH.de(e)}}n.elements.target=$(e);if(!n.elements.target.length||!n.elements.target.is(":visible")){return}n.fixedPosition=WH.isElementFixedPosition(n.elements.target[0]);if(typeof i.buttonSize==="string"){n.buttonSize=i.buttonSize}if(i.extraButtons instanceof Array){n.extraButtons=i.extraButtons}if(typeof i["class"]==="string"){n["class"]=i["class"]}n.contents=t;n.closeButtonText=i.closeButtonText||WH.TERMS.gotIt_exclamation;n.position=["bottom","left","right","top"].indexOf(i.position)!==-1?i.position:"bottom";o();r()}function r(){$(window).resize((function(){var e=document.querySelectorAll(".element-highlight");for(var t=0,i=e.length;t<i;t++){WH.de(e[t])}}));r=function(){}}function o(){var e=n.fixedPosition?n.elements.target[0].getBoundingClientRect():n.elements.target.offset();var t=n.elements.target.outerHeight();var i=n.elements.target.outerWidth();n.elements.wrapper=$("<div/>",{class:"element-highlight",css:{left:e.left+"px",top:e.top+"px"},id:n.storageKey});if(n.fixedPosition){n.elements.wrapper.css("position","fixed")}$("<div/>",{class:"element-highlight-highlighter",css:{height:t+"px",width:i+"px","border-radius":n.elements.target.css("border-radius")}}).appendTo(n.elements.wrapper);var a={};switch(n.position){case"bottom":a.left=i/2+"px";a.top=t+"px";break;case"left":a.right="0px";a.top=t/2+"px";break;case"right":a.left=i+"px";a.top=t/2+"px";break;case"top":a.bottom="0px";a.left=i/2+"px";break}var s=$("<div/>",{class:"element-highlight-dialog",css:a,"data-position":n.position}).appendTo(n.elements.wrapper);var r=$("<div/>",{class:"element-highlight-dialog-content","data-buttons":n.extraButtons.length+1}).appendTo(s);if(n["class"]){n.elements.wrapper.addClass(n["class"])}if(typeof n.contents==="string"){r.text(n.contents)}else{$(n.contents).appendTo(r)}var o=$("<div/>",{class:"element-highlight-dialog-content-buttons"}).appendTo(r);if(n.extraButtons.length){for(var c=0,u=n.extraButtons.length;c<u;c++){var d=n.extraButtons[c];if(!d.url&&!d.action){continue}var f=$("<a/>",{class:"element-highlight-dialog-content-button btn btn-site",text:d.text}).appendTo(o);if(d.url){f.attr("href",d.url)}if(d.action){f.click(d.action)}if(n.buttonSize){f.addClass("btn-"+n.buttonSize)}}}var h=$("<a/>",{class:"element-highlight-dialog-content-close btn btn-site",text:n.closeButtonText,click:l}).appendTo(o);if(n.buttonSize){h.addClass("btn-"+n.buttonSize)}n.elements.wrapper.appendTo(document.body);switch(n.position){case"left":case"right":setTimeout((function(){r.css("top","-"+r.outerHeight()/2+"px")}),0);break}}function l(){n.elements.wrapper.fadeOut((function(){$(this).remove()}));if(n.useLocalStorage){WH.LocalStorage.set(n.storageKey,JSON.stringify(true))}}s(t,i,a)};WH.Icon=new function(){const e=this;const t=WH.Game;this.TINY="tiny";this.SMALL="small";this.MEDIUM="medium";this.LARGE="large";this.BLIZZARD="blizzard";this.LEGACY_IDS={0:this.SMALL,1:this.MEDIUM,2:this.LARGE,3:this.BLIZZARD};this.UNKNOWN="inv_misc_questionmark";this.UNKNOWN_ZONE="inv_misc_map08";const i=[this.TINY,this.SMALL,this.MEDIUM,this.LARGE,this.BLIZZARD];this.create=function(t,i,a,n){n=n||{};if(i===WH.Icon.TINY){return WH.ce("img",{className:"icontiny",src:e.getIconUrl(t,i,n.game)})}let s={color:n.color,game:n.game,lazyLoad:n.lazyLoad,type:n.type};return Icon.create(t,Icon.sizeIds.hasOwnProperty(i)?Icon.sizeIds[i]:Icon.sizeIds.medium,null,a===null?false:a,n.num,n.quantity,n.hasOwnProperty("border")?!n.border:undefined,n.rel,n.span,n.simple,s)};this.getIconUrl=function(a,n,s){if(i.indexOf(n)===-1){n=e.MEDIUM}let r=t.getKey(s||t.DEFAULT);if(!r){WH.warn('Invalid game provided for "'+a+'" icon: '+s);r=t.getKey(t.WOW);a=e.UNKNOWN}return WH.STATIC_URL+"/images/"+r+"/icons"+"/"+n+"/"+a.toLowerCase()+(n===e.TINY?".gif":".jpg")};this.getLink=function(e){return e.querySelector("a")};this.isValidSize=function(e){return i.indexOf(e)!==-1};this.setLinkUrl=function(t,i){let a=e.getLink(t);if(a){a.href=i}};this.setName=function(t,i,a,n){if(!a){e.setTexture(t,null);return}if(i===e.BLIZZARD){i=e.LARGE}e.setTexture(t,e.getIconUrl(a,i,n))};this.setTexture=function(e,t){e.firstChild.style.backgroundPosition="";e.firstChild.style.backgroundImage=t?'url("'+t+'")':""}};var Icon={questionMarkIcon:WH.Icon.UNKNOWN,sizes:["small","medium","large","blizzard"],sizes2:[18,36,56,64],sizeIds:{small:0,medium:1,large:2,blizzard:3},premiumOffsets:[[-56,-36],[-56,0],[0,0],[0,0]],premiumBorderClasses:["-premium","-gold","","-premiumred","-red",""],STANDARD_BORDER:2,privilegeBorderClasses:{uncommon:"-q2",rare:"-q3",epic:"-q4",legendary:"-q5"},idLookupCache:{},create:function(e,t,i,a,n,s,r,o,l,c,u){u=u||{};var d=WH.ce(l?"span":"div");var f=WH.ce("ins");var h=WH.ce("del");if(t==null){t=Icon.sizeIds.medium}d.className="icon"+Icon.sizes[t];if(c===true){d.dataset.type="simple"}else if(u.type){d.dataset.type=u.type}if(u.color){d.dataset.color=u.color}WH.ae(d,f);if(!r){WH.ae(d,h)}if(u.game&&u.game!==WH.Game.WOW){d.dataset.game=WH.Game.getKey(u.game)}if(e){Icon.setTexture(d,t,e,u.game);if(!WH.isRemote()&&u.lazyLoad!==false){WH.DOM.lazyLoadBackground(d.firstChild)}}if(a){var p=WH.ce("a");p.href=a;if(a.indexOf("wowhead.com")==-1&&/^https?:/.test(a)){p.target="_blank"}WH.ae(d,p)}else if(e){var m=d.firstChild.style;var g=m.backgroundImage.indexOf("/avatars/")!=-1;if(!g){if(a!==false){var p=WH.ce("a");p.href="javascript:";WH.ae(d,p);d.onclick=Icon.onClick}}}if(o&&typeof p!="undefined"){p.rel=o}Icon.setNumQty(d,n,s);return d},createUser:function(e,t,i,a,n,s,r){if(e==2)t=WH.staticUrl+"/uploads/avatars/"+t+".jpg";var o=Icon.create(t,i,null,a,null,null,s);if(n!=Icon.STANDARD_BORDER){if(Icon.premiumBorderClasses[n]){o.className+=" "+o.className+Icon.premiumBorderClasses[n]}}else if(r&&Icon.privilegeBorderClasses.hasOwnProperty(r))o.className+=" "+o.className+Icon.privilegeBorderClasses[r];if(e==2)Icon.moveTexture(o,i,Icon.premiumOffsets[i][0],Icon.premiumOffsets[i][1],true);o.classList.add("icon"+Icon.sizes[i]+"-sprite");return o},getIdFromName:function(e,t){if(Icon.idLookupCache.hasOwnProperty(e)){window.requestAnimationFrame((function(){t(Icon.idLookupCache[e]||undefined)}));return}$.ajax({url:"/icon/get-id-from-name",data:{name:e},dataType:"json",success:function(i){Icon.idLookupCache[e]=i;t(i||undefined)}})},getPrivilegeBorder:function(e){var t=false;if(e>=5e3)t="uncommon";if(e>=1e4)t="rare";if(e>=15e3)t="epic";if(e>=25e3)t="legendary";return t},setUrl:function(e,t){if(!t){t="javascript:"}Icon.getLink(e).href=t},setTexture:function(e,t,i,a){var n=e.firstChild.style;n.backgroundSize="";n.backgroundPosition="";if(!i){n.backgroundImage=null;return}if(i.indexOf("/")!==-1){n.backgroundImage="url("+i+")";n.backgroundSize="contain"}else{let e=Icon.sizes[t];if(e==="blizzard"){e="large"}n.backgroundImage="url("+WH.Icon.getIconUrl(i,e,a)+")"}},moveTexture:function(e,t,i,a,n){var s=e.firstChild.style;s.backgroundSize="";if(i||a){if(n)s.backgroundPosition=i+"px "+a+"px";else s.backgroundPosition=-i*Icon.sizes2[t]+"px "+-a*Icon.sizes2[t]+"px"}else if(s.backgroundPosition)s.backgroundPosition=""},setNumQty:function(e,t,i){var a=WH.gE(e,"span");for(var n=0,s=a.length;n<s;++n){if(a[n]){WH.de(a[n])}}if(t!=null&&(t>1&&t<2147483647||t.length&&t!="0"&&t!="1")){a=WH.createTextGlow(t,"q1");a.style.right="0";a.style.bottom="0";a.style.position="absolute";WH.ae(e,a)}if(i!=null&&i>0){a=WH.createTextGlow("("+i+")","q");a.style.left="0";a.style.top="0";a.style.position="absolute";WH.ae(e,a)}},getLink:function(e){return WH.gE(e,"a")[0]},showIconInfo:function(e){if(e.firstChild){let t=e.firstChild.style;if(t.backgroundImage&&(!WH.STATIC_URL||t.backgroundImage.indexOf(WH.STATIC_URL)>=4)){let e=t.backgroundImage.match(/images\/([^/]+)\/icons\/[^/]+\/([^/.]+).(?:jpg|gif)/);if(e){Icon.displayIcon(e[2],WH.Game.getByKey(e[1]))}}}},onClick:function(){Icon.showIconInfo(this)},displayIcon:function(e,t){if(!Dialog.templates.icondisplay){Dialog.templates.icondisplay={title:WH.TERMS.icon,width:500,buttons:[["arrow",WH.TERMS.original],["x",WH.TERMS.close]],fields:[{id:"icon",label:WH.TERMS.name_colon,required:1,type:"text",labelAlign:"left",compute:function(e,i,a,n){n.classList.add("icon-dialog-content");var s=this.iconDiv=WH.ce("div");s.update=function(){setTimeout((function(){WH.safeSelect(e)}),10);WH.ee(s);WH.ae(s,WH.Icon.create(e.value,WH.Icon.LARGE,undefined,{game:t}))};WH.ae(s,WH.Icon.create(i,WH.Icon.LARGE,undefined,{game:t}));WH.ae(n,s);WH.ae(n,e)}},{id:"iconId",label:WH.TERMS.id+WH.TERMS.colon_punct,type:"text",labelAlign:"left",compute:function(e,t,i,a){a.classList.add("icon-dialog-content");e.value="";this.iconIdField=e}},{id:"location",label:" ",required:1,type:"caption",compute:function(e,t,i,a,n){WH.ee(a);a.classList.add("icon-dialog-caption");var s=WH.TERMS.seeallusingicon_format;s=s.replace("$1",'<a href="/items?filter=142;0;'+this.data.icon+'">'+WH.Types.getLowerPlural(WH.Types.ITEM)+"</a>");s=s.replace("$2",'<a href="/spells?filter=15;0;'+this.data.icon+'">'+WH.Types.getLowerPlural(WH.Types.SPELL)+"</a>");s=s.replace("$3",'<a href="/achievements?filter=10;0;'+this.data.icon+'">'+WH.Types.getLowerPlural(WH.Types.ACHIEVEMENT)+"</a>");a.innerHTML=s}}],onInit:function(e){this.updateIcon=this.template.updateIcon.bind(this,e)},onShow:function(e){this.updateIcon();if(location.hash&&location.hash.indexOf("#icon")==-1)this.oldHash=location.hash;else this.oldHash="";var t="#icon";let i=window.g_pageInfo&&g_pageInfo.type&&[WH.Types.ITEM,WH.Types.SPELL,WH.Types.ACHIEVEMENT].includes(g_pageInfo.type);if(!i){t+=":"+this.data.icon;if(this.data.game&&this.data.game!==WH.Game.DEFAULT){t+=":"+WH.Game.getKey(this.data.game)}}location.hash=t},onHide:function(e){if(this.oldHash)WH.setHash(this.oldHash);else WH.clearHash()},updateIcon:function(e){this.iconDiv.update();var t=this.iconIdField;Icon.getIdFromName(e.icon.value,(function(e){t.value=e||""}))},onSubmit:function(e,t,i,a){if(i==="arrow"){let e=WH.Icon.getIconUrl(t.icon,WH.Icon.LARGE,t.game);let i=window.open(e,"_blank");i.focus();return false}return true}}}if(!Icon.icDialog)Icon.icDialog=new Dialog;Icon.icDialog.show("icondisplay",{data:{icon:e,game:t}})},checkPound:function(){if(location.hash&&location.hash.indexOf("#icon")===0){let e=location.hash.split(":");let t;let i;if(e.length===3){t=e[1];i=WH.Game.getByKey(e[2])}else if(e.length===2){t=e[1]}else if(e.length===1&&window.g_pageInfo){t=WH.Gatherer.getIconName(g_pageInfo.type,g_pageInfo.typeId)}if(t){Icon.displayIcon(t,i)}}}};if(!WH.REMOTE){WH.onLoad(Icon.checkPound)}WH.jQuery=new function(){this.formatJqxhrMessage=function(e){let t=[];if(e.status){t.push("status: ["+e.status+"]")}if(e.statusText){t.push("statusText: ["+e.statusText+"]")}if(e.responseJSON&&e.responseJSON.error){t.push("responseJSON.error: ["+e.responseJSON.error+"]")}else if(e.responseText){t.push("responseText: ["+e.responseText+"]")}return t.join(", ")}};WH.Layout=new function(){const e=this;const t=WH.DOM;const i={Exocet:"https://use.typekit.net/qwt0uqi.css"};const a={vkontakte:"vk",reddit:"reddit-alien"};const n={activeNavItem:null,autoSearchFocus:true,breadcrumb:null,checkedMenuItems:[],disableLayoutAnimation:0,elements:{$breadcrumb:$('<div class="breadcrumb"/>'),header:undefined,headerNav:undefined,"header-wrapper":undefined,"main-contents":undefined,"page-content":undefined},forcedFullscreenMode:false,fullscreenMode:undefined,fullscreenModeDefault:false,fullscreenModeNamespace:null,initialized:false,pageName:null};this.addShareLinks=function(t,i){let a=$("<div>",{class:"share-links"}).prependTo(t);let n=e.getShareServices(i);for(let e=0,t=n.length;e<t;e++){$("<a>",{class:"fa fa-"+n[e].fontIcon,href:n[e].url,rel:"np",text:WH.Strings.sprintf(WH.TERMS.shareon_format,n[e].name),target:"_blank"}).appendTo(a)}};this.disableLayoutAnimation=function(){document.body.dataset.disableLayoutAnimation="true";n.disableLayoutAnimation++};this.enableLayoutAnimation=function(){if(n.disableLayoutAnimation===0||--n.disableLayoutAnimation===0){delete document.body.dataset.disableLayoutAnimation}};this.expandContent=function(){WH.WAS.remove("vertical")};this.expandSite=function(t){if(!WH.WAS||!document.body){WH.aE(document,"bodyAvailable",e.expandSite.bind(this,t));return}if(!WH.WAS.showAds()){return}t=t!==false;if(!t){e.disableLayoutAnimation();setTimeout((function(){requestAnimationFrame(e.enableLayoutAnimation)}),10)}WH.WAS.removeAll(t);document.body.dataset.showSideExpander="false";document.body.classList.add("no-ads-breadcrumb");setTimeout((function(){document.body.classList.remove("has-ads");document.body.classList.add("no-ads")}),(t?WH.WAS.ANIMATION_DURATION_MS:0)+1)};this.expandVideo=function(){WH.WAS.remove("horizontal")};this.getBreadcrumb=function(){return n.elements.$breadcrumb};this.getElement=function(e){if(!n.elements.hasOwnProperty(e)){WH.error("Requested unsupported element.",e);return null}if(n.elements[e]===undefined){n.elements[e]=WH.qs("."+e);if(!n.elements[e]){if(document.readyState!=="complete"){n.elements[e]=undefined}else{n.elements[e]=null}}}return n.elements[e]};this.getFullscreenMode=function(){if(n.forcedFullscreenMode){return true}if(n.fullscreenMode===undefined){n.fullscreenMode=d()}return n.fullscreenMode};this.getHeaderHeight=function(){if(WH.Layout.Responsive.isZulInMobileMode()){return 40}let e=WH.Layout.getElement("header-wrapper");if(e){return e.getBoundingClientRect().height}return 0};this.getPageName=function(){return n.pageName||null};this.getShareTypes=function(){let e=["twitter","facebook","reddit"];if(Locale.get().id===LOCALE_RURU){e.unshift("vk")}return e};this.getShareServices=function(t){let i=[];let n=["vkontakte","twitter","facebook","reddit"];for(let s=0,r=n.length;s<r;s++){let r=n[s];if(r==="vkontakte"&&Locale.getId()!==LOCALE_RURU){continue}i.push({type:r,name:WH.TERMS[r],url:e.getShareUrl(r,t),fontIcon:a[r]||r})}return i};this.getShareUrl=function(e,t){let i=encodeURIComponent(t);switch(e){case"facebook":return"https://www.facebook.com/sharer/sharer.php?u="+i;case"reddit":return"//www.reddit.com/submit?url="+i+"&r=wow";case"twitter":return"https://twitter.com/intent/tweet?text=%20"+i+"%20via%20@Wowhead";case"vk":return"https://vk.com/share.php?url="+i;case"link":return t}WH.error("Tried to get the URL to share to an unknown service.",e);return""};this.init=function(){m();let e=g();H();h();WH.Layout.Responsive.init(e);W();n.initialized=true};this.initSidebar=function(){if(!WH.WAS.showAds()){return}WH.DynamicFixedElement.init("sidebar",".sidebar")};this.loadFont=function(e){let t=i[e];if(!t){WH.error("Could not find a URL for the specified font.",e);return}if(document.head.querySelector('link[rel="stylesheet"][href="'+t+'"]')){return}WH.ae(document.head,WH.ce("link",{rel:"stylesheet",type:"text/css",href:t}))};this.locateBreadcrumb=function(){let t=Menu.getFullPath(Menu.getMenu(),n.breadcrumb);if(!t.length){return}if(!g_pageInfo||!g_pageInfo.hasOwnProperty("typeId")){return}let i=new RegExp("\\b"+g_types[g_pageInfo.type]+"="+g_pageInfo.typeId+"\\b");let a=JSON.parse(JSON.stringify(n.breadcrumb));a.pop();let s=false;let r=function(e){a.push(e[Menu.ITEM_CRUMB]);let t=Menu.getSubmenu(e);if(t&&t.length){for(let e=0,i=t.length;e<i&&!s;e++){r(t[e])}}else{s|=e.length>2&&i.test(e[Menu.ITEM_URL])}if(!s){a.pop()}};r(t.pop());if(s){n.breadcrumb=a;e.updateBreadcrumb()}};this.set=function(t){if(!t){return}let i=false;if(t.hasOwnProperty("activeTab")&&n.activeNavItem!==t.activeTab){n.activeNavItem=typeof t.activeTab==="string"&&t.activeTab.match(/^\d+$/)?parseInt(t.activeTab):t.activeTab;i=true}let a=false;if(t.hasOwnProperty("breadcrumb")&&JSON.stringify(n.breadcrumb)!==JSON.stringify(t.breadcrumb)){n.breadcrumb=t.breadcrumb;a=true}if(t.hasOwnProperty("pageName")){n.pageName=t.pageName}if(t.hasOwnProperty("autoSearchFocus")){n.autoSearchFocus=t.autoSearchFocus}if(n.initialized){if(i){S()}if(a){e.updateBreadcrumb()}}};this.setBodyAttributes=function(){document.body.dataset.env=WH.getDataEnvKey();document.body.dataset.locale=Locale.getName();document.body.dataset.sidebar=JSON.stringify(!!WH.PageMeta.hasSidebar);document.body.dataset.theme=WH.Theme.getTheme();document.body.dataset.themeType=WH.Theme.getThemeType();document.body.dataset.touch=JSON.stringify(Platform.isTouch());document.body.dataset.tree=WH.getDataTreeKey();document.body.dataset.width=WH.PageMeta.fullWidth?"full":"standard";if(WH.PageMeta.logo){document.body.dataset.logo=WH.PageMeta.logo}if(WH.PageMeta.page){document.body.dataset.page=WH.Strings.slug(WH.PageMeta.page)}y()};this.setForcedFullscreenMode=function(t){let i=e.getFullscreenMode();n.forcedFullscreenMode=t;if(e.getFullscreenMode()!==i){y()}else{document.body.dataset.forcedFullscreenMode=JSON.stringify(t)}};this.setFullscreenMode=function(t){let i=e.getFullscreenMode();n.fullscreenMode=t;let a=t?n.fullscreenModeDefault===false&&u()===false?"Re-enabled":"Enabled":n.fullscreenModeDefault===true&&u()===true?"Re-disabled":"Disabled";WH.LocalStorage.set(o(),JSON.stringify(!!t));WH.Track.interactiveEvent("Changed Option","Fullscreen Mode",a);if(e.getFullscreenMode()!==i){y()}};this.setFullscreenModeNamespace=function(t,i){let a=e.getFullscreenMode();n.fullscreenModeNamespace=t;n.fullscreenModeDefault=t===null||typeof i!=="boolean"?false:i;n.fullscreenMode=undefined;if(e.getFullscreenMode()!==a){y()}};this.setTitle=function(e){if(e.indexOf(WH.TERMS.wowhead)===-1){e+=WH.TERMS.hyphen_punct+WH.TERMS.worldofwarcraft}document.title=e};this.showClassicLinkOrRedirect=function(){if(T()){b();return}if(!WH.isRetailTree()||!WH.PageMeta.classicDataEnv||r()){return}if(!WH.PageMeta.classicRedirectSkip){s();return}f()};this.toggleFullscreenMode=function(){e.setFullscreenMode(!d())};this.updateBreadcrumb=function(){if(!n.breadcrumb||!n.breadcrumb.length){n.elements.$breadcrumb.detach();setTimeout((function(){if(n.elements.$breadcrumb.is(":empty")){n.elements.$breadcrumb.detach()}}),0);return}n.elements.$breadcrumb.empty();if(n.checkedMenuItems.length){$.each(n.checkedMenuItems,(function(){this.checked=false;Menu.updateItem(this)}));n.checkedMenuItems=[]}let e=Menu.getFullPath(Menu.getMenu(),n.breadcrumb);if(!e.length){return}let t=e.length-1;let i=[];for(let a=0,s=e.length;a<s;a++){let s=e[a];let r=Menu.getItemOptions(s);s.checked=true;if(s[Menu.ITEM_OPTIONS]&&s[Menu.ITEM_OPTIONS].breadcrumbParent||e[a+1]&&e[a+1][Menu.ITEM_OPTIONS]&&e[a+1][Menu.ITEM_OPTIONS].breadcrumbParent){if(!s[Menu.ITEM_OPTIONS]){s[Menu.ITEM_OPTIONS]={}}s[Menu.ITEM_OPTIONS].checkedFunc=function(e){let t=$("#main-precontents .breadcrumb span a.open");return t.text()===e[Menu.ITEM_LABEL]}}n.checkedMenuItems.push(s);Menu.updateItem(s);let o=c();let l=o;let u=Menu.getItemUrl(s);if(typeof u==="string"){u=WH.ensureUrlProtocol(u);l=$("<a/>",{href:u,rel:"np"}).appendTo(o)}else{u=undefined}let d=Menu.getLabel(s,true);l.text(d);Menu.add(l,s.parentMenu);o.appendTo(n.elements.$breadcrumb);i.push({name:d,url:u,image:r.tinyIcon?WH.ensureUrlProtocol(WH.Icon.getIconUrl(r.tinyIcon,WH.Icon.MEDIUM)):undefined});if(r.onBreadcrumbDisplay){r.onBreadcrumbDisplay(n.breadcrumb)}let f=Menu.getSubmenu(s);if(a===t&&f){o.addClass("breadcrumb-arrow");let e=$('<span class="breadcrumb-ellipsis">...</span>');Menu.add(e,f);e.appendTo(n.elements.$breadcrumb)}}WH.Seo.addJsonLdBreadcrumb(i);n.elements.$breadcrumb.trigger("update");if(!n.elements.$breadcrumb.is(":empty")){n.elements.$breadcrumb.appendTo("#main-precontents");n.elements.$breadcrumb.show()}ZUL.regenerateMenu()};this.updateContentHeight=function(){let i=WH.qs(".main-contents");let a=WH.qs(".sidebar");let n=!i||!a;if(!WH.WAS.showAds()){n=true;e.updateContentHeight=function(){}}if(n){if(i&&i.style.minHeight){i.style.minHeight=""}return}let s=t.getInnerHeight(i);let r=i.offsetHeight-s;let o=t.getInnerHeight(a)-r;let l=WH.ge("main-precontents");if(l){o-=l.offsetHeight}if(WH.WAS.isSkinned()){o+=10}if(s<o){i.style.minHeight=o+"px"}};this.updateSearchWidth=function(e){if(!WH.Theme.isStandard()){return}let t=WH.qs(".header");let i=WH.qs(".header-right");let a=WH.qs(".header-user");let n=WH.qs(".header-search");let s=WH.qs(".header-search form");let r=WH.qs('.header-search input[type="text"]');let o=WH.qs(".header-search-button");if(t&&i&&a&&n&&s&&r&&o){let e=n.getBoundingClientRect().left-t.getBoundingClientRect().left;let l=window.getComputedStyle(i).getPropertyValue("left");s.style.position="absolute";s.style.top=o.style.top="10px";s.style.left=o.style.left=e-parseInt(l)+"px";s.style.right=i.getBoundingClientRect().right-a.getBoundingClientRect().left+"px";r.style.width="100%"}if(e!==false){WH.Layout.Responsive.check()}};function s(){let e=WH.Url.getSubdomain(WH.PageMeta.classicDataEnv,Locale.getId());let t=location.pathname+location.search;let i=t.indexOf("?")!==-1||t.indexOf("&")!==-1?"&":"?";t+=i+"classicRedirect";t+=location.hash;location.href=WH.Url.generate(t,{subdomain:e})}function r(){return WH.LocalStorage.jsonGet("fromClassic")===true}function o(){return"fullscreenMode"+(n.fullscreenModeNamespace?"."+n.fullscreenModeNamespace:"")}function l(e){let t=Menu.getItemOptions(e);let i=WH.ce("a",{className:t.headerNavIcon?"header-nav-icon":"header-nav-text",href:e[Menu.ITEM_URL],rel:"np"});if(!e[Menu.ITEM_URL]){i.href="javascript:";i.className+=" unlinked"}if(t.className){i.className+=" "+t.className}if(t.title){i.title=t.title}let a=Menu.getSubmenu(e);let n=WH.ce("span");WH.ae(i,n);if(t.headerNavIcon){n.classList.add("header-nav-icon-image");if(t.headerNavIconClass){n.classList.add(t.headerNavIconClass)}else if(t.headerNavIcon.indexOf("/")>-1){n.style.background="url("+WH.staticUrl+t.headerNavIcon+")"}else{n.style.background="url("+WH.staticUrl+"/images/wow/icons/medium/"+t.headerNavIcon+".jpg)"}if(t.headerNavIconWithName){let t=WH.ce("span",{className:"header-nav-icon-text"});WH.st(t,e[Menu.ITEM_LABEL]);WH.ae(i,t)}}else{WH.st(n,e[Menu.ITEM_LABEL]);if(a&&WH.Theme.isClassicType()){WH.ae(i,WH.ce("span",{className:"fa fa-caret-down"}))}}if(a){Menu.add(i,a,{padded:true})}return i}function c(){n.elements.$breadcrumb.children("span:last").addClass("breadcrumb-arrow");return $("<span/>").appendTo(n.elements.$breadcrumb)}function u(){try{let e=JSON.parse(WH.LocalStorage.get(o()));return typeof e==="boolean"?e:undefined}catch(e){return undefined}}function d(){let e=u();return e===undefined?n.fullscreenModeDefault:e}function f(){let e=WH.ge("main-contents");let i=WH.qs(WH.PageMeta.classicLinkSelector);let a="bottom";if(!i||!t.isVisible(i)){i=WH.qs(".main-contents > .text > .heading-size-1");if(!i||!t.isVisible(i)){if(WH.Layout.Responsive.check()){return}i=e;a="top";if(!i||!t.isVisible(i)){return}}}let n=t.getInnerWidth(i);if(n&&n+230<(t.getInnerWidth(e)||Platform.getViewportWidth())){a="right"}let s=WH.Page.getType();let r=WH.Types.hasName(s)?WH.Types.getLowerSingular(s):WH.TERMS.page_lc;let o=WH.Url.generate(location.pathname,{subdomain:WH.Url.getSubdomain(WH.PageMeta.classicDataEnv)});let l=WH.ce("div",{className:"highlight-classic-link-content"});l.innerHTML=WH.term("dataEnvVersionLink_format",WH.getDataEnvSeoName(WH.PageMeta.classicDataEnv),r,'<a href="'+o+'">',"</a>");setTimeout((function(){let e="classic-link-type-"+(s||"other");new WH.Highlight(e,i,l,{buttonSize:"small",class:"highlight-classic-link",closeButtonText:WH.TERMS.close,extraButtons:[{text:WH.TERMS.wowheadClassic,url:o}],position:a})}),250)}function h(){e.updateBreadcrumb()}function p(){if(!WH.Theme.isStandard()){return}requestAnimationFrame(e.updateSearchWidth);if(typeof MutationObserver!=="undefined"){let t=WH.qs(".header");if(t){let i=new MutationObserver(e.updateSearchWidth);i.observe(t,{characterData:true,childList:true,subtree:true})}}}function m(){$(".header-expand-site-tab").attr("href","javascript:").click(WH.Layout.expandSite);let e=WH.getPageData("listPage.notFoundPath");if(e){history.replaceState({},"",e)}WH.qsa(".data-env-links a[title]").forEach((function(e){let t=WH.getDataEnvFromKey(e.dataset.env);if(WH.getDataEnv()!==t){WH.aE(e,"click",E.bind(e,e,t));WH.aE(e,"mouseover",E.bind(e,e,t));E(e,t)}let i=e.title;if(WH.PageMeta.page==="home"||(WH.PageMeta.page||"").indexOf("news")===0){let e=t===WH.dataEnv.MAIN?WH.TERMS.newsTypes+WH.TERMS.colon_punct+WH.TERMS.all:WH.TERMS.newsType+WH.TERMS.colon_punct+WH.TERMS[WH.getDataEnvTerm(t)];i+='<div style="margin-top:10px">'+e+"</div>"}WH.Tooltip.simple(e,'<span class="no-wrap">'+i+"</span>",e.href?"q2":"q");e.title=""}));$(".header-theme-switcher a").click((function(){if(this.classList.contains("current")){return}this.classList.remove("fa-square");this.classList.add("fa-refresh");this.classList.add("fa-spin");if(!WH.User.isLoggedIn()){window.location="/account=signin?next="+encodeURIComponent(window.location.pathname+(window.location.hash?"#"+window.location.hash:""));return}WH.Theme.set(this.dataset.theme)}))}function g(){let t=e.getElement("header");if(!t){return}let i=WH.ce("div",{className:"header-nav-wrapper"});WH.ae(t,i);n.elements.headerNav=WH.ce("div",{className:"header-nav"});WH.ae(i,n.elements.headerNav);let a=Menu.getMenu();let s=[];let r=[];for(let e=0,t;t=a[e];e++){let e=Menu.getItemOptions(t);if(e.breadcrumbOnly||e.hide){continue}let i=WH.ce("a",{dataset:{id:t[Menu.ITEM_CRUMB]}});WH.st(i,t[Menu.ITEM_LABEL]);if(e.collapseOrder){i.dataset.collapseOrder=e.collapseOrder;r.push(i)}if(e.rel){i.rel=e.rel}let a=$(i);Menu.linkifyItem(t,a);i.menuItem=t;a.data("menuItem",t);s.push(i);WH.ae(n.elements.headerNav,i)}S();let o=l([null,"",null,null,{className:"header-nav-ellipsis"}]);let c=WH.ce("span",{className:"fa fa-ellipsis-h"});WH.ae(o.firstElementChild,c);WH.ae(n.elements.headerNav,o);let u=WH.ce("div",{className:"header-nav-features"});WH.ae(i,u);let d=Menu.getFeaturedNavigationMenu();let f=[];for(let e=0,t;t=d[e];e++){let e=l(t);e.menuItem=t;f.push(e);WH.ae(u,e)}let h=l([null,"",null,null,{className:"header-nav-ellipsis"}]);let p=WH.ce("span",{className:"fa fa-ellipsis-h"});WH.ae(h.firstElementChild,p);WH.ae(u,h);v(f);r.sort((function(e,t){return e.menuItem[Menu.ITEM_OPTIONS].collapseOrder-t.menuItem[Menu.ITEM_OPTIONS].collapseOrder}));return{collapsibleNavLinks:r,featuredEllipsis:h,featuredLinks:f,featuredNav:u,header:t,headerWrapper:t.parentNode,nav:n.elements.headerNav,navEllipsis:o,navLinks:s,navWrapper:i}}function H(){let e=$(".header-search");if(e.length){let t=$('input[type="text"]',e).focus((function(){WH.qs(".header-search").dataset.hasFocus="true"})).blur((function(){WH.qs(".header-search").dataset.hasFocus="false"}));let i=$("body");if(i.hasClass("home")){WH.safeFocus(t)}if(WH.LocalStorage.get("showRandomWidget")==="true"){WH.LocalStorage.remove("showRandomWidget");let e=WH.qs(".header-nav dl");if(e){let t=WH.ce("a",{className:"header-search-random fa fa-random fa-no-padding",href:"/random"});WH.Tooltip.simple(t,WH.TERMS.anotherrandompage_exclamation,"q2");let i=WH.ce("dt");WH.ae(i,t);WH.ae(e,i)}}$("<a/>",{class:"header-search-button fa fa-search",href:"javascript:"}).click(_).appendTo(e);$("form",e).submit(WH.preventEmptyFormSubmission);LiveSearch.attach(t[0]);if(Array.prototype.indexOf&&n.autoSearchFocus){i.keydown(function(e,t){if(!t.ctrlKey&&!t.metaKey&&!t.altKey&&WH.keyPressIsAlphaNumeric(t)&&(!document.activeElement||!["INPUT","SELECT","TEXTAREA"].includes(document.activeElement.tagName)&&!document.activeElement.isContentEditable)){if(e.offset().top>=window.scrollY){e.focus()}}}.bind(null,t))}p()}}function W(){if(WH.getGets().hasOwnProperty("classicRedirect")&&!WH.isRetailTree()){if(window.history&&window.history.replaceState){window.history.replaceState({},"",location.pathname.replace(/[?&]classicRedirect$/,"")+location.search.replace(/[?&]classicRedirect$/,"")+location.hash)}setTimeout((function(){let e='.data-env-links [data-env="live"]';new WH.Highlight("highlight-retail",e,WH.term("returnToRetail_tip",WH.getDataEnvSeoName()),{extraButtons:[{text:WH.Strings.sprintf(WH.TERMS.backTo_format,WH.qs(e).textContent.trim()),url:WH.qs(e).href}],position:"bottom"})}),250)}}function v(e){let t=function(e){return Math.floor(Math.random()*e)+1};switch(document.body.dataset.logo){case"april-fools":const i=WH.Time.MS_SEC*3;const a=WH.Time.MS_SEC*30;let n=true;let s=e.slice();let r=function(){let e=t(s.length)-1;let o=s[e];o.className="header-nav-text header-nav-april-fools";o.classList.add(n?"first-fool":"entrance-"+t(3));s.splice(e,1);n=false;if(s.length){setTimeout(r,t(a))}else{setTimeout((function(){let e=WH.qs(".header-nav-april-fools.first-fool");e.classList.add("fool-behaves");e.classList.remove("first-fool")}),i)}};setTimeout(r,i);break;case"noblegarden":let o=function(e,i){if(i>3){e.classList.add("header-nav-noblegarden-"+i);e.classList.add("header-nav-noblegarden-dye-"+t(6))}else{e.className="header-nav-text header-nav-noblegarden-"+i;e.classList.add("header-nav-noblegarden-dye-"+t(6))}};if(t(20)===20){for(let t=0,i=e.length;t<i;t++){let i=e[t];if(i.classList.contains("header-nav-classes")){o(i,1)}else{o(i,4)}}break}let l=t(20)===20?6:t(3);let c=[];let u=[];while(c.length<l){let i=t(6);if(c.includes(i)){continue}let a=t(e.length)-1;if(u.includes(a)){continue}let n=e[a];if(i>3&&n.classList.contains("header-nav-classes")){continue}c.push(i);u.push(a);o(n,i)}break}}function _(){let e=$(this).siblings("form").submit().children("input");WH.safeFocus(e)}function T(){let e=WH.getGets();if(e.hasOwnProperty("fromClassic")||e.hasOwnProperty("fromBurningCrusade")){WH.Url.replacePageQuery((function(e){delete e.classicRedirect;delete e.fromClassic;delete e.fromBurningCrusade}));return true}return false}function b(){WH.LocalStorage.jsonSet("fromClassic",true)}function E(e,t){if(e.classList.contains("disabled")){delete e.href;return}let i=location.pathname+location.search;if(WH.isClassicTree()&&location.pathname!=="/"){i+=(i.match(/[?&]/)?"&":"?")+"fromClassic"}if(WH.isTbcTree()&&location.pathname!=="/"){i+=(i.match(/[?&]/)?"&":"?")+"fromBurningCrusade"}i+=location.hash;e.href=WH.Url.generate(i,{dataEnv:t})}function y(){let t=e.getFullscreenMode();let i=JSON.stringify(t);let a=document.body.dataset.fullscreenMode&&document.body.dataset.fullscreenMode!==i;document.body.dataset.fullscreenMode=i;document.body.dataset.forcedFullscreenMode=JSON.stringify(n.forcedFullscreenMode);let s=WH.qs(".header-user-fullscreen span");if(s){WH.st(s,t?WH.TERMS.exitFullscreen:WH.TERMS.fullscreen)}if(a){Menu.hide(true);WH.Tooltip.hide();if(t){WH.Layout.Responsive.disableNavScrollLimit()}}WH.Layout.Responsive.check(true);WH.WAS.updateSkinPosition()}function S(){if(!n.elements.headerNav){return}let e=Menu.getMenu();for(let t=0,i=e.length;t<i;t++){let i=e[t];let a=WH.qs('a[data-id="'+i[Menu.ITEM_CRUMB]+'"]',n.elements.headerNav);if(!a){return}let s=Platform.isTouch();if(i[Menu.ITEM_CRUMB]===n.activeNavItem){a.classList.add(s?"active-touch":"active")}else{a.classList.remove(s?"active-touch":"active")}let r=Menu.getSubmenu(i);if(r){if(s){Menu.addTouch(a,r)}else{Menu.add(a,r,{padded:true})}}}}};window.Lightbox=new function(){const e=this;const t=WH.DOM;const i=WH.Tooltip;this.BLEED_SIZE=50*2;this.UI_HEIGHT=52;this.UI_WIDTH=20;const a={callbacks:{onHide:undefined,onResize:undefined,onShow:undefined},elements:{frame:undefined,frames:{},inner:undefined,outer:undefined},initialized:false,lastId:undefined};this.hide=function(){if(!a.initialized||!e.isVisible()){return}l();if(a.callbacks.onHide){a.callbacks.onHide()}WH.displayNone(a.elements.outer);a.elements.inner.style.width="";Menu.hide(true);i.hide();WH.WAS.restoreHidden();PoundChecker.resume();WH.preventScroll(false)};this.isVisible=function(){return!!a.elements.outer&&t.isVisible(a.elements.outer)};this.reveal=function(){a.elements.outer.dataset.frame=a.lastId;a.elements.frame=a.elements.frames[a.lastId];WH.displayDefault(a.elements.frame);WH.displayDefault(a.elements.outer);c()};this.setSize=function(e){a.elements.inner.style.width=e+"px"};this.show=function(t,r,o){r=r||{};a.callbacks.onHide=r.onHide;a.callbacks.onResize=r.onResize;a.callbacks.onShow=r.onShow;Menu.hide(true);i.hide();WH.WAS.hideAll();PoundChecker.pause();s();n();if(a.lastId!==t&&a.elements.frames[a.lastId]){WH.displayNone(a.elements.frames[a.lastId])}a.lastId=t;let l=!a.elements.frames[t];if(l){let e=WH.ce("div",{className:"lightbox-frame"});WH.ae(a.elements.inner,e);a.elements.frames[t]=e}a.elements.frame=a.elements.frames[t];if(a.callbacks.onShow){a.callbacks.onShow(a.elements.frame,l,o)}e.reveal();WH.preventScroll(true,".lightbox-content")};this.showPicker=function(e,t,i){e+="-picker";Lightbox.show(e,{onShow:function(a,n){Lightbox.setSize(800);let s;if(n){a.classList.add(e);WH.ae(a,WH.ce("div",{className:"lightbox-content listview",id:"lv-"+e}));let i=WH.ce("a",{className:"dialog-option fa fa-times",href:"javascript:"},WH.ct(WH.TERMS.close));WH.aE(i,"click",Lightbox.hide);WH.ae(a,i);t.id=e;s=new Listview(t)}if(i){i(a,n,s)}}})};function n(){WH.aE(document,"keydown",r);WH.aE(window,"resize",o)}function s(){if(a.initialized){return}a.initialized=true;a.elements.inner=WH.ce("div",{className:"lightbox-inner"});a.elements.outer=WH.ce("div",{className:"lightbox-outer",style:{display:"none"}},a.elements.inner);WH.ae(document.body,a.elements.outer);let t=false;let i=false;let n=false;WH.aE(a.elements.inner,"mousedown",(function(){i=true;t=true}));WH.aE(a.elements.inner,"mouseup",(function(){i=false;t=true}));WH.aE(a.elements.outer,"mousedown",(function(){n=true;if(i){i=false;t=true}else{t=false}}));WH.aE(a.elements.outer,"mouseup",(function(i){if(!n){return}n=false;if(!t&&i.target===a.elements.outer){e.hide()}}))}function r(t){if(t.key==="Escape"){e.hide()}}function o(){c();if(a.callbacks.onResize){a.callbacks.onResize()}}function l(){WH.dE(document,"keydown",r);WH.dE(window,"resize",o)}function c(){let t=Platform.getViewportSize();if(t.width>=WH.Responsive.BREAKPOINTS.MOBILE_MODE){let i=t.height-e.BLEED_SIZE;if(a.elements.frame.scrollHeight>i){a.elements.inner.style.maxHeight=i+"px";a.elements.frame.style.maxHeight=i+"px";return}}a.elements.inner.style.maxHeight="";a.elements.frame.style.maxHeight=""}};WH.Links=new function(){this.show=function(r,o,l){r.blur();if(r.addedLinksMenu){return}let c=[];c.push(Menu.createHeading({label:WH.TERMS.clickToCopy}));c.push([0,WH.TERMS.link,WH.copyToClipboard.bind(null,location.href),null,{fontIcon:"link"}]);let u=a(o);if(u){c.push([0,WH.TERMS.wowheadMarkupTag,WH.copyToClipboard.bind(null,u),null,{icon:"/images/logos/favicon-16.png"}])}let d=t(o);if(d){c.push([0,WH.TERMS.inGameLink,WH.copyToClipboard.bind(null,d),null,{icon:"/images/icons/wow.png"}])}let f=e(o);if(f){c.push([0,WH.TERMS.inGameDressingRoomCommand,WH.copyToClipboard.bind(null,f),null,{icon:"/images/icons/wow.png"}])}let h=i(o);if(h){c.push([0,WH.TERMS.inGameSoundCommand,WH.copyToClipboard.bind(null,h),null,{icon:"/images/icons/wow.png"}])}let p=n(o);if(p){c.push([0,WH.TERMS.mogItImportString,WH.copyToClipboard.bind(null,p),null,{fontIcon:"code"}])}let m=s(o);if(m){c.push([0,WH.TERMS.simulationCraftImportString,WH.copyToClipboard.bind(null,m),null,{fontIcon:"code"}])}if(o.typeId){c.push(Menu.createItem({label:WH.TERMS.id,url:WH.copyToClipboard.bind(null,o.typeId),options:{fontIcon:"hashtag"}}))}if(r.dataset.displayId){c.push(Menu.createItem({label:WH.TERMS.displayId,url:function(e){let t=WH.ge("wh-mv-view-in-3d-button");let i=t&&t.dataset.mvDisplayId||r.dataset.displayId;WH.copyToClipboard(i,e)},options:{fontIcon:"hashtag"}}))}if(WH.User.hasRole(U_GROUP_STAFF)&&r.dataset.modelMarkup){c.push(Menu.createHeading({label:WH.term("parens_format",WH.TERMS.clickToCopy,WH.TERMS.staffemployees)}));c.push(Menu.createItem({label:"Model Markup",url:WH.copyToClipboard.bind(null,r.dataset.modelMarkup)}))}c.push(Menu.createHeading({label:WH.TERMS.share}));var g=WH.Layout.getShareServices(location.href);for(var H=0,W=g.length;H<W;H++){c.push([0,g[H].name,g[H].url,null,{fontIcon:g[H].fontIcon,newWindow:true}])}r.addedLinksMenu=true;Menu.add(r,c,{showAtElement:true,showImmediately:true},l)};function e(e){if(!e.dressup||!e.dressup.length){return null}var t='/run local function f(i,b)DressUpItemLink("item:"..i.."::::::::::::9:"..b);end;';for(var i=0,a=e.dressup.length;i<a;i++){var n=e.dressup[i].slice(0);while(n.length<2){n.push(0)}t+="f("+n.shift()+","+(n.length>1?'"'+n.join(":")+'"':n.shift())+");"}return t}function t(e){if(!(e.linkColor&&e.linkId&&e.linkName)){return null}var t=e.linkName.replace(/:+$/,"").replace(/"/g,'\\"');return"/script DEFAULT_CHAT_FRAME:AddMessage("+'"\\124c'+e.linkColor+"\\124H"+e.linkId+"\\124h["+t+']\\124h\\124r");'}function i(e){return e.sound?"/script PlaySound("+e.sound+")":null}function a(e){if(!(e.type&&e.typeId)){return null}var t=WH.markup.getTagByEntityType(e.type);if(!t){return null}return"["+t+"="+e.typeId+(e.bonuses&&e.bonuses.length?" bonus="+e.bonuses.join(":"):"")+(e.spec?" spec="+e.spec:"")+"]"}function n(e){if(!e.dressup||!e.dressup.length){return null}var t="";for(var i=0,a=e.dressup.length;i<a;i++){var n=e.dressup[i];if(n[0]){t+=(t?":":"compare?items=")+n[0];if(n[1]){t+=".0.0.0.0.0.0.0.0.0."+n[1]}}}return t||null}function s(e){if(e.type!==WH.Types.ITEM||!e.slot){return null}var t=r(parseInt(e.slot));if(!t){return null}var i=t+"="+e.linkName.toLowerCase().replace(/ /g,"_").replace(/[^+.%\w]/g,"")+",id="+e.typeId;if(e.bonuses&&e.bonuses.length&&e.bonuses[0]!=0){i+=",bonus_id="+e.bonuses.join("/")}if(e.dropLevel){i+=",drop_level="+e.dropLevel}return i}function r(e){for(var t in g_character_slots_data){if(g_character_slots_data.hasOwnProperty(t)&&g_character_slots_data[t].itemSlots.indexOf(e)!==-1){return g_character_slots_data[t].simCraftName||g_character_slots_data[t].name}}return null}};window.g_listviews={};function Listview(e){const t=WH.User;if(!this.initialSetupComplete){WH.cO(this,e);if(typeof this.tabs==="string"){this.tabs=window[this.tabs]}if(this.id){let e=(this.tabs?"tab-":"lv-")+this.id;if(this.parent){this.container=WH.ce("div",{id:e});WH.ae(WH.ge(this.parent),this.container)}else{this.container=WH.ge(e)}if(this.tabs){this.container.style.display="none"}}else{return}g_listviews[this.id]=this;if(this.tabs){this.tabIndex=this.tabs.add(this.getTabName(),$.extend({id:this.id,onLoad:this.initialize.bind(this),onShow:function(){this.updateTileSizes();this.writeHash()}.bind(this)},this.tabOpts));this.tabClick=Tabs.trackClick.bind(this.tabs,this.tabs.tabs[this.tabIndex])}this.initialSetupComplete=true}if(!this.template){WH.error("Every listview requires a template");return}if(typeof this.template==="string"){this.loadingTemplate=true;Listview.loadTemplate(this.template,function(){this.template=Listview.templates[this.template];delete this.loadingTemplate;Listview.call(this,e)}.bind(this));return}if(t.getDebug()){this.debug=true}if(this.data==null){this.data=[]}if(!this.hasOwnProperty("hash")){if(this.template.hasOwnProperty("hash")){this.hash=this.template.hash}else{this.hash=Listview.HASH_FULL}}this.lockHash=true;if(this.searchable==null){if(this.template.searchable!=null){this.searchable=this.template.searchable}else{this.searchable=false}}if(this.filtrable==null){if(this.template.filtrable!=null){this.filtrable=this.template.filtrable}else{this.filtrable=false}}if(this.sortable==null){if(this.template.sortable!=null){this.sortable=this.template.sortable}else{this.sortable=true}}this.specialHashes={};if(this.data.length===1){this.filtrable=false;this.searchable=false;this.sortable=false}if(this.searchable&&this.searchDelay==null){if(this.template.searchDelay!=null){this.searchDelay=this.template.searchDelay}else{this.searchDelay=333}}if(this.clickable==null){if(this.template.clickable!=null){this.clickable=this.template.clickable}else{this.clickable=true}}if(this.hideBands==null)this.hideBands=this.template.hideBands;if(this.hideNav==null)this.hideNav=this.template.hideNav;if(this.hideHeader==null)this.hideHeader=this.template.hideHeader;if(this.hideCount==null)this.hideCount=this.template.hideCount;if(this.computeDataFunc==null&&this.template.computeDataFunc!=null){this.computeDataFunc=this.template.computeDataFunc}if(this.createCbControls==null&&this.template.createCbControls!=null){this.createCbControls=this.template.createCbControls}if(this.createTooltipToggle==null&&this.template.createTooltipToggle!=null){this.createTooltipToggle=this.template.createTooltipToggle}if(this.template.onBeforeCreate!=null){if(this.onBeforeCreate==null){this.onBeforeCreate=this.template.onBeforeCreate}else{this.onBeforeCreate=[this.template.onBeforeCreate,this.onBeforeCreate]}}if(this.onAfterCreate==null&&this.template.onAfterCreate!=null){this.onAfterCreate=this.template.onAfterCreate}if(this.onNoData==null&&this.template.onNoData!=null){this.onNoData=this.template.onNoData}if(this.createNote==null&&this.template.createNote!=null){this.createNote=this.template.createNote}if(this.template.sortOptions){this.sortOptions=[];WH.cOr(this.sortOptions,this.template.sortOptions)}if(this.customFilter==null&&this.template.customFilter!=null){this.customFilter=this.template.customFilter}if(this.onSearchSubmit==null&&this.template.onSearchSubmit!=null){this.onSearchSubmit=this.template.onSearchSubmit}if(this.getItemLink==null&&this.template.getItemLink!=null){this.getItemLink=this.template.getItemLink}if(this.noRowClick==null&&this.template.noRowClick!=null){this.noRowClick=this.template.noRowClick}if(this.forceBandTop==null&&this.template.forceBandTop!=null){this.forceBandTop=this.template.forceBandTop}if(this.completionText==null&&this.template.completionText!=null){this.completionText=this.template.completionText}if(this.completionText==null){this.completionText=Listview.getCompletionText()}if(this.clip==null&&this.template.clip!=null){this.clip=this.template.clip}if(this.clip||this.template.compute||this.id==="topics"||this.id==="recipes"||this.template.noDebug){this.debug=false}if(this.mode==null){this.mode=this.template.mode}if(this.alternateVersions==null){this.alternateVersions=this.template.alternateVersions}if(this.template.noStyle!=null){this.noStyle=this.template.noStyle}if(this.nItemsPerPage==null){if(this.template.nItemsPerPage!=null){this.nItemsPerPage=this.template.nItemsPerPage}else{this.nItemsPerPage=50}}this.nItemsPerPage|=0;if(this.nItemsPerPage<=0){this.nItemsPerPage=0}if(this.validateHashPagination==null){this.validateHashPagination=true}this.resetRowVisibility();if(this.mode===Listview.MODE_CALENDAR){this.dates=[];this.nItemsPerPage=1;this.nDaysPerMonth=[];if(this.template.startOnMonth!=null){this.startOnMonth=this.template.startOnMonth}else{this.startOnMonth=new Date}this.startOnMonth.setDate(1);this.startOnMonth.setHours(0,0,0,0);if(this.nMonthsToDisplay==null){if(this.template.nMonthsToDisplay!=null){this.nMonthsToDisplay=this.template.nMonthsToDisplay}else{this.nMonthsToDisplay=1}}let e=this.startOnMonth.getFullYear();let t=this.startOnMonth.getMonth();for(let i=0;i<this.nMonthsToDisplay;++i){let a=new Date(e,t+i,32);this.nDaysPerMonth[i]=32-a.getDate();for(let a=1;a<=this.nDaysPerMonth[i];++a){this.dates.push({date:new Date(e,t+i,a)})}}if(this.template.rowOffset!=null){this.rowOffset=this.template.rowOffset}}this.columns=[];for(let e=0,t=this.template.columns.length;e<t;++e){let t={};WH.cO(t,this.template.columns[e]);this.columns.push(t)}if(this.extraCols!=null){for(let e=0,t=this.extraCols.length;e<t;++e){let t=null;let i=this.extraCols[e];if(typeof i==="string"){if(!Listview.extraCols.hasOwnProperty(i)){WH.error("Unknown extraCol ["+i+"].");continue}i=Listview.extraCols[i]}if(!i){WH.error("Could not find the requested listview column:",this.extraCols[e]);continue}if(i.after||i.before){let e=WH.inArray(this.columns,i.after?i.after:i.before,(function(e){return e.id}));if(e!==-1){t=i.after?e+1:e}}if(t==null){t=this.columns.length}if(i.id===Listview.COLUMN_ID_DEBUG_ID){this.columns.splice(0,0,WH.cO({},i))}else{this.columns.splice(t,0,WH.cO({},i))}if(!this.sortOptions){continue}t=null;if(i.hasOwnProperty("sortOptionsPosition")){switch(i.sortOptionsPosition){case Listview.SORT_OPTIONS_FIRST:t=0;break}}else if(i.after||i.before){let e=WH.inArray(this.sortOptions,i.after?i.after:i.before,(function(e){return e.id}));if(e!==-1){t=i.after?e+1:e}}if(t==null){t=this.sortOptions.length}if(i.id===Listview.COLUMN_ID_DEBUG_ID){this.sortOptions.splice(0,0,i)}else{this.sortOptions.splice(t,0,i)}}}this.visibility=[];let i=[];let a=[];if(this.visibleCols!=null){WH.arrayWalk(this.visibleCols,(function(e){i[e]=1}))}if(this.hiddenCols!=null){WH.arrayWalk(this.hiddenCols,(function(e){a[e]=1}))}if(Array.isArray(this.sortOptions)){for(let e=0,t=this.sortOptions.length;e<t;++e){let t=this.sortOptions[e];t.__index=e;if(i[t.id]!=null||!t.hidden&&a[t.id]==null){this.visibility.push(e)}}}else{for(let e=0,t=this.columns.length;e<t;++e){let t=this.columns[e];t.__index=e;if(i[t.id]!=null||!t.hidden&&a[t.id]==null){this.visibility.push(e)}}}if(this.sort==null&&this.template.sort){this.sort=this.template.sort.slice(0)}if(this.sort!=null){let e=this.sort;this.sort=[];for(let t=0,i=e.length;t<i;++t){let i=parseInt(e[t]);if(isNaN(i)){let i=0;if(e[t].charAt(0)==="-"){i=1;e[t]=e[t].substring(1)}let a=WH.inArray(this.columns,e[t],(function(e){return e.id}));if(a!==-1){if(i){this.sort.push(-(a+1))}else{this.sort.push(a+1)}}}else{this.sort.push(i)}}}else{this.sort=[]}if(this.debug){this.columns.splice(0,0,{id:Listview.COLUMN_ID_DEBUG_ID,name:WH.TERMS.id,width:"5%",compute:function(e,t){if(e.id){let i=WH.ce("pre",{style:{display:"inline",margin:"0"}},WH.ct(e.id));WH.clickToCopy(i);WH.ae(t,i)}},getVisibleText:function(e){return e.id||""},getValue:function(e){return e.id||0},sortFunc:function(e,t,i){if(e.id==null){return-1}else if(t.id==null){return 1}return WH.stringCompare(e.id,t.id)}});for(let e=0,t;t=this.columns[e];e++){t.__index=e}this.visibility.splice(0,0,-1);for(let e=0,t=this.visibility.length;e<t;++e){this.visibility[e]=this.visibility[e]+1}for(let e=0,t=this.sort.length;e<t;++e){if(this.sort[e]<0){this.sort[e]=this.sort[e]-1}else{this.sort[e]=this.sort[e]+1}}}this.originalSort=JSON.parse(JSON.stringify(this.sort));for(let e=0,t;t=this.columns[e];++e){t.actions=t.actions||[]}this.Filters=new Listview.Filters(this);if(!this.tabs||this.tabsCalledInitialize){this.initialize()}}Listview.COLUMN_ID_COMPLETION="completed";Listview.COLUMN_ID_DEBUG_ID="debug-id";Listview.COLUMN_ID_POPULARITY="popularity";Listview.COLUMN_TYPE_NUMBER="number";Listview.COLUMN_TYPE_RANGE="range";Listview.COLUMN_TYPE_TEXT="text";Listview.COMPLETION_TYPE_NONE=0;Listview.COMPLETION_TYPE_BATTLE_PET=1;Listview.COMPLETION_TYPE_COLLECTION=2;Listview.HASH_DISABLED=0;Listview.HASH_FULL=1;Listview.HASH_SIMPLE=2;Listview.SORT_OPTIONS_FIRST=0;Listview.MODE_DEFAULT=0;Listview.MODE_CHECKBOX=1;Listview.MODE_DIV=2;Listview.MODE_TILED=3;Listview.MODE_CALENDAR=4;Listview.prototype={addOptions:function(e,t){t=t||{};t.className="listview-note-options";let i=WH.ce("div",t);WH.ae(this.getNoteTopDiv(),i);for(let t=0,a;a=e[t];t++){let e=WH.ce("div",{className:"listview-note-options-option"});let t=WH.ce("label",undefined,WH.ct(a.label));if(a.option.nodeType===Node.ELEMENT_NODE&&/^(input|select|textarea|button|object)$/.test(a.option.tagName.toLowerCase())){if(!a.option.id){a.option.id="listview-option-"+WH.Strings.guid()}t.htmlFor=a.option.id}else{t.style.cursor="default"}WH.ae(e,t);WH.ae(e,WH.ce("div",undefined,a.option));WH.ae(i,e)}},initialize:function(){const e=this;if(this.loadingTemplate){this.tabsCalledInitialize=true;return}delete this.tabsCalledInitialize;if(this.data.length){if(this.computeDataFunc!=null){for(let e=0,t=this.data.length;e<t;++e){this.computeDataFunc(this.data[e])}}}let t;if(this.onBeforeCreate!=null){if(typeof this.onBeforeCreate=="function"){t=this.onBeforeCreate()}else{for(let e=0;e<this.onBeforeCreate.length;++e){this.onBeforeCreate[e].bind(this)()}}}this.noData=WH.ce("div");this.noData.className="listview-nodata text";this.createMainContainer();this.createBands();if(this.customFilter!=null){this.Filters.applyDataOnly()}if(this.tabs){if(this.tabs.poundedTab===this.tabIndex){this.readHash()}}else{this.readHash()}this.applySort();this.updateNav();this.refreshRows(true);this.updateBrowseSession();if(!e.clip&&e.scrollerVertical&&e.bandTop&&e.bandBot){e.updateScrollEnhancements();WH.aE(window,"resize",e.updateScrollEnhancements.bind(e));WH.aE(window,"scroll",e.updateScrollEnhancements.bind(e))}if(this.onAfterCreate){this.onAfterCreate(t)}this.lockHash=false},createHeader:function(){let e=WH.ce("tr");if(this.mode===Listview.MODE_CHECKBOX){let t=WH.ce("th",{style:{width:"33px"}});WH.ae(e,t);let i=WH.ce("div");WH.ae(t,i);let a=WH.ce("a",{className:"listview-cb"},WH.ct(WH.Strings.nbsp));WH.ae(i,a)}for(let t=0,i=this.visibility.length;t<i;++t){let i=this.visibility[t];let a=this.sortOptions?this.sortOptions[i]:this.columns[i];let n=WH.ce("th");let s=WH.ce("span");let r=WH.ce("span");let o=WH.ce("div");let l=WH.ce("a");a.__th=n;if(a.actions&&a.actions.length){l.href="javascript:";l.onclick=l.oncontextmenu=Listview.onColumnHeaderClick.bind(this,a,i)}else if(this.sortable&&(a.sortable==null||a.sortable)){l.href="javascript:";l.onclick=this.sortBy.bind(this,i+1,false)}if(l.onclick){if(!Platform.isTouch()){l.onmouseover=Listview.onColumnHeaderHover.bind(this,l,a);l.onmouseout=WH.Tooltip.hide}}else{l.className="static"}if(a.width!=null)n.style.width=a.width;if(a.align!=null)n.style.textAlign=a.align;if(a.span!=null)n.colSpan=a.span;let c=a.headerClasses||[];if(c.length){l.classList.add(...c)}WH.ae(r,WH.ct(a.name?a.name:WH.Strings.nbsp));WH.ae(s,r);WH.ae(l,s);WH.ae(o,l);WH.ae(n,o);WH.ae(e,n)}if(this.hideHeader){this.thead.style.display="none"}WH.ae(this.thead,e)},createSortOptions:function(e){if(!Array.isArray(this.sortOptions)){return}let t=null;if(Array.isArray(this.sort)){t=this.sort[0]}let i=[];for(let e=0;e<this.sortOptions.length;e++){if(this.sortOptions[e].hidden){continue}let a=WH.ce("a",{href:"javascript:"});a.innerHTML=this.sortOptions[e].name;a.onclick=this.sortGallery.bind(this,a,e+1);if(t===e+1){a.className="active"}i.push(a)}let a=WH.ce("span",{className:"listview-sort-options-choices"});for(let e=0;e<i.length;e++){WH.ae(a,i[e])}let n=WH.ce("div",{className:"listview-sort-options"},WH.ct(WH.TERMS.sortby_colon));WH.ae(n,a);WH.aef(e,n)},getSpecialHash:function(e){let t=e+":";let i=location.hash.substr(1).split(";");for(let e=0,a=i.length;e<a;e++){if(i[e].indexOf(t)===0){return i[e].substr(t.length)}}return undefined},getSpecialHashesString:function(){let e=[];for(let t in this.specialHashes){if(this.specialHashes.hasOwnProperty(t)){e.push(t+":"+this.specialHashes[t])}}return e.join(";")},isColumnVisible:function(e){return this.visibility.indexOf(e.__index)!==-1},removeSpecialHash:function(e){delete this.specialHashes[e];let t=e+":";let i=location.hash.substr(1).split(";").filter((function(e){return e.substr(0,t.length)!==t}));location.hash=i.join(";")},setSpecialHash:function(e,t){this.specialHashes[e]=t},sortGallery:function(e,t){let i=$(e);i.siblings("a").removeClass("active");i.addClass("active");this.sortBy(t)},copyValues:function(e,t,i){WH.copyToClipboard(this.data.map((t=>{if(t.__hidden){return null}let i=e(t);if(typeof i==="string"){i=i.trim();if(i.includes(",")){i=JSON.stringify(i)}}return i==null||i===""?"-":i})).filter((e=>e!=null)).join(", "),i);t.classList.remove("fa-clipboard");t.classList.add("fa-check");setTimeout((()=>{t.classList.remove("fa-check");t.classList.add("fa-clipboard")}),1.5*WH.Time.MS_SEC)},createBands:function(){let e=WH.ce("div");let t=WH.ce("div");let i=WH.ce("div");let a=WH.ce("div");this.bandTop=e;this.bandBot=t;this.noteTop=i;this.noteBot=a;e.className="listview-band-top";t.className="listview-band-bottom";this.navTop=this.createNav(true);this.navBot=this.createNav(false);i.className=a.className="listview-note";if(this.note){i.innerHTML=this.note}else if(this.createNote){this.createNote(i,a)}this.createSortOptions(i);if(this._errors){let e=WH.ce("b",{className:"q10 fa fa-exclamation-triangle fa-size-s"},WH.ct(WH.TERMS.error));if(i.innerHTML){e.style.marginLeft="10px"}let t=WH.ce("small");WH.Tooltip.simple(t,WH.TERMS.invalidfilters_tip,"q");WH.ae(t,e);WH.ae(i,t)}if(!i.firstChild&&!(this.createCbControls||this.mode===Listview.MODE_CHECKBOX)){WH.ae(i,WH.ct(WH.Strings.nbsp))}if(!(this.createCbControls||this.mode===Listview.MODE_CHECKBOX)){WH.ae(a,WH.ct(WH.Strings.nbsp))}WH.ae(e,this.navTop);let n=this.Filters.getOptionsToggle();if(n){WH.ae(e,n)}let s=this.getCopyButton();if(s){WH.ae(e,s)}WH.ae(e,i);if(this.showLootSpecs){this.classSelectorDiv=WH.ce("div");this.classSelectorDiv.id="class-selector";this.classSelectorDiv.style.paddingLeft="3px";let t="";t+='<div id="class-selector-c0" class="iconmedium active">'+'<ins><span style="text-align: center; line-height: 30px; height: 30px; width: 30px;">'+WH.TERMS.all+"</span></ins>"+'<span><img src="'+WH.staticUrl+'/images/Icon/medium/border/default.png" /></span>'+'<a href="javascript:" data-classid="0"></a></div>';for(let e in g_file_classes){t+='<div id="class-selector-c'+e+'" class="iconmedium">'+'<ins><img src="'+WH.staticUrl+"/images/wow/icons/medium/class_"+g_file_classes[e]+'.jpg" /></ins>'+'<span><img src="'+WH.staticUrl+'/images/Icon/medium/border/default.png" /></span>'+'<a href="javascript:" data-classid="'+e+'"></a></div>'}this.classSelectorDiv.innerHTML=t;$("div.iconmedium a",this.classSelectorDiv).bind("mouseover",(function(e){let t=parseInt($(e.target).attr("data-classid"));if(t){let i=WH.Wow.PlayerClass.getName(t);WH.Tooltip.showAtCursor(e,i,0,0,"q")}}));$("div.iconmedium",this.classSelectorDiv).bind("mouseout",(function(e){WH.Tooltip.hide()}));let i=this;$("div.iconmedium a",this.classSelectorDiv).bind("contextmenu",(function(e){return false}));let a=function(e){if(e){WH.LocalStorage.set("dynamic_quest_class",e);this.classFilter=function(t){for(let i in t.specs){if(WH.inArray(g_chr_specs_by_class[e],t.specs[i])!==-1){return true}}return false};if(!WH.isSet("g_filterByClassAchievement")){if(!(WH.isSet("g_user")&&g_user.id)){return}$.ajax({url:"/website-achievement-explored",data:{trigger:"bosslootfilter"},success:function(){AchievementCheck()},type:"POST"});window.g_filterByClassAchievement=true}}else{WH.LocalStorage.remove("dynamic_quest_class");this.classFilter=null;this.deleteRowCaches()}this.Filters.apply();this.applySort();this.refreshRows(true)};$("div.iconmedium a",this.classSelectorDiv).bind("mousedown",(function(e){let t=parseInt($(e.target).attr("data-classid"));switch(e.which){case 3:if(t&&$(e.target).parent().hasClass("active")){$(e.target).parent().removeClass("active");a.call(i,null);$("#class-selector-c0").addClass("active")}break;default:$(".iconmedium",i.classSelectorDiv).removeClass("active");$(e.target).parent().addClass("active");a.call(i,t);break}}));$(e).append(this.classSelectorDiv);$(e).append('<div class="pad" style="clear: left;"></div>');if(WH.LocalStorage.get("dynamic_quest_class")){classId=WH.LocalStorage.get("dynamic_quest_class");$("#class-selector-c"+classId+" a",this.classSelectorDiv).trigger("mousedown")}}WH.ae(t,this.navBot);WH.ae(t,a);if(this.createCbControls||this.mode===Listview.MODE_CHECKBOX){if(this.note&&!this.showLootSpecs){i.style.paddingBottom="5px"}this.cbBarTop=this.createCbBar(true);this.cbBarBot=this.createCbBar(false);WH.ae(e,this.cbBarTop);WH.ae(t,this.cbBarBot);if(!this.noteTop.firstChild&&!this.cbBarTop.firstChild){this.noteTop.innerHTML="&nbsp;"}if(!this.noteBot.firstChild&&!this.cbBarBot.firstChild){this.noteBot.innerHTML="&nbsp;"}if(this.noteTop.firstChild&&this.cbBarTop.firstChild&&!this.showLootSpecs){this.noteTop.style.paddingBottom="6px"}if(this.noteBot.firstChild&&this.cbBarBot.firstChild){this.noteBot.style.paddingBottom="6px"}}if(this.hideBands&1){e.style.display="none"}if(this.hideBands&2){t.style.display="none"}WH.ae(this.container,this.bandTop);this.scrollerHorizontal=WH.ce("div");this.scrollerHorizontal.className="listview-scroller-horizontal";WH.ae(this.container,this.scrollerHorizontal);this.scrollerVertical=WH.ce("div");this.scrollerVertical.className="listview-scroller-vertical";if(this.clip){this.scrollerVertical.style.width=this.clip.w+"px";this.scrollerVertical.style.height=this.clip.h+"px"}if(this.containVerticalScrolling){WH.aE(this.scrollerVertical,"wheel",WH.pickerWheel)}WH.ae(this.scrollerVertical,this.mainContainer);WH.ae(this.scrollerVertical,this.noData);WH.ae(this.scrollerHorizontal,this.scrollerVertical);WH.ae(this.container,this.bandBot)},createMainContainer:function(){let e=this.mainContainer;if(this.mode===Listview.MODE_DIV){this.mainContainer=this.mainDiv=WH.ce("div");if(!this.noStyle){this.mainContainer.className="listview-mode-div"}}else if(this.mode===Listview.MODE_TILED){this.mainContainer=this.mainDiv=WH.ce("div",{className:"listview-mode-tiled"});if(this.clickable){this.mainContainer.className+=" clickable"}if(this.sortOptions){setTimeout(this.updateSortArrow.bind(this),0)}WH.aE(window,"resize",this.updateTileSizes.bind(this))}else{this.mainContainer=this.table=WH.ce("table");this.thead=WH.ce("thead");this.tbody=WH.ce("tbody");if(this.clickable){this.tbody.className="clickable"}if(this.mode===Listview.MODE_CALENDAR){this.table.className="listview-mode-calendar";let e=100/WH.Time.DAYS_PER_WEEK+"%";let t=WH.ce("colgroup");for(let i=0;i<WH.Time.DAYS_PER_WEEK;++i){let i=WH.ce("col");i.style.width=e;WH.ae(t,i)}WH.ae(this.mainContainer,t);if(this.sortOptions){setTimeout(this.updateSortArrow.bind(this),0)}}else{this.table.className="listview-mode-default";this.createHeader();this.updateSortArrow()}WH.ae(this.table,this.thead);WH.ae(this.table,this.tbody)}if(e){e.after(this.mainContainer);WH.de(e);this.deleteRowCaches()}},createNav:function(e){let t=WH.ce("div");t.firstLink=WH.ce("a");t.previousLink=WH.ce("a");t.nextLink=WH.ce("a");t.lastLink=WH.ce("a");t.statusText=WH.ce("span");t.firstIndex=WH.ce("b");t.lastIndex=WH.ce("b");t.totalCount=WH.ce("b");t.className="listview-nav";t.firstLink.href=t.previousLink.href=t.nextLink.href=t.lastLink.href="javascript:";WH.ae(t.firstLink,WH.ct(WH.Strings.laquo+" "+WH.TERMS.first));WH.ae(t.previousLink,WH.ct(WH.Strings.lsaquo+" "+WH.TERMS.previous));WH.ae(t.nextLink,WH.ct(WH.TERMS.next+" "+WH.Strings.rsaquo));WH.ae(t.lastLink,WH.ct(WH.TERMS.last+" "+WH.Strings.raquo));t.firstLink.onclick=this.firstPage.bind(this);t.previousLink.onclick=this.previousPage.bind(this);t.nextLink.onclick=this.nextPage.bind(this);t.lastLink.onclick=this.lastPage.bind(this);if(this.mode===Listview.MODE_CALENDAR){WH.ae(t.firstIndex,WH.ct("a"));WH.ae(t.statusText,t.firstIndex)}else{WH.ae(t.firstIndex,WH.ct("a"));WH.ae(t.lastIndex,WH.ct("a"));WH.ae(t.totalCount,WH.ct("a"));WH.ae(t.statusText,t.firstIndex);WH.ae(t.statusText,WH.ct(WH.TERMS.hyphen_punct));WH.ae(t.statusText,t.lastIndex);WH.ae(t.statusText,WH.ct(WH.TERMS.of_lc));WH.ae(t.statusText,t.totalCount)}WH.ae(t,t.firstLink);WH.ae(t,t.previousLink);WH.ae(t,t.statusText);WH.ae(t,t.nextLink);WH.ae(t,t.lastLink);if(e){if(this.hideNav&1){t.style.display="none"}}else{if(this.hideNav&2){t.style.display="none"}}if(this.tabClick){$("a",t).click(this.tabClick)}if(e){this.resetSortLink=WH.ce("a",{className:"listview-reset-sort fa fa-times-circle",href:"javascript:",style:{display:"none"}},WH.ct(WH.TERMS.resetSort));WH.aE(this.resetSortLink,"click",this.resetSort.bind(null,this));WH.aef(t,this.resetSortLink)}return t},createCbBar:function(e){let t=WH.ce("div");if(this.createCbControls){this.createCbControls(t,e)}if(this.createTooltipToggle){this.createTooltipToggle(t,e)}if(t.firstChild){t.className="listview-withselected"+(e?"":"2");WH.ae(t,this.createToggleAll())}return t},createToggleAll:function(){let e=WH.ce("a");e.className="listview-toggleall";let t=function(e){let t=$("td:first-child input:checkbox:not(:checked)",$(this).parents(".listview")).length?WH.TERMS.selectall_stc:WH.TERMS.deselectall_stc;WH.Tooltip.showAtCursor(e,t,0,0,"q")};e.onclick=function(e,t,i){let a=$("td:first-child",$(this).parents(".listview"));if($("input:checkbox:not(:checked)",a).length){Listview.cbSelect.call(e,true)}else{Listview.cbSelect.call(e,false)}t.call(this,i)}.bind(e,this,t);e.onmousedown=WH.rf;e.onmouseover=t;e.onmousemove=WH.Tooltip.cursorUpdate;e.onmouseout=WH.Tooltip.hide;return e},deleteRowCaches:function(){for(let e in this.data){this.data[e].__tr=null}},getCopyButton:function(){const e=this;if(!this.template.columns||this.template.copyableColumns===false){return null}let t=WH.ce("a",{className:"listview-option-button fa fa-clipboard"});let i=[];let a=false;this.visibility.forEach((n=>{let s=e.columns[n];if(!s||s.copyable===false||!s.name||s.id===Listview.COLUMN_ID_COMPLETION){return}let r=(s.getPlainText?e=>s.getPlainText(e):null)||(s.getVisibleText&&!(s.id==="name"&&s.value)?e=>s.getVisibleText(e):null)||(s.getValue?e=>s.getValue(e):null)||(s.value?e=>e[s.value]:null);if(!r){return}i.push(Menu.createItem({label:s.name,url:e.copyValues.bind(e,r,t)}));a=a||["id",Listview.COLUMN_ID_DEBUG_ID].includes(s.id)}));if(!a){for(let a=0;a<10;a++){if(this.data[a]&&this.data[a].id!=null){i.unshift(Menu.createItem({label:WH.TERMS.id,url:e.copyValues.bind(e,(e=>e.id),t)}));break}}}if(!i.length){return null}let n;if(i.length===1){n=WH.term("copyEach_format",Menu.getLabel(i[0]));WH.aE(t,"click",Menu.getItemUrl(i[0]))}else{n=WH.TERMS.copy_clipboard+WH.TERMS.ellipsis_punct;i.unshift(Menu.createHeading({label:WH.TERMS.copyAll}));Menu.add(t,i,{showAtElement:true})}WH.Tooltip.simple(t,n,"q2");return t},refreshRows:function(e){let t;switch(this.mode){case Listview.MODE_DIV:t=this.mainContainer;break;case Listview.MODE_TILED:t=this.mainDiv;break;default:t=this.tbody}if(!t){return}WH.ee(t);if(this.nRowsVisible===0){if(!this.filtered&&!this.forceBandTop){this.bandTop.style.display=this.bandBot.style.display="none";this.mainContainer.style.display="none"}this.noData.style.display="";this.showNoData();return}let i;let a;if(!(this.hideBands&1)){this.bandTop.style.display=""}if(!(this.hideBands&2)){this.bandBot.style.display=""}if(this.nDaysPerMonth&&this.nDaysPerMonth.length){i=0;for(let e=0;e<this.rowOffset;++e){i+=this.nDaysPerMonth[e]}a=i+this.nDaysPerMonth[this.rowOffset]}else if(this.nItemsPerPage>0){i=this.rowOffset;a=Math.min(i+this.nRowsVisible,i+this.nItemsPerPage);if(this.filtered&&this.rowOffset>0){for(let e=0,t=0;e<this.data.length&&t<this.rowOffset;++e){let a=this.data[e];if(a.__hidden||a.__deleted){i++}else{t++}}a+=i-this.rowOffset}}else{i=0;a=this.nRowsVisible}let n=a-i;if(this.mode===Listview.MODE_DIV){for(let e=0;e<n;++e){let t=i+e;let a=this.data[t];if(!a){break}if(a.__hidden||a.__deleted){++n;continue}WH.ae(this.mainDiv,this.getDiv(t))}}else if(this.mode===Listview.MODE_TILED){for(let e=0;e<n;++e){let t=i+e;let a=this.data[t];if(!a){break}if(a.__hidden||a.__deleted){++n;continue}WH.ae(this.mainDiv,this.getDiv(t))}this.updateTileSizes();let e=WH.qsa("img",this.mainDiv);for(let t=0,i;i=e[t];t++){WH.aE(i,"load",this.updateTileSizesAfterDelay.bind(this))}}else if(this.mode===Listview.MODE_CALENDAR){let e=WH.ce("tr");for(let t=0;t<7;++t){WH.ae(e,WH.ce("th",undefined,WH.ct(WH.Time.getWeekdayName(t))))}WH.ae(this.tbody,e);e=WH.ce("tr");let t=this.dates[i].date.getDay();for(let i=0;i<t;i++){WH.ae(e,WH.ce("td",{className:"empty-cell"}))}let n=t;for(let t=i;t<a;++t){WH.ae(e,this.getEvent(t));if(++n===7){WH.ae(this.tbody,e);e=WH.ce("tr");n=0}}if(n!==0){for(;n<7;++n){WH.ae(e,WH.ce("td",{className:"empty-cell"}))}WH.ae(this.tbody,e)}}else{for(let t=0;t<n;++t){let a=i+t;let s=this.data[a];if(!s){break}if(s.__hidden||s.__deleted){++n;continue}WH.ae(this.tbody,this.getRow(a,e))}}this.mainContainer.style.display="";this.noData.style.display="none";$WowheadPower.attachTouchTooltips(t)},showNoData:function(){let e=this.noData;WH.ee(e);let t=-1;if(this.onNoData){t=this.onNoData.bind(this,e)()}if(t===-1){if(this.noDataElement){WH.ae(this.noData,this.noDataElement)}else if(this.noDataText){WH.ae(this.noData,WH.ct(this.noDataText))}else{WH.ae(this.noData,WH.ct(this.filtered?WH.TERMS.nomatches_tip:WH.TERMS.nodata_tip))}}},getColumn:function(e){for(let t=0,i;i=this.columns[t];t++){if(i.id===e){return i}}return undefined},getDiv:function(e){let t=this.data[e];if(t.__div==null||this.minPatchVersion!=t.__minPatch){this.createDiv(t,e)}return t.__div},createDiv:function(e,t){let i=WH.ce("div");e.__div=i;if(this.minPatchVersion){e.__minPatch=this.minPatchVersion}if(this.onItemClick){WH.aE(i,"click",this.onItemClick.bind(this,e))}else if(this.getItemLink&&this.clickable){WH.aE(i,"click",this.onStandardClickableRowClick.bind(this,e))}this.template.compute.bind(this,e,i,t)()},getCell:function(e,t){let i=this.data[e];if(t||i.__td==null){this.createCell(i,e)}return i.__td},createCell:function(e,t){let i=WH.ce("td");e.__td=i;this.template.compute.bind(this,e,i,t)()},getEvent:function(e){let t=this.dates[e];if(t.__td==null){this.createEvent(t,e)}return t.__td},createEvent:function(e,t){e.events=WH.arrayFilter(this.data,(function(t){if(t.__hidden||t.__deleted||t.name.match(/^\[#/)){return false}if(!WH.Wow.Event){return false}let i=WH.Wow.Event.getNextEvent(t.occurrences,e.date);if(i){let t=new Date(i.start);let a=new Date(i.end);t.setHours(0,0,0,0);a.setHours(0,0,0,0);return t<=e.date&&a>e.date}return false}));let i=WH.ce("td");e.__td=i;if(e.date.getFullYear()===WH.getServerTime().getFullYear()&&e.date.getMonth()===WH.getServerTime().getMonth()&&e.date.getDate()===WH.getServerTime().getDate()){i.className="calendar-today"}let a=WH.ce("div",{className:"calendar-date"});WH.st(a,e.date.getDate());WH.ae(i,a);a=WH.ce("div");a.className="calendar-event";WH.ae(i,a);this.template.compute.bind(this,e,a,t)();if(this.onItemClick){WH.aE(i,"click",this.onItemClick.bind(this,e))}else if(this.getItemLink){WH.aE(i,"click",this.onStandardClickableRowClick.bind(this,e))}},getRow:function(e,t){let i=this.data[e];if(t||i.__tr==null){this.createRow(i)}return i.__tr},setRow:function(e){if(this.data[e.pos]){this.data[e.pos]=e;this.data[e.pos].__tr=e.__tr;this.createRow(this.data[e.pos]);this.refreshRows()}},createRow:function(e){let t=WH.ce("tr",{className:"listview-row"});e.__tr=t;if(this.mode===Listview.MODE_CHECKBOX){let i=WH.ce("td");if(!e.__nochk){i.className="listview-cb";i.onclick=Listview.cbCellClick;let t=WH.ce("input",{type:"checkbox"});t.onclick=Listview.cbClick;if(e.__chk){t.checked=true}e.__cb=t;WH.ae(i,t)}WH.ae(t,i)}for(let i=0,a=this.visibility.length;i<a;++i){let a=this.visibility[i];let n=this.sortOptions?this.sortOptions[a]:this.columns[a];let s=WH.ce("td");let r;if(n.align!=null){s.style.textAlign=n.align}if(n.compute){r=n.compute.bind(this,e,s,t,a)()}else if(e[n.value]!=null){r=e[n.value]}else{r=-1}if(r!==-1&&r!=null){s.insertBefore(WH.ct(r),s.firstChild)}WH.ae(t,s)}if(this.mode===Listview.MODE_CHECKBOX&&e.__chk){t.className="checked"}if(e.frommerge){t.className+=" mergerow"}if(this.onItemClick){WH.aE(t,"click",this.onItemClick.bind(this,e))}else if(this.getItemLink){WH.aE(t,"click",this.onStandardClickableRowClick.bind(this,e))}},onStandardClickableRowClick:function(e,t){if(this.noRowClick){return}if(t.target&&WH.closest(t.target,"a")){return}location.href=this.getItemLink(e)},submitSearch:function(e){if(!this.onSearchSubmit||e.keyCode!==13){return}for(let e=0,t=this.data.length;e<t;++e){if(this.data[e].__hidden){continue}this.onSearchSubmit.bind(this,this.data[e])()}},validatePage:function(e){if(e===true&&!this.validateHashPagination){return}if(this.rowOffset<0){this.rowOffset=0}else if(this.mode===Listview.MODE_CALENDAR){this.rowOffset=Math.min(this.rowOffset,this.nDaysPerMonth.length-1)}else{this.rowOffset=this.getRowOffset(this.rowOffset+this.nItemsPerPage>this.nRowsVisible?this.nRowsVisible-1:this.rowOffset)}},getRowOffset:function(e){return this.nItemsPerPage>0&&e>0?Math.floor(e/this.nItemsPerPage)*this.nItemsPerPage:0},resetRowVisibility:function(e){for(let e=0,t=this.data.length;e<t;++e){this.data[e].__hidden=false}this.filtered=false;if(e!==true){this.rowOffset=0}this.nRowsVisible=this.data.length},changePage:function(){this.refreshRows();this.updateNav();this.writeHash();this.updateBrowseSession();let e=WH.getScroll();let t=WH.ac(this.container);if(e.y>t[1]){scrollTo(e.x,t[1])}},firstPage:function(){if(this.rowOffset>0){this.rowOffset=0;this.changePage()}return false},previousPage:function(){if(this.rowOffset>0){this.rowOffset-=this.nItemsPerPage;this.validatePage();this.changePage()}return false},nextPage:function(){let e=this.rowOffset;this.rowOffset+=this.nItemsPerPage;this.validatePage();if(this.rowOffset!==e){this.changePage()}return false},lastPage:function(){let e=this.rowOffset;this.rowOffset=99999999;this.validatePage();if(this.rowOffset!==e){this.changePage()}return false},addSort:function(e,t){let i=WH.inArray(e,Math.abs(t),(function(e){return Math.abs(e)}));if(i!==-1){t=e[i];e.splice(i,1)}e.splice(0,0,t)},sortBy:function(e,t){let i=this.sortOptions||this.columns;if(e<=0||e>i.length){return}this.searchSort=false;if(Math.abs(this.sort[0])==e&&!t){this.sort[0]=-this.sort[0]}else{let t=-1;if(i[e-1].type===Listview.COLUMN_TYPE_TEXT){t=1}this.addSort(this.sort,t*e)}if(this.data[0]&&!this.data[0].__originalIndex){for(let e in this.data){if(this.data.hasOwnProperty(e)&&this.data[e]){this.data[e].__originalIndex=e}}}if(this.resetSortLink){this.resetSortLink.style.display=""}this.applySort();this.refreshRows();this.updateSortArrow();this.writeHash()},applySort:function(){if(!this.sort.length){return}Listview.sort=this.sort;Listview.columns=this.columns;Listview.sortOptions=this.sortOptions;if(this.template.beforeSort){this.template.beforeSort.call(this)}if(this.indexCreated){this.data.sort(Listview.sortIndexedRows.bind(this))}else{this.data.sort(Listview.sortRows.bind(this))}this.updateSortIndex();this.updateBrowseSession()},resetSort:function(e){if(e.originalSort&&e.data[0]&&e.data[0].hasOwnProperty("__originalIndex")){e.sort=JSON.parse(JSON.stringify(e.originalSort));e.data.sort((function(e,t){return(e.__originalIndex||0)-(t.__originalIndex||0)}));e.indexCreated=false;e.applySort();e.refreshRows();e.removeSortArrow();e.writeHash(true)}else{WH.error("Could not revert to default sort.",e.id,!e.originalSort?"No original sort":!e.data[0]?"No first row":"No original indexes")}if(e.resetSortLink){e.resetSortLink.style.display="none"}},setSort:function(e,t,i){this.searchSort=false;if(this.sort.toString()!==e.toString()){this.sort=e;this.applySort();if(t){this.refreshRows()}if(i){this.writeHash()}}},readHash:function(){if(!this.hash||!location.hash.length){return}let e=location.hash.substr(1);this.Filters.reset();const t=this;e.split(/[;:]/).forEach((function(e){if(/^\d+([+-]\d+)*$/.test(e)){let i=parseInt(e);if(isNaN(i)){return}t.rowOffset=i;t.validatePage(true);if(t.hash!==Listview.HASH_SIMPLE){let i=[];let a=e.match(/([+-])[0-9]+/g);if(a){let e=(t.sortOptions||t.columns).length;for(let n=a.length-1;n>=0;n--){let s=parseInt(a[n])||0;let r=Math.abs(s);if(r<=0||r>e){break}t.addSort(i,s)}t.setSort(i,false,false)}}if(t.tabs){t.tabs.setTabPound(t.tabIndex,t.buildHash())}}else{t.Filters.readHashPart(e)}}));t.Filters.apply();t.updateSortArrow()},setHashMode:function(e){this.hash=e},updateBrowseSession:function(){if(!window.JSON||!WH.LocalStorage.isSupported()){return}if(typeof Filter=="undefined"&&location.pathname!=="/search"){return}if(this.data.length<3){return}if(typeof this.getItemLink!="function"){return}let e=5;let t=location.pathname+location.search;let i=new Date(WH.getServerTime().getTime()-1e3*60*60*24*3).getTime();let a=WH.LocalStorage.get("lvBrowse");if(a){a=window.JSON.parse(a);for(let e=0;e<a.length;e++){if(a[e].path===t||a[e].when<i){a.splice(e--,1)}}if(a.length>=e){a.splice(e-1,a.length-e-1)}}else{a=[]}let n=[];let s;let r=/^\/[-a-z]+=\d+/i;for(let e=0;e<this.data.length;e++){if(s=r.exec(this.getItemLink(this.data[e]))){n.push(s[0])}}if(n.length<3){return}a.unshift({path:t,hash:location.hash,when:WH.getServerTime().getTime(),urls:n});WH.LocalStorage.set("lvBrowse",window.JSON.stringify(a))},updateScrollEnhancements:function(){if(!this.bandTop.offsetParent){return}const e=200;let t=Platform.getViewportHeight();let i=t-this.scrollerVertical.getBoundingClientRect().top-this.bandBot.offsetHeight;i=Math.max(i,e);if(i<this.scrollerVertical.scrollHeight){if(!this.container.dataset.fixedBottom){this.container.dataset.fixedBottom="true"}this.bandBot.style.width=this.bandBot.parentNode.offsetWidth+"px";this.container.style.paddingBottom=this.bandBot.offsetHeight+"px";if(this.scrollerVertical.scrollWidth>this.scrollerVertical.clientWidth){this.scrollerHorizontal.style.minHeight=this.scrollerVertical.scrollHeight+"px";this.scrollerVertical.style.maxHeight=i+"px"}else if(this.scrollerHorizontal.style.minHeight){this.scrollerHorizontal.style.minHeight="";this.scrollerVertical.style.maxHeight=""}if(i===e){let e=this.bandTop.offsetParent;let t=i+this.scrollerVertical.getBoundingClientRect().top-e.getBoundingClientRect().top-parseInt(getComputedStyle(e).getPropertyValue("border-top-width"));this.bandBot.dataset.atTop="true";this.bandBot.style.top=t+"px"}else{if(this.bandBot.dataset.atTop){delete this.bandBot.dataset.atTop;this.bandBot.style.top=""}}}else{if(this.container.dataset.fixedBottom){delete this.container.dataset.fixedBottom;this.bandBot.style.width="";this.container.style.paddingBottom="";if(this.bandBot.dataset.atTop){delete this.bandBot.dataset.atTop;this.bandBot.style.top=""}this.scrollerHorizontal.style.minHeight="";this.scrollerVertical.style.maxHeight=""}}},removeSortArrow:function(){if(this.lsa){this.lsa.classList.remove("listview-sort-desc","listview-sort-asc");this.lsa.classList.remove("active")}},updateSortArrow:function(){if(!this.sort.length||!this.thead||this.mode===Listview.MODE_CALENDAR||this.searchSort){return}let e=WH.inArray(this.visibility,Math.abs(this.sort[0])-1);if(e===-1){return}if(this.mode===Listview.MODE_TILED){if(!this.sortOptions){return}let t=$(".listview-sort-options a",this.noteTop).get(e);if(this.lsa&&this.lsa!=t){this.lsa.className=""}t.className=this.sort[0]<0?"active listview-sort-desc":"active listview-sort-asc";this.lsa=t;return}if(this.mode===Listview.MODE_CHECKBOX&&e<this.thead.firstChild.childNodes.length-1){e+=1}let t=this.thead.firstChild.childNodes[e].firstChild.firstChild.firstChild;if(this.lsa&&this.lsa!=t){this.lsa.className=""}t.className=this.sort[0]<0?"listview-sort-desc":"listview-sort-asc";this.lsa=t},updateSortIndex:function(){let e=this.data;for(let t=0,i=e.length;t<i;++t){e[t].__si=t}this.indexCreated=true},updateTabName:function(){if(this.tabs&&this.tabIndex!=null){this.tabs.setTabName(this.tabIndex,this.getTabName())}},updateTileSizes:function(){if(this.mode!==Listview.MODE_TILED||!this.mainDiv||!this.mainDiv.offsetParent){return}this.mainDiv.dataset.widthTesting="true";let e=0;for(let t=0,i;i=this.mainDiv.childNodes[t];t++){e=Math.max(e,i.offsetWidth)}if(e>30){this.mainDiv.style.gridTemplateColumns="repeat(auto-fit, minmax("+e+"px, 1fr))"}delete this.mainDiv.dataset.widthTesting;clearTimeout(this.updateTileSizesDelay)},updateTileSizesAfterDelay:function(){if(!this.updateTileSizesDelay){this.updateTileSizesDelay=setTimeout(this.updateTileSizes.bind(this),100)}},writeHash:function(e){if(!this.hash||this.lockHash||!this.Filters){return}function t(e){let t=[];e=";"+e;let i=location.hash.substr(1).split(";");for(let a=0,n=i.length;a<n;a++){let n=i[a].match(/^[a-zA-Z0-9_]+:/);if(n&&e.indexOf(";"+n[0])===-1){t.push(i[a])}}return t}let i=e===true?"":this.buildHash();if(this.tabs){this.tabs.setTabPound(this.tabIndex,i)}let a=this.getSpecialHashesString();let n=[];let s=t(a);if(this.tabs){if(s.length&&s[0].indexOf(this.id+":")===0){n.push(s.shift())}else{n.push(this.id)}}n.push(a);n=n.concat(s);n.push(i);let r=n.filter(Boolean).join(";");if(this.tabs&&r===this.id&&this.tabs.selectedTab===-1&&!location.hash){r=""}if(r){location.replace("#"+r)}else{WH.clearHash()}},updateNav:function(){let e=[this.navTop,this.navBot];let t=false;let i=false;let a=new Date;if(this.nRowsVisible>0){if(!(this.hideNav&1)){e[0].style.display=""}if(!(this.hideNav&2)){e[1].style.display=""}}else{e[0].style.display=e[1].style.display="none"}if(this.mode===Listview.MODE_CALENDAR){for(let e=0;e<this.nDaysPerMonth.length;++e){if(e===this.rowOffset){if(e>0){t=true}if(e<this.nDaysPerMonth.length-1){i=true}}}a.setTime(this.startOnMonth.valueOf());a.setMonth(a.getMonth()+this.rowOffset)}else{if(this.nItemsPerPage){if(this.rowOffset>0){t=true}if(this.rowOffset+this.nItemsPerPage<this.nRowsVisible){i=true}}}for(let n=0;n<2;++n){let s=e[n];s.firstLink.dataset.active=t?"yes":"no";s.previousLink.dataset.active=t?"yes":"no";s.nextLink.dataset.active=i?"yes":"no";s.lastLink.dataset.active=i?"yes":"no";if(this.mode===Listview.MODE_CALENDAR){s.firstIndex.firstChild.nodeValue=WH.Time.getMonthName(a.getMonth())+" "+a.getFullYear()}else{s.firstIndex.firstChild.nodeValue=this.rowOffset+1;s.lastIndex.firstChild.nodeValue=this.nItemsPerPage?Math.min(this.rowOffset+this.nItemsPerPage,this.nRowsVisible):this.nRowsVisible;s.totalCount.firstChild.nodeValue=this.nRowsVisible}}if(!t&&!i){$(e[0]).addClass("listview-nav-nocontrols");$(e[1]).addClass("listview-nav-nocontrols")}else{$(e[0]).removeClass("listview-nav-nocontrols");$(e[1]).removeClass("listview-nav-nocontrols")}},getTabName:function(){let e=this.name;let t=this.data.length;for(let e=0,i=this.data.length;e<i;++e){if(this.data[e].__hidden||this.data[e].__deleted){--t}}if(typeof this.forceQuantity=="number"||typeof this.forceQuantity=="string"){t=this.forceQuantity}if((t>0||typeof this.forceQuantity=="string")&&!this.hideCount){e+=WH.sprintf(WH.TERMS._paren,t)}return e},buildHash:function(){let e=[];let t="";t+=this.rowOffset;if(this.hash===Listview.HASH_FULL&&this.sort.length&&JSON.stringify(this.originalSort)!==JSON.stringify(this.sort)){t+=("+"+this.sort.join("+")).replace(/\+-/g,"-")}if(t!=="0"){e.push(t)}e=e.concat(this.Filters.getHashParts());return e.join(";")},getCheckedRows:function(){let e=[];for(let t=0,i=this.data.length;t<i;++t){let i=this.data[t];if(i.__cb&&i.__cb.checked||!i.__cb&&i.__chk){e.push(i)}}return e},resetCheckedRows:function(){for(let e=0,t=this.data.length;e<t;++e){let t=this.data[e];if(t.__cb){t.__cb.checked=false}else if(t.__chk){t.__chk=null}if(t.__tr){t.__tr.className=t.__tr.className.replace("checked","")}}},deleteRows:function(e){if(!e||!e.length){return}for(let t=0,i=e.length;t<i;++t){let i=e[t];if(!i.__hidden&&!i.__hidden){this.nRowsVisible-=1}i.__deleted=true}this.updateTabName();if(this.rowOffset>=this.nRowsVisible){this.previousPage()}else{this.refreshRows();this.updateNav();this.updateBrowseSession()}},setData:function(e){this.data=e;this.indexCreated=false;this.resetCheckedRows();this.resetRowVisibility();if(this.tabs){if(this.tabs.poundedTab===this.tabIndex){this.readHash()}}else{this.readHash()}this.applySort();this.updateSortArrow();if(this.customFilter!=null||this.classFilter!=null){this.Filters.applyDataOnly()}this.updateNav();this.refreshRows();this.updateBrowseSession()},getNoteTopDiv:function(){return this.noteTop},getNoDataDiv:function(){return this.noData},createIndicator:function(e,t,i,a){if(!this.noteIndicators){this.noteIndicators=WH.ce("div");this.noteIndicators.className="listview-indicators";$(this.noteIndicators).insertBefore($(this.noteTop))}let n=$('<span class="indicator"></span>').html(e).append(!t?"":$('<a class="indicator-x">[x]</a>').attr("href",t).click((function(){if(this.tabClick){this.tabClick()}}))).css("cursor",typeof i=="function"?"pointer":null).click((function(){if(this.tabClick){this.tabClick()}if(typeof i==="function"){i()}}));if(a){WH.Tooltip.simple(n.get(0),a,"q")}$(this.noteIndicators).append(n);$(this.noteTop).css("padding-top","7px");if(!this.showLootSpecs){$(this.noteTop).css("padding-bottom","11px")}return n[0]},removeIndicators:function(){if(this.noteIndicators){$(this.noteIndicators).remove();this.noteIndicators=null}$(this.noteTop).css("padding-top","")},createProgressBar:function(e,t,i,a,n,s){if(!this.noteProgressBars){this.noteProgressBars=WH.ce("table");this.noteProgressBars.className="listview-progressbars";$(this.noteProgressBars).insertBefore($(this.noteTop))}let r=4;if(isNaN(n)||n<1){n=1}if(n>r){n=r}let o=this.noteProgressBars.lastChild;let l=n;if(o&&o.childNodes){for(let e=0;e<o.childNodes.length;++e){l+=o.childNodes[e].colSpan||1}}if(!o||l>r){o=WH.ce("tr");WH.ae(this.noteProgressBars,o)}let c=WH.ce("td");if(n>1){c.colSpan=n}if(i){c.className="clickable";c.onclick=function(){i.apply(this,a)}}if(e){WH.ae(c,WH.ce("div",{className:"heading"},WH.ct(e)))}let u=WH.ce("div",{className:"bar-wrap"});let d=WH.ce("div",{className:"bar-bg"});WH.ae(u,d);if(t[2]){let e=WH.ce("div",{className:"bar yellow"});e.style.width=Math.round((t[1]+t[2]+t[5])/t[0]*1e3)/10+"%";WH.ae(u,e)}let f=WH.ce("div",{className:"bar"});f.style.width=Math.round((t[1]+t[5])/t[0]*1e3)/10+"%";if(s){f.className+=" "+s}WH.ae(u,f);if(t[5]){let e=WH.ce("div",{className:"bar gray"});e.style.width=Math.round(t[5]/t[0]*1e3)/10+"%";WH.ae(u,e)}else{t[5]=0}let h=WH.ce("span");WH.st(h,t[1]+t[5]+(t[2]||t[3]?" ("+(t[3]||t[2])+")":"")+" / "+t[0]);WH.ae(u,h);WH.ae(c,u);WH.ae(o,c);$(this.noteTop).css("padding-top","")},removeProgressBars:function(){if(this.noteProgressBars){$(this.noteProgressBars).remove();this.noteProgressBars=null}$(this.noteTop).css("padding-top","")},addTooltipToggle:function(e,t){if(!WH.User.isPremium()){return}let i=false;for(let e=0;e<this.data.length;e++){if(t[this.data[e].id]&&t[this.data[e].id].hasOwnProperty("screenshot")){i=true;break}}if(!i){return}WH.Tooltip.hideScreenshots=true;if(WH.LocalStorage.isSupported()){WH.Tooltip.hideScreenshots=WH.LocalStorage.get("tooltipScreenshots")!=="1"}let a=function(){WH.Tooltip.hideScreenshots=!this.checked;if(WH.LocalStorage.isSupported()){if(this.checked){WH.LocalStorage.set("tooltipScreenshots","1")}else{WH.LocalStorage.remove("tooltipScreenshots")}}$("input[type=checkbox].tooltipToggle").prop("checked",!!this.checked)};let n=WH.ce("label");let s=WH.ce("input",{checked:!WH.Tooltip.hideScreenshots,className:"tooltipToggle",type:"checkbox"});WH.aE(s,"click",a.bind(s));WH.ae(n,s);WH.ae(n,WH.ct(WH.TERMS.screenshotsontooltips_stc));WH.ae(e,n)},noteTopFormIsEmpty:function(){let e=true;$("input, select",this.noteTop).each((function(){switch(this.tagName){case"INPUT":if(this.value){e=false;return false}break;case"SELECT":if($(this).val()){e=false;return false}break}}));return e}};Listview.sortRows=function(e,t){let i=Listview.sort;let a=Listview.sortOptions||Listview.columns;if(this.searchSort&&e.hasOwnProperty("searchpopularity")&&t.hasOwnProperty("searchpopularity")&&(e.searchpopularity>0||t.searchpopularity>0)){return WH.stringCompare(t.searchpopularity,e.searchpopularity)}for(let n=0,s=i.length;n<s;++n){let s;let r=a[Math.abs(i[n])-1];if(!r){r=this.template}if(r.sortFunc){s=r.sortFunc.call(this,e,t,i[n])}else{s=WH.stringCompare(e[r.value],t[r.value])}if(s){return s*i[n]}}return 0};Listview.sortIndexedRows=function(e,t){let i=Listview.sort;let a=Listview.sortOptions||Listview.columns;let n;if(this.searchSort&&e.hasOwnProperty("searchpopularity")&&t.hasOwnProperty("searchpopularity")&&(e.searchpopularity>0||t.searchpopularity>0)){return WH.stringCompare(t.searchpopularity,e.searchpopularity)}for(let s in i){let r=a[Math.abs(i[s])-1];if(!r){r=this.template}if(r.sortFunc){n=r.sortFunc.call(this,e,t,i[0])}else{let i=r.stat||r.value;n=WH.stringCompare(e[i],t[i])}if(n){return n*i[s]}}return e.__si-t.__si};Listview.cbSelect=function(e){for(let t=0,i=this.data.length;t<i;++t){let i=this.data[t];let a=e;if(i.__hidden){continue}if(!i.__nochk&&i.__cb){let e=i.__cb,t=e.parentNode.parentNode;if(a==null){a=!e.checked}if(e.checked!==a){e.checked=a;t.className=e.checked?t.className+" checked":t.className.replace("checked","")}}else if(a==null){a=true}i.__chk=a}};Listview.cbClick=function(e){setTimeout(Listview.cbUpdate.bind(0,0,this,this.parentNode.parentNode),1);WH.sp(e)};Listview.cbCellClick=function(e){setTimeout(Listview.cbUpdate.bind(0,1,this.firstChild,this.parentNode),1);WH.sp(e)};Listview.cbUpdate=function(e,t,i){if(e){t.checked=!t.checked}i.className=t.checked?i.className+" checked":i.className.replace("checked","")};Listview.getCompletionText=function(e){return WH.cO({all:WH.TERMS.all,identical:WH.TERMS.complete,similar:WH.TERMS.inprogress,extra:WH.TERMS.excluded,duplicate:WH.TERMS.duplicate,missing:WH.TERMS.incomplete,this:WH.TERMS.current,other:WH.TERMS.goal},{[Listview.COMPLETION_TYPE_BATTLE_PET]:{identical:WH.TERMS.maxlevel,similar:WH.TERMS.lowlevel,missing:WH.TERMS.missing},[Listview.COMPLETION_TYPE_COLLECTION]:{identical:WH.TERMS.collected,missing:WH.TERMS.missing}}[e]||{})};Listview.onColumnHeaderClick=function(e,t,i){const a=this;if(this.tabClick){this.tabClick()}if(i.button===2||i.shiftKey||i.ctrlKey){WH.Tooltip.hide();requestAnimationFrame((function(){if(e.actions.length===1||i.ctrlKey){let n=e.actions[0];if(n.menu){Menu.show(n.menu,WH.closest(i.target,"th"))}else{n.action.apply(a,e,t,i)}}else{let n=[];for(let i=0,s;s=e.actions[i];i++){if(s.heading){n.push(Menu.createHeading({label:s.name}))}else{n.push(Menu.createItem({label:s.name,submenu:s.menu,url:s.menu?undefined:s.action.bind(a,e,t)}))}}Menu.show(n,WH.closest(i.target,"th"))}}))}else{this.sortBy(t+1)}return false};Listview.onColumnHeaderHover=function(e,t){if(!(this.sortable&&(t.sortable==null||t.sortable)||t.actions.length)){return}let i=WH.ce("div");if(t.tooltipElement){WH.ae(i,t.tooltipElement)}else{WH.ae(i,WH.ce("b",{className:"q1"},WH.ct(t.tooltip||t.name)))}let a=this.Filters.getColumnTooltipAdditions(t);if(a){WH.ae(i,a)}WH.ae(i,WH.ce("div",{className:"q2 no-wrap"},WH.ct(WH.TERMS.clicktosort_stc)));if(t.actions.length){let e=t.actions.length>1?WH.TERMS.rightClickForMoreActions_stc:t.actions[0].tooltipText||WH.TERMS.rightClickTo_format.replace("%s",t.actions[0].name);WH.ae(i,WH.ce("div",{className:"q2 no-wrap"},WH.ct(e)))}WH.Tooltip.show(e,i.innerHTML,0,0,"q")};(function(){let e={};Listview.loadTemplate=function(t,i){if(Listview.templates.hasOwnProperty(t)){if(i){i()}return}let a=t;if(a.indexOf(".")>0){a=a.substr(0,a.indexOf("."))}let n=e.hasOwnProperty(a);if(!n){e[a]=[]}if(i){e[a].push(i)}if(!n){let i=WH.ce("script");let n=WH.staticUrl+"/js/WH/Listview/Templates/"+a+".js";if(WH.PageMeta.scriptVersionQueryString){n+="?"+WH.PageMeta.scriptVersionQueryString}i.src=n;WH.aE(i,"load",(function(){if(!Listview.templates.hasOwnProperty(t)){WH.error('Loaded listview template file "'+a+'", but template "'+t+'" still not defined!')}else{while(e[a].length){e[a].shift()()}}}));WH.aE(i,"error",(function(){WH.error('Could not load listview template "'+t+'" from file "'+a+'"!')}));WH.ae(WH.qs("head"),i)}}})();Listview.extraCols={id:{id:"id",name:"ID",width:"5%",compute:function(e,t){if(e.id){WH.ae(t,WH.ct(e.id))}},sortFunc:function(e,t){let i=parseInt(e.id||0);let a=parseInt(t.id||0);if(i===a){return 0}return i<a?-1:1}},patch:{id:"obj-patch",name:WH.TERMS.patch,compute:function(e,t){if(typeof e.patch!="undefined"){let i=parseInt(e.patch);if(i===0||i===-1){WH.ae(t,WH.ct("???"))}else{let e=Math.floor(i/1e4);let a=Math.floor(i/100)%100;let n=i%100;let s=WH.sprintf("$1.$2.$3",e,a,n);WH.ae(t,WH.ct(s))}}},sortFunc:function(e,t,i){if(e.patch===t.patch){return 0}else if(e.patch<t.patch){return-1}else{return 1}}},date:{id:"obj-date",name:WH.TERMS.added,compute:function(e,t){if(e.date){if(e.date<=86400){WH.ae(t,WH.ct("???"))}else{let i=new Date(e.date*1e3);let a=(WH.getServerTime()-i)/1e3;return WH.formatDate(t,a,i,null,true)}}},sortFunc:function(e,t,i){if(e.date===t.date){return 0}else if(e.date<t.date){return-1}else{return 1}}},cost:{id:"cost",name:WH.TERMS.cost,getValue:function(e){if(e.cost){return(e.cost[2]&&e.cost[2][0]?e.cost[2][0][1]:0)||(e.cost[1]&&e.cost[1][0]?e.cost[1][0][1]:0)||e.cost[0]}},compute:function(e,t){if(e.cost){WH.ae(t,WH.Wow.buildMoney({copper:e.cost[0],currencies:e.cost[1],items:e.cost[2]}))}},sortFunc:function(e,t,i){if(e.cost==null){return-1}else if(t.cost==null){return 1}let a=0,n=0,s=0,r=0;if(e.cost[2]!=null)WH.arrayWalk(e.cost[2],(function(e,t,i,n){a+=Math.pow(10,n)+e[1]}));if(t.cost[2]!=null)WH.arrayWalk(t.cost[2],(function(e,t,i,a){n+=Math.pow(10,a)+e[1]}));if(e.cost[1]!=null)WH.arrayWalk(e.cost[1],(function(e,t,i,a){s+=Math.pow(10,a)+e[1]}));if(t.cost[1]!=null)WH.arrayWalk(t.cost[1],(function(e,t,i,a){r+=Math.pow(10,a)+e[1]}));return WH.stringCompare(a,n)||WH.stringCompare(s,r)||WH.stringCompare(e.cost[0],t.cost[0])}},count:{id:"count",name:WH.TERMS.count,value:"count",compute:function(e,t){if(e.outof){WH.ae(t,WH.ce("div",{className:"small q0"},WH.ct(WH.sprintf(WH.TERMS.outof_format,e.outof))))}return e.count>0?e.count:"??"},getVisibleText:function(e){let t=e.count;if(e.outof){t+=" "+e.outof}return t},sortFunc:function(e,t,i){if(e.count==null){return-1}else if(t.count==null){return 1}return WH.stringCompare(e.count,t.count)}},percent:{id:"percent",name:"%",value:"percent",compute:function(row,td){let personalLootDifficulty=this.selectedDifficulty==WH.Wow.Difficulty.ID_LEGACY_RAID_FINDER||this.selectedDifficulty==WH.Wow.Difficulty.ID_RAID_FINDER;if(row.modes&&personalLootDifficulty||g_pageInfo&&g_pageInfo.type===WH.Types.NPC&&g_world_bosses[g_pageInfo.typeId]||g_pageInfo&&g_pageInfo.type===WH.Types.ITEM&&(g_world_bosses[row.id]||row.personal_loot)){$(td).addClass("tip").mouseover((function(e){WH.Tooltip.showAtCursor(e,WH.TERMS.personal_loot_tip,0,0,"q")})).mousemove((function(e){WH.Tooltip.cursorUpdate(e)})).mouseout((function(){WH.Tooltip.hide()}));return WH.TERMS.personal_loot_abbrev}if(row.hasOwnProperty("percentOverride")){let e=row.percentOverride;return parseFloat(e.toFixed(e>=1.95?0:e>=.195?1:2))}if(row.count<=0||!this._totalCount&&!row.outof){return"??"}if(row.pctstack){let text="";let data=eval("("+row.pctstack+")");for(let e in data){let t=data[e]*row.percent/100;if(t>=1.95){t=parseFloat(t.toFixed(0))}else if(t>=.195){t=parseFloat(t.toFixed(1))}else{t=parseFloat(t.toFixed(2))}text+=WH.sprintf(WH.TERMS.stackof_format,e,t)+"<br />"}$(td).addClass("tip").mouseover((function(e){WH.Tooltip.showAtCursor(e,text,0,0,"q")})).mousemove((function(e){WH.Tooltip.cursorUpdate(e)})).mouseout((function(){WH.Tooltip.hide()}))}let value=parseFloat(row.percent.toFixed(row.percent>=1.95?0:row.percent>=.195?1:2));if(row.pctstack){$(td).append($("<span>").addClass("tip").text(value))}else{return value}},getVisibleText:function(e){let t=e.percent;if(e.hasOwnProperty("percentOverride")){t=e.percentOverride}else if(e.count<=0){return"??"}if(t>=1.95){return t.toFixed(0)}else if(t>=.195){return parseFloat(t.toFixed(1))}else{return parseFloat(t.toFixed(2))}},sortFunc:function(e,t,i){let a=e.percent;let n=t.percent;if(e.count==null){a=0}if(t.count==null){n=0}if(e.hasOwnProperty("percentOverride")){a=e.percentOverride}if(t.hasOwnProperty("percentOverride")){n=t.percentOverride}let s;if(a>=1.95){s=a.toFixed(0)}else if(a>=.195){s=parseFloat(a.toFixed(1))}else{s=parseFloat(a.toFixed(2))}let r;if(n>=1.95){r=n.toFixed(0)}else if(n>=.195){r=parseFloat(n.toFixed(1))}else{r=parseFloat(n.toFixed(2))}return WH.stringCompare(s,r)}},stock:{id:"stock",name:WH.TERMS.stock,width:"10%",value:"stock",compute:function(e,t){if(e.stock>0){return e.stock}else{return String.fromCharCode(8734)}},getVisibleText:function(e){if(e.stock>0){return e.stock}else{return String.fromCharCode(8734)+" infinity"}}},currency:{id:"currency",name:WH.TERMS.currency,getValue:function(e){if(e.currency){return e.currency[0]?e.currency[0][1]:0}},compute:function(e,t){if(e.currency){WH.ae(t,WH.Wow.buildMoney({currencies:e.currency}))}},sortFunc:function(e,t,i){if(e.currency==null){return-1}else if(t.currency==null){return 1}let a=0,n=0;WH.arrayWalk(e.currency,(function(e,t,i,n){a+=Math.pow(10,n)+e[1]}));WH.arrayWalk(t.currency,(function(e,t,i,a){n+=Math.pow(10,a)+e[1]}));return WH.stringCompare(a,n)}},mode:{id:"mode",name:"Mode",after:"name",type:"text",compute:function(e,t){if(e.modes&&e.modes.mode){if(this.validateBonuses){for(let t in this.validateBonuses){if(WH.inArray(e.bonustrees,this.validateBonuses[t])!==-1){if(this.diffLangref&&this.diffLangref[this.selectedDifficulty]){return this.diffLangref[this.selectedDifficulty]}else{break}}}}if(e.bonustrees&&this.diffLangref&&this.diffLangref[this.selectedDifficulty]){return this.diffLangref[this.selectedDifficulty]}let t=WH.Wow.Difficulty;let i=function(i){for(let a=0;a<t.GROUPS[i].length;a++){if(e.modes.mode.indexOf(t.GROUPS[i][a])<0){return false}}return true};let a=false;a=a||i(t.GROUP_RAID);a=a||i(t.GROUP_LEGACY_RAID);a=a||e.modes.mode.indexOf(t.ID_DUNGEON_NORMAL)>=0&&e.modes.mode.indexOf(t.ID_DUNGEON_HEROIC)>=0;return a?WH.TERMS.all:Listview.extraCols.mode.getVisibleText(e)}},getVisibleText:function(e){let t=WH.Wow.Difficulty;let i=e.modes.mode.includes.bind(e.modes.mode);let a=(i(t.ID_SEASON_OF_MASTERY_DUNGEON)||i(t.ID_SEASON_OF_MASTERY_20_PLAYER)||i(t.ID_SEASON_OF_MASTERY_40_PLAYER))&&!(i(t.ID_DUNGEON_NORMAL)||i(t.ID_RAID_40_PLAYER)||i(t.ID_CLASSIC_RAID_20_PLAYER)||i(t.ID_RAID_NORMAL));if(a){return WH.TERMS.seasonOfMastery_abbrev}if(i(t.ID_RAID_NORMAL)){return WH.TERMS.normal}if(i(t.ID_RAID_HEROIC)){return WH.TERMS.heroic}if(i(t.ID_RAID_MYTHIC)){return WH.TERMS.mythic}if(i(t.ID_RAID_FINDER)){return WH.TERMS.raidfinder}let n=i(t.ID_DUNGEON_NORMAL)||i(t.ID_TBC_DUNGEON_NORMAL)||i(t.ID_LEGACY_10_PLAYER)||i(t.ID_LEGACY_25_PLAYER);let s=i(t.ID_DUNGEON_HEROIC)||i(t.ID_TBC_DUNGEON_HEROIC)||i(t.ID_LEGACY_10_PLAYER_HEROIC)||i(t.ID_LEGACY_25_PLAYER_HEROIC);let r=i(t.ID_DUNGEON_MYTHIC);let o=i(t.ID_DUNGEON_TIMEWALKING);let l=i(t.ID_LEGACY_10_PLAYER)||i(t.ID_LEGACY_10_PLAYER_HEROIC)||i(t.ID_TBC_10_PLAYER);let c=i(t.ID_LEGACY_25_PLAYER)||i(t.ID_LEGACY_25_PLAYER_HEROIC)||i(t.ID_TBC_25_PLAYER);let u=i(t.ID_LEGACY_RAID_FINDER);let d=u;t.GROUPS[t.GROUP_DUNGEON].concat(t.GROUPS[t.GROUP_LEGACY_RAID]).forEach((function(e){d=d&&!i(e)}));let f=i(t.ID_RAID_NORMAL);let h=f;t.GROUPS[t.GROUP_DUNGEON].concat(t.GROUPS[t.GROUP_LEGACY_RAID]).forEach((function(e){h=h&&!i(e)}));let p;if(l&&!c){p=10}else if(c&&!l){p=25}let m;if(n&&!s&&!r&&!o){m="normal"}else if(s&&!n&&!r&&!o){m="heroic"}else if(r&&!n&&!s&&!o){m="mythic"}if(m&&!u&&!f){if(p&&!r){return WH.sprintf(WH.TERMS[m+"_format"],p)}else{return WH.TERMS[m]}}if(p&&!u&&!f){return WH.sprintf(WH.TERMS.dungeonplayer_format,p)}if(d){return WH.TERMS.raidfinder}if(h){return WH.TERMS.flexible}return WH.TERMS.all},sortFunc:function(e,t,i){return-WH.stringCompare(Listview.extraCols.mode.compute.call(this,e),Listview.extraCols.mode.compute.call(this,t))}},requires:{id:"requires",name:WH.TERMS.requires,type:"text",compute:function(e,t){let i=e.achievement?WH.Gatherer.get(WH.Types.ACHIEVEMENT,e.achievement):null;if(i){WH.noWrap(t);t.className="small";t.style.lineHeight="18px";let a=WH.ce("a",{className:"icontiny tinyspecial",href:WH.Entity.getPath(WH.Types.ACHIEVEMENT,e.achievement),style:{backgroundImage:"url("+WH.Icon.getIconUrl(i.icon,WH.Icon.TINY)+")",whiteSpace:"nowrap"}},WH.ct(i["name_"+Locale.getName()]));WH.ae(t,a)}},getVisibleText:function(e){return WH.Gatherer.getName(WH.Types.ACHIEVEMENT,e.achievement)},sortFunc:function(e,t,i){return WH.stringCompare(this.getVisibleText(e),this.getVisibleText(t))}},reqskill:{id:"reqskill",name:WH.TERMS.skill,width:"10%",value:"reqskill",before:"yield"},yield:{id:"yield",name:WH.TERMS.yields,type:"text",align:"left",span:2,value:"name",compute:function(e,t,i){if(e["yield"]&&g_items[e["yield"]]){let a=WH.ce("td");a.style.width="1px";a.style.paddingRight="0";a.style.borderRight="none";WH.ae(a,g_items.createIcon(e["yield"],1));WH.ae(i,a);t.style.borderLeft="none";let n=WH.ce("div");let s=WH.ce("a",{className:"q"+g_items[e["yield"]].quality,href:WH.Entity.getPath(WH.Types.ITEM,e["yield"])});WH.ae(s,WH.ct(g_items[e["yield"]]["name_"+Locale.getName()]));WH.ae(n,s);WH.ae(t,n)}},getVisibleText:function(e){if(e["yield"]&&g_items[e["yield"]]){return g_items[e["yield"]]["name_"+Locale.getName()]}},sortFunc:function(e,t,i){if(!e["yield"]||!g_items[e["yield"]]||!t["yield"]||!g_items[t["yield"]]){return e["yield"]&&g_items[e["yield"]]?1:t["yield"]&&g_items[t["yield"]]?-1:0}return-WH.stringCompare(g_items[e["yield"]].quality,g_items[t["yield"]].quality)||WH.stringCompare(g_items[e["yield"]]["name_"+Locale.getName()],g_items[t["yield"]]["name_"+Locale.getName()])}},compare:{id:"compare",name:WH.TERMS.completion,getValue:function(e){return Math.floor(e.compare.progress*100)},compute:function(e,t,i){let a=WH.ce("span",{className:"compare-text"});if(!this.completionMode){a.style.display="block";a.style.margin="0 auto";a.style.textAlign="left";a.style.width="53px"}if(!this.completionText){this.completionText=Listview.getCompletionText()}let n=e.compare.hasOwnProperty("progressAmount")?e.compare.progressAmount:e.compare.progress;if(n<0){n=0}let s=WH.ce("span",{className:"progress-icon progress-"+(n===1?"8":Math.min(Math.round(n*8),7))});let r=WH.ce("span");if(this.completionMode){if(e.compare.progress===1){WH.st(r,this.completionText["identical"])}else if(e.compare.progress===-1){WH.st(r,this.completionText["duplicate"])}else if(!e.compare.progress&&e.compare.primary==this.dataSource){WH.st(r,this.completionText["extra"])}else if(!e.compare.progress){WH.st(r,this.completionText["missing"])}else{WH.ae(r,WH.ct(this.completionText["similar"]+" ("));WH.ae(r,WH.ce("span",{className:"tip"},WH.ct(Math.floor(e.compare.progress*100)+"%")));WH.ae(r,WH.ct(")"))}}else{WH.st(r,Math.floor(e.compare.progress*100)+"%")}let o=true;for(let t in e.compare.tooltip){o=o&&e.compare.tooltip[t].length!==e.compare.data.length}if(e.compare.tooltip.length&&o){a.onmouseover=function(e,t,i,a,n){let s='<table class="compare"><tr>';let r;s+="<tr>";for(let t=0;t<e.data.length;++t){r=e.data[t].status==i?"this":"other";s+="<td><b>"+a[r]+"</b></td>"}s+="</tr>";for(let t=0;t<e.tooltip.length;++t){let i=1;if(e.progress<1){i=e.tooltip[t][e.data[0].status]?1:0;for(let a=1;i&&a<e.data.length;++a){let n=e.tooltip[t];let s=n[e.data[a].status];if(s==="&lt;"+WH.TERMS.any+"&gt;"){continue}if(!s||s!==n[e.data[0].status]){i=0}}}s+="<tr>";for(let a=0;a<e.data.length;++a){s+='<td class="q'+i+'">'+e.tooltip[t][e.data[a].status]+"</td>"}s+="</tr>"}s+="</table>";WH.Tooltip.showAtCursor(n,s,0,0,"q")}.bind(a,e.compare,this.completionMode,this.dataSource,this.completionText);a.onmousemove=WH.Tooltip.cursorUpdate;a.onmouseout=WH.Tooltip.hide;if(!this.completionMode){r.className="tip"}}r.insertBefore(WH.ct(" "),r.firstChild);r.insertBefore(s,r.firstChild);r.style.whiteSpace="nowrap";WH.ae(a,r);WH.ae(t,a)},sortFunc:function(e,t,i){return e.compare.progress-t.compare.progress}},modify:{id:"modify",sortable:0,filtrable:0,compute:function(e,t,i){if(this.createModifyButton){t.style.cursor="default";$(t).click((function(e){e.stopPropagation()}));let i=WH.ce("a",{className:"icon-edit",href:"javascript:"},WH.ct(WH.TERMS.modify));WH.ae(t,this.createModifyButton(e,i))}}},bpetquality:{id:"quality",name:WH.TERMS.quality,compute:function(e,t,i){let a=e.compare.data[0].bpet&&e.compare.data[0].bpet.id?WH.Wow.Item.getQualityName(e.compare.data[0].bpet.quality):"";WH.ae(t,WH.ct(a))},sortFunc:function(e,t,i){let a=e.compare.data[0].bpet&&e.compare.data[0].bpet.id?e.compare.data[0].bpet.quality:-1;let n=t.compare.data[0].bpet&&t.compare.data[0].bpet.id?t.compare.data[0].bpet.quality:-1;return a-n}},popularity:{id:Listview.COLUMN_ID_POPULARITY,copyable:false,name:WH.TERMS.popularity_abbrev,sortOptionsPosition:Listview.SORT_OPTIONS_FIRST,tooltip:WH.TERMS.popularity,max:null,value:"popularity",compute:function(e,t,i,a){let n=this.columns[a];if(n.max===null){n.initMax.call(this,n)}let s=e.hasOwnProperty("popularity")?e.popularity:0;let r=n.max===0?0:s/n.max;r=Math.round(r*8);WH.ae(t,WH.ce("span",{className:"popularity-icon popularity-"+r}))},initMax:function(e){e.max=0;for(let t=0;t<this.data.length;t++){if(this.data[t].hasOwnProperty("popularity")){e.max=Math.max(e.max,this.data[t].popularity||0)}}},sortFunc:function(e,t,i){let a=e.hasOwnProperty("popularity")?e.popularity:0;let n=t.hasOwnProperty("popularity")?t.popularity:0;return n-a}},contentPhase:{id:"contentPhase",name:WH.isClassicTree()?WH.TERMS.seasonOfMasteryPhase:WH.TERMS.phase,tooltip:WH.isClassicTree()?WH.TERMS.seasonOfMasteryContentPhase:WH.TERMS.contentPhase,value:"contentPhase",width:"5%",getVisibleText:function(e){if(typeof e.contentPhase==="number"){return e.contentPhase.toFixed(2).replace(/\D?0*$/,"")}return e.contentPhase||""}}};Listview.templates={};Listview.funcBox={getCurrentItemBonuses:function(e){var t=[];var i=e.bonuses?e.bonuses:this.itemBonusesFromDD?this.itemBonusesFromDD:null;var a=!e.bonuses&&this.itemBonusesFromDD;var n=a?this.validateBonuses:[];if((!i||!i.length)&&e.context){var s=Listview.funcBox.getBonusDataForContext.call(this,e.context);if(s.length==2){i=s[0];n=s[1];a=true}}if(i){for(var r in i){var o=i[r];if(WH.inArray(t,o)==-1&&(!a||WH.inArray(e.bonustrees,n[r])!=-1)){t.push(o)}}}return t},getItemLevelWithBonuses:function(e){var t=e.level;var i=false;var a=false;var n=Listview.funcBox.getCurrentItemBonuses.call(this,e);if(n.length>0&&WH.isSet("g_itembonuses")){for(var s in n){var r=n[s];if(g_itembonuses[r]){WH.arrayWalk(g_itembonuses[r],(function(e){switch(e[0]){case 1:t+=e[1];break;case 11:case 13:i=e[1];break;case 14:a=e[1];break}}))}}}if(i){let e=WH.getScalingDistributionCurve(i);if(e&&e.maxLevel){let t=e.maxLevel;let i=WH.maxLevel<=t?WH.maxLevel:t;let a=Math.round(WH.getCurveValue(e.curve,i));if(a){return a}}}if(a&&t==e.level&&a<600){return a}return t},createSimpleCol:function(e,t,i,a){return{id:e,name:WH.TERMS[t]||t,width:i,value:a}},initLootTable:function(e){var t;if(this._totalCount!=null)t=this._totalCount;else t=e.outof;if(t==0){if(e.count!=-1)e.percent=e.count;else e.percent=0}else{e.percent=e.count/t*100}Listview.funcBox.initModeFilter.bind(this,e)()},initModeFilter:function(e){if(this._lootModes==null){this._lootModes={}}if(this._distinctModes==null){this._distinctModes={}}if(e.modes){let t=WH.Wow.Difficulty.getIds();for(let i=0;i<t.length;i++){let a=t[i];if(this._lootModes[a]==null){this._lootModes[a]=0}if(e.modes.mode.indexOf(a)>=0){this._lootModes[a]++}}let i=e.modes.mode.join(",");if(this._distinctModes[i]==null){this._distinctModes[i]=0}this._distinctModes[i]++}},addModeIndicator:function(){const e=this;const t=WH.Wow.Difficulty;let i=0;for(let e in this._distinctModes){if(this._distinctModes.hasOwnProperty(e)&&this._distinctModes[e]){i++}}if(this._distinctModes[t.GROUPS[t.GROUP_NONE].join(",")]&&i<2){return}let a=[t.ID_NONE,t.ID_DUNGEON_NORMAL,t.ID_DUNGEON_HEROIC,t.ID_DUNGEON_MYTHIC,t.ID_DUNGEON_TIMEWALKING,t.ID_TBC_DUNGEON_NORMAL,t.ID_TBC_DUNGEON_HEROIC,t.ID_SEASON_OF_MASTERY_DUNGEON,t.ID_LEGACY_RAID_FINDER,t.ID_LEGACY_10_PLAYER,t.ID_LEGACY_10_PLAYER_HEROIC,t.ID_LEGACY_25_PLAYER,t.ID_LEGACY_25_PLAYER_HEROIC,t.ID_CLASSIC_RAID_20_PLAYER,t.ID_SEASON_OF_MASTERY_20_PLAYER,t.ID_RAID_40_PLAYER,t.ID_SEASON_OF_MASTERY_40_PLAYER,t.ID_TBC_10_PLAYER,t.ID_TBC_25_PLAYER,t.ID_RAID_FINDER,t.ID_RAID_NORMAL,t.ID_RAID_HEROIC,t.ID_RAID_MYTHIC];let n={};n[t.ID_DUNGEON_HEROIC]=WH.TERMS.heroic;n[t.ID_DUNGEON_NORMAL]=WH.TERMS.normal;n[t.ID_TBC_DUNGEON_NORMAL]=WH.TERMS.normal;n[t.ID_TBC_DUNGEON_HEROIC]=WH.TERMS.heroic;n[t.ID_NONE]=WH.TERMS.normal;n[t.ID_LEGACY_10_PLAYER]=WH.sprintf(WH.TERMS.normal_format,10);n[t.ID_LEGACY_25_PLAYER]=WH.sprintf(WH.TERMS.normal_format,25);n[t.ID_LEGACY_10_PLAYER_HEROIC]=WH.sprintf(WH.TERMS.heroic_format,10);n[t.ID_LEGACY_25_PLAYER_HEROIC]=WH.sprintf(WH.TERMS.heroic_format,25);n[t.ID_LEGACY_RAID_FINDER]=WH.TERMS.raidfinder;n[t.ID_RAID_40_PLAYER]=WH.GlobalStrings.RAID_DIFFICULTY_40PLAYER;n[t.ID_RAID_NORMAL]=WH.TERMS.normal;n[t.ID_RAID_HEROIC]=WH.TERMS.heroic;n[t.ID_RAID_MYTHIC]=WH.TERMS.mythic;n[t.ID_RAID_FINDER]=WH.TERMS.raidfinder;n[t.ID_DUNGEON_MYTHIC]=WH.TERMS.mythic;n[t.ID_DUNGEON_TIMEWALKING]=WH.TERMS.timewalking;n[t.ID_CLASSIC_RAID_20_PLAYER]=WH.GlobalStrings.RAID_DIFFICULTY_20PLAYER;n[t.ID_TBC_10_PLAYER]=t.getName(t.ID_TBC_10_PLAYER);n[t.ID_TBC_25_PLAYER]=t.getName(t.ID_TBC_25_PLAYER);n[t.ID_SEASON_OF_MASTERY_DUNGEON]=t.getName(t.ID_SEASON_OF_MASTERY_DUNGEON);n[t.ID_SEASON_OF_MASTERY_20_PLAYER]=t.getName(t.ID_SEASON_OF_MASTERY_20_PLAYER);n[t.ID_SEASON_OF_MASTERY_40_PLAYER]=t.getName(t.ID_SEASON_OF_MASTERY_40_PLAYER);let s={};this.diffLangref={};$.extend(this.diffLangref,n);if(WH.WAS.showAds()){s[t.ID_LEGACY_10_PLAYER]=n[t.ID_LEGACY_10_PLAYER];s[t.ID_LEGACY_25_PLAYER]=n[t.ID_LEGACY_25_PLAYER];s[t.ID_LEGACY_10_PLAYER_HEROIC]=n[t.ID_LEGACY_10_PLAYER_HEROIC];s[t.ID_LEGACY_25_PLAYER_HEROIC]=n[t.ID_LEGACY_25_PLAYER_HEROIC];s[t.ID_LEGACY_RAID_FINDER]=n[t.ID_LEGACY_RAID_FINDER];n[t.ID_LEGACY_10_PLAYER]=WH.TERMS.normal_abbrev+10;n[t.ID_LEGACY_25_PLAYER]=WH.TERMS.normal_abbrev+25;n[t.ID_LEGACY_10_PLAYER_HEROIC]=WH.TERMS.horde_abbrev+10;n[t.ID_LEGACY_25_PLAYER_HEROIC]=WH.TERMS.horde_abbrev+25;n[t.ID_LEGACY_RAID_FINDER]=WH.TERMS.lookingforraid_abbrev;n[t.ID_RAID_NORMAL]=WH.TERMS.normal_abbrev;n[t.ID_RAID_HEROIC]=WH.TERMS.horde_abbrev;n[t.ID_RAID_MYTHIC]=WH.TERMS.mythic_abbrev;n[t.ID_RAID_FINDER]=WH.TERMS.lookingforraid_abbrev;n[t.ID_DUNGEON_MYTHIC]=WH.TERMS.mythic_abbrev;n[t.ID_DUNGEON_TIMEWALKING]=WH.TERMS.timewalking_abbrev;n[t.ID_SEASON_OF_MASTERY_DUNGEON]=t.getNameShorthand(t.ID_SEASON_OF_MASTERY_DUNGEON);n[t.ID_SEASON_OF_MASTERY_20_PLAYER]=t.getNameShorthand(t.ID_SEASON_OF_MASTERY_20_PLAYER);n[t.ID_SEASON_OF_MASTERY_40_PLAYER]=t.getNameShorthand(t.ID_SEASON_OF_MASTERY_40_PLAYER)}let r=[];let o=function(t){WH.setSelectedLink(this,"lootmode-"+e.tabIndex);e.selectedDifficulty=t;let i=Listview.funcBox.getItemBonusesForDifficulty.call(e,t);e.itemBonusesFromDD=i[0];e.validateBonuses=i[1];if(t!=null){e.setSpecialHash("mode",WH.Strings.slug(n[t].replace(" ","")))}else{e.removeSpecialHash("mode")}e.customFilter=function(i){return Listview.funcBox.filterMode(i,e._totalCount,t)};e.Filters.apply();e.applySort();e.refreshRows(true)};let l;let c=e.getSpecialHash("mode");for(let e=0;e<a.length;e++){let i=a[e];if(!this._lootModes[i]){continue}let u=WH.ce("a");WH.ae(u,WH.ce("span",{},WH.ct(n[i])));WH.ae(u,WH.ct(WH.Strings.sprintf(WH.TERMS.parens_format,"",this._lootModes[i])));u._clickAction=o.bind(u,i);WH.aE(u,"click",u._clickAction);let d=t.getIconClass(i);if(d){u.classList.add(d)}r.push({indicator:$('<span class="indicator-mode"></span>').append(u).append($("<b"+(d?' class="'+d+'"':"")+">"+n[i]+" ("+this._lootModes[i]+")</b>")),tooltip:s[i]});if(r.length===1){l=o.bind(u[0],i)}if(c===WH.Strings.slug(n[i].replace(" ",""))){u._clickAction()}}if(l&&(!WH.setSelectedLink.groups||!WH.setSelectedLink.groups["lootmode-"+e.tabIndex])){l()}let u=false;for(let e=0;e<r.length;++e){let t=$("a",r[e].indicator);if(!$("span",t).html()&&r.length==3){u=true}else{this.createIndicator(r[e].indicator,null,t[0]._clickAction,r[e].tooltip)}}if(u){l()}if(this.showLootSpecs){this.classSelectorDiv.style.marginTop="0px"}$(this.noteTop).append($('<div class="clear"></div>'))},filterMode:function(e,t,i){if(t!=null&&e.count!=null){if(e._count==null)e._count=e.count;var a=e._count;if(i!=null&&e.modes[i]){a=e.modes[i].count;t=e.modes[i].outof}e.__tr=null;e.count=a;e.outof=t;if(t)e.percent=a/t*100;else e.percent=a}if(i==null){return true}return e.modes&&e.modes.mode&&e.modes.mode.indexOf(i)>=0},getItemBonusesForDifficulty:function(e){var t=[];if(e&&WH.isSet("g_pageInfo")){var i=e<0?-e:e;var a=0;var n=g_pageInfo.typeId;switch(g_pageInfo.type){case 1:a=g_npcs[n]&&g_npcs[n].hasOwnProperty("location")?g_npcs[n].location[0]:0;break;case 7:a=n;break;default:break}var s=0;if(WH.isSet("g_mapdifficulties")&&g_mapdifficulties[a]&&g_mapdifficulties[a][i]){s=g_mapdifficulties[a][i]}else if(WH.isSet("g_difficulties")&&g_difficulties[i]){s=g_difficulties[i].context||0}t=Listview.funcBox.getBonusDataForContext.call(this,s)}return t},getItemUrl:function(e){var t;if(e.baseName){t=e.baseName}else if(typeof e.name==="string"&&e.name!==""){t=e.name}var i={};var a=Listview.funcBox.getCurrentItemBonuses.call(this,e);if(a.length>0){i.bonus=a.join(":")}if(this.ilvlOverride){i[this.ilvlOverride.name]=""}else if(this.addIlvlToLinks){i.ilvl=Listview.funcBox.getItemLevelWithBonuses(e)}return WH.Wow.Item.getPath(e.id,t,i)},getBonusDataForContext:function(e){var t=[];if(e&&WH.isSet("g_item_bonuscontexts")&&g_item_bonuscontexts[e]){var i=[];var a=[];for(var n in g_item_bonuscontexts[e]){var s=g_item_bonuscontexts[e][n];i.push(s[1]);a.push(s[0])}t=[i,a]}return t},assocArrCmp:function(e,t,i){if(e==null)return-1;else if(t==null)return 1;var a=Math.max(e.length,t.length);for(var n=0;n<a;++n){if(e[n]==null)return-1;else if(t[n]==null)return 1;var s=WH.stringCompare(i[e[n]],i[t[n]]);if(s!=0)return s}return 0},location:function(e,t,i){if(e.location==null)return-1;var a=i?i:3;var n=e.location.slice(0,a);if(n.length<e.location.length){n.push(-1)}for(var s=0,r=n.length;s<r;++s){if(s>0)WH.ae(t,WH.ct(WH.TERMS.comma_punct));var o=n[s];if(o==-1)WH.ae(t,WH.ct(WH.TERMS.ellipsis_punct));else{var l=WH.ce("a");l.className="q1";l.href=WH.Entity.getPath(WH.Types.ZONE,o,WH.Wow.Area.getName(o));WH.ae(l,WH.ct(WH.Wow.Area.getName(o)||WH.Gatherer.getName(WH.Types.ZONE,o)));WH.ae(t,l)}}},arrayText:function(e,t){if(e==null){return}else if(!Array.isArray(e)){return t[e]}var i="";for(var a=0,n=e.length;a<n;++a){if(a>0)i+=" ";if(!t[e[a]])continue;i+=t[e[a]]}return i},createCenteredIcons:function(e,t,i,a,n,s,r){if(e!=null){var o=0;var l=WH.ce("div"),c=WH.ce("div");WH.ae(document.body,l);if(i&&(e.length!=1||!r)){var u=WH.ce("div");u.style.position="relative";u.style.width="1px";var d=WH.ce("div");d.className="q0";d.style.position="absolute";d.style.right="2px";d.style.lineHeight="26px";d.style.fontSize="11px";d.style.whiteSpace="nowrap";WH.ae(d,WH.ct(i));WH.ae(u,d);WH.ae(l,u);l.style.paddingLeft=$(d).width()+"px"}var f=g_items;if(a==WH.Types.SPELL){f=g_spells}else if(a==WH.Types.PET_ABILITY){f=g_petabilities}for(var h=0,p=e.length;h<p;++h){if(s&&o%s==0){WH.ae(l,WH.ce("div",{className:"clear-left"}))}o++;var m;if(e[h]==null){m=WH.ce("div");m.style.width=m.style.height="26px"}else{var g=undefined;var H=undefined;var W=undefined;if(typeof e[h]=="object"){g=e[h][0];H=e[h][1];W=e[h][2]}else{g=e[h]}if(typeof g=="string"){m=Icon.create(g,0,null,W)}else if(g){m=f.createIcon(g,0,H)}else{m=Icon.create("inventoryslot_empty",0,null,"javascript:")}if(n){m.children[2].rel=n[h]}}if(e.length==1&&r){if(g&&g_items[g]){WH.ee(l);var v=g_items[g],_=WH.ce("a"),T=WH.ce("span");T.style.paddingTop="4px";_.href=WH.Entity.getPath(WH.Types.ITEM,g);_.className="q"+v.quality+" icontiny tinyspecial";_.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/tiny/"+v.icon.toLowerCase()+".gif)";_.style.whiteSpace="nowrap";WH.st(_,WH.Gatherer.getName(WH.Types.ITEM,g));WH.ae(T,_);if(H>1)WH.ae(T,WH.ct(" ("+H+")"));if(i){var u=WH.ce("span");u.className="q0";u.style.fontSize="11px";u.style.whiteSpace="nowrap";WH.ae(u,WH.ct(i));WH.ae(l,u);if($(d).length>0)T.style.paddingLeft=$(d).width()+"px"}WH.ae(l,T)}}else{m.style.cssFloat=m.style.styleFloat="left";WH.ae(l,m);l.style.margin="0 auto";l.style.textAlign="left";var b=e.length;if(s&&s<e.length){b=s}l.style.width=26*b+"px"}}c.className="clear";WH.ae(t,l);WH.ae(t,c);return true}},createSocketedIcons:function(e,t,i,a,n){var s=0,r=WH.ce("div"),o=WH.ce("div");for(var l=0,c=e.length;l<c;++l){var u,d=i[l];if(g_items&&g_items[d])u=g_items.createIcon(d,0);else if(WH.isSet("g_gems")&&g_gems&&g_gems[d])u=Icon.create(g_gems[d].icon,0,null,"/item="+d);else u=Icon.create(null,0,null,"javascript:");u.className+=" iconsmall-socket-"+g_file_gems[e[l]]+(!i||!d?"-empty":"");u.style.cssFloat=u.style.styleFloat="left";if(a&&a[l]){u.insertBefore(WH.ce("var"),u.childNodes[1]);++s}WH.ae(r,u)}r.style.margin="0 auto";r.style.textAlign="left";r.style.width=26*e.length+"px";o.className="clear";WH.ae(t,r);WH.ae(t,o);if(n&&s==e.length){r=WH.ce("div");r.style.paddingTop="4px";WH.ae(r,WH.ct(n));WH.ae(t,r)}}};window.LiveSearch=new function(){const e=this;const t=500;const i={elements:{container:undefined,currentTextBox:undefined,lastDiv:undefined},lastSearch:{},timer:undefined,prepared:false,cancelNext:false,hasData:false};this.attach=function(e){if(e.getAttribute("autocomplete")==="off"){return}e.setAttribute("autocomplete","off");WH.aE(e,"focus",d);WH.aE(e,"keyup",h);WH.aE(e,"keydown",f)};this.hide=function(e){if(e&&!WH.isLeftClick(e)){return}if(i.elements.container){i.elements.container.style.display="none"}if(i.elements.currentTextBox){i.elements.currentTextBox.dataset.hasLiveSearch="false"}};this.reset=function(t){i.lastSearch[t.id]=null;t.value="";i.hasData=false;e.hide()};function a(e){if(e&&!u()){return}if(i.elements.currentTextBox==null){return}let t=WH.ac(i.elements.currentTextBox);i.elements.container.style.left=t[0]+"px";i.elements.container.style.top=t[1]+i.elements.currentTextBox.offsetHeight+"px";i.elements.container.style.width=i.elements.currentTextBox.offsetWidth-4+"px"}function n(){s(this.parentNode.parentNode,true)}function s(t,a){if(i.elements.lastDiv){i.elements.lastDiv.classList.remove("live-search-selected")}i.elements.lastDiv=t;i.elements.lastDiv.classList.add("live-search-selected");if(!a){H();setTimeout(g.bind(e,i.elements.currentTextBox,WH.getTextContent(t.firstChild.firstChild.childNodes[1])),1);i.cancelNext=true}}function r(e){if(!u()){if(i.hasData){H()}return}let t=i.elements.container.childNodes[0].nodeName==="EM"?i.elements.container.childNodes[3]:i.elements.container.firstChild;let a=e?t:i.elements.container.lastChild;if(i.elements.lastDiv==null){s(a)}else{let t=e?i.elements.lastDiv.nextSibling:i.elements.lastDiv.previousSibling;if(t){if(t.nodeName==="STRONG"){t=i.elements.container.lastChild}s(t)}else{s(a)}}}function o(t,a,s){let r=WH.Layout.Responsive.isZulInMobileMode();m(r);H();i.hasData=true;while(i.elements.container.firstChild){WH.de(i.elements.container.firstChild)}a=a.replace(/[^a-z0-9\-]/gi," ");a=a.replace(/\s+/g," ").trim();let o=WH.createOrRegex(a,a==="s"?"[%]":null);if(r){let t=WH.ce("div",{className:"live-search-zul-closer"});let a=WH.ce("div");let s=WH.ce("a");s.innerHTML='<i class="fa fa-times"></i><span class="q10">'+WH.TERMS.closesearch+"</span>";s.onclick=e.hide;s.onmouseover=n;WH.ae(a,s);WH.ae(t,a);WH.ae(i.elements.container,t)}if(s.length===0){WH.ae(i.elements.container,WH.ce("div",{style:{padding:"5px",textAlign:"center",fontSize:"1.2em"}},WH.ct(WH.TERMS.noresults)));return}for(let e=0;e<s.length;e++){let t=s[e];let a=t.type;let l=t.id;let u=WH.ce("a");let d=WH.ce("i");let f=WH.ce("span");let h=WH.ce("div");let p=WH.ce("div");WH.aE(u,"mouseover",n);u.href=WH.Entity.getPath(a,l,t.name);if(a===WH.Types.NPC&&t.boss){h.classList.add("live-search-icon-boss")}else if(a===WH.Types.ITEM&&t.quality!=null){u.classList.add("q"+t.quality)}else if(a===WH.Types.ITEM_SET&&t.quality!=null){u.classList.add("q"+t.quality)}else if(a===WH.Types.CLASS){u.classList.add("c"+l)}if(t.icon){h.classList.add("live-search-icon");h.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/"+(r?"medium":"small")+"/"+t.icon.toLowerCase()+".jpg)"}else if((a===WH.Types.QUEST||a===WH.Types.TITLE)&&t.side>=1&&t.side<=2){h.classList.add("live-search-icon-quest-"+(t.side===1?"alliance":"horde"))}WH.ae(d,WH.ct(WH.Types.getUpperSingular(a)));WH.ae(u,d);let m=t.name;m=m.replace(o,c);if(a===WH.Types.TITLE){m=m.replace("%s",'<span class="q0">&lt;'+WH.TERMS.name+"&gt;</span>")}if(a===WH.Types.SPELL&&t.rank){f.innerHTML=WH.Strings.sprintf(WH.TERMS.parens_format,m,t.rank)}else{f.innerHTML=m}WH.ae(u,f);WH.ae(p,u);WH.ae(h,p);WH.ae(i.elements.container,h)}}function l(e,t){WH.fetch("/search/suggestions-template",{cookies:false,query:{q:t},success:function(i){if(i.search===t){o(e,i.search,i.results)}}})}function c(e,t){return t?e:"<b><u>"+e+"</u></b>"}function u(){if(!i.elements.container){return false}return i.elements.container.style.display!=="none"}function d(e){let t=e.target;if(t!==document){i.elements.currentTextBox=t}}function f(t){switch(t.key){case"Escape":e.hide();break;case"ArrowUp":r(false);break;case"ArrowDown":r(true);break}}function h(t){let a=t.target;let n=a.value.replace(/\s+/g," ").trim();if(n===i.lastSearch[a.id]){return}i.lastSearch[a.id]=n;if(a!==document){i.elements.currentTextBox=a}if(n.length){p(a,n)}else{e.hide()}}function p(e,a){if(i.cancelNext){i.cancelNext=false;return}i.hasData=false;if(i.timer>0){clearTimeout(i.timer);i.timer=0}i.timer=setTimeout(l.bind(0,e,a),t)}function m(t){if(i.prepared){if(t){i.elements.container.classList.add("live-search-mobile")}else{i.elements.container.classList.remove("live-search-mobile")}return}i.prepared=true;i.elements.container=WH.ce("div",{className:"live-search"+(t?" live-search-mobile":""),style:{display:"none"}});WH.ae(document.body,i.elements.container);WH.aE(window,"resize",a.bind(e,true));if(!t){WH.aE(document,"click",e.hide)}}function g(e,t){e.value=t;e.selectionStart=e.selectionEnd=t.length}function H(){if(i.elements.container&&!u()){a();if(i.elements.currentTextBox){i.elements.currentTextBox.dataset.hasLiveSearch="true"}i.elements.container.style.opacity="0";i.elements.container.style.display="block";$(i.elements.container).animate({opacity:"1"},"fast")}}};var LOCALE_ENUS=0;var LOCALE_KOKR=1;var LOCALE_FRFR=2;var LOCALE_DEDE=3;var LOCALE_ZHCN=4;var LOCALE_ESES=6;var LOCALE_RURU=7;var LOCALE_PTBR=8;var LOCALE_ITIT=9;var Locale={DEFAULT:LOCALE_ENUS,current:{},locales:{0:{id:LOCALE_ENUS,name:"enus",code:"en",domain:"www.wowhead.com",description:"English",descriptionEnglish:"English"},1:{id:LOCALE_KOKR,name:"kokr",code:"ko",domain:"ko.wowhead.com",description:"한국어",descriptionEnglish:"Korean"},2:{id:LOCALE_FRFR,name:"frfr",code:"fr",domain:"fr.wowhead.com",description:"Français",descriptionEnglish:"French"},3:{id:LOCALE_DEDE,name:"dede",code:"de",domain:"de.wowhead.com",description:"Deutsch",descriptionEnglish:"German"},4:{id:LOCALE_ZHCN,name:"zhcn",code:"zh",domain:"cn.wowhead.com",description:"简体中文",descriptionEnglish:"Simplified Chinese"},6:{id:LOCALE_ESES,name:"eses",code:"es",domain:"es.wowhead.com",description:"Español",descriptionEnglish:"Spanish"},7:{id:LOCALE_RURU,name:"ruru",code:"ru",domain:"ru.wowhead.com",description:"Русский",descriptionEnglish:"Russian"},8:{id:LOCALE_PTBR,name:"ptbr",code:"pt",domain:"pt.wowhead.com",description:"Português Brasileiro",descriptionEnglish:"Brazilian Portuguese"},9:{id:LOCALE_ITIT,name:"itit",code:"it",domain:"it.wowhead.com",description:"Italiano",descriptionEnglish:"Italian"}},exists:function(e){return Locale.locales.hasOwnProperty(e)},getAll:function(){var e=[];for(var t in Locale.locales){e.push(Locale.locales[t])}return e},getAllByName:function(){var e=Locale.getAll();e.sort((function(e,t){return WH.stringCompare(e.description,t.description)}));return e},getCode:function(e){return(Locale.locales[e]||Locale.locales[Locale.getId()]).code},getDataEnvForcedLocale:function(e){switch(e){case WH.dataEnv.PTR:case WH.dataEnv.BETA:return LOCALE_ENUS}return undefined},getDescription:function(e){if(typeof e!=="number"&&typeof e!=="string"){e=Locale.getId()}return Locale.locales[e].description},getEnglishDescription:function(e){if(typeof e!=="number"&&typeof e!=="string"){e=Locale.getId()}return Locale.locales[e].descriptionEnglish},getLocalizedDescription:function(e){if(typeof e!=="number"&&typeof e!=="string"){e=Locale.getId()}return WH.GlobalStrings["LFG_LIST_LANGUAGE_"+Locale.getName(e).toUpperCase()]},getId:function(){return Locale.current.id},getIetf:function(e){let t=Locale.getName(e);return t.substr(0,2)+"-"+t.substr(2,2).toUpperCase()},getName:function(e){if(!Locale.locales[e]){e=Locale.getId()}return Locale.locales[e].name},getPreferred:function(){if(!WH.Cookies.available()){return}let e=WH.getCookies("prefLocale");if(e==undefined){return}e=parseInt(e);return Locale.exists(e)?e:undefined},get:function(){var e=Locale.getId();return Locale.locales[e]},isLocaleName:function(e){for(var t in Locale.locales){if(Locale.locales.hasOwnProperty(t)&&Locale.locales[t].name===e){return true}}return false},set:function(e){$.extend(Locale.current,Locale.locales[e]);if(e!==LOCALE_ENUS){Menu.sortGlobalMenus()}},setPreferred:function(e){if(!WH.Cookies.available()){return}if(e==null){WH.deleteCookie("prefLocale","/",WH.Cookies.getDomain(),true)}else if(!Locale.exists(e)){WH.error("Invalid locale: ["+e+"]")}else{WH.setCookie("prefLocale",365,e,"/",WH.Cookies.getDomain(),true)}},formatList:function(e,t,i){var a=t==="or"?e.length===2?WH.TERMS.wordspace_punct+WH.TERMS.or_lc+WH.TERMS.wordspace_punct:WH.TERMS.finalenumerationseparatoror_punct:e.length===2?WH.TERMS.and_lc:WH.TERMS.finalenumerationseparator_punct;if(i){var n=Math.max((WH.TERMS.wordspace_punct+WH.TERMS.ellipsis_punct+WH.TERMS.wordspace_punct).length,a.length);var s=(""+e[e.length-1]).length;i-=n+s}var r="";for(var o=0,l=e.length;o<l;o++){if(o>0){r+=o===l-1?a:WH.TERMS.enumerationseparator_punct}r+=e[o];if(i&&r.length>=i&&o<e.length-2){r+=WH.TERMS.wordspace_punct+WH.TERMS.ellipsis_punct+WH.TERMS.wordspace_punct+e[e.length-1];break}}return r},hasSentenceSpaces:function(e){return e!==LOCALE_ZHCN},hasWordSpaces:function(e){return e!==LOCALE_ZHCN}};Locale.set(LOCALE_ENUS);function Mapper(e,t){WH.cO(this,e);if(this.parent&&!this.parent.nodeName){this.parent=WH.ge(this.parent)}else{if(!this.parent){return}}var i;this.mouseX=0;this.mouseY=0;this.editable=this.editable||false;this.overlay=this.overlay||false;this.dataEnv=this.dataEnv||WH.getDataEnv();if(WH.isClassicTree(this.dataEnv)){this.rootMapDir="/images/wow/classic/maps"}else if(WH.isTbcTree(this.dataEnv)){this.rootMapDir="/images/wow/tbc/maps"}else if(this.legacy){this.rootMapDir="/images/wow/maps/legacy"}else{this.rootMapDir="/images/wow/maps"}this.localeDir=Locale.getName();if(this.dataEnv===WH.dataEnv.PTR){this.localeDir="ptr"}else if(this.dataEnv===WH.dataEnv.BETA){this.localeDir="beta"}if(this.editable){this.zoomable=this.toggle=false;this.show=this.mouse=true}else{this.zoomable=this.zoomable==null?true:this.zoomable;this.toggle=this.toggle==null?true:this.toggle;this.show=this.show==null?true:this.show;this.mouse=this.mouse==null?false:this.mouse}this.buttons=this.buttons==null?true:this.buttons;this.zoneLink=this.zoneLink==null?true:this.zoneLink;if(location.href.indexOf("zone=")!=-1){this.zoneLink=false}this.zoom=this.zoom||0;this.zone=this.zone||0;this.level=this.level==null?Mapper.zoneDefaultLevel[this.zone]||0:this.fixLevel(this.level,this.zone);this.phase=0;if(Mapper.zoneDefaultPhase){this.phase=Mapper.zoneDefaultPhase[this.zone]||0}this.pins=[];this.nCoords=0;this.tempWidth=null;this.tempHeight=null;this.parent.className="mapper";this.parent.appendChild(this.span=WH.ce("span",{className:"mapper-map"}));this.overlaySpan=i=WH.ce("div",{className:"mapper-overlay"});this.overlaySpan.appendChild(WH.ce("div",{className:"mapper-overlay-expander"}));this.span.appendChild(i);this.buttonDiv=i=WH.ce("div");i.style.position="absolute";i.style.top=i.style.right="3px";if(this.buttons){this.parent.appendChild(i)}if(this.editable){this.span.onmouseup=this.addPin.bind(this);i=WH.createTextGlow(WH.TERMS.clickmappins_tip);i.style.fontSize="13px";i.style.position="absolute";i.style.bottom=i.style.right="0";this.parent.appendChild(i)}else{this.sToggle=i=WH.createButton(WH.TERMS.hidepins_stc,null,{click:this.toggleShow.bind(this)});i.style["float"]="right";i.style.display="none";this.buttonDiv.appendChild(i)}if(this.zoomable){this.span.onclick=this.toggleZoom.bind(this);this.span.id="sjdhfkljawelis"+(this.unique!==undefined?this.unique:"");this.sZoom=i=WH.createTextGlow(WH.TERMS.clickmapzoom_tip,"mapper-zoomtip");i.style.fontSize="13px";i.style.position="absolute";i.style.bottom=i.style.right="0";this.span.appendChild(i)}this.sZoneLink=i=WH.createTextGlow("");i.style.display="none";i.style.position="absolute";i.style.top=i.style.left="0";this.parent.appendChild(i);if(this.mouse){this.parent.onmouseout=function(){this.timeout=setTimeout(function(){this.sMouse.style.display="none"}.bind(this),1)}.bind(this);this.parent.onmouseover=function(){clearTimeout(this.timeout);this.sMouse.style.display=""}.bind(this);this.span.onmousemove=this.updateMouseCoords.bind(this);this.span.onmousedown=this.updateMouseCoords.bind(this);this.sMouse=i=WH.createTextGlow("(0.0, 0.0)");i.style.display="none";i.style.position="absolute";i.style.bottom=i.style.left="0";i.onmouseup=WH.sp;this.span.appendChild(i)}this.floorPins={};if(e.coords!=null){this.setCoords(e.coords,this.level,e.uiMapId,e.uiMapName)}else{if(e.link!=null){this.setLink(e.link)}}if(e.objectives){this.setObjectives(e.objectives)}if(e.zoneparent&&e.zones){this.setZones(e.zoneparent,e.zones)}this.onlyPhases=false;if(Mapper.multiLevelZones.hasOwnProperty(this.zone)){this.onlyPhases=Mapper.multiLevelZones[this.zone].length==Mapper.multiLevelZones[this.zone].filter((function(e){return e.indexOf("_")!=-1})).length+1}this.updateMap(t)}Mapper.sizes=[[488,325,"normal"],[772,515,"zoom"],[1002,668,"original"],[224,149,"small"]];Mapper.zoneLevelOffset={};Mapper.multiLevelZones={};Mapper.zonePhased={};Mapper.garrisonLevelsToMapTiers={};Mapper.zoneDefaultLevel={};Mapper.remappedLevels={};Mapper.prototype={getMap:function(){return this.parent},update:function(e,t){if(e.zoom!=null){this.zoom=e.zoom}if(e.zone!=null){this.zone=e.zone}if(e.show!=null){this.show=e.show}this.pins=[];this.nCoords=0;for(var i in this.floorPins){if(this.floorPins[i].parentNode){WH.de(this.floorPins[i])}}this.floorPins={};if(this.floorButton){WH.de(this.floorButton);this.floorButton=null}var a=e.level===undefined?0:this.fixLevel(parseInt(e.level),this.zone);if(!e.preservelevel){this.level=a}else{a=this.level}var n=WH.isSet("g_mapperData")?g_mapperData:false;if(n&&n[this.zone]&&!e.coords){var s=n[this.zone];var r=-1;for(var i in s){if(!s.hasOwnProperty(i)){continue}var o=this.fixLevel(parseInt(i),this.zone);if(e.level===undefined&&s[i].count>r){a=parseInt(o);r=s[i].count}if(s[i].coords){this.setCoords(s[i].coords,o,s[i].uiMapId,s[i].uiMapName)}}this.level=a;if(this.floorPins[this.level]){WH.ae(this.span,this.floorPins[this.level])}}else{if(e.coords!=null){var l=999;for(var i in e.coords){if(!e.coords.hasOwnProperty(i)){continue}var o=this.fixLevel(parseInt(i),this.zone);this.setCoords(e.coords[i],o,e.uiMapId,e.uiMapName);if(o<l){l=o}}if(l!=999&&!e.preservelevel){this.level=l}if(this.floorPins[this.level]){WH.ae(this.span,this.floorPins[this.level])}}else{if(e.link!=null){this.setLink(e.link)}}}this.updateMap(t)},fixLevel:function(e,t){if(Mapper.remappedLevels[t]&&Mapper.remappedLevels[t].hasOwnProperty(e)){return Mapper.remappedLevels[t][e]}if(Mapper.multiLevelZones.hasOwnProperty(t)){var i=parseInt(Mapper.multiLevelZones[t][0].substr((""+t).length+1));var a;for(var n=1;n<Mapper.multiLevelZones[t].length;n++){a=parseInt(Mapper.multiLevelZones[t][n].substr((""+t).length+1));if(Math.abs(e-a)<Math.abs(e-i)){i=a}}return i}return e},getZone:function(){return this.zone},setZone:function(e,t,i){this.pins=[];this.nCoords=0;if(this.floorPins[this.level]){WH.de(this.floorPins[this.level])}this.floorPins={};if(this.floorButton){WH.de(this.floorButton);this.floorButton=null}this.zone=e;this.level=t||0;this.updateMap(i);return true},getFloorsMenu:function(){if(!Mapper.multiLevelZones[this.zone]){return null}var e=[];var t=Mapper.multiLevelZones[this.zone];var i=Mapper.zonePhased[this.zone]?g_zone_phases:g_zone_areas;var a=function(e){return e[Menu.ITEM_CRUMB]==this.mapName||this.level===undefined&&e[Menu.ITEM_CRUMB]==0}.bind(this);var n,s,r;for(var o=0;s=t[o];o++){var l=0;var c=s.indexOf("-");var u=s.indexOf("_");if(c<0){n=o}else if(u>=0){n=s.substring(c+1,u);l=s.substr(u+1)}else{n=s.substr(c+1)}var d=this.getMapDisplayName(s,this.zone,n,l);r=[s,d,this.setMap.bind(this,s,n,l,true)];r[Menu.ITEM_OPTIONS]={checkedFunc:a};e.push(r)}return e},getMapDisplayName:function(e,t,i,a){var n="";var s;if(Mapper.zonePhased[t]&&g_zone_phases[t]){var r=Mapper.multiLevelZones[t].indexOf(e);if(g_zone_phases[t].hasOwnProperty(r)){s=g_zone_phases[t][r]}}if(g_zone_areas[t]&&g_zone_areas[t].hasOwnProperty(i)){n=g_zone_areas[t][i]}else if(g_zone_playerconditions[t]&&g_zone_playerconditions[t].hasOwnProperty(a)){n=g_zone_playerconditions[t][a]}else if(s){n=s}else{if(this.onlyPhases){n=WH.Strings.sprintf(WH.TERMS.zonePhase_format,a)}else if(Mapper.multiLevelZones[t].filter((function(e){return e.indexOf("-"+i+"_")!=-1})).length+(i==0?1:0)>1){n=WH.Strings.sprintf(WH.TERMS.zoneLevelPhase_format,i,a)}else{n=WH.Strings.sprintf(WH.TERMS.zoneLevel_format,i)}}return n},setMap:function(e,t,i,a){if(t!=this.level){if(this.floorPins[this.level]){WH.de(this.floorPins[this.level])}if(this.floorPins[t]){WH.ae(this.span,this.floorPins[t])}this.level=t}this.mapName=e;this.phase=i;this.span.style.background="url("+WH.staticUrl+this.rootMapDir+"/"+this.localeDir+"/"+Mapper.sizes[this.zoom][2]+"/"+e+".jpg?"+WH.getDataBuild()+")";if(this.overlay){this.overlaySpan.style.background="url("+WH.staticUrl+this.rootMapDir+"/overlay/"+Mapper.sizes[this.zoom][2]+"/"+e+".png?"+WH.getDataBuild()+")"}if(this.sZoneLink&&!this.noZoneName){var n="";var s=parseInt(this.zone);var r=WH.Wow.Area.getName(s)!=null;var o=Mapper.zonePhased[this.zone]?g_zone_phases:g_zone_areas;if(r){if(this.zoneLink){n+=WH.ce("a",{href:"/zone="+s},WH.ct(WH.Wow.Area.getName(s))).outerHTML}if(Mapper.multiLevelZones[s]){if(this.zoneLink){n+=": "}n+=this.getMapDisplayName(e,s,t,i)}WH.setInnerHtml(this.sZoneLink,n,"div");if(this.zoneLink){for(var l=0;l<9;++l){if(l==4){continue}this.sZoneLink.childNodes[l].firstChild.style.color="black"}}}this.sZoneLink.style.display=r?"":"none"}if(a){this.onMapUpdate&&this.onMapUpdate(this)}},setObjectives:function(e){var t={start:1,end:1,startend:1,sourcestart:1,sourceend:1};for(var i in e){var a=e[i];if(g_mapperData[i]===undefined){g_mapperData[i]={}}for(var n in a.levels){var s=a.levels[n];var r=ShowOnMap.combinePins(s);var o=r[0];g_mapperData[i][n]={count:o.length,coords:[]};for(var l=0;l<o.length;++l){var c=ShowOnMap.buildTooltip(o[l].list);g_mapperData[i][n].coords.push([o[l].coord[0],o[l].coord[1],{type:c[1],url:c[2],menu:c[3],label:c[0]}])}}}},setZones:function(e,t){e=$("#"+e);if(!e||!t||t.length==0||!this.objectives){return}var i=function(e,i,a,n){var s=[false,-1];for(var r=0;r<a.length;++r){if(r>0){d.append(r==a.length-1?WH.TERMS.and_lc:WH.TERMS.comma_punct)}var o=null;if(e.objectives[a[r][0]].mappable>0){o=$("<a/>",{href:"javascript:",text:e.objectives[a[r][0]].zone});o.click(function(t,i){e.update({zone:i});WH.setSelectedLink(t,"mapper")}.bind(e,o[0],a[r][0]));o.isLink=true}else{o=$("<a/>",{href:"/zone="+a[r][0],text:e.objectives[a[r][0]].zone});WH.Tooltip.simple(o[0],WH.TERMS.zonelink_tip,"q")}if(t.length>1){var l=n[a[r][0]];if(l.start&&l.end){o.addClass("icontiny");o.css("background-image","url("+WH.staticUrl+"/images/wow/icons/tiny/quest_startend.gif)");o.css("padding-left","20px")}else{if(l.start){o.addClass("icontiny");o.css("background-image","url("+WH.staticUrl+"/images/wow/icons/tiny/quest_start.gif)");o.css("padding-left","14px")}else{if(l.end){o.addClass("icontiny");o.css("background-image","url("+WH.staticUrl+"/images/wow/icons/tiny/quest_end.gif)");o.css("padding-left","16px")}}}}i.append(o);if(a[r][1]>s[1]){s=[o,a[r][1]]}}return s[0]};var a=function(e,t,i){var a=[];for(var n=0;n<e.length;++n){if(t[e[n][0]][i]){a.push(e[n])}}return a};var n={};var s={start:[],end:[],objective:[]};for(var r in this.objectives){if(n[r]===undefined){n[r]={}}var o=this.objectives[r];for(var l in o.levels){var c=o.levels[l];for(var u=0;u<c.length;++u){if(c[u].point=="start"||c[u].point=="sourcestart"){s.start.push(r);n[r].start=true}else{if(c[u].point=="end"||c[u].point=="sourceend"){s.end.push(r);n[r].end=true}else{if(c[u].point=="requirement"||c[u].point=="sourcerequirement"){s.objective.push(r);n[r].objective=true}}}}}}e.append(WH.getMajorHeading(WH.TERMS.relevantlocations,2,3));if(t.length==1&&this.missing==0){var d=$("<span/>",{html:WH.TERMS.questobjectives1zone_tip.replace("$$","<b>"+this.objectives[t[0][0]].zone+"</b>.")});e.append(d);this.update({zone:t[0][0]})}else{if(this.missing>0){var f=function(e,t){if(e.length!=t.length){return false}var i={};for(var a=e.length;a>=0;--a){i[e[a]]=true}for(var n=t.length;n>=0;--n){if(i[t[n]]===undefined){return false}}return true};var d=$("<span/>");var h=false,p=false,m=false;s.objective=WH.arrayUnique(s.objective);s.start=WH.arrayUnique(s.start);s.end=WH.arrayUnique(s.end);var g=s.start.length>0&&f(s.start,s.end);var H=s.start.length>0&&f(s.start,s.objective);var W=s.end.length>0&&f(s.end,s.objective);var v=a(t,n,"objective");var _=a(t,n,"start");var T=a(t,n,"end");let r=WH.getPageData("mapper.objectiveTerms");let o;switch(true){case!!(g&&H):o=WH.TERMS.partofquesthappensin_format.split("$$");d.text(o[0]);h=i(this,d,t,n);d.append(o[1]);break;case!!(g&&s.objective.length==0):o=r.sex.split("$$");d.text(o[0]);h=i(this,d,t,n);d.append(o[1]);break;case!!g:o=r.ox_sey.split("$$");d.text(o[0]);h=i(this,d,_,n);d.append(o[1]);p=i(this,d,v,n);d.append(o[2]);break;case!!(H&&s.end.length==0):o=r.osx.split("$$");d.text(o[0]);h=i(this,d,t,n);d.append(o[1]);break;case!!H:o=r.osx_ey.split("$$");d.text(o[0]);h=i(this,d,v,n);d.append(o[1]);p=i(this,d,T,n);d.append(o[2]);break;case!!(W&&s.start.length==0):o=r.oex.split("$$");d.text(o[0]);h=i(this,d,t,n);d.append(o[1]);break;case!!W:o=r.oex_sy.split("$$");d.text(o[0]);h=i(this,d,_,n);d.append(o[1]);p=i(this,d,v,n);d.append(o[2]);break;case!!(s.start.length>0&&s.end.length>0&&s.objective.length>0):o=r.ox_sy_ez.split("$$");d.text(o[0]);h=i(this,d,_,n);d.append(o[1]);p=i(this,d,v,n);d.append(o[2]);m=i(this,d,T,n);d.append(o[3]);break;case!!(s.start.length>0&&s.end.length>0):o=r.sx_ey.split("$$");d.text(o[0]);h=i(this,d,_,n);d.append(o[1]);p=i(this,d,T,n);d.append(o[2]);break;case!!(s.start.length>0&&s.objective.length>0):o=r.ox_sy.split("$$");d.text(o[0]);h=i(this,d,_,n);d.append(o[1]);p=i(this,d,v,n);d.append(o[2]);break;case!!(s.end.length>0&&s.objective.length>0):o=r.ox_ey.split("$$");d.text(o[0]);h=i(this,d,v,n);d.append(o[1]);p=i(this,d,T,n);d.append(o[2]);break;case s.start.length>0:o=r.sx.split("$$");d.text(o[0]);h=i(this,d,t,n);d.append(o[1]);break;case s.end.length>0:o=r.ex.split("$$");d.text(o[0]);h=i(this,d,t,n);d.append(o[1]);break;case s.objective.length>0:o=r.ox.split("$$");d.text(o[0]);h=i(this,d,t,n);d.append(o[1]);break;default:o=WH.TERMS.partofquesthappensin_format.split("$$");d.text(o[0]);h=i(this,d,t,n);d.append(o[1]);break}e.append(d);if(h&&h.isLink){h.click()}else{if(p&&p.isLink){p.click()}else{if(m&&m.isLink){m.click()}}}}else{var b=WH.TERMS.partofquesthappensin_format.split("$$");var d=$("<span/>",{text:b[0]});var h=i(this,d,t,n);d.append(b[1]);e.append(d);if(h&&h.isLink){h.click()}}}},setSize:function(e,t){this.tempWidth=e;this.tempHeight=t;this.updateMap(true)},getZoom:function(){return this.zoom},setZoom:function(e,t){this.zoom=e;this.tempWidth=this.tempHeight=null;this.updateMap(t)},toggleZoom:function(e){this.zoom=1-this.zoom;this.zoom++;this.updateMap(true);if(e){this.updateMouseCoords(e)}if(this.sZoom){if(this.sZoom.style.display=="none"){this.sZoom.style.display=""}else{this.sZoom.style.display="none"}}if(this.zoom){var t=Platform.getViewportSize();if(t.width>=900){MapViewer.show({mapper:this,zoom:this.zoom})}}},getShow:function(){return this.show},setShow:function(e){this.show=e;var t=this.show?"":"none";for(var i in this.floorPins){this.floorPins[i].style.display=t}this.sToggle.innerHTML=this.show?WH.TERMS.hidepins_stc:WH.TERMS.showpins_stc},toggleShow:function(){this.setShow(!this.show)},getCoords:function(){var e=[];for(var t in this.pins){if(!this.pins[t].free){e.push([this.pins[t].x,this.pins[t].y])}}return e},clearPins:function(){for(var e in this.pins){this.pins[e].style.display="none";this.pins[e].free=true}},setCoords:function(e,t,i,a){var n;var s,r;if(t===undefined){this.clearPins();if(e.length){r=true;s=0}else{for(let t in e){s=t;break}if(s==null){return}e=e[s]}s=parseInt(s);if(!r){s=this.fixLevel(s,this.zone);this.level=s}}else{s=t;if(!e.length){e=e[s]&&e[s].length?e[s]:[]}}this.nCoords=e.length;i=i||this.uiMapId;a=a||this.uiMapName;for(let t in e){var o=e[t],l=o[2];if(o[0]===undefined||o[1]===undefined){continue}if(o[0]===null||o[1]===null){var c=this.parent.id?this.parent.id.replace(/^mapper-parent-/,""):this.parent;if(WH.Wow.Area.getName(c)){c=WH.Wow.Area.getName(c)}WH.error("Bad coordinates for",c,"-- Pin Coords:",o);continue}n=this.getPin(s);n.x=o[0];n.y=o[1];n.style.left=n.x+"%";n.style.top=n.y+"%";let r=false;if(this.editable&&!(l&&l.locked)){n.a.onmouseup=this.delPin.bind(this,n);r=true}else{if(l&&l.url){n.a.href=WH.markup.getFixedUrl(l.url);n.a.rel="np"+(l.rel?"&"+l.rel:"");n.a.style.cursor="pointer";r=true}}if(l&&l.tooltip){n.a.tt="";var u=false;for(var d in l.tooltip){if(n.a.tt!=""){n.a.tt+="<br />"}n.a.tt+='<b class="q">'+d+"</b> ($)<br />";for(var f in l.tooltip[d].info){n.a.tt+="<div>"+l.tooltip[d].info[f]+"</div>"}if(!u&&l.tooltip[d].footer){n.a.tt+=l.tooltip[d].footer+"<br />";u=true}}}else{if(l&&l.label){n.a.tt=l.label}else{if(l&&l.fixTooltip){n.a.rel=n.a.rel.replace(/^np&?/,"");WH.dE(n.a,"mouseover",this.pinOver);WH.dE(n.a,"mouseout",WH.Tooltip.hide);n.a.tt="";if(typeof l.fixTooltip=="function"){n.a._fixTooltip=l.fixTooltip}}else{n.a.tt="$";if(!r){WH.dE(n.a,"mouseover",this.pinOver);let e={getAllCoords:function(){let e=[];WH.qsa("div.pin a",this.floorPins[s]).forEach((function(t){if(typeof t.tt==="string"){e.push(t.tt.split(", "))}}));return e}.bind(this)};if(i){e.uiMapId=i}if(a){e.uiMapName=a}if(this.name){e.name=this.name}WH.Wow.UiMap.clickToCopyCoordinates(n.a,function(){return this.tt.split(", ")}.bind(n.a),e)}}}}if(l&&l.menu){n.a.menu=l.menu;Menu.add(n.a,n.a.menu,{showAtCursor:true})}if(l&&l.type){n.className+=" pin-"+l.type}if(l&&l.mapicon){n.className+=" pin-object";n.a.style.backgroundPosition=(l.mapicon+2)%8*-16+"px "+Math.floor((l.mapicon+2)/8)*-16+"px"}n.a.tt=WH.stringReplace(n.a.tt,"$",n.x.toFixed(1)+", "+n.y.toFixed(1));if(l&&l.lines){for(var h=0,p=l.lines.length;h<p;++h){if(o[0]==l.lines[h][0]&&o[1]==l.lines[h][1]){continue}for(var m=0,g=Mapper.sizes.length;m<g;++m){var H=Mapper.sizes[m];n=this.line(o[0]*H[0]/100,o[1]*H[1]/100,l.lines[h][0]*H[0]/100,l.lines[h][1]*H[1]/100,l.type);n.className+=" "+H[2];WH.ae(this.floorPins[s],n)}}}if(l&&l.dataset){WH.cO(n.dataset,l.dataset)}}this.onPinUpdate&&this.onPinUpdate(this)},getLink:function(){var e="";for(var t in this.pins){if(!this.pins[t].free&&this.pins[t].floor==this.level){e+=(this.pins[t].x<10?"0":"")+(this.pins[t].x<1?"0":"")+(this.pins[t].x*10).toFixed(0)+(this.pins[t].y<10?"0":"")+(this.pins[t].y<1?"0":"")+(this.pins[t].y*10).toFixed(0)}}return(this.zone?this.zone:"")+(Mapper.multiLevelZones[this.zone]&&this.level!=0?"."+this.level:"")+(e?":"+e:"")},setLink:function(e,t,i){var a=[];e=e.split(":");var n=e[0];var s=0;if(n.indexOf(".")!=-1){var r=n.split(".");n=r[0];s=parseInt(r[1])}s=i&&i!=-1&&!s?i:s;if(!this.setZone(n,s,t)){return false}if(e.length==2){for(var o=0;o<e[1].length;o+=6){var l=e[1].substr(o,3)/10;var c=e[1].substr(o+3,3)/10;if(isNaN(l)||isNaN(c)){break}a.push([l,c])}}this.setCoords(a,s);return true},updateMap:function(e){this.parent.style.width=this.span.style.maxWidth=(this.tempWidth?this.tempWidth:Mapper.sizes[this.zoom][0])+"px";this.span.style.maxHeight=(this.tempHeight?this.tempHeight:Mapper.sizes[this.zoom][1])+"px";this.parent.setAttribute("data-mapsize",Mapper.sizes[this.zoom][2]);if(!this.editable){this.parent.style.cssFloat=this.parent.style.styleFloat="left"}if(this.zone=="0"){this.span.style.background="black"}else{var t=this.level;var i=this.phase;var a=this.zone+(t?"-"+t:"");if(Mapper.multiLevelZones[this.zone]&&Mapper.multiLevelZones[this.zone][t]){a=Mapper.multiLevelZones[this.zone][t];if(i!=0){a+="_"+i}}else if(Mapper.garrisonLevelsToMapTiers[this.zone]&&Mapper.garrisonLevelsToMapTiers[this.zone][t]){a=this.zone+"__"+Mapper.garrisonLevelsToMapTiers[this.zone][t]}this.setMap(a,t,i);if(!this.floorButton&&Mapper.multiLevelZones[this.zone]){var n;this.floorButton=n=WH.createButton(Mapper.zonePhased[this.zone]?WH.TERMS.changephase_ellipsis:WH.TERMS.changefloor_ellipsis);n.menu=this.getFloorsMenu();if(n.menu&&n.menu.length){Menu.add(n,n.menu,{showAtElement:true})}n.style["float"]="right";this.buttonDiv.appendChild(n)}else{if(this.floorButton){this.floorButton.style.display=Mapper.multiLevelZones[this.zone]?"":"none"}}}if(this.sToggle){this.sToggle.style.display=this.toggle&&this.nCoords?"":"none"}$(".line",this.floorPins[t]).hide();$(".line."+Mapper.sizes[this.zoom][2],this.floorPins[t]).show();this.onMapUpdate&&this.onMapUpdate(this)},cleanPin:function(e,t){var i=this.pins[e];i.style.display="";i.free=false;i.className="pin";for(var a in i.dataset){if(i.dataset.hasOwnProperty(a)){delete i.dataset[a]}}i.a.onmousedown=WH.rf;i.a.onmouseup=WH.rf;i.a.href="javascript:";i.a.style.cursor="default";i.floor=t;return i},getPin:function(e){for(var t=0;t<this.pins.length;++t){if(this.pins[t].free){return this.cleanPin(t,e)}}var i=WH.ce("div"),a=WH.ce("a");i.className="pin";i.appendChild(a);i.a=a;i.floor=e;WH.aE(a,"mouseover",this.pinOver);WH.aE(a,"mouseout",WH.Tooltip.hide);a.onclick=WH.sp;this.pins.push(i);this.cleanPin(this.pins.length-1,e);if(!this.floorPins[e]){this.floorPins[e]=WH.ce("div");this.floorPins[e].style.display=this.show?"":"none";if(e==this.level){WH.ae(this.span,this.floorPins[e])}}WH.ae(this.floorPins[e],i);return i},addPin:function(e){if(!WH.isLeftClick(e)){return}this.updateMouseCoords(e);let t=this.getPin(this.level);t.x=this.mouseX;t.y=this.mouseY;t.style.left=t.x.toFixed(1)+"%";t.style.top=t.y.toFixed(1)+"%";t.a.onmouseup=this.delPin.bind(this,t);t.a.tt=t.x.toFixed(1)+", "+t.y.toFixed(1);this.onPinUpdate&&this.onPinUpdate(this);return false},delPin:function(e,t){e.style.display="none";e.free=true;WH.sp(t);WH.Tooltip.hide();this.onPinUpdate&&this.onPinUpdate(this)},pinOver:function(){WH.Tooltip.show(this,this.tt,4,0)},updateMouseCoords:function(e){let t=WH.getOffset(this.parent);let i=WH.getScroll();this.mouseX=Math.floor((e.clientX+i.x-t.left-3)/Mapper.sizes[this.zoom][0]*1e3)/10;this.mouseY=Math.floor((e.clientY+i.y-t.top-3)/Mapper.sizes[this.zoom][1]*1e3)/10;if(this.mouseX<0){this.mouseX=0}else{if(this.mouseX>100){this.mouseX=100}}if(this.mouseY<0){this.mouseY=0}else{if(this.mouseY>100){this.mouseY=100}}if(this.mouse){WH.setTextNodes(this.sMouse,"("+this.mouseX.toFixed(1)+", "+this.mouseY.toFixed(1)+")")}},line:function(e,t,i,a,n){var s=Math.min(e,i);var r=Math.max(e,i);var o=Math.min(t,a);var l=Math.max(t,a);var c=r-s;var u=l-o;var d=Math.sqrt(Math.pow(c,2)+Math.pow(u,2));var f=Math.atan2(u,c);var h=$('<span class="line" />').css({top:o.toFixed(2)+"px",left:s.toFixed(2)+"px",width:c.toFixed(2)+"px",height:u.toFixed(2)+"px"}).append($("<var />").css({width:d.toFixed(2)+"px",transform:"rotate("+f+"rad)"}));if(!(e==s&&t==o)&&!(i==s&&a==o)){h.addClass("flipped")}if(n!=null){h.addClass("line-"+n)}return h[0]}};var g_zone_areas={};window.MapViewer=new function(){const e=WH.DOM;const t={desiredScale:undefined,elements:{aCover:undefined,container:undefined,mapDiv:undefined,placeholder:undefined,screen:undefined,temporaryParent:undefined,oldParent:undefined},imageWidth:undefined,imageHeight:undefined,mapper:undefined,oldOnClick:undefined,oldOnUpdate:undefined,scale:undefined,zoom:undefined};this.checkPound=function(){if(location.hash&&location.hash.startsWith("#map")){let e=location.hash.split("=");if(e.length===2){let t=e[1];if(t){MapViewer.show({link:t})}}else{e=location.hash.split(":");let i=WH.ge("sjdhfkljawelis");if(i){i.onclick()}if(e.length===2){if(!i){MapViewer.show({link:e[1]})}let a=e[1].split(".");let n={zone:a[0]};if(a.length===2){n.level=parseInt(a[1])+1}t.mapper.update(n)}}}};this.getZoom=function(){if(typeof t.zoom==="number"){return t.zoom}return 1};this.show=function(e){t.zoom=e.zoom;WH.Track.interactiveEvent("Zone Maps","Show",e.link?e.link:"General");if(e.link){t.elements.temporaryParent=WH.ce("div",{id:"fewuiojfdksl"});WH.ae(document.body,t.elements.temporaryParent);let i=new Mapper({parent:t.elements.temporaryParent.id});i.setLink(e.link,true);i.toggleZoom()}else Lightbox.show("mapviewer",{onShow:s,onHide:n,onResize:o.bind(self,true)},e)};function i(){let e="#map";if(t.elements.temporaryParent){e+="="+t.mapper.getLink()}else if(Mapper.zoneDefaultLevel[t.mapper.zone]){if(Mapper.zoneDefaultLevel[t.mapper.zone]!==t.mapper.level){e+=a(t.mapper)}}else if(t.mapper.level!==0){e+=a(t.mapper)}else if((!window.g_mapperData||!g_mapperData[t.mapper.zone])&&(!window.g_mapper_data||!g_mapper_data[t.mapper.zone])){e+=a(t.mapper)}return e}function a(e){let t=":"+e.zone;if(e.level){t+="."+e.level}return t}function n(){t.mapper.span.onclick=t.oldOnClick||null;t.mapper.onMapUpdate=t.oldOnUpdate||null;t.mapper.span.style.cursor="";t.oldOnClick=null;t.oldOnUpdate=null;if(!t.elements.temporaryParent){WH.de(t.mapper.parent);t.mapper.parent.style.borderWidth="";t.mapper.parent.style.marginTop="";if(t.elements.placeholder){if(!t.elements.placeholder.parentNode){return}t.elements.oldParent.insertBefore(t.mapper.parent,t.elements.placeholder)}else{WH.ae(t.elements.oldParent,t.mapper.parent)}WH.de(t.elements.placeholder);t.elements.oldParent=null}else{WH.de(t.elements.temporaryParent);t.elements.temporaryParent=null}t.mapper.toggleZoom();if(location.hash.indexOf("#show")===-1){WH.clearHash()}else if(window.mapShowObject){mapShowObject.onCollapse()}}function s(e,i,a){t.mapper=a.mapper;t.elements.container=e;if(i){e.classList.add("mapviewer");t.elements.screen=WH.ce("div",{className:"lightbox-content mapviewer-screen",style:{height:Mapper.sizes[MapViewer.getZoom()][1]+"px",width:Mapper.sizes[MapViewer.getZoom()][0]+"px"}});t.elements.aCover=WH.ce("a",{className:"mapviewer-cover",href:"javascript:"});WH.aE(t.elements.aCover,"click",Lightbox.hide);let i=WH.ce("span");let a=WH.ce("b");WH.ae(a,WH.ct(WH.TERMS.close));WH.ae(i,a);WH.ae(t.elements.aCover,i);WH.ae(t.elements.screen,t.elements.aCover);t.elements.mapDiv=WH.ce("div");WH.ae(t.elements.screen,t.elements.mapDiv);WH.ae(e,t.elements.screen);let n=WH.ce("a",{className:"dialog-option fa fa-times",href:"javascript:"});WH.aE(n,"click",Lightbox.hide);WH.ae(n,WH.ct(WH.TERMS.close));WH.ae(e,n)}o()}function r(){if(t.oldOnUpdate){t.oldOnUpdate(t.mapper)}location.replace(i())}function o(e=false){if(e&&t.scale===t.desiredScale&&window.innerHeight>t.elements.container.offsetHeight){return}t.elements.container.style.visibility="hidden";l();if(!e){if(!t.elements.placeholder){t.elements.placeholder=WH.ce("div",{style:{height:"325px",padding:"3px",marginTop:"10px"}})}t.mapper.parent.style.borderWidth="0px";t.mapper.parent.style.marginTop="0px";t.mapper.span.style.cursor="pointer";if(t.mapper.span.onclick){t.oldOnClick=t.mapper.span.onclick}t.mapper.span.onclick=Lightbox.hide;if(t.mapper.onMapUpdate){t.oldOnUpdate=t.mapper.onMapUpdate}t.mapper.onMapUpdate=r;if(!t.elements.temporaryParent){t.elements.oldParent=t.mapper.parent.parentNode;t.elements.oldParent.insertBefore(t.elements.placeholder,t.mapper.parent);WH.de(t.mapper.parent);WH.ae(t.elements.mapDiv,t.mapper.parent)}else{WH.de(t.elements.temporaryParent);WH.ae(t.elements.mapDiv,t.elements.temporaryParent)}if(!location.hash.includes("#show")){location.replace(i())}else if(window.mapShowObject){mapShowObject.onExpand()}}Lightbox.reveal();t.elements.container.style.visibility="visible"}function l(){t.desiredScale=1;t.scale=1;if(t.desiredScale>1){t.desiredScale=1}if(t.scale>1){t.scale=1}t.imageWidth=Math.round(t.scale*Mapper.sizes[MapViewer.getZoom()][0]);t.imageHeight=Math.round(t.scale*Mapper.sizes[MapViewer.getZoom()][1]);if(t.elements.screen){WH.de(".mapviewer-screen-sizer",t.elements.screen);let i=WH.ce("div",{className:"mapviewer-screen-sizer"});e.setRelativeHeight(i,t.imageWidth,t.imageHeight);WH.ae(t.elements.screen,i)}let i=Math.max(480,t.imageWidth);Lightbox.setSize(i+Lightbox.UI_WIDTH)}WH.onLoad(this.checkPound)};WH.markup=new function(){this.MODE={COMMENT:1,ARTICLE:2,QUICK_FACTS:3,SIGNATURE:4,REPLY:5};this.CLASS={ADMIN:40,STAFF:30,PREMIUM:20,USER:10,PENDING:1};this.modes={[this.MODE.COMMENT]:"comment",[this.MODE.REPLY]:"reply",[this.MODE.ARTICLE]:"article",[this.MODE.QUICK_FACTS]:"quickfacts",[this.MODE.SIGNATURE]:"signature"};this.globalAttributes={id:{req:false,valid:/^[a-z0-9_-]+$/i},title:{req:false,valid:/[\S ]+/},class:{req:false,valid:/\S+/}};this.regex={cssUnitOrInt:/\d+(%|px|em)?/,domain:/^((www|classic|tbc|bc|ptr|beta|mop|wod|legion|bfa|shadowlands|sl|d2)$|((ko|fr|de|cn|es|ru|pt|it)($|\.(classic|tbc|ptr|beta|shadowlands|sl|d2)$)))/,isInt:/^[0-9]+$/,intCsv:/^[0-9,]+$/,noWhitespace:/^\S+$/,subdomainEnv:{PTR:/(^|\.)ptr\./,BETA:/(^|\.)(?:beta|shadowlands|sl|bfa|legion|wod|mop)\./}};const e=["about-us-team-tables","guide-51","guide-53","guide-61","guide-block-nav","guide-brewfest","guide-children","guide-classes","guide-foundry","guide-hallows","guide-highmaul","guide-hub","guide-irontide","guide-love","guide-lunar","guide-mop","guide-moplaunch","guide-noblegarden","guide-orgrimmar","guide-pilgrim","guide-role","guide-summer","guide-theramore","guide-thunderking","guide-transmog","guide-winter","guide-wodlaunch"];let t="abc";let i;let a;this.mode=this.MODE.ARTICLE;this.allow=this.CLASS.STAFF;this.root=undefined;this.dbPage=false;this.isPreview=false;this.inNewsType=0;this.mediaUid=t;this.tags={};this.initialized=false;this.disabledEnvironments={BETA:false,PTR:false};this.blockTags={};this.postTags=[];this.collectTags={};this.excludeTags={};this.tooltipTags={};this.tooltipTagsWithRawText={};this.applyCommonAttributes=function(e,t){if(WH.markup.allow<this.CLASS.STAFF){return}if(t.id){e.id=t.id}if(t.title){e.title=t.title}if(t["class"]){if(e.className){e.className+=" "+t["class"]}else{e.className=t["class"]}}if(t.style){var i=e.getAttribute("style");if(i){e.setAttribute("style",i+"; "+t.style)}else{e.setAttribute("style",t.style)}}if(t["data-highlight"]){e.setAttribute("data-highlight",t["data-highlight"])}};this.getTagByEntityType=function(e){if(!e){return null}let t=WH.Types.getRequiredTrees(e);if(t&&!t.includes(WH.getDataTree())){return null}for(var i in WH.markup.tags){if(WH.markup.tags.hasOwnProperty(i)&&WH.markup.tags[i].entityType===e){return i}}return null};this.init=function(){if(this.initialized){return}var e=[],t=[],i=[];for(var a in WH.markup.tags){if(!WH.markup.tags.hasOwnProperty(a)){continue}if(WH.markup.tags[a].block){WH.markup.blockTags[a]=true}if(WH.markup.tags[a].exclude){for(var n in WH.markup.tags[a].exclude){if(!WH.markup.tags[a].exclude.hasOwnProperty(n)){continue}if(!this.excludeTags[n]){this.excludeTags[n]={}}this.excludeTags[n][a]=WH.markup.tags[a].exclude[n]}}if(WH.markup.tags[a].post){this.postTags.push(a)}if(WH.markup.tags[a].trim){i.push(a)}if(WH.markup.tags[a].ltrim){e.push(a)}if(WH.markup.tags[a].rtrim){t.push(a)}}if(e.length>0){this.ltrimRegex=new RegExp("\\s*\\[("+e.join("|")+")([^a-z0-9]+.*)?]","ig")}if(t.length>0){this.rtrimRegex=new RegExp("\\[/("+t.join("|")+")\\]\\s*","ig")}if(i.length>0){this.trimRegex=new RegExp("\\s*\\[("+i.join("|")+")([^\\[]*)?\\]\\s*","ig")}this.initialized=true;$((function(){$("body").delegate("[data-highlight]","mouseenter",(function(){var e=$(this).attr("data-highlight").split(":");if(e.length!=2){return}var t=$("#"+e[0]).get(0),i=parseInt(e[1]),a=$(t).val();if(!t||!i||!a){return}var n=$(t).val(a.substr(0,i))[0].scrollHeight;$(t).val(a).animate({scrollTop:n},250);t.selectionStart=i;t.selectionEnd=i}))}))};this.assembleDomNode=function(e,t){if(e===null){return document.createDocumentFragment()}if(!(e instanceof Node)){WH.Track.nonInteractiveEvent("Markup","Legacy HTML",JSON.stringify(e));if(g_user.roles&U_GROUP_ADMIN&&!this.convertToDomNodeWarned){this.convertToDomNodeWarned=true;alert("Some markup on this page returned something other than a node!")}let t=document.createDocumentFragment();t.appendChild(WH.ct(e));return t}if(t){let i;if(e instanceof Element&&e.dataset.markupContentTarget){i=e}else if(e.querySelector&&e.querySelector("[data-markup-content-target]")){i=e.querySelector("[data-markup-content-target]")}else{i=e;while(i.hasChildNodes()&&i.firstChild instanceof Element){i=i.firstChild}}i.appendChild(t)}return e};this.getDatabaseDomainInfo=function(e){var t=function(e){var t={};e=(e||"").split(".");if(e.length>2){WH.warn("Markup trying to parse long domain",e)}var i=e.length?e[e.length-1]:"";if(i){if(new RegExp("^"+WH.Url.getBetaSubdomain()+"$").test(i)){t.dataEnv=WH.dataEnv.BETA}else{for(var a in WH.dataEnv){if(!WH.dataEnv.hasOwnProperty(a)||!WH.dataEnvKey.hasOwnProperty(WH.dataEnv[a])){continue}if(new RegExp("^"+WH.dataEnvKey[WH.dataEnv[a]]+"$").test(i)){t.dataEnv=WH.dataEnv[a];break}if(i==="bc"){t.dataEnv=WH.dataEnv.TBC;break}}}}var n=e[0];if(n){if(WH.getLocaleFromDomain.L.hasOwnProperty(n)){t.locale=WH.getLocaleFromDomain.L[n]}else if(n==="www"){t.locale=LOCALE_ENUS}if(!t.hasOwnProperty("dataEnv")){t.dataEnv=WH.dataEnv.MAIN}}return t};var n=t(e.domain||e.site);var s=n.locale;if(s===undefined&&a!==undefined){s=a}if(s===null){s=Locale.getId()}var r=n.dataEnv||i||WH.getDataEnv();if(r===WH.dataEnv.PTR&&WH.markup.disabledEnvironments.PTR){r=WH.dataEnv.MAIN}if(r===WH.dataEnv.BETA&&WH.markup.disabledEnvironments.BETA){r=WH.dataEnv.MAIN}let o=Locale.getDataEnvForcedLocale(r);if(o!==undefined){s=o}var l=WH.Url.getSubdomain(r,s);var c={host:WH.Url.generate("",{subdomain:l}).replace(/\/$/,""),nameKey:"name_"+Locale.getName(s),subdomain:l||"www",dataEnv:r,localeId:s};return c};this.getEscapedHtml=function(e){e=e.replace(/&nbsp;/g,WH.Strings.nbsp).replace(/&ndash;/g,"–").replace(/&mdash;/g,"—");return WH.Strings.escapeHtml(e)};this.getFixedUrl=function(e){if(!e){return""}var t=e.charAt(0);if(t==="/"&&e.charAt(1)!=="/"||t==="?"){e=e.replace(/^[\/\?]+/,"");e="/"+e}return e};this.getDomFragment=function(t,i){if(!i){i={}}if(!i.allow){if(i.roles){i.allow=this.rolesToClass(i.roles)}else{i.allow=this.CLASS.STAFF}}try{var a=n(t,i);var s=a.toNode()}catch(e){var s=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error!"));WH.ae(s,WH.ce("br"));WH.ae(s,WH.ct(e));WH.error(e)}if(s.querySelector("."+e.join(",."))){e.filter((function(e){return!!s.querySelector("."+e)})).forEach((function(t){let i=WH.staticUrl+"/css/"+WH.Theme.getThemePath()+"markup/"+t+".css";if(WH.PageMeta.scriptVersionQueryString){i+="?"+WH.PageMeta.scriptVersionQueryString}WH.ae(document.head,WH.ce("link",{rel:"stylesheet",type:"text/css",href:i}));let a=e.indexOf(t);if(a>=0){e.splice(a,1)}}))}if(i.prepend){$(s).prepend($.parseHTML(i.prepend))}if(i.append){$(s).append($.parseHTML(i.append))}return s};this.getMarkupFromHtml=function(e,t){var i=e.replace(/\n+/g,"");i=i.replace(/\s+/g," ");i=i.replace(/> </g,"><");i=i.replace(/&amp;/gi,"&");i=i.replace(/(&#160;|$nbsp;)/gi," ");for(var a in WH.markup.tags){if(WH.markup.tags.hasOwnProperty(a)&&WH.markup.tags[a].fromHtml){i=WH.markup.tags[a].fromHtml(i,t)}}i=i.replace(/<style\b[\s\S]*?>[\s\S]*?<\/style>/g,"");i=i.replace(/<\/?[a-z][a-z0-9]*\b[\s\S]*?>/g," ");i=i.replace(/<!--(.*?)-->/g,"");i=i.replace(/\n[\n]+/g,"\n\n");i=i.replace(/[ ]+/g," ");i=i.replace(/\t/g,"  ");return WH.trim(i)};this.insertEntityTag=function(e,t,i){let a=prompt(WH.term("enterEntityId_format",t));if(a!=null){WH.insertTag(e,"["+i+"="+(parseInt(a)||0)+"]")}};this.isUrlExternal=function(e){if(!e){return false}var t=WH.ce("a");t.href=e;return!(!t.hostname||/(^|\.)wowhead\.com$/.test(t.hostname))};this.isUrlSafe=function(e,t){if(!e){return true}if(e==="javascript:"){return true}var i=e.match(/^([^:\\./]+):/i);if(i&&i[1]){var a=i[1];if(a==="http"||a==="https"){return true}if(t&&(a==="mailto"||a==="irc")){return true}return false}return true};this.matchOuterTags=function(e,t,i,a){var n=a.indexOf("g")>-1,s=a.replace(/g/g,""),r=new RegExp(t+"|"+i,"g"+s),o=new RegExp(t,s),l=[],c,u,d,f;do{c=0;while(d=r.exec(e)){if(o.test(d[0])){if(!c++){u=r.lastIndex;f=d}}else if(c){if(!--c){l.push([e.slice(u,d.index),f[0],d[0]]);if(!n){return l}}}}}while(c&&(r.lastIndex=u));return l.length?l:false};this.printHtml=function(e,t,i){var a=WH.ge(t);if(i&&i.removeTableTags){e=e.replace(/\[\/?(td|tr|table)[^\]]*]/g,"")}$(a).empty().append(WH.markup.getDomFragment(e,i));if($(a).find("div.full-tweet").length&&typeof twttr==="object"&&twttr.hasOwnProperty("widgets")){twttr.widgets.load(a)}};this.rolesToClass=function(e){if(e&(U_GROUP_ADMIN|U_GROUP_VIP|U_GROUP_DEV)){return this.CLASS.ADMIN}else if(e&U_GROUP_STAFF){return this.CLASS.STAFF}else if(e&U_GROUP_PREMIUM){return this.CLASS.PREMIUM}else if(e&U_GROUP_PENDING){return this.CLASS.PENDING}else{return this.CLASS.USER}};this.setDataEnv=function(e){switch(e){case WH.dataEnvKey[WH.dataEnv.PTR]:i=WH.markup.disabledEnvironments.PTR?WH.dataEnv.MAIN:WH.dataEnv.PTR;break;case WH.dataEnvKey[WH.dataEnv.BETA]:case WH.Url.getBetaSubdomain():i=WH.markup.disabledEnvironments.BETA?WH.dataEnv.MAIN:WH.dataEnv.BETA;break;case WH.dataEnvKey[WH.dataEnv.CLASSIC]:i=WH.dataEnv.CLASSIC;break;case"bc":case WH.dataEnvKey[WH.dataEnv.TBC]:i=WH.dataEnv.TBC;break;default:i=WH.dataEnv.MAIN}};this.stripTags=function(e,t){let i=n(e,t);return i.toHtml()};function n(e,n){a=undefined;if(n&&n.hasOwnProperty("locale")){a=n.locale}var s=(e||"").replace(/\r/g,"");if(!n)n={};if(!n.skipReset){WH.markup.mediaUid=n.uid||t;WH.markup.root=n.root;WH.markup.isPreview=n.isPreview||false;WH.markup.dbPage=n.dbPage||false;i=WH.getDataEnv();if(Locale.getDataEnvForcedLocale(i)!==undefined){a=Locale.getDataEnvForcedLocale(i)}WH.markup.disabledEnvironments={BETA:(!WH.isBetaActive()||n.disabledEnvironments&&n.disabledEnvironments.beta)&&!WH.isBeta(),PTR:(!WH.isPtrActive()||n.disabledEnvironments&&n.disabledEnvironments.ptr)&&!WH.isPtr()};if(WH.markup.mediaUid!=t){g_screenshots[WH.markup.mediaUid]=[]}}if(n.roles&&n.roles&(U_GROUP_ADMIN|U_GROUP_EDITOR|U_GROUP_MOD|U_GROUP_BUREAU|U_GROUP_DEV|U_GROUP_BLOGGER)&&n.mode!=WH.markup.MODE.SIGNATURE){n.mode=WH.markup.MODE.ARTICLE}WH.markup.mode=n.mode||WH.markup.MODE.ARTICLE;WH.markup.allow=n.allow||WH.markup.CLASS.STAFF;WH.markup.inNewsType=n.inNewsType?n.inNewsType:0;if(n.stopAtBreak){var r=s.indexOf("[break]");if(r!=-1){s=s.substring(0,r)}}else{s=s.replace("[break]","")}var o=new WH.markup.Tree;s=s.trim();if(WH.markup.postTags.length){for(var l in WH.markup.postTags){var c=WH.markup.postTags[l];if(s.indexOf("["+c)!=-1){if(!(WH.markup.tags[c].allowedModes&&WH.markup.tags[c].allowedModes[WH.markup.modes[n.mode]]==undefined)){for(var u in WH.markup.tags[c].collect){WH.markup.collectTags[u]=true}}}}}s=s.replace(/\n(\s*)\n/g,"\n\n");var d=s.length;var f=0,h=0,p=-1,m=-1,g=true,H=false;var W=function(e){var t,i,a;if(e.charAt(0)=='"'||e.charAt(0)=="'"){t=e.charAt(0);var n=e.indexOf(t,1);if(n>-1){a=e.substring(1,n);e=e.substring(n+1).trim();return{value:a,str:e}}}i=e.indexOf(" ");if(i>-1){a=e.substring(0,i);e=e.substring(i+1).trim()}else{a=e;e=""}return{value:a,str:e}};var v=/^\s*[a-z0-9-]+\s*=/;while(h<d){p=s.indexOf("[",h);if(p>-1){h=p+1;if(p>0&&s.charAt(p-1)=="\\"){g=false;p=-1}else{m=s.indexOf("]",h)}}else{h=d}var _,T={};if(n.highlight&&$(n.highlight)){T["data-highlight"]=n.highlight+":"+p}if(m>-1){var b=s.substring(p+1,m);if(b.charAt(0)=="/"){H=true;_=b.substr(1).trim().toLowerCase()}if(!H){var E=b.indexOf(" "),y=b.indexOf("=");var S;if((y<E||E==-1)&&y>-1){_=b.substring(0,y).toLowerCase();b=b.substring(y+1).trim();var w=W(b);b=w.str;if(WH.markup.tags[_]==undefined||WH.markup.tags[_].attr==undefined||WH.markup.tags[_].attr.unnamed==undefined){g=false}else{T.unnamed=w.value}}else if(E>-1){_=b.substring(0,E).toLowerCase();b=b.substring(E+1).trim();if(b.indexOf("=")==-1){if(WH.markup.tags[_]==undefined||WH.markup.tags[_].attr==undefined||WH.markup.tags[_].attr.unnamed==undefined){g=false}else{T.unnamed=b}b=""}}else{_=b.toLowerCase();b=""}if(WH.markup.tags[_]==undefined){g=false}else if(g){var c=WH.markup.tags[_];while(b!=""){var I="";if(!v.test(b)){I="unnamed"}else{y=b.indexOf("=");if(y==-1){g=false;break}I=b.substring(0,y).trim().toLowerCase();b=b.substring(y+1).trim()}var w=W(b);b=w.str;if(c.attr==undefined||c.attr[I]==undefined){if(WH.markup.globalAttributes[I]==undefined||WH.markup.globalAttributes[I].valid!=undefined&&!WH.markup.globalAttributes[I].valid.test(w.value)){g=false;break}}T[I]=w.value}if(g&&c.attr){for(var N in c.attr){if(c.attr[N].req&&T[N]==undefined){g=false;break}else if(T[N]==undefined){continue}if(c.attr[N].valid!=undefined&&!c.attr[N].valid.test(T[N])){g=false;break}}if(g&&c.validate!=undefined){g=c.validate(T)}}}}else if(WH.markup.tags[_]==undefined){g=false}}else{g=false}if(g){if(f!=p){var R=s.substring(f,p).replace(/\\\[/g,"[");var M={_rawText:R};o.openTag("<text>",M)}if(H){g=o.closeTag(_)}else{g=o.openTag(_,T)}if(g){f=h=m+1}else{f=p}}g=true;H=false;p=m=-1}if(f<d){var R=s.substr(f).replace(/\\\[/g,"[");var M={_rawText:R};o.openTag("<text>",M)}return o}};WH.markup.tags.artifactcalc={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},toNode:function(){return null}};WH.markup.tags["azerite-finder"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{class:{req:true,valid:/.+/},spec:{req:false,valid:/.+/},selectmultiple:{req:false,valid:/^true|false$/},showtiers:{req:false,valid:/^true|false$/},spells:{req:false,valid:/^\d+(,\d+){0,19}$/}},callbacks:[],toNode:function(e){let t=WH.ce("div",{className:"clear azerite-finder-markup-parent",style:{display:"none"}});let i=function(){let i={embed:WH.Strings.guid(),class:e["class"]};if(e.spec){i.spec=e.spec}if(e.selectmultiple){i.multiselect=e.selectmultiple==="true"?1:0}if(e.showtiers){i.showtier=e.showtiers==="true"?1:0}if(e.spells){i.spellids=e.spells}$(t).load("/azerite-finder?"+WH.Url.buildQuery(i))};if(!WH.Wow.AzeriteFinder){this.callbacks.push(i);if(this.callbacks.length===1){WH.loadAssets("azerite-finder",(function(){let e;while(e=WH.markup.tags["azerite-finder"].callbacks.shift()){e()}}))}}else{i()}return t}};WH.markup.tags["blizzconline-giveaway"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(){let e=false;return function(){if(!e){$.getScript("https://widget.gleamjs.io/e.js");e=true}return WH.ce("a",{className:"e-widget no-button",href:"https://gleam.io/nsPDV/wowheads-blizzconline-giveaway",rel:"nofollow"},WH.ct("Wowhead's BlizzConline 2021 Giveaway"))}}()};WH.markup.tags["bloodmallet-chart"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{axiscolor:{req:false,valid:/.+/},azeritetier:{req:false,valid:/.+/},backgroundcolor:{req:false,valid:/.+/},class:{req:true,valid:/.+/},chartmode:{req:false,valid:/.+/},corruptionrepresentation:{req:false,valid:/.+/},covenant:{req:false,valid:/.+/},entries:{req:false,valid:/^\d+$/},fontcolor:{req:false,valid:/.+/},fightstyle:{req:false,valid:/.+/},spec:{req:true,valid:/.+/},type:{req:false,valid:/.+/}},toNode:function(e){WH.Tools.Highcharts.loadScript((function(){clearTimeout(WH.markup.tags["bloodmallet-chart"].loadScriptsTimeout);WH.markup.tags["bloodmallet-chart"].loadScriptsTimeout=setTimeout(WH.Tools.Bloodmallet.loadCharts,0)}));var t=WH.ce("div",{className:"bloodmallet_chart",textContent:WH.TERMS.loading_ellipsis,id:WH.Strings.guid()});t.setAttribute("data-wow-class",e["class"].replace("-","_"));t.setAttribute("data-wow-spec",e.spec.replace("-","_"));if(!e["backgroundcolor"]){e["backgroundcolor"]="#242424"}if(!e["axiscolor"]){e["axiscolor"]=WH.Wow.Item.getQualityColor(WH.Wow.Item.QUALITY_POOR)}if(!e["fontcolor"]){e["fontcolor"]="#ccc"}var i={axiscolor:"axis-color",azeritetier:"azerite-tier",backgroundcolor:"background-color",chartmode:"chart-mode",corruptionrepresentation:"corruption-representation",covenant:"covenant",entries:"entries",fontcolor:"font-color",fightstyle:"fight-style",type:"type"};for(var a in i){if(e[a]){t.setAttribute("data-"+i[a],e[a].replace("-","_"))}}return t}};WH.markup.tags.bluetweet={empty:true,ltrim:true,attr:{id:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){if(g_bluetweets[e.id]&&g_bluetweets[e.id].id){return WH.createTweetDiv(g_bluetweets[e.id])}return WH.ce("a",{href:"https://twitter.com/wowheadtweets/status/"+e.id,className:"full-tweet"},WH.ct("Tweet #"+e.id))}};WH.markup.tags.chart={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{id:{req:true,valid:/^[0-9a-zA-Z-]+$/},type:{req:true,valid:/^barpercent|pie|rank|rankpercent$/},width:{req:false,valid:/^\d+$/},height:{req:false,valid:/^\d+$/},credits:{req:false,valid:/^profiler|none$/},sort:{req:false,valid:/^asc|desc$/}},toNode:function(e){var t;if(!g_charts.hasOwnProperty(e.id)){t=WH.ce("div",{className:"highchart "+e.type,style:{border:"1px solid #CCC"}},WH.ct("(Chart "+e.id+" not found)"));if(e.width){t.style.width=""+e.width+"px"}if(e.height){t.style.height=""+e.height+"px"}return t}var i=WH.markup.getDatabaseDomainInfo(e);var a=i.nameKey;var n={};if(!e.credits||e.credits=="profiler"){n.href="/list";n.text=WH.TERMS.poweredbyprofiler_tip}if(e.credits=="none"){n.enabled=false}switch(e.type){case"rank":case"rankpercent":var s=g_charts[e.id];var r=s[0].keyType;var o;var l;var c;var u;var d=[];for(var f in s[0].data){d.push(f)}d.sort((function(e,t){return WH.stringCompare(s[0].data[e],s[0].data[t])}));if(e.sort=="desc"){d.reverse()}else if(!e.sort){if(s[1].data){if(s[0].data[d[0]]/s[1].data>.5){d.reverse()}}}t=WH.ce("div",{style:{display:"inline-block"}});if(e.width){t.style.width=""+e.width+"px"}var h;var p;var m=WH.ce("ol");WH.ae(t,m);for(var g=0;g<d.length;g++){f=d[g];u=false;o=f;l="";c="";if(u=WH.Gatherer.get(s[0].keyType,parseInt(f,10),i.dataEnv)){o=u.hasOwnProperty(a)?u[a]:f;l=u.hasOwnProperty("quality")?u.quality:"";c=u.hasOwnProperty("icon")?u.icon:""}p=WH.ce("li");WH.ae(m,p);if(c){var H=document.createDocumentFragment();WH.ae(H,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+c+".gif",style:{verticalAlign:"middle"},loading:"lazy"}));WH.ae(H,WH.ct(WH.Strings.nbsp))}if(r){h=WH.ce("a",{href:WH.Entity.getPath(r,f),className:"q"+l+(c?" icontiny":"")})}else{h=WH.ce("span",{className:"q"+l})}WH.ae(p,h);if(c){WH.ae(h,H)}WH.ae(h,WH.ct(o));if(e.type=="rankpercent"&&s[1].data){WH.ae(p,WH.ct(" "));WH.ae(p,WH.ce("small",{className:"q0"},WH.ct(WH.sprintf(WH.TERMS._paren,(s[0].data[f]/s[1].data*100).toFixed(4)+"%"))))}}if(n.text){var W=WH.ce("div",{style:{position:"relative",top:"-12px",textAlign:"right",fontSize:"10px"}});WH.ae(t,W);if(n.href){h=WH.ce("a",{href:n.href,className:"q0"},WH.ct(n.text))}else{h=WH.ce("span",{className:"q0"},WH.ct(n.text))}WH.ae(W,h)}return t;break}if(!WH.isSet("g_highcharts")){WH.Tools.Highcharts.loadScript();g_highcharts={charts:[],divIndex:0,pending:undefined};g_highcharts.ShowCharts=function(e){if(e){g_highcharts.pending=undefined}else if(typeof g_highcharts.pending!="undefined"){return}var t=false;if(WH.isSet("Highcharts")){for(var i=0;i<g_highcharts.charts.length;i++){if(g_highcharts.charts[i].rendered){continue}if($(g_highcharts.charts[i].container).length==0){t=true;continue}$(g_highcharts.charts[i].container).highcharts(g_highcharts.charts[i].chart);g_highcharts.charts[i].rendered=true}}else{t=true}if(t){g_highcharts.pending=window.setTimeout(g_highcharts.ShowCharts,250,true);return}}}t=WH.ce("div",{className:"highcharts-wowhead-style highchart "+e.type});if(e.width){t.style.width=""+e.width+"px"}if(e.height){t.style.height=""+e.height+"px"}switch(e.type){case"barpercent":var s=g_charts[e.id];var v=s[0].keyType&&g_types.hasOwnProperty(s[0].keyType)?g_types[s[0].keyType]:false;var _={container:t,chart:{}};_.chart={credits:n,chart:{type:"bar",styledMode:true,plotBorderWidth:0,style:{fontFamily:"Open Sans"}},plotOptions:{bar:{borderWidth:0,dataLabels:{style:{textShadow:"none"}}}},xAxis:{categories:[]},yAxis:{min:0,max:100,title:{enabled:false}},legend:{enabled:false},title:{text:""},tooltip:{formatter:function(){var e=this.x+": "+this.y+"%";if(v){var t=v in g_completion?g_completion[v]:false;for(var i in g_user.lists){var a=g_user.lists[i];if(!(a.id in t)){continue}var n=WH.inArray(t[a.id],this.point.id)!=-1;e+='<br><span class="progress-icon '+(n?"progress-8":"progress-0")+'"></span> ';e+=a.character+" - "+a.realm+" "+a.region}}return e},useHTML:true},series:[{data:[],events:{click:function(t){if(g_charts[e.id][0].keyType){location.href=WH.Entity.getPath(g_charts[e.id][0].keyType,t.point.series.data[t.point.x].id)}}}}]};var T;var b=[];if(v&&WH.isSet("g_completion")&&g_completion.hasOwnProperty(v)&&g_user.hasOwnProperty("lists")&&g_user.lists&&g_user.lists.length){for(var g=0;g<g_user.lists.length;g++){T=""+g_user.lists[g].id;if(g_user.lists[g].pinned>0&&g_completion[v].hasOwnProperty(T)){b=g_completion[v][T];if(g_user.lists[g].pinned>1){break}}}}var E=[];for(var f in s[0].data){if(!s[0].data.hasOwnProperty(f)){continue}E.push({k:f,v:s[0].data[f]})}E.sort((function(e,t){return WH.stringCompare(t.v,e.v)}));if(e.sort=="asc"){E.reverse()}for(var g=0;g<E.length;g++){var y=E[g];var u=WH.Gatherer.get(s[0].keyType,y.k,i.dataEnv);u=u?u[a]:y.k;var S={id:y.k,y:Math.round(y.v/s[1].data*100)};if(b.indexOf(parseInt(S.id,10))!=-1){S.colorIndex=6}_.chart.xAxis.categories.push(u);_.chart.series[0].data.push(S)}g_highcharts.charts.push(_);break;case"pie":var _={container:t,chart:{}};_.chart={credits:n,chart:{type:"pie",styledMode:true,plotBorderWidth:0,style:{fontFamily:"Open Sans"}},plotOptions:{pie:{dataLabels:{style:{textShadow:"none"}}}},legend:{enabled:false},title:{text:""},tooltip:{formatter:function(){return this.point.name+": "+Math.round(this.y)+"%"}},series:[{data:[]}]};var s=g_charts[e.id];var E=[];var w=0;var I=true;var u;var N={};if(s[0].keyType==WH.Types.RACE){var N={24:WH.TERMS.neutral,25:WH.TERMS.alliance,26:WH.TERMS.horde};for(var R in N){if(N.hasOwnProperty(R)){N[R]=WH.TERMS.wordspace_punct+WH.TERMS.openparenthesis_punct+N[R]+WH.TERMS.closedparenthesis_punct}}}for(var f in s[0].data){if(!s[0].data.hasOwnProperty(f)){continue}w+=s[0].data[f];I&=!isNaN(f)&&f!="0";u=(WH.Gatherer.get(s[0].keyType,f,i.dataEnv)||{})[a]||f;u+=N[f]||"";E.push({k:f,keyName:u,v:s[0].data[f]})}if(!isNaN(s[1].data)&&w/s[1].data<.98){E.push({k:I?0:"Other",v:s[1].data-w})}if(g_gathered_types.hasOwnProperty(s[0].keyType)){E.sort((function(e,t){return WH.stringCompare(t.v,e.v)||WH.stringCompare(e.keyName,t.keyName)}))}else{E.sort((function(e,t){return WH.stringCompare(e.keyName,t.keyName)||WH.stringCompare(t.v,e.v)}))}for(var g=0;g<E.length;g++){var y=E[g];_.chart.series[0].data.push({id:y.k,name:y.keyName,y:y.v/s[1].data*100})}g_highcharts.charts.push(_);break;default:return WH.ce("div",{},WH.ct("(Chart type "+e.type+" unknown)"));break}g_highcharts.ShowCharts();return t}};WH.markup.tags.countdown={empty:true,attr:{bg:{req:true,valid:/^(https?:)?\/\/[^\/]+\/.+/},time:{req:true,valid:/^[A-Za-z0-9 :,-]+$/},text:{req:false,valid:/.*/},completion:{req:false,valid:/.*/},url:{req:false,valid:/^(https?:)?\/\/[^\/]+\/.+/}},toNode:function(e){var t=WH.ce("div");var i={element:t,bg:e.bg,completionText:e.completion,time:e.time};if(e.text){i.text=e.text}if(e.url){i.url=e.url}WH.countdownClock(i);return t}};WH.markup.tags["d2-skill-calc"]=function(){let e=[];return{empty:true,attr:{unnamed:{req:true,valid:/^[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true|false$/},order:{req:false,valid:/^true|false$/}},toNode:function(t){let i=WH.ce("div",{className:"diablo-2-skill-calc-markup"});let a={embedded:true,hash:t.unnamed,editable:t.editable==="true",order:t.order!=="false"};let n=function(){new WH.D2.SkillCalc(i,a)};if(!WH.D2.hasOwnProperty("SkillCalc")){e.push(n);if(e.length===1){WH.loadAssets("diablo-2-skill-calc",(function(){let t;while(t=e.shift()){t()}}))}}else{n()}return i}}}();WH.markup.tags["d2-tooltip"]=function(){let e=false;return{empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{float:{req:false,valid:/^(left|right)$/i},style:{req:false,valid:/^[^"<>]+$/}},toNode:function(t){let i=WH.ce("span",{className:"d2tt"});if(t["float"]){i.classList.add("markup-float-"+t["float"])}WH.markup.applyCommonAttributes(i,t);if(!e){WH.Layout.loadFont("Exocet");e=true}return i}}}();WH.markup.tags["dps-rankings"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[a-z0-9-]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){let t=WH.markup.getDatabaseDomainInfo(e);let i=WH.getDataTree(t.dataEnv);let a=WH.getPageData(["markup.dpsRankings",i,e.unnamed].join("."));return!!a},toNode:function(e){let t=WH.markup.getDatabaseDomainInfo(e);let i=WH.getDataTree(t.dataEnv);let a=i===WH.dataTree.CLASSIC?"classic.warcraftlogs.com":"www.warcraftlogs.com";let n=WH.getPageData(["markup.dpsRankings",i,e.unnamed].join("."));let s=n.data;let r=n.info;let o=document.createDocumentFragment();if(r){WH.ae(o,WH.ce("div",{style:{fontSize:"90%"}},WH.ct(r)))}var l=WH.ce("div",{className:"highchart bar highcharts-wowhead-style"});WH.ae(o,l);WH.Tools.Highcharts.loadScript((function(){var e={credits:{href:"https://"+a+"/",text:WH.TERMS.warcraftlogs_site},chart:{type:"bar",height:Math.max(400,Math.min(600,s.length*30)),styledMode:true,plotBorderWidth:0,style:{fontFamily:"Open Sans"}},plotOptions:{bar:{borderWidth:0,dataLabels:{style:{textShadow:"none"}}}},xAxis:{categories:[]},yAxis:{min:0,title:{enabled:false}},legend:{enabled:false},title:{text:""},tooltip:{formatter:function(){var e=Math.ceil(Math.min(2,Math.max(0,4-Math.log10(this.y))));var t=WH.ce("div");WH.ae(t,WH.ct(this.x+WH.TERMS.colon_punct));WH.ae(t,WH.ce("b",{},WH.ct(WH.Strings.formatNumber(this.y,false,e,e))));WH.ae(t,WH.ct(WH.TERMS.wordspace_punct+WH.GlobalStrings.DPS));return t.innerHTML},useHTML:true},series:[{data:[]}]};s.sort((function(e,t){return t.dps-e.dps}));for(var t,n=0;t=s[n];n++){var r=WH.Wow.PlayerClass.getName(t.classId);if(t.spec==="DPS"){r=WH.Strings.sprintf(WH.TERMS.dpsRoleClass_format,r)}else{r=WH.Strings.sprintf(WH.TERMS.specclass_format,i===WH.getDataTree()?WH.Wow.PlayerClass.Specialization.getName(t.specId):t.spec,r)}e.xAxis.categories.push(r);var o={id:r,y:t.dps,colorIndex:"c"+t.classId};e.series[0].data.push(o)}Highcharts.chart(l,e)}));return o}};WH.markup.tags["heart-of-azeroth-calc"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],counter:0,toNode:function(e){var t=WH.markup.getDatabaseDomainInfo(e);var i=WH.ce("div",{id:"markup-heart-of-azeroth-calc-"+this.counter++});var a=function(){new WH.Wow.HeartOfAzerothCalc(i,{embedded:true,hash:e.unnamed.replace(/^#+/,""),editable:e.editable=="true"})};if(!WH.Wow.HeartOfAzerothCalc){this.callbacks.push(a);if(this.callbacks.length==1){WH.loadAssets("heart-of-azeroth-calc",(function(){for(var e,t=0;e=WH.markup.tags["heart-of-azeroth-calc"].callbacks[t];t++){e()}}))}}else{a()}return i}};WH.markup.tags.galleryupload={empty:false,allowedClass:WH.markup.CLASS.ADMIN,attr:{unnamed:{req:true,valid:/^[0-9]+$/},submittext:{req:false,valid:/.+/}},toNode:function(e){var t="";var i=document.createDocumentFragment();var a=WH.ce("form",{method:"POST",action:"/gallery-upload",enctype:"multipart/form-data"});WH.aE(a,"submit",WH.markup.tags.galleryupload._validateForm.bind(null,a));WH.ae(i,a);WH.ae(i,WH.ce("div",{style:{display:"none"},dataset:{markupContentTarget:1}}));WH.ae(a,WH.ce("input",{type:"hidden",name:"gallery",value:e.unnamed}));WH.ae(a,WH.ce("input",{type:"hidden",name:"message",value:""}));WH.ae(a,WH.ce("input",{type:"hidden",name:"from",value:location.pathname+location.search}));WH.ae(a,WH.ce("input",{type:"file",name:"incoming",accept:".jpg,.jpeg,.png,image/jpeg,image/png",required:true}));WH.ae(a,WH.ct(" "));WH.ae(a,WH.ce("button",{type:"submit",className:"btn btn-primary"},WH.ct(e.submittext||WH.TERMS.submit)));return i},_validateForm:function(e){var t=3;var i=e.incoming;if(!i||i.value==""){return false}if(i.files&&i.files.length){if(i.files.length>1){alert("Too many files");return false}if(i.files[0].size>t*1048576){alert(WH.TERMS.filesizelimit_format.replace("%d",t).replace("&gt;",">"));return false}}e.message.value=e.nextSibling.textContent;return true}};WH.markup.tags["gear-planner"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],counter:0,toNode:function(e){var t=WH.markup.getDatabaseDomainInfo(e);if(!WH.isClassicTree()&&!WH.isTbcTree()){return WH.ce("div",{className:"q10"},WH.ct("[gear-planner] "+WH.TERMS.errorClassicOnly_tip))}let i=WH.isTbcTree()?"GearPlannerTbc":"GearPlanner";var a=WH.ce("div",{id:"markup-gear-planner-calc-"+this.counter++});var n=function(){new WH.Wow[i](a,{embedded:true,hash:e.unnamed.replace(/^#+/,""),editable:e.editable=="true"})};if(!WH.Wow[i]){this.callbacks.push(n);if(this.callbacks.length==1){WH.loadAssets("gear-planner",(function(){for(var e,t=0;e=WH.markup.tags["gear-planner"].callbacks[t];t++){e()}}))}}else{n()}return a}};WH.markup.tags["guide-content"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toNode:function(e){var t=document.createDocumentFragment();WH.ae(t,WH.ct("(Content from "));WH.ae(t,WH.ce("a",{href:"/guide="+e.unnamed},WH.ct("Guide #"+e.unnamed)));WH.ae(t,WH.ct(")"));return t}};WH.markup.tags["guild-rankings"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/[a-z-]+/},raid:{req:true,valid:/[a-z-]+/},difficulty:{req:false,valid:/(normal|heroic|mythic)/}},toNode:function(e){var t=document.createDocumentFragment();WH.ae(t,WH.ce("h3",{className:"heading-size-2 guild-boss-rankings-heading",dataset:{markupContentTarget:1}},WH.ce("a",{href:"https://raider.io/"},WH.ct("Powered by Raider.IO"))));var i;var a=WH.ce("tr");WH.ae(t,WH.ce("table",{className:"guild-boss-rankings"},a));var n=WH.Strings.slug(e.unnamed);var s=WH.Strings.slug(e.raid);var r=WH.Strings.slug(e.difficulty||"mythic");let o=s+"."+n+"."+r;for(var l=1;l<=3;l++){i=WH.ce("td");WH.ae(a,i);let e=WH.getPageData(["markup.guildRankings",o].join("."));if(e){let t=e[l-1];if(t){var c=t.realm.toLowerCase().replace(/[^a-z ]/,"").replace(" ","-");i.className="guild-boss-rankings-earned";WH.ae(i,WH.ce("div",{className:"guild-boss-rankings-"+t.faction},WH.ce("a",{href:"https://raider.io/guilds/"+t.region.toLowerCase()+"/"+c+"/"+t.name,target:"_blank"},WH.ct(t.name))));WH.ae(i,WH.ce("a",{href:"https://raider.io/"+s+"/realm-rankings/"+t.region.toLowerCase()+"/"+c+"/"+r,target:"_blank"},WH.ct("("+t.region+") "+t.realm)));continue}}switch(l){case 1:WH.st(i,"1st Place");break;case 2:WH.st(i,"2nd Place");break;case 3:WH.st(i,"3rd Place");break;default:WH.st(i,l+"th Place")}WH.ae(i,WH.ce("br"));WH.ae(i,WH.ct("Not Earned"))}return t},toText:function(e){var t=WH.Strings.slug(e.unnamed);var i=WH.Strings.slug(e.raid);var a=WH.Strings.slug(e.difficulty||"mythic");let n=i+"."+t+"."+a;var s="";for(var r=1;r<=3;r++){var o="";switch(r){case 1:o="1st";break;case 2:o="2nd";break;case 3:o="3rd";break;default:o=r+"th"}s+=o+" Place: ";let e=WH.getPageData(["markup.guildRankings",n].join("."));if(e){let t=e[r-1];if(t){s+=t.name+", ("+t.region+") "+t.realm+", "+WH.ucfirst(t.faction)+". ";continue}}s+="Not Earned. "}return e._textContents+": "+s}};WH.markup.tags.lightbox={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^map$/},zone:{req:false,valid:/^-?[0-9]+[a-z]?$/i},floor:{req:false,valid:/^[0-9]+$/},pins:{req:false,valid:/^[0-9]+$/}},validate:function(e){switch(e.unnamed){case"map":if(e.zone){return true}break}return false},toNode:function(e){var t=WH.ce("a");WH.markup.applyCommonAttributes(t,e);var i="";switch(e.unnamed){case"map":i="/maps?data="+e.zone;if(e.floor){i+="."+e.floor}if(e.pins){i+=":"+e.pins}var a=i.substr(6).replace("data=","");t.href=i;WH.aE(t,"click",(function(e){if(!WH.isLeftClick(e)){return true}MapViewer.show({link:a});e.preventDefault()}))}return t}};WH.markup.tags.listview={empty:true,attr:{id:{req:true,valid:/^\d+/},rows:{req:false,valid:/^\d+/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.ce("div");let i=WH.Gatherer.get(WH.Types.LISTVIEW,e.id);if(!i){t.className="error-message";WH.ae(t,WH.ct("Listview #"+e.id+" not found."));return t}if(i.template!=="db2-file-markup"){t.className="error-message";WH.ae(t,WH.ct("Listview #"+e.id+" uses unknown template: ["+i.template+"]."));return t}let a={id:WH.Strings.guid(),clickable:false,filtrable:true,hash:Listview.HASH_DISABLED,searchable:true,template:{noDebug:true,columns:[]},data:i.rows,parent:t,nItemsPerPage:e.rows,createNote:function(e,t){let a=[{label:"Product",option:WH.ct(i.product)},{label:"Build",option:WH.ct(i.build)},{label:"File",option:WH.ct(i.file)}];this.addOptions(a,{style:{minHeight:"39px"}})}};for(let e,t=0;e=i.cols[t];t++){a.template.columns.push({id:"col"+t,align:"left",compute:function(e,t,a,n){let s=t["col"+e];let r=WH.ct(s);if(i.cols[e].numeric){r=WH.ce("pre",{style:{display:"inline",margin:"0"}},r)}let o=t["col"+e+"icon"];if(o){if(r.nodeType!==Node.ELEMENT_NODE){r=WH.ce("span",{},r)}r.classList.add("icontiny");WH.aef(r,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+o+".gif",style:{paddingRight:"5px",verticalAlign:"middle"},loading:"lazy"}))}let l;if(l=i.cols[e].entityType){r=WH.ce("a",{href:WH.Url.generate(WH.Entity.getPath(l,s),{subdomain:i.subdomain})},r)}WH.ae(a,r);if(t.hotfixAdd){n.classList.add("new-row-2");WH.Tooltip.simple(a,"<i>New row via hotfix.</i>","q0")}else if(t.hotfixDelete){n.classList.add("deleted");WH.Tooltip.simple(a,"<i>Deleted row via hotfix.</i>","q0")}else if((t.changes||[])[e]){a.classList.add("changed-cell");WH.Tooltip.simple(a,WH.Strings.escapeHtml(t.changes[e]),"q0")}else if(t["new"]){n.classList.add("new-row");WH.Tooltip.simple(a,"<i>New row this build.</i>","q0")}}.bind(null,t),name:e.label||"[col"+t+"]",type:e.numeric?Listview.COLUMN_TYPE_NUMBER:Listview.COLUMN_TYPE_TEXT,value:"col"+t,pos:t,sortFunc:function(e,t,i){let a=t["col"+e];let n=i["col"+e];return WH.stringCompare(a,n)}.bind(null,t)})}new Listview(a);t.querySelector("div").className="listview";return t}};WH.markup.tags.map={empty:false,attr:{zone:{req:true,valid:/^-?[0-9a-z\-_]+$/i},floor:{req:false,valid:/^\d+/},source:{req:false,valid:/\S+/},legacy:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{pin:1},mapHits:0,toNode:function(e){let t=WH.markup.getDatabaseDomainInfo(e);var i=[];while(e._contents.hasChildNodes()){var a=e._contents.removeChild(e._contents.firstChild);i=i.concat(a.whMarkupInfo)}var n=document.createDocumentFragment();var s=WH.ce("div");WH.markup.applyCommonAttributes(s,e);WH.ae(n,s);WH.ae(n,WH.ce("div",{style:{clear:"left"}}));new Mapper({parent:s,unique:WH.markup.tags.map.mapHits++,zone:e.zone,coords:i?i:null,legacy:e.legacy||false,level:e.hasOwnProperty("floor")?e.floor:undefined,dataEnv:t.dataEnv});return n}};WH.markup.tags.pin={empty:false,attr:{url:{req:false,valid:/\S+/},type:{req:false,valid:/^[0-9]+$/},x:{req:true,valid:/^[0-9]{1,2}(\.[0-9])?$/},y:{req:true,valid:/^[0-9]{1,2}(\.[0-9])?$/},path:{req:false,valid:/^([0-9]{1,2}(\.[0-9])?[,:]?)+$/}},invisibleContent:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{map:1},toNode:function(e){if(e.url&&!WH.markup.isUrlSafe(e.url)){e.url=""}var t=e._contents;if(e.url&&e.url.indexOf("npc=")!=-1){var i=document.createDocumentFragment();WH.ae(i,WH.ce("b",{className:"q"},t));WH.ae(i,WH.ce("br"));WH.ae(i,WH.ce("span",{className:"q2"},WH.ct(WH.TERMS.clicktoviewthisnpc_stc)));t=i}if(e.url&&e.url.indexOf("/")<0&&e.url.indexOf("=")>=0){e.url="/"+e.url}var a=null;if(e.path){var n=e.path.split(":"),a=[];for(var s=0,r=n.length;s<r;++s){var o=n[s].split(",");if(o.length==2){a.push([parseFloat(o[0]||0),parseFloat(o[1]||0)])}}}var l=WH.ce("div");l.whMarkupInfo=[[parseFloat(e.x||0),parseFloat(e.y||0),{label:WH.ce("div",{},t).innerHTML,url:e.url,type:e.type,lines:a}]];return l}};WH.markup.tags.model={empty:false,attr:{item:{req:false,valid:/^[0-9]+$/},object:{req:false,valid:/^[0-9]+$/},npc:{req:false,valid:/^[0-9]+$/},itemset:{req:false,valid:/^[0-9,]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},border:{req:false,valid:/^[0-9]+$/},fileid:{req:false,valid:/^[0-9]+$/},float:{req:false,valid:/^(left|right)$/i},humanoid:{req:false,valid:/^1$/},img:{req:false,valid:/\S+/},label:{req:false,valid:/[\S ]+/},link:{req:false,valid:/\S+/},shadow:{req:false,valid:/^(true|false)$/},slot:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,skipSlots:{4:1,5:1,6:1,7:1,8:1,9:1,10:1,16:1,19:1,20:1},toNode:function(e){var t=WH.markup.getDatabaseDomainInfo(e);var i=WH.ce("a");var a;WH.markup.applyCommonAttributes(i,e);var n=false;if(e.npc){i.href="#modelviewer:"+WH.Types.NPC+":"+e.npc+":"+(e.humanoid?"1":"0");WH.aE(i,"click",(function(){var i={dataEnv:t.dataEnv,type:WH.Types.NPC,displayId:e.npc,slot:e.slot,displayAd:1,fromTag:1};if(e.humanoid){i.humanoid=1}if(e.link){i.link=e.link}if(e.label){i.label=e.label}if(e.fileid){i.fileId=e.fileid}WH.ModelViewer.showLightbox(i)}));var s={alt:e._contents.textContent,title:e._contents.textContent,src:e.img||WH.ModelViewer.getContentPath(t.dataEnv)+"thumbs/npc/"+e.npc+".png"};if(!e.img){s.width="150";s.height="150"}WH.ae(i,a=WH.ce("img",s));n=true}else if(e.object){i.href="#modelviewer:"+WH.Types.OBJECT+":"+e.object;WH.aE(i,"click",(function(){var i={dataEnv:t.dataEnv,type:WH.Types.OBJECT,displayId:e.object,displayAd:1,fromTag:1};if(e.link){i.link=e.link}if(e.label){i.label=e.label}if(e.fileid){i.fileId=e.fileid}WH.ModelViewer.showLightbox(i)}));var s={alt:e._contents.textContent,title:e._contents.textContent,src:e.img||WH.ModelViewer.getContentPath(t.dataEnv)+"thumbs/obj/"+e.object+".png"};if(!e.img){s.width="150";s.height="150"}WH.ae(i,a=WH.ce("img",s));n=true}else if(e.item&&e.slot){i.href="#modelviewer:"+WH.Types.ITEM+":"+e.item+":"+e.slot;WH.aE(i,"click",(function(){var i={dataEnv:t.dataEnv,type:WH.Types.ITEM,displayId:e.item,slot:e.slot,displayAd:1,fromTag:1};if(e.link){i.link=e.link}if(e.label){i.label=e.label}if(e.fileid){i.fileId=e.fileid}WH.ModelViewer.showLightbox(i)}));var s={alt:e._contents.textContent,title:e._contents.textContent,src:e.img||WH.Wow.Item.getThumbUrl(e.item,undefined,t.dataEnv)};if(!e.img){s.width="150";s.height="150"}WH.ae(i,a=WH.ce("img",s));n=true}else if(e.itemset){i.href="javascript:";WH.aE(i,"click",(function(){var i={dataEnv:t.dataEnv,type:WH.Types.ITEM_SET,equipList:e.itemset.split(","),displayAd:1,fromTag:1};if(e.link){i.link=e.link}if(e.label){i.label=e.label}if(e.fileid){i.fileId=e.fileid}WH.ModelViewer.showLightbox(i)}))}else if(e.fileid){i.href="javascript:";WH.aE(i,"click",(function(){var i={dataEnv:t.dataEnv,fileId:e.fileid,displayAd:1,fromTag:1};if(e.link){i.link=e.link}if(e.label){i.label=e.label}WH.ModelViewer.showLightbox(i)}));if(e.img){var s={alt:e._contents.textContent,title:e._contents.textContent,src:e.img};WH.ae(i,a=WH.ce("img",s));n=true}}else{var r=document.createDocumentFragment();WH.ae(r,WH.ct("[model]"));WH.ae(r,WH.ce("span",{dataset:{markupContentTarget:1}}));WH.ae(r,WH.ct("[/model]"));return r}if(a){if(e["float"]){a.classList.add("markup-float-"+e["float"])}if(e.border!==undefined){if(e.border==0){a.classList.add("no-border")}else{a.classList.add("border");a.style.borderWidth=""+e.border+"px"}}else{a.classList.add("content-image");if(e.shadow=="true"){a.classList.add("content-image-shadowed")}}a.loading="lazy"}while(n&&e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}return i}};WH.markup.tags.modelviewer=WH.markup.tags.model;WH.markup.tags["mythic-damage-calc"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[^\/][\/a-zA-Z0-9_-]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],toNode:function(e){let t=WH.ce("div");let i=function(){new WH.Wow.MythicDamageCalc(t,{embedded:true,hash:e.unnamed})};if(!WH.Wow.MythicDamageCalc){this.callbacks.push(i);if(this.callbacks.length===1){WH.loadAssets("mythic-damage-calc",(function(){let e;while(e=WH.markup.tags["mythic-damage-calc"].callbacks.shift()){e()}}))}}else{i()}return t}};WH.markup.tags["raid-bots-form"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^droptimizer|gear|talents|quick|stats$/}},toNode:function(e){return WH.Raidbots.createForm(e.unnamed)}};WH.markup.tags["reddit"]={empty:true,ltrim:true,attr:{unnamed:{req:true,valid:/\br\/[^\/]+\/comments\/[a-z0-9]+/},width:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.ce("div",{className:"reddit-markup"});let i=e.unnamed.match(/\br\/[^\/]+\/comments\/([a-z0-9]+)/)[1];WH.xhrJsonRequest("https://api.reddit.com/api/info?id=t3_"+i,(function(i){if(!i||!i.data||!i.data.children||!i.data.children[0]||!i.data.children[0].data||i.data.children[0].kind!=="t3"){WH.st(t,"Error: could not fetch Reddit post "+e.unnamed);t.classList.add("error-message");return}let a=i.data.children[0].data;WH.DOM.addScriptOnce("https://embed.redditmedia.com/widgets/platform.js",{async:true});let n=Math.min(Platform.getViewportWidth()-40,e.width||800);WH.ae(t,WH.ce("div",{className:"reddit-markup-container",style:{width:n+"px"}},WH.ce("blockquote",{className:"reddit-card"},WH.ce("a",{href:"https://www.reddit.com"+a.permalink}))))}));return t}};WH.markup.tags["reddit-video"]={empty:true,ltrim:true,attr:{unnamed:{req:true,valid:/\br\/[^\/]+\/comments\/[a-z0-9]+/},width:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.ce("div",{className:"reddit-markup"});let i=e.unnamed.match(/\br\/[^\/]+\/comments\/([a-z0-9]+)/)[1];WH.xhrJsonRequest("https://api.reddit.com/api/info?id=t3_"+i,(function(i){if(!i||!i.data||!i.data.children||!i.data.children[0]||!i.data.children[0].data||i.data.children[0].kind!=="t3"){WH.st(t,"Error: could not fetch Reddit post "+e.unnamed);t.classList.add("error-message");return}let a=i.data.children[0].data;let n=a.secure_media&&a.secure_media.reddit_video||a.preview&&a.preview.reddit_video_preview;if(!n||!n.fallback_url){WH.st(t,"Error: could not find any video in Reddit post "+e.unnamed);t.classList.add("error-message");return}WH.DOM.addScriptOnce("https://embed.redditmedia.com/widgets/platform.js",{async:true});let s=Math.min(Platform.getViewportWidth()-40,e.width||800,n.width);WH.ae(t,WH.ce("div",{className:"reddit-markup-container",style:{width:s+"px"}},WH.ce("blockquote",{className:"reddit-card"},WH.ce("a",{href:"https://www.reddit.com"+a.permalink}))))}));return t}};WH.markup.tags.regexreplace={empty:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{"guide-content":1},attr:{unnamed:{req:true,valid:/^[^a-z\\].+[^a-z\\]$/},with:{req:true,valid:/^.*$/}},toNode:function(e){var t=document.createDocumentFragment();WH.ae(t,WH.ct(" "));var i=WH.ce("span",{className:"q0"});WH.ae(t,i);WH.ae(i,WH.ct('Regex Replacing: "'));WH.ae(i,WH.ce("b",{},WH.ct(e.unnamed)));WH.ae(i,WH.ct('" With: "'));WH.ae(i,WH.ce("b",{},WH.ct(e["with"])));WH.ae(i,WH.ct('"'));return t}};WH.markup.tags.replace={empty:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{"guide-content":1},attr:{unnamed:{req:true,valid:/^.+$/},with:{req:true,valid:/^.*$/}},toNode:function(e){var t=document.createDocumentFragment();WH.ae(t,WH.ct(" "));var i=WH.ce("span",{className:"q0"});WH.ae(t,i);WH.ae(i,WH.ct('Replacing: "'));WH.ae(i,WH.ce("b",{},WH.ct(e.unnamed)));WH.ae(i,WH.ct('" With: "'));WH.ae(i,WH.ce("b",{},WH.ct(e["with"])));WH.ae(i,WH.ct('"'));return t}};WH.markup.tags.screenshot={empty:false,attr:{id:{req:false,valid:/^[0-9]+$/},url:{req:false,valid:/\S+/},thumb:{req:false,valid:/\S+/},size:{req:false,valid:/^(thumb|small|resized|normal)$/i},width:{req:false,valid:/^[0-9]+$/},height:{req:false,valid:/^[0-9]+$/},float:{req:false,valid:/^(left|right)$/i},border:{req:false,valid:/^[0-9]+$/},shadow:{req:false,valid:/^(true|false)$/}},invisibleContent:true,allowedClass:WH.markup.CLASS.STAFF,validate:function(e){if(e.url&&!e.thumb){return false}else if(!e.id&&!e.url){return false}return true},toNode:function(e){var t=[];var i=[];var a="javascript:";var n="";var s={};if(e.id){s=WH.Gatherer.get(WH.Types.SCREENSHOT,e.id)||{};a=WH.getScreenshotUrl(e.id,"normal",{description:e.title,imageType:s.imageType});var r=e.id;if(e.thumb&&e.thumb.match(/^[0-9]+$/)){r=e.thumb;e.thumb=null}n=WH.getScreenshotUrl(r,e.size||"thumb",{description:e.title,imageType:s.imageType})}else if(e.url){a=e.url}if(e.thumb){n=e.thumb}if(!g_screenshots[WH.markup.mediaUid]){g_screenshots[WH.markup.mediaUid]=[]}var o=WH.ce("a",{href:a});WH.markup.applyCommonAttributes(o,e);WH.aE(o,"click",function(e,t,i){if(!WH.isLeftClick(i)){return}ScreenshotViewer.show({screenshots:e,pos:t});i.preventDefault()}.bind(null,""+WH.markup.mediaUid,g_screenshots[WH.markup.mediaUid].length));var l=WH.ce("img");WH.ae(o,l);if(e.size&&e.width){l.width=e.width}if(e.size&&e.height){l.height=e.height}l.src=WH.Url.addMaxSizeParams(n,{height:l.height,width:l.width});l.loading="lazy";if(e.border!==undefined){if(e.border==0){l.classList.add("no-border")}else{l.classList.add("border");l.style.borderWidth=""+e.border+"px"}}else{l.classList.add("content-image");if(e.shadow=="true"){l.classList.add("content-image-shadowed")}}if(e["float"]){l.classList.add("markup-float-"+e["float"])}l.alt=e.title||"";var c={caption:e.title,width:e.size?null:e.width,height:e.size?null:e.height,noMarkup:true};if(e.id){c.id=e.id;c.imageType=s.imageType}else{c.url=e.url}g_screenshots[WH.markup.mediaUid].push(c);return o}};WH.markup.tags["google-sheet"]={empty:true,attr:{unnamed:{req:true,valid:/^[a-zA-Z0-9_-]+$/}},libraryLoaded:false,toNode:function(e){var t=WH.Strings.guid();var i=e.unnamed;var a=document.createDocumentFragment();WH.ae(a,WH.ce("img",{src:WH.staticUrl+"/images/icons/ajax-medium-242424.gif",style:{margin:"0 5px 0 0",position:"relative",top:"-1px",verticalAlign:"middle",width:"16px"}}));WH.ae(a,WH.ct(WH.TERMS.loading_ellipsis));var n=WH.ce("div",{id:t},a);n.dataset.loading=1;if(!WH.markup.tags["google-sheet"].libraryLoaded){$.getScript("https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.3.4/tabletop.min.js");WH.markup.tags["google-sheet"].libraryLoaded=true}setTimeout(WH.markup.tags["google-sheet"].fetchSheet.bind(null,n,i),0);return n},fetchSheet:function(e,t){if(typeof Tabletop==="undefined"){setTimeout(WH.markup.tags["google-sheet"].fetchSheet.bind(null,e,t),50);return}Tabletop.init({key:t,callback:WH.markup.tags["google-sheet"].renderSheet.bind(null,e,t),simpleSheet:true});setTimeout(function(e,t){if(e.dataset.loading){WH.markup.tags["google-sheet"].renderError(e,t)}}.bind(null,e,t),5e3)},renderError:function(e,t){var i=document.createDocumentFragment();WH.ae(i,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(i,WH.ct(WH.Strings.nbsp+" "+WH.TERMS.googlesheeterror_tip));WH.ae(i,WH.ce("a",{href:"https://docs.google.com/spreadsheets/d/"+t,target:"_blank"},WH.ct(t)));delete e.dataset.loading;$(e).empty().append(i)},renderSheet:function(e,t,i,a){if(!a||!a.model_names||!a.model_names.length||!a.models||!a.models[a.model_names[0]]){WH.markup.tags["google-sheet"].renderError(e,t);return}var n={columns:[],searchable:true,filtrable:true,clickable:false};var s=a.models[a.model_names[0]].column_names;for(var r=0;r<s.length;r++){var o=s[r];if(!o){continue}n.columns.push({id:WH.Strings.slug(o),name:WH.deUrlize(o),type:"text",align:i[0][o].length>10?"left":"center",compute:function(e,t,i,a){if(t[e].length<=10){var n=WH.ce("span",{className:"no-wrap"});WH.st(n,t[e]);WH.ae(i,n)}else{WH.st(i,t[e])}}.bind(null,o),getVisibleText:function(e,t){return t[e]}.bind(null,o),sortFunc:function(e,t,i){return WH.stringCompare(t[e],i[e])}.bind(null,o)})}Listview.templates[e.id]=n;delete e.dataset.loading;e.className="listview";WH.ee(e);new Listview({template:e.id,id:e.id,parent:e.id,data:i})}};WH.markup.tags["soulbind-calc"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[^\/][\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],toNode:function(e){let t=WH.markup.getDatabaseDomainInfo(e);let i=WH.ce("div");let a=function(){new WH.Wow.SoulbindCalc(i,{embedded:true,hash:e.unnamed,editable:e.editable==="true",dataEnv:t.dataEnv})};if(!WH.Wow.SoulbindCalc){this.callbacks.push(a);if(this.callbacks.length===1){WH.loadAssets("soulbind-calc",(function(){let e;while(e=WH.markup.tags["soulbind-calc"].callbacks.shift()){e()}}))}}else{a()}return i}};WH.markup.tags["survey-covenants"]={empty:true,attr:{background:{req:false,valid:/^false$/},class:{req:false,valid:/^.+$/},spec:{req:false,valid:/^.+$/},date:{req:false,valid:/^\d{4}-\d\d-\d\d$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){const t=WH.Gatherer;const i=WH.Strings;const a=WH.WarcraftLogs;let n=i.slug(e["class"]||"",true);let s=i.slug(e.spec||"",true);let r=[n,s].filter((function(e){return!!e})).join(".");if(e.date){r+="/"+e.date}let o=t.get(WH.Types.SURVEY_COVENANTS,r);if(!o){let e=WH.ce("div");WH.ae(e,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(e,WH.ct(i.nbsp+" "+WH.TERMS.notenoughdata));return e}let l=WH.ce("div",{className:"top-covenants"});if(e.background==="false"){l.classList.add("no-background")}let c=WH.ce("div");WH.ae(l,c);let u=0;o.data.sort((function(e,i){return WH.stringCompare(t.getName(WH.Types.COVENANT,e.id),t.getName(WH.Types.COVENANT,i.id))}));for(let e=0,n;n=o.data[e];e++){let e=t.get(WH.Types.COVENANT,n.id);let s=i.slug(e.name_enus||"");let r=WH.ce("span",{className:"covenant-"+s+" icon-"+s},WH.ct(t.getName(WH.Types.COVENANT,n.id)+" "+WH.Strings.formatNumber(n.pop/100,true,0,1)));WH.ae(c,r);WH.Tooltip.simple(r,a.getCovenantTooltip.bind(undefined,n),"q");u++}while(u<4){WH.ae(c,WH.ce("span"));u++}if(o.endTimestamp){let e=WH.ce("div",{className:"top-covenants-time"});WH.ae(l,e);let t=o.startTimestamp?new Date(o.startTimestamp*1e3):null;let i=new Date(o.endTimestamp*1e3);let a=(new Date).getFullYear()>(t||i).getFullYear()?{month:"short",day:"numeric",year:"numeric"}:{month:"long",day:"numeric"};let n=Locale.getIetf();i=i.toLocaleDateString(n,a);if(t){t=t.toLocaleDateString(n,a);WH.st(e,WH.term("dataCollectedDateRange_format",t,i))}else{WH.st(e,WH.term("dataCollectedDate_format",i))}}return l}};WH.markup.tags.talent={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},abilities:{req:false,valid:/^true|false$/},editable:{req:false,valid:/^true$/},glyphs:{req:false,valid:/^false$/},specs:{req:false,valid:/^true$/},builds:{req:false,valid:/^true|false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},icons:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],toNode:function(e){if(WH.isClassicTree()||WH.isTbcTree()){return WH.markup.tags.talent.toNodeClassic(e)}var t=WH.markup.getDatabaseDomainInfo(e);if(e.unnamed.indexOf("-")<0){e.glyphs="false"}var i=WH.ce("div",{className:"talentcalc-markup-parent"});if(e.glyphs=="false"){i.className+="talentcalc-markup-no-glyphs"}if(e.specs!="true"){i.className+=" talentcalc-markup-no-specs"}var a={parent:i,embedded:true,markup:true,hash:e.unnamed.replace(/^#+/,""),editable:e.editable=="true",dataDomain:t.host,dataEnv:t.dataEnv};if(e.builds){a.builds=JSON.parse(e.builds)}var n=function(){new TalentCalc(a)};if(!WH.isSet("TalentCalc")){this.callbacks.push(n);if(this.callbacks.length==1){WH.loadAssets("talent-calc",(function(){for(var e,t=0;e=WH.markup.tags.talent.callbacks[t];t++){e()}}))}}else{n()}return i},toNodeClassic:function(e){var t=WH.ce("div",{className:"talentcalc-markup-parent"});var i={embedded:true,hash:e.unnamed.replace(/^#+/,""),editable:e.editable==="true",abilities:e.abilities==="true"};var a=function(){new WH.Wow.TalentCalcClassic(t,i)};if(!WH.Wow.hasOwnProperty("TalentCalcClassic")){this.callbacks.push(a);if(this.callbacks.length==1){WH.loadAssets("talent-calc-classic",(function(){for(var e,t=0;e=WH.markup.tags.talent.callbacks[t];t++){e()}}))}}else{a()}return t}};WH.markup.tags["pvp-calc"]={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},icons:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],counter:0,toNode:function(e){var t=WH.markup.getDatabaseDomainInfo(e);var i=WH.ce("div",{id:"markup-pvptalent-"+this.counter++,className:"pvptalentcalc-markup-parent"});var a=function(){new PvpTalentCalc({id:i.id,embedded:true,markup:true,hash:e.unnamed.replace(/^#+/,""),editable:e.editable=="true",dataDomain:t.host})};if(!WH.isSet("PvpTalentCalc")){this.callbacks.push(a);if(this.callbacks.length==1){WH.loadAssets("pvp-talent-calc",(function(){for(var e,t=0;e=WH.markup.tags["pvp-calc"].callbacks[t];t++){e()}}))}}else{a()}return i}};WH.markup.tags["talent-pvp"]=WH.markup.tags["pvp-calc"];WH.markup.tags["honor-calc"]=WH.markup.tags["pvp-calc"];WH.markup.tags.time={empty:true,attr:{until:{req:false,valid:/^\d+$/},since:{req:false,valid:/^\d+$/},server:{req:false,valid:/^true$/}},validate:function(e){if(!e.until&&!e.since){return false}return true},toNode:function(e){var t=WH.ce("span");t.title=new Date((e.until?e.until:e.since)*1e3).toLocaleString();WH.st(t,WH.markup.tags.time.getTime(e));setInterval(WH.markup.tags.time.updateTime.bind(null,t,e),5e3);return t},getTime:function(e){var t;if(e.server){t=WH.getServerTime().getTime()/1e3}else{t=(new Date).getTime()/1e3}var i=0;if(e.until){i=e.until-t}else{i=t-e.since}if(i>0){return WH.formatTimeElapsed(i)}else{return"0 "+WH.TERMS.seconds_lc}},updateTime:function(e,t){e.firstChild.nodeValue=WH.markup.tags.time.getTime(t)}};WH.markup.tags.tooltip={empty:false,attr:{name:{req:false,valid:/\S+/},bare:{req:false,valid:/^true$/i},label:{req:false,valid:/[\S ]+/}},invisibleContent:true,allowedClass:WH.markup.CLASS.STAFF,validate:function(e){if(!e.unnamed&&!e.name){return false}return true},toNode:function(e){var t=document.createElement("div");if(e.label){var i=document.createElement("table");t.appendChild(i);var a=document.createElement("tr");i.appendChild(a);var n=document.createElement("td");a.appendChild(n);n.className="q0";n.style.width="300px";var s=document.createElement("small");n.appendChild(s);s.appendChild(document.createTextNode(e.label))}t.appendChild(e._contents);WH.markup.tooltipTags[e.name]=t.innerHTML;if(e.bare){WH.markup.tooltipTagsWithRawText[e.name]=true}return null}};WH.markup.tags["top-builds"]={empty:true,attr:{background:{req:false,valid:/^false$/},boss:{req:true,valid:/^.+$/},class:{req:true,valid:/^.+$/},difficulty:{req:true,valid:/^(heroic|mythic)$/},spec:{req:true,valid:/^.+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){const t=WH.Wow.Covenant;const i=WH.Gatherer;const a=WH.WarcraftLogs;let n=WH.getPageData(["markup.topBuilds",e.boss,e.difficulty,e["class"],e.spec].join("."));if(!n){let e=WH.ce("div");WH.ae(e,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(e,WH.ct(WH.Strings.nbsp+" "+WH.TERMS.notopbuildsdata_tip));return e}let s=WH.getDataEnv();if(n.items){i.addData(WH.Types.ITEM,s,n.items)}if(n.spells){i.addData(WH.Types.SPELL,s,n.spells)}let r=WH.ce("div",{className:"top-builds"});if(e.background==="false"){r.classList.add("no-background")}let o=0;let l=0;let c=WH.ce("div",{className:"top-builds-covenants"});WH.ae(c,WH.getImitationHeading(WH.TERMS.covenants,6));let u=WH.ce("table");let d=WH.ce("tr",{className:"top-builds-covenants-popularity"});let f=WH.ce("tr",{className:"top-builds-covenants-icon"});WH.ae(u,d);WH.ae(u,f);let h=0;if(n.build.covenants){for(let e=0,i;i=n.build.covenants[e];e++){WH.ae(d,WH.ce("td",undefined,WH.ct(Math.round(i.pop)+"%")));let e=WH.Icon.create(t.getIcon(i.id),WH.Icon.SMALL,"javascript:;");WH.Tooltip.simple(WH.Icon.getLink(e),a.getCovenantTooltip.bind(undefined,i),"q",true);WH.ae(f,WH.ce("td",undefined,e));h++}}o++;if(!h){WH.de(f);let e=WH.ce("td",undefined,WH.ct(WH.TERMS.notenoughdata));WH.ae(d,e);l++}WH.ae(c,u);WH.ae(r,c);o++;l+=a.displayTopSpells(r,WH.TERMS.topConduits,"top-builds-conduits",n.build.conduits,true);o++;l+=a.displayTopSpells(r,WH.TERMS.topLegendaries,"top-builds-legendary-powers",n.build.legendaryPowers,true);let p=WH.ce("div",{className:"top-builds-trinkets"});WH.ae(p,WH.getImitationHeading(WH.TERMS.toptrinkets,6));let m=WH.ce("table");let g=WH.ce("tr",{className:"top-builds-trinkets-popularity"});let H=WH.ce("tr",{className:"top-builds-trinkets-icon"});WH.ae(m,g);WH.ae(m,H);let W=0;if(n.build.trinkets){for(let e=0,t;t=n.build.trinkets[e];e++){let e=i.get(WH.Types.ITEM,t.id);if(!e){continue}let a=Icon.create(e.icon,Icon.sizeIds.small,undefined,WH.Wow.Item.getPath(t.id),undefined,undefined,undefined,undefined,true);a.className+=" iconsmall-q"+e.quality;let n=Icon.getLink(a);n.setAttribute("data-whattach","true");n.target="_blank";let s=WH.ce("td");WH.ae(s,a);WH.ae(g,WH.ce("td",{innerHTML:Math.round(t.pop)+"%"}));WH.ae(H,s);W++}}o++;if(!W){WH.de(H);let e=WH.ce("td",{innerHTML:WH.TERMS.notenoughdata});WH.ae(g,e);l++}WH.ae(p,m);WH.ae(r,p);let v=WH.ce("div",{className:"top-builds-talents"});WH.ae(v,WH.getImitationHeading(WH.TERMS.toptalents,6));let _=WH.ce("table",{className:"top-builds-top-talents"});let T=0;if(n.build.talents){let e=WH.ce("tr",{className:"top-builds-talents-popularity"});let t=WH.ce("tr",{className:"top-builds-talents-icon"});let a=WH.ce("tr",{className:"top-builds-talents-level"});WH.ae(_,e);WH.ae(_,t);WH.ae(_,a);let s=WH.Wow.Spell.getTalentLevels();for(let r=0,o;o=n.build.talents[r];r++){if(r!==0){let t=WH.ce("td",{className:"top-builds-talents-divider",rowSpan:3});WH.ae(e,t)}let n=WH.ce("th",{className:"q"});let l=WH.ce("div");WH.st(l,s[r]);WH.ae(n,l);WH.ae(a,n);let c=0;let u=0;let d=0;for(let a=0,n;n=o[a];a++){let a=i.get(WH.Types.SPELL,n.id);if(!a){this.display_addUnknownIcon(e,t,Math.round(n.pop));u+=Math.round(n.pop);c++;continue}let s=Icon.create(a.icon,Icon.sizeIds.small,undefined,WH.Wow.Spell.getPath(n.id));WH.Icon.getLink(s).target="_blank";let r=WH.ce("td");WH.ae(r,s);WH.ae(e,WH.ce("td",{innerHTML:Math.round(n.pop)+"%"}));WH.ae(t,r);u+=Math.round(n.pop);c++;T++;d++}n.colSpan=Math.max(1,d);let f=c===2?100-u:WH.TERMS.questionmark_punct;while(c<3&&u<100){this.display_addUnknownIcon(e,t,f);c++}}}o++;if(!T){WH.ee(_);let e=WH.ce("td",{innerHTML:WH.TERMS.notenoughdata});let t=WH.ce("tr",undefined,e);WH.ae(_,t);l++}WH.ae(v,_);WH.ae(r,v);if(l===o){WH.ee(r);let t=WH.ce("div",{className:"top-builds-no-data q0",innerHTML:WH.term("noTopDifficultyBossKillsDataForSpec_tip",WH.TERMS[e.difficulty]),style:{marginTop:"10px"}});WH.ae(r,t)}return r},display_addUnknownIcon:function(e,t,i){let a=Icon.create(Icon.questionMarkIcon,Icon.sizeIds.small,undefined,"javascript:");let n=Icon.getLink(a);WH.Tooltip.simple(n,'<b class="q10">'+WH.TERMS.notfound_format.replace("%s",WH.Types.getUpperSingular(WH.Types.SPELL))+"</b><br>"+WH.TERMS.entityremovedsincedatasaved_tip,"q0",true);let s=WH.ce("td");WH.ae(s,a);let r=WH.ce("td",{innerHTML:i+"%"});r.style.opacity=".5";WH.ae(e,r);WH.ae(t,s)}};WH.markup.tags["top-covenants"]={empty:true,attr:{background:{req:false,valid:/^false$/},class:{req:false,valid:/^.+$/},spec:{req:false,valid:/^.+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){const t=WH.Gatherer;const i=WH.Strings;const a=WH.WarcraftLogs;let n=i.slug(e["class"]||"all",true);let s=i.slug(e.spec||"all",true);let r=WH.getPageData(["markup.topCovenants",n,s].join("."));if(!r||!r.topCovenants||!r.topCovenants.length){let e=WH.ce("div");WH.ae(e,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(e,WH.ct(i.nbsp+" "+WH.TERMS.notenoughdata));return e}let o=WH.ce("div",{className:"top-covenants"});if(e.background==="false"){o.classList.add("no-background")}let l=WH.ce("div");WH.ae(o,l);let c=0;r.topCovenants.sort((function(e,i){return WH.stringCompare(t.getName(WH.Types.COVENANT,e.id),t.getName(WH.Types.COVENANT,i.id))}));for(let e=0,n;n=r.topCovenants[e];e++){let e=t.get(WH.Types.COVENANT,n.id);let s=i.slug(e.name_enus||"");let r=WH.ce("span",{className:"covenant-"+s+" icon-"+s},WH.ct([e["name_"+Locale.getName()],WH.Strings.formatNumber(n.pop/100,true,0,1)].join(" ")));WH.ae(l,r);WH.Tooltip.simple(r,a.getCovenantTooltip.bind(undefined,n),"q");c++}while(c<4){WH.ae(l,WH.ce("span"));c++}return o}};WH.markup.tags["top-mythic-classes"]={empty:true,attr:{unnamed:{req:true,valid:/^[A-Za-z0-9' -]+$/},affixes:{req:true,valid:/^(current|all)$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.getPageData(["markup.topMythicClasses",e.unnamed,e.affixes].join("."));let i=WH.ce("div");WH.ae(i,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(i,WH.ct(WH.Strings.nbsp+" "+WH.TERMS.notopmythicclassesdata_tip));if(!t){return i}var a=WH.ce("div",{className:"top-mythic-classes"});var n=["tank","healer","dps"];for(var s=0,r;r=t.classes[s];s++){var o=WH.staticUrl+"/images/classes/symbols/icon-"+g_file_classes[r.class_id]+".png";var l=Math.round(r.total/t.counts.total*100)+"%";var c=WH.ce("div",{className:"top-mythic-classes-class"});WH.ae(a,c);var u=WH.ce("div",{className:"top-mythic-classes-class-content"});WH.ae(c,u);WH.ae(u,WH.ce("div",{className:"top-mythic-classes-class-crest",style:{backgroundImage:"url("+o+")"}}));var d=WH.ce("div",{className:"top-mythic-classes-class-title"});WH.ae(u,d);WH.ae(d,WH.ce("span",{className:"c"+r.class_id},WH.ct(WH.Wow.PlayerClass.getName(r.class_id))));WH.ae(d,WH.ce("small",{},WH.ct(l)));for(var f=0,h;h=n[f];f++){if(r.hasOwnProperty(h)){var p=WH.ce("span");WH.ae(p,WH.ce("b",{},WH.ct(Math.round(r[h]/t.counts[h]*100))));WH.ae(p,WH.ct("%"));WH.ae(u,WH.ce("span",{className:"iconrole iconsmall "+h},p))}}}if(!a.hasChildNodes()){return i}return a}};WH.markup.tags["top-mythic-runs"]={empty:true,attr:{unnamed:{req:true,valid:/^.*$/},affixes:{req:true,valid:/^.*$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.getPageData(["markup.topMythicRuns",e.unnamed,e.affixes].join("."));let i=WH.ce("div");WH.ae(i,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(i,WH.ct(WH.Strings.nbsp+" "+WH.TERMS.notopmythicrunsdata_tip));if(!t){return i}var a=WH.ce("div",{className:"top-mythic-runs"});var n=5;for(var s=0,r;r=t.runs[s];s++){r=r.run;var o=WH.ce("div",{className:"top-mythic-runs-run"});WH.ae(a,o);WH.ae(o,WH.ce("div",{className:"top-mythic-runs-run-level"},WH.ct(WH.TERMS.mythicplus+WH.TERMS.wordspace_punct+r.mythic_level)));var l=r.clear_time_ms/1e3;var c=Math.floor(l/60);l=Math.round(l-c*60);WH.ae(o,WH.ce("div",{className:"top-mythic-runs-run-time"},WH.ct(c+WH.TERMS.wordspace_punct+(c===1?WH.TERMS.minute_lc:WH.TERMS.minutes_lc)+WH.TERMS.wordspace_punct+l+WH.TERMS.wordspace_punct+(l===1?WH.TERMS.second_lc:WH.TERMS.seconds_lc))));if(r.roster.length){var u=document.createDocumentFragment();var d=document.createDocumentFragment();for(var f=0,h;h=r.roster[f];f++){h=h.character;var p=g_spec2SeoShorthand[h["class"].id][WH.getSpecIndexFromSpecId(h.spec.id)];var m=Icon.create(WH.Wow.PlayerClass.Specialization.getIconName(h.spec.id),Icon.sizeIds.small,undefined,"/"+p+"-"+g_class2SeoShorthand[h["class"].id]+"-guide",undefined,undefined,undefined,undefined,true);WH.Tooltip.simple(m,'<span class="no-wrap">'+WH.sprintf(WH.TERMS.guide_format,WH.TERMS.specclass_format.replace("%1$s",WH.Wow.PlayerClass.Specialization.getName(h.spec.id)).replace("%2$s",WH.Wow.PlayerClass.getName(h["class"].id)))+"</span>","c"+h["class"].id,true);WH.ae(u,WH.ce("td",{},m));var g=g_file_genders[h.race.id===WH.Wow.Race.ID_BLOOD_ELF?1:0];var H=WH.Icon.create("race_"+g_file_races[h.race.id]+"_"+g,WH.Icon.SMALL,WH.Entity.getPath(WH.Types.RACE,h.race.id,g_chr_races[h.race.id]),{span:true});WH.Tooltip.simple(H,g_chr_races[h.race.id],"q",true);WH.ae(d,WH.ce("td",{},H))}var W=WH.ce("table");WH.ae(o,W);WH.ae(W,WH.ce("tr",{},u));WH.ae(W,WH.ce("tr",{},d))}if(e.affixes==="all"){var v=WH.ce("div",{className:"top-mythic-runs-run-affixes"});WH.ae(o,v);WH.ae(v,WH.ct(WH.TERMS.affixes+WH.TERMS.colon_punct));for(var _=0,T;T=r.weekly_modifiers[_];_++){var b=WH.Icon.create(T.icon,WH.Icon.SMALL,WH.Entity.getPath(WH.Types.AFFIX,T.id,T.name),{span:true});var E=Icon.getLink(b);E.setAttribute("data-whattach","true");WH.ae(v,b)}}if(s+1===n){break}}if(!a.hasChildNodes()){return i}return a}};WH.markup.tags.twitch={empty:true,attr:{unnamed:{req:true,valid:/^\S+$/},width:{req:false,valid:/^[0-9]+$/},height:{req:false,valid:/^[0-9]+$/},time:{req:false,valid:/^(?:\d+h)?(?:\d{1,2}m)?(?:\d{1,2}s)?$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=function(){let t=Platform.getViewportWidth()-40;let i;let a;let n=16/9;if(e.width&&e.height){i=parseInt(e.width);a=parseInt(e.height);n=i/a;if(i>t){i=t;a=i/n}}else if(e.width){i=Math.min(parseInt(e.width),t);a=i/n}else if(e.height){a=parseInt(e.height);i=a*n;if(i>t){i=t;a=i/n}}else{i=Math.min(t,620);a=i/n}return{width:i,height:a}}();let i=function(){if(/^[a-zA-Z0-9_-]{4,25}$/.test(e.unnamed)){return{type:"channel",id:e.unnamed,time:undefined}}let t;if(t=e.unnamed.match(/\/videos?\/(\d+)/)){let i={type:"video",id:t[1],time:undefined};if(t=e.unnamed.match(/[&?]t=((?:\d+h)?(?:\d{1,2}m)?(?:\d{1,2}s)?)/)){i.time=t[1]}return i}if(t=e.unnamed.match(/clips\.twitch\.tv\/([a-zA-Z0-9_-]+)/)){return{type:"clip",id:t[1],time:undefined}}if(t=e.unnamed.match(/\/clips?\/([a-zA-Z0-9_-]+)/)){return{type:"clip",id:t[1],time:undefined}}if(t=e.unnamed.match(/twitch\.tv\/([a-zA-Z0-9_-]{3,25})/)){return{type:"channel",id:t[1],time:undefined}}return{type:undefined,id:undefined,time:undefined}}();let a="&parent="+encodeURIComponent(location.hostname);a+="&autoplay=false";if(e.time&&i.type==="video"){a+="&time="+encodeURIComponent(e.time)}else if(i.time){a+="&time="+encodeURIComponent(i.time)}switch(i.type){case"channel":return WH.ce("iframe",{src:"https://player.twitch.tv/?channel="+i.id+a,frameBorder:0,scrolling:"no",height:t.height,width:t.width,allow:"fullscreen"});case"video":return WH.ce("iframe",{src:"https://player.twitch.tv/?video=v"+i.id+a,frameBorder:0,scrolling:"no",height:t.height,width:t.width,allow:"fullscreen"});case"clip":return WH.ce("iframe",{src:"https://clips.twitch.tv/embed?clip="+i.id+a,frameBorder:0,scrolling:"no",height:t.height,width:t.width,allow:"fullscreen"})}return WH.ce("div",{className:"error-message",style:{border:"1px dashed",boxSizing:"border-box",height:t.height+"px",width:t.width+"px",padding:"5px"}},WH.ct("Error: Could not detect Twitch embed type for ["+e.unnamed+"]."))}};WH.markup.tags.video={empty:true,attr:{border:{req:false,valid:/^[0-9]+$/},float:{req:false,valid:/^(left|right)$/i},id:{req:true,valid:/^[0-9]+$/},shadow:{req:false,valid:/^(true|false)$/},unnamed:{req:false,valid:/^embed$/i},width:{req:false,valid:WH.markup.regex.isInt}},ltrim:true,rtrim:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){if(!g_videos[e.id]){return WH.ce("b",{},WH.ct("Video #"+e.id))}var t=g_videos[e.id];var i=[];var a=[];if(e.unnamed){switch(t.videoType){case 1:return WH.markup.tags.youtube.toNode({unnamed:t.videoId,width:e.width});case 2:let i=WH.ce("video",{controls:true},WH.ce("source",{src:WH.Url.generate("/video-stream/"+t.id+"-"+t.videoId,{dataEnv:WH.dataEnv.MAIN,locale:LOCALE_ENUS})}));if(e.width){i.style.width=e.width+"px"}return i;default:return WH.ce("b",{},WH.ct("Video id "+e.id+" cannot be embedded with unsupported type: "+t.videoType))}}if(!g_videos[WH.markup.mediaUid]){g_videos[WH.markup.mediaUid]=[]}let n=t.videoId;if(t.videoType===2){n=e.id+"-"+n}var s=WH.ce("div",{style:{position:"relative",display:"inline-block",zoom:1}});var r=WH.ce("a",{href:WH.sprintf(vi_siteurls[t.videoType],n)});WH.ae(s,r);WH.markup.applyCommonAttributes(r,e);WH.aE(r,"click",(function(e){if(!WH.isLeftClick(e)){return}VideoViewer.show({videos:WH.markup.mediaUid,pos:g_videos[WH.markup.mediaUid].length});e.preventDefault()}));if(vi_thumbnails[t.videoType]){var o=WH.ce("img",{src:WH.sprintf(vi_thumbnails[t.videoType],t.videoId)});if(e.width){o.style.width=e.width+"px"}o.loading="lazy";WH.ae(r,o);if(e.border!==undefined){if(e.border==0){o.classList.add("no-border")}else{o.classList.add("border");o.style.borderWidth=""+e.border+"px"}}else{o.classList.add("content-image");if(e.shadow!=="false"){o.classList.add("content-image-shadowed")}}if(e["float"]){o.classList.add("markup-float-"+e["float"])}if(t.hasCaption){o.alt=t.caption}WH.ae(r,WH.ce("img",{src:WH.staticUrl+"/images/icons/play-sm.png",style:{opacity:"0.6",position:"absolute",width:"48px",height:"48px",top:"23px",left:"38px"}}))}else{WH.st(r,t.caption)}g_videos[WH.markup.mediaUid].push(WH.dO(t));return s}};WH.markup.tags.youtube={empty:true,attr:{unnamed:{req:true,valid:/\S+/},title:{req:false,valid:/[\S ]+/},thumb:{req:false,valid:/\S+/},width:{req:false,valid:/^[0-9]+$/},height:{req:false,valid:/^[0-9]+$/},start:{req:false,valid:/^\d+$/},end:{req:false,valid:/^\d+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=e.width?e.width:640;var i=e.height?e.height:360;if(window.outerWidth&&window.outerWidth-20<t){t=window.outerWidth-20;i=Math.floor(t*.5625)}var a={height:i,width:t,videoId:e.unnamed,playerVars:{autoplay:1}};if(e.start){a.playerVars.start=e.start}if(e.end){a.playerVars.end=e.end}if(!WH.markup.tags.youtube.listeningForApiReady){WH.markup.tags.youtube.listeningForApiReady=true;var n;if(WH.isSet("onYouTubeIframeAPIReady")&&typeof window.onYouTubeIframeAPIReady=="function"){n=window.onYouTubeIframeAPIReady}else{n=function(){}}window.onYouTubeIframeAPIReady=function(){WH.markup.tags.youtube.apiReady=true;n()};if(!WH.isSet("YT")){window.YT={};WH.ajaxIshRequest("https://www.youtube.com/iframe_api",true)}}var s={yt:a,loaded:false};var r=WH.ce("div",{className:"wh-youtube"});s.container=r;var o=i/t*100;var l="https://i.ytimg.com/vi/"+a.videoId+"/sddefault.jpg";if(t<=480||$(document).width()<=500){l="https://i.ytimg.com/vi/"+a.videoId+"/hqdefault.jpg"}if(e.thumb){l=e.thumb;r.classList.add("wh-youtube-custom-thumb")}if(o<=35){r.classList.add("wh-youtube-short")}r.style.background="url("+l+")";r.style.maxWidth=""+t+"px";let c=WH.ce("a",{className:"wh-youtube-inner",href:"javascript:",style:{paddingTop:""+o+"%"}});WH.ae(r,c);if(e.title){WH.ae(c,WH.ce("div",{className:"wh-youtube-title"},WH.ct(e.title)))}WH.ae(c,WH.ce("i",{className:"fa fa-circle"}));WH.ae(c,WH.ce("i",{className:"fa fa-play-circle"}));WH.aE(c,"click",WH.markup.tags.youtube.onClick.bind(s));return r},fromHtml:function(e){var t;if(t=e.match(/<iframe\b[\s\S]*?src="[\s\S]*?youtube\.com\/embed\/[\s\S]*?"[\s\S]*?><\/iframe>/gi)){for(var i=0;i<t.length;++i){var a=t[i].match(/src="[\s\S]*?youtube\.com\/embed\/([\s\S]*?)"/i),n=t[i].match(/width[:="]+\s*([0-9]+)/i),s=t[i].match(/height[:="]+\s*([0-9]+)/i),r=t[i].match(/border[:="]+\s*([0-9]+)/i);e=e.replace(t[i],"[youtube="+a[1]+(n?" width="+n[1]:"")+(s?" height="+s[1]:"")+"]")}}return e},listeningForApiReady:false,apiReady:false,onClick:function(){if(this.loaded){return}if(!WH.markup.tags.youtube.apiReady){setTimeout(WH.markup.tags.youtube.onClick.bind(this),125);return}this.container.classList.add("wh-youtube-loaded");this.loaded=true;this.player=new YT.Player(this.container.firstChild,this.yt)}};WH.markup.entityTagToNode=function(e,t,i,a){var n=t.unnamed;var s=WH.markup.getDatabaseDomainInfo(t);var r=s.host;var o=s.nameKey;if(typeof a==="undefined"){a=[]}var l=WH.TERMS.openparenthesis_punct+WH.Types.getUpperSingular(e)+WH.TERMS.wordspace_punct+"#"+n+WH.TERMS.closedparenthesis_punct;if(t.diff){a.push("diff="+t.diff)}if(t.diffnew){a.push("diffnew="+t.diffnew)}if(t.spec){a.push("spec="+t.spec)}if(t.tempname){l=t.tempname}var c=WH.ce("a");if(a.length){c.rel=a.join("&")}var u=parseInt(n,10);var d=null;var f=g_gathered_types[e];var h=WH.Gatherer.get(e,u,s.dataEnv);if(h&&(h[o]||h["name"])){if(h.hasOwnProperty("fromDataEnv")){r=WH.Url.generate("",{subdomain:WH.Url.getSubdomain(h.fromDataEnv,s.locale)}).replace(/\/$/,"")}if(h.hasOwnProperty("quality")){var p=h.quality;if(t.quality){p=t.quality}c.classList.add("q"+p)}var m=h[o]||h.name;var g;if((g=m.indexOf(" / "))!=-1){if(/\.1$/.test(n)){m=m.substr(0,g)}else if(/\.2$/.test(n)){m=m.substr(g+3)}}if(e===WH.Types.ITEM&&!h.icon){h.icon=Icon.questionMarkIcon}var H=undefined;if((!t.icon||t.icon!=="false")&&(h.icon||typeof f.getIcon==="function")){H=h.icon;switch(e){case WH.Types.ITEM:H=f.getIcon(u,undefined,undefined,s.dataEnv)||H;break;case WH.Types.CLASS:case WH.Types.CURRENCY:case WH.Types.RACE:H=f.getIcon(u)||H;break}}if(H){c.classList.add("icontiny");WH.ae(c,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+H.toLowerCase()+".gif",style:{verticalAlign:"middle"},loading:"lazy"}));WH.ae(c,WH.ct(" "))}WH.ae(c,WH.ce("span",{className:"tinyicontxt"},WH.ct(m)));d=m}else{WH.st(c,l)}c.href=r+WH.Entity.getPath(e,n,d);WH.markup.applyCommonAttributes(c,t);return c};WH.markup.entityTagToText=function(e,t){var i=t.unnamed;var a=WH.markup.getDatabaseDomainInfo(t);var n=a.nameKey;var s=WH.Gatherer.get(e,i,a.dataEnv);if(s&&s[n]){return WH.markup.getEscapedHtml(s[n])}return WH.Types.getUpperSingular(e)+WH.TERMS.wordspace_punct+"#"+i};WH.markup.tags.achievement={entityType:WH.Types.ACHIEVEMENT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ACHIEVEMENT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ACHIEVEMENT)};WH.markup.tags["adventure-combatant-ability"]={entityType:WH.Types.ADVENTURE_COMBATANT_ABILITY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},icon:{req:false,valid:/^false$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ADVENTURE_COMBATANT_ABILITY),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ADVENTURE_COMBATANT_ABILITY)};WH.markup.tags.affix={entityType:WH.Types.AFFIX,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.AFFIX),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.AFFIX)};WH.markup.tags["azerite-essence"]={entityType:WH.Types.AZERITE_ESSENCE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.AZERITE_ESSENCE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.AZERITE_ESSENCE)};WH.markup.tags["azerite-essence-power"]={entityType:WH.Types.AZERITE_ESSENCE_POWER,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},spec:{req:false,valid:/^[0-9]+$/},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.AZERITE_ESSENCE_POWER),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.AZERITE_ESSENCE_POWER)};WH.markup.tags["bfa-champion"]={entityType:WH.Types.BFA_CHAMPION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.quality){t.push("q="+e.quality)}if(e.level){t.push("level="+e.level)}if(e.abilities){t.push("abil="+e.abilities)}return WH.markup.entityTagToNode(WH.Types.BFA_CHAMPION,e,undefined,t)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.BFA_CHAMPION)};WH.markup.tags.building={entityType:WH.Types.BUILDING,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},nolvl:{req:false,valid:/^true$/},short:{req:false,valid:/^true$/},side:{req:false,valid:/^1|2$/}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=e.unnamed;var i=WH.markup.getDatabaseDomainInfo(e);var a=i.host;var n=i.nameKey;var s=WH.ce("a");var r=WH.Gatherer.get(WH.Types.BUILDING,t,i.dataEnv);if(r&&r[n]){if(r.hasOwnProperty("fromDataEnv")){a=WH.Url.generate("",{subdomain:WH.Url.getSubdomain(r.fromDataEnv,i.locale)}).replace(/\/$/,"")}var o=r[n];s.href=a+WH.Entity.getPath(WH.Types.BUILDING,t,o);var l=e["short"]?WH.TERMS.level_abbrev:WH.TERMS.level;if(e.side){var c=new RegExp(e.side==1?" \\/ .+$":"[^\\/]+ \\/ ");o=o.replace(c,"")}else if(e["short"]){if(g_garrison_building_short_names.hasOwnProperty(t)){o=g_garrison_building_short_names[t]}}var u=!e.nolvl&&r.hasOwnProperty("level")?l+WH.TERMS.wordspace_punct+r.level+WH.TERMS.wordspace_punct:"";WH.st(s,u+o)}else{s.href=a+WH.Entity.getPath(WH.Types.BUILDING,t);WH.st(s,WH.TERMS.openparenthesis_punct+WH.Types.getUpperSingular(WH.Types.BUILDING)+WH.TERMS.wordspace_punct+"#"+t+WH.TERMS.closedparenthesis_punct)}WH.markup.applyCommonAttributes(s,e);return s},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.BUILDING)};WH.markup.tags["class"]={entityType:WH.Types.CLASS,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}if(e.unnamed>=1&&e.unnamed<=12){return true}return false},toNode:function(e){var t=WH.markup.entityTagToNode(WH.Types.CLASS,e);t.classList.add("c"+e.unnamed);return t},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.CLASS)};WH.markup.tags.champion={entityType:WH.Types.CHAMPION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.quality){t.push("q="+e.quality)}if(e.level){t.push("level="+e.level)}if(e.abilities){t.push("abil="+e.abilities)}return WH.markup.entityTagToNode(WH.Types.CHAMPION,e,undefined,t)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.CHAMPION)};WH.markup.tags.currency={entityType:WH.Types.CURRENCY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},amount:{req:false,valid:/^[0-9\:]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=WH.markup.entityTagToNode(WH.Types.CURRENCY,e);var i=t.querySelector(".tinyicontxt");if(i){t.classList.add("q1")}if(e.amount){if(i){var a=t.textContent;t.classList.add("tip");WH.aE(t,"mouseover",(function(e){WH.Tooltip.showAtCursor(e,a,0,0,"q1")}));WH.aE(t,"mousemove",WH.Tooltip.cursorUpdate);WH.aE(t,"mouseout",WH.Tooltip.hide);WH.st(t.querySelector(".tinyicontxt")||t,e.amount.split(":").join(" - "));var n=t.querySelector("img");if(n){t.style.backgroundImage="url("+n.src+")";t.classList.remove("icontiny");t.classList.add("icontinyr");n.parentNode.removeChild(n)}}else{WH.ae(t,WH.ct(WH.TERMS.wordspace_punct+"x"+e.amount.split(":").join(" - ")))}}else{var s=WH.ce("span");while(t.hasChildNodes()){WH.ae(s,t.firstChild)}WH.ae(t,s)}return t},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.CURRENCY)};WH.markup.tags.event={entityType:WH.Types.EVENT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.EVENT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.EVENT)};WH.markup.tags.faction={entityType:WH.Types.FACTION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.FACTION),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.FACTION)};WH.markup.tags.follower={entityType:WH.Types.FOLLOWER,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.quality){t.push("q="+e.quality)}if(e.level){t.push("level="+e.level)}if(e.abilities){t.push("abil="+e.abilities)}return WH.markup.entityTagToNode(WH.Types.FOLLOWER,e,undefined,t)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.FOLLOWER)};WH.markup.tags["gear-set"]={entityType:WH.Types.GEAR_SET,empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toNode:function(e){var t=e.unnamed;var i=g_gearsets[t];var a=WH.Entity.getPath(WH.Types.GEAR_SET,t,(i||{}).name);var n=WH.ce("a",{href:a,target:"_blank"});n.setAttribute("whattach","true");if(i){if(i["class"]){n.className="icontiny c"+i["class"];WH.ae(n,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+g_classes.getIcon(i["class"])+".gif",style:{verticalAlign:"middle"},loading:"lazy"}));WH.ae(n,WH.ct(" "))}WH.ae(n,WH.ct(i.name))}else{WH.ae(n,WH.ct(WH.Types.getUpperSingular(WH.Types.GEAR_SET)+WH.TERMS.wordspace_punct+"#"+t))}return n}};WH.markup.tags.guide={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.GUIDE),toText:function(e){var t=e.unnamed;var i="name";if(g_guides[t]&&g_guides[t][i]){return WH.markup.getEscapedHtml(g_guides[t][i])}return WH.Types.getUpperSingular(WH.Types.GUIDE)+WH.TERMS.wordspace_punct+"#"+t}};WH.markup.tags["mission-ability"]={entityType:WH.Types.MISSION_ABILITY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.MISSION_ABILITY),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.MISSION_ABILITY)};WH.markup.tags.garrisonability=WH.cO(WH.markup.tags["mission-ability"]);delete WH.markup.tags.garrisonability.entityType;WH.markup.tags.icondb={entityType:WH.Types.ICON,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},block:{req:false,valid:/^(true|false)$/},color:{req:false,valid:WH.markup.regex.noWhitespace},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},domain:{req:false,valid:WH.markup.regex.domain},name:{req:false,valid:/^true$/},site:{req:false,valid:WH.markup.regex.domain},size:{req:false,valid:/^(tiny|small|medium|large)$/},tempname:{req:false},type:{req:false,valid:WH.markup.regex.noWhitespace}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=e.size?e.size:"small";var i=e.name==="true";var a=e.unnamed;var n=WH.markup.getDatabaseDomainInfo(e);var s=WH.TERMS.openparenthesis_punct+WH.Types.getUpperSingular(WH.Types.ICON)+WH.TERMS.wordspace_punct+"#"+a+WH.TERMS.closedparenthesis_punct;let r=[];if(e.diff){r.push("diff="+e.diff)}if(e.diffnew){r.push("diffnew="+e.diffnew)}r=r.length?r.join("&"):null;if(e.tempname){s=e.tempname}var o=WH.ce("a");var l=WH.Gatherer.get(WH.Types.ICON,a,n.dataEnv);let c=n.host;if(l&&l.name){if(l.hasOwnProperty("fromDataEnv")){c=WH.Url.generate("",{subdomain:WH.Url.getSubdomain(l.fromDataEnv,n.locale)}).replace(/\/$/,"")}c+=WH.Entity.getPath(WH.Types.ICON,a,l.name)}else{c+=WH.Entity.getPath(WH.Types.ICON,a)}o.href=c;if(l&&l.name){if(i){s=" "+l.name}if(t==="tiny"){o.classList.add("icontiny");let e=WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+l.icon.toLowerCase()+".gif",style:{verticalAlign:"middle"},loading:"lazy"});WH.ae(o,e)}else{let a={span:i||e.block!=="true",color:e.color,type:e.type};if(!i){if(r){a.rel=r}return WH.Icon.create(l.name,t,c,a)}WH.ae(o,WH.Icon.create(l.name,t,null,a))}}if(r){o.rel=r}if(i){WH.ae(o,WH.ct(s))}WH.markup.applyCommonAttributes(o,e);return o},toText:function(e){var t=e.unnamed;if(g_icons[t]&&g_icons[t].name){return WH.markup.getEscapedHtml(g_icons[t].name)}return WH.Types.getUpperSingular(WH.Types.ICON)+WH.TERMS.wordspace_punct+"#"+t}};WH.markup.tags.item={entityType:WH.Types.ITEM,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},"azerite-powers":{req:false,valid:/^[0-9:]+$/},bonus:{req:false,valid:/^[0-9:]+$/},spec:{req:false,valid:/^[0-9]+$/},ak:{req:false,valid:/^[0-9]+$/},tooltip:{req:false,valid:/^true$/i},tempname:{req:false},transmog:{req:false,valid:/^([0-9]+|hidden)$/}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.ak){t.push("artk="+e.ak)}if(e["azerite-powers"]){t.push("azerite-powers="+e["azerite-powers"])}if(e.bonus){t.push("bonus="+e.bonus)}if(e.spec){t.push("spec="+e.spec)}if(e.transmog){t.push("transmog="+e.transmog)}var i=WH.markup.entityTagToNode(WH.Types.ITEM,e,undefined,t);i.dataset.entity="item";i.dataset.entityHasIcon="true";if(e.tooltip){i=WH.ce("span",{},i);$WowheadPower.replaceWithTooltip(i,WH.Types.ITEM,e.unnamed)}return i},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ITEM)};WH.markup.tags["item-set"]={entityType:WH.Types.ITEM_SET,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^-?[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ITEM_SET),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ITEM_SET)};WH.markup.tags.itemset=WH.cO({},WH.markup.tags["item-set"]);delete WH.markup.tags.itemset.entityType;WH.markup.tags.mission={entityType:WH.Types.MISSION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.MISSION),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.MISSION)};WH.markup.tags.npc={entityType:WH.Types.NPC,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.NPC),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.NPC)};WH.markup.tags["order-advancement"]={entityType:WH.Types.ORDER_ADVANCEMENT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ORDER_ADVANCEMENT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ORDER_ADVANCEMENT)};WH.markup.tags.outfit={entityType:WH.Types.OUTFIT,empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toNode:function(e){var t=e.unnamed;var i=g_outfits[t];var a=WH.Entity.getPath(WH.Types.OUTFIT,t,i&&i.name);var n=WH.ce("a",{href:a,target:"_blank"});n.setAttribute("whattach","true");if(i){if(i.classs){n.className="icontiny c"+i.classs;WH.ae(n,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+g_classes.getIcon(i.classs)+".gif",style:{verticalAlign:"middle"},loading:"lazy"}));WH.ae(n,WH.ct(" "))}WH.ae(n,WH.ct(i.name))}else{WH.ae(n,WH.ct(WH.Types.getUpperSingular(WH.Types.OUTFIT)+WH.TERMS.wordspace_punct+"#"+t))}return n}};WH.markup.tags["pet-ability"]={entityType:WH.Types.PET_ABILITY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.PET_ABILITY),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.PET_ABILITY)};WH.markup.tags.petability=WH.cO({},WH.markup.tags["pet-ability"]);delete WH.markup.tags.petability.entityType;WH.markup.tags.object={entityType:WH.Types.OBJECT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.OBJECT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.OBJECT)};WH.markup.tags.pet={entityType:WH.Types.PET,empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.PET),toText:function(e){let t=e.unnamed;let i=WH.Wow.Pet.getName(t);if(i){return WH.markup.getEscapedHtml(i)}return WH.Types.getUpperSingular(WH.Types.PET)+WH.TERMS.wordspace_punct+"#"+t}};WH.markup.tags.quest={entityType:WH.Types.QUEST,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){let t=e.unnamed;let i=WH.Gatherer.get(WH.Types.QUEST,t);let a=WH.markup.entityTagToNode(WH.Types.QUEST,e);if(i){let e=a.querySelector("span");if(e&&i.hasOwnProperty("_side")){switch(i["_side"]){case 1:e.classList.add("icon-alliance");break;case 2:e.classList.add("icon-horde");break}}}return a},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.QUEST)};WH.markup.tags.race={entityType:WH.Types.RACE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},gender:{req:false,valid:/^(0|1)$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}if(g_file_races[e.unnamed]){return true}return false},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.RACE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.RACE)};WH.markup.tags.resource={entityType:WH.Types.RESOURCE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.RESOURCE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.RESOURCE)};WH.markup.tags.ship={entityType:WH.Types.SHIP,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.quality){t.push("q="+e.quality)}if(e.level){t.push("level="+e.level)}if(e.abilities){t.push("abil="+e.abilities)}return WH.markup.entityTagToNode(WH.Types.SHIP,e,undefined,t)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.SHIP)};WH.markup.tags.skill={entityType:WH.Types.SKILL,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.SKILL),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.SKILL)};WH.markup.tags.sound={empty:true,attr:{unnamed:{req:false,valid:/^[0-9]+$/},src:{req:false,valid:/\S+/},title:{req:false,valid:/\S+/},type:{req:false,valid:/\S+/},src2:{req:false,valid:/\S+/},type2:{req:false,valid:/\S+/},domain:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if(e.unnamed){return true}if(!e.src){return false}return true},toNode:function(e){var t;var i;var a;var n;var s;var r;var o=WH.markup.getDatabaseDomainInfo(e);var l=o.host;if(e.unnamed){if(!(e.unnamed in g_sounds)){return null}if(!g_sounds[e.unnamed].hasOwnProperty("files")){return null}var c;var u=g_sounds[e.unnamed].files;u.sort((function(){return Math.sign(Math.random()-.5)}));while(!c&&u.length){c=u.shift();if(!c.hasOwnProperty("type")){c=undefined}}if(!c){return null}t=c.type;i=c.url;a=g_sounds[e.unnamed].name?g_sounds[e.unnamed].name:c.title;n=l+WH.Entity.getPath(WH.Types.SOUND,e.unnamed,a)}else{if(WH.markup.allow<WH.markup.CLASS.STAFF){return null}i=e.src;a=e.title?e.title:"(Unknown)";if(!/^(https?:)?\/\//.test(i)){if(/^\d+$/.test(i)){let e=parseInt(i);let t=Locale.getName(o.localeId);i=WH.STATIC_URL+"/sound-ids/live/"+t+"/"+(e&255)+"/"+e}else{i=WH.STATIC_URL+"/wowsounds"+i}}if(e.hasOwnProperty("type")){t=e.type}else{switch(e.src.toLowerCase().substr(-4)){case".mp3":t="audio/mpeg";break;case".ogg":t='audio/ogg; codecs="vorbis"';break}}if(e.src2){s=e.src2;if(!/^(https?:)?\/\//.test(s)){if(/^\d+$/.test(s)){let e=parseInt(s);let t=Locale.getName(o.localeId);i=WH.STATIC_URL+"/sound-ids/live/"+t+"/"+(e&255)+"/"+e}else{s=WH.STATIC_URL+"/wowsounds"+s}}if(e.hasOwnProperty("type2")){r=e.type2}else{switch(e.src2.toLowerCase().substr(-4)){case".mp3":r="audio/mpeg";break;case".ogg":r='audio/ogg; codecs="vorbis"';break}}}}var d=document.createDocumentFragment();var f=WH.ce("audio");WH.ae(d,f);f.preload="none";f.controls="true";WH.markup.applyCommonAttributes(f,e);if(e.unnamed){f.setAttribute("rel","sound="+e.unnamed)}var h=WH.ce("source",{src:i});WH.ae(f,h);if(t){h.type=t}if(s){h=WH.ce("source",{src:s});WH.ae(f,h);if(r){h.type=r}}if(n){var p=WH.ce("div",{className:"audiomarkup"});p.appendChild(d.firstChild);WH.ae(p,WH.ce("br"));WH.ae(p,WH.ce("a",{href:n},WH.ct(a)));WH.ae(d,p)}return d},fromHtml:function(e){var t=e.match(/<audio [^>]*\brel="sound=(\d+)/);if(t){return"[sound="+t[1]+"]"}return e.replace(/<audio\b[\s\S]*?><source\b[\s\S]*\bsrc="([^"]*?)"[\s\S]*?<\/audio>/gi,'[sound src="$1"]')}};WH.markup.tags.spell={entityType:WH.Types.SPELL,empty:true,allowInReplies:true,attr:{buff:{req:false,valid:/^true$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},domain:{req:false,valid:WH.markup.regex.domain},icon:{req:false,valid:/^(false|tiny|small|medium|large)$/},rank:{req:false,valid:WH.markup.regex.isInt},site:{req:false,valid:WH.markup.regex.domain},tempname:{req:false},tooltip:{req:false,valid:/^true$/},unnamed:{req:true,valid:/^[0-9]+$/}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=e.unnamed;var i=WH.markup.getDatabaseDomainInfo(e);var a=i.host;var n=i.nameKey;var s;var r=[];var o=WH.TERMS.openparenthesis_punct+WH.Types.getUpperSingular(WH.Types.SPELL)+WH.TERMS.wordspace_punct+"#"+t+WH.TERMS.closedparenthesis_punct;if(e.buff){r.push("buff")}if(e.diff){r.push("diff="+e.diff)}if(e.diffnew){r.push("diffnew="+e.diffnew)}if(e.rank){r.push("rank="+e.rank)}if(e.tempname){o=e.tempname}var l=document.createDocumentFragment();var c=WH.Gatherer.get(WH.Types.SPELL,t,i.dataEnv);if(c&&c[n]){if(c.hasOwnProperty("fromDataEnv")){a=WH.Url.generate("",{subdomain:WH.Url.getSubdomain(c.fromDataEnv,i.locale)}).replace(/\/$/,"")}var u=false;var d=false;switch(e.icon){case"false":break;case"large":case"medium":case"small":u=WH.Icon.create(c.icon.toLowerCase(),e.icon,a+WH.Entity.getPath(WH.Types.SPELL,t,c[n]),{span:true});u.dataset.entityIcon="spell";WH.ae(l,u);break;case"tiny":default:if(e["class"]){e["class"]+=" icontiny"}else{e["class"]="icontiny"}d=c.icon.toLowerCase()}s=WH.ce("a",{href:a+WH.Entity.getPath(WH.Types.SPELL,t,c[n])});WH.ae(l,s);if(r.length){s.rel=r.join("&")}WH.markup.applyCommonAttributes(s,e);s.dataset.entity="spell";s.dataset.entityHasIcon=u||d?"true":"false";if(d){WH.ae(s,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+d+".gif",style:{verticalAlign:"middle"},loading:"lazy"}));WH.ae(s,WH.ct(" "));WH.ae(s,WH.ce("span",{className:"tinyicontxt"},WH.ct(c[n])))}else{WH.ae(s,WH.ct(c[n]))}if(c.hasOwnProperty("quality")&&c.quality>=0){s.classList.add("q"+c.quality)}}else{s=WH.ce("a",{href:a+WH.Entity.getPath(WH.Types.SPELL,t)});WH.ae(l,s);if(r.length){s.rel=r.join("&")}s.dataset.entity="spell";WH.st(s,o)}if(e.tooltip){l=WH.ce("span",{},l);$WowheadPower.replaceWithTooltip(l,WH.Types.SPELL,e.unnamed)}return l},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.SPELL)};WH.markup.tags.statistic=WH.cO({},WH.markup.tags.achievement);delete WH.markup.tags.statistic.entityType;WH.markup.tags.storyline={entityType:WH.Types.STORYLINE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.STORYLINE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.STORYLINE)};WH.markup.tags.threat={entityType:WH.Types.THREAT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.THREAT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.THREAT)};WH.markup.tags.title={entityType:WH.Types.TITLE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.TITLE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.TITLE)};WH.markup.tags["transmog-set"]={entityType:WH.Types.TRANSMOG_SET,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.TRANSMOG_SET),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.TRANSMOG_SET)};WH.markup.tags.zone={entityType:WH.Types.ZONE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ZONE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ZONE)};WH.markup.tags.acronym={empty:false,attr:{unnamed:{req:true}},toNode:function(e){var t=WH.ce("span");t.className="tip";WH.markup.applyCommonAttributes(t,e);WH.aE(t,"mouseover",(function(t){WH.Tooltip.showAtCursor(t,e.unnamed,0,0,"q1")}));WH.aE(t,"mousemove",WH.Tooltip.cursorUpdate);WH.aE(t,"mouseout",WH.Tooltip.hide);return t}};WH.markup.tags.b={empty:false,allowInReplies:true,toNode:function(e){var t=WH.ce("b");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<(b|big|strong)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[b]$2[/b]")}};WH.markup.tags.br={empty:true,toNode:function(e){return WH.ce("br")},fromHtml:function(e){return e.replace(/<br\b[\s\S]*?>/gi,"\n")}};WH.markup.tags.center={empty:false,allowInReplies:false,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("div");t.style.textAlign="-moz-center";t.style.textAlign=t.style.textAlign||"-webkit-center";t.style.textAlign=t.style.textAlign||"center";return t},fromHtml:function(e){return e.replace(/<center>([\s\S]+?)<\/center>/gi,"[pad][div align=center]$1[/div][pad]")}};WH.markup.tags.code={block:true,empty:false,attr:{wrap:{req:false,valid:/^(true|false)$/}},rtrim:true,itrim:true,helpText:true,allowedChildren:{"<text>":1},toNode:function(e){var t=WH.ce("pre");t.className="code";if(e.wrap==="true"){t.style.whiteSpace="normal"}else if(e.wrap==="false"){t.style.whiteSpace="nowrap"}if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.color={empty:false,attr:{unnamed:{req:true,valid:/^.*/i}},allowedClass:WH.markup.CLASS.STAFF,extraColors:{deathknight:"c6","death-knight":"c6",dk:"c6",demonhunter:"c12","demon-hunter":"c12",dh:"c12",druid:"c11",hunter:"c3",mage:"c8",monk:"c10",paladin:"c2",priest:"c5",rogue:"c4",shaman:"c7",warlock:"c9",warrior:"c1","quest-item":"q",poor:"q0",common:"q1",uncommon:"q2",rare:"q3",epic:"q4",legendary:"q5",artifact:"q6",heirloom:"q7",wowtoken:"q8",glyph:"q9",kyrian:"covenant-kyrian",venthyr:"covenant-venthyr",necrolord:"covenant-necrolord","night-fae":"covenant-night-fae","meta-gem":"gem1","red-gem":"gem2","yellow-gem":"gem4","orange-gem":"gem6","blue-gem":"gem8","purple-gem":"gem10","green-gem":"gem12","prismatic-gem":"gem14",yell:"s1",say:"s2",whisper:"s3",exalted:"rep-exalted",revered:"rep-revered",honored:"rep-honored",friendly:"rep-friendly",neutral:"rep-neutral",unfriendly:"rep-unfriendly",hostile:"rep-hostile",hated:"rep-hated","skill-red":"q10","skill-orange":"r1","skill-yellow":"r2","skill-green":"r3","skill-gray":"r4",blizzard:"blizzard-blue"},toNode:function(e){let t=/^(aqua|black|blue|fuchsia|gray|green|lightblue|lime|maroon|navy|olive|purple|red|silver|teal|white|yellow|#[a-f0-9]{6}|#[a-f0-9]{3})$/i;let i=WH.ce("span");if(WH.markup.tags.color.extraColors[e.unnamed]){i.className=WH.markup.tags.color.extraColors[e.unnamed]}else if(Object.values(WH.markup.tags.color.extraColors).includes(e.unnamed)){i.className=e.unnamed}else if(t.test(e.unnamed)){if(e.unnamed.toLowerCase()==="#00c0ff"){i.className="blizzard-blue"}else{i.style.color=e.unnamed}}WH.markup.applyCommonAttributes(i,e);return i}};WH.markup.tags["cta-button"]={allowedClass:WH.markup.CLASS.STAFF,empty:false,helpText:"[cta-button=https://www.google.com border=strong class=c3]"+WH.TERMS.text+"[/cta-button]",attr:{unnamed:{req:false,valid:/\S+/},border:{req:false,valid:/^(strong|none)$/},game:{req:false,valid:/\S+/},icon:{req:false,valid:/\S+/},newwindow:{req:false,valid:/^true$/},onclick:{req:false,valid:/[\S ]+/},rel:{req:false,valid:/\S+/},style:{req:false,valid:/^[^"<>]+$/},tooltip2:{req:false,valid:/\S+/},tooltip:{req:false,valid:/\S+/}},validate:function(e){return WH.markup.tags.url.validate(e)},toNode:function(e){let t=WH.markup.tags.url.toNode(e);if(t.nodeType!==Node.ELEMENT_NODE){return t}t.classList.add("cta-button");if(e.border){t.dataset.border=e.border}if(e.icon){const i=WH.Game;let a=e.game?i.getByKey(e.game):i.DEFAULT;if(!a){WH.warn('Invalid game provided in cta-button markup for "'+e.icon+'" icon: '+e.game);a=i.WOW;e.icon=WH.Icon.UNKNOWN}t.dataset.markupContentTarget=1;t.dataset.icon="true";WH.aef(t,WH.ce("span",{className:"cta-button-icon",style:{"background-image":"url("+WH.Icon.getIconUrl(e.icon,WH.Icon.MEDIUM,a)+")"}}))}return t}};WH.markup.tags.del={empty:false,attr:{copy:{req:false,valid:/^true$/}},toNode:function(e){var t=WH.ce("del");t.className="diffmod";WH.markup.applyCommonAttributes(t,e);if(!e.copy){t.setAttribute("unselectable","on")}return t}};WH.markup.tags.div={empty:false,block:true,ltrim:true,rtrim:true,itrim:true,attr:{clear:{req:false,valid:/^(left|right|both)$/i},unnamed:{req:false,valid:/^hidden$/i},float:{req:false,valid:/^(left|right)$/i},align:{req:false,valid:/^(left|right|center)$/i},margin:{req:false,valid:/^\d+$/},style:{req:false,valid:/^[^"<>]+$/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("div");if(e.clear){t.style.clear=e.clear}if(e.unnamed){t.style.display="none"}if(e.width){t.style.width=e.width}if(e["float"]){t.className+=" markup-float-"+e["float"]}if(e.align){t.style.textAlign=e.align}if(e.margin){t.style.margin=e.margin+"px"}if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}t.className=t.className.replace(/^ +/,"");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e,t){t=t||0;var i;if(i=WH.markup.matchOuterTags(e,"<div\\b[\\s\\S]*?>","</div>","g")){for(var a=0;a<i.length;++a){var n=i[a][1].match(/float:\s*(left|right)"/i),s=i[a][1].match(/width[:="]+\s*([0-9]+)/i);e=e.replace(i[a][1]+i[a][0]+i[a][2],"\n"+Array(t+1).join("\t")+"[div"+(n?" float="+n[1]:"")+(s?" width="+s[1]:"")+"]"+WH.markup.tags.div.fromHtml(i[a][0],t+1)+"[/div]")}}return e}};WH.markup.tags["entity-list-toggle"]=new function(){this.block=true;this.empty=false;this.ltrim=true;this.rtrim=true;this.itrim=true;this.attr={for:{req:true,valid:/.+/}};this.toNode=function(t){let a=WH.ce("div",{className:"entity-list-toggle"});a.setAttribute("data-initialized","false");a.dataset["for"]=t["for"];let n=WH.ce("div",{className:"entity-list-toggle-controls"});WH.ae(a,n);WH.markup.applyCommonAttributes(a,t);clearTimeout(e.initTimer);e.initTimer=setTimeout(i,0);return a};const e={initTimer:undefined};function t(e,t){let i=t.id+"-requirement";let a=WH.qs("#"+i,e);if(!a){e.dataset.hasRequirements="true";let n=WH.qs(".entity-list-item-requirement-set",e);if(n){WH.ae(n,WH.ct(WH.TERMS.comma_punct))}else{n=WH.ce("span",{className:"entity-list-item-requirement-set"});let t=WH.ce("div",{className:"entity-list-item-requirement"});WH.aef(e,t);WH.Strings.sprintf(WH.GlobalStrings.SPELL_FAILED_REQUIRES_SPELL_FOCUS,"|").split("|").forEach((function(e,i){if(e){WH.ae(t,WH.ct(e))}if(i===0){WH.ae(t,n)}}))}a=WH.ce("span",{id:i,innerHTML:t.innerHTML});WH.ae(n,a)}}function i(){$('.entity-list-toggle[data-initialized="false"] .entity-list-toggle-controls').each((function(){let e=this;let t=this.parentNode;WH.qsa(".entity-list-toggle-option",e).forEach((function(e){e.classList.add("fa");e.classList.add("fa-fw");WH.aE(e,"click",a.bind(undefined,t,e,false));a(t,e,true);WH.qsa("a",e).forEach((function(e){WH.aE(e,"click",(function(e){e.preventDefault()}))}))}));t.setAttribute("data-initialized","true")}))}function a(e,t,i,a){if(a){a.preventDefault()}let s=WH.ge(e.dataset["for"]);if(!s){WH.error("No target wrapper for entity list toggler.",e);return}let r={enabled:{on:t.dataset.entityListEnable?t.dataset.entityListEnable.split(","):[],off:t.dataset.entityListDisable?t.dataset.entityListDisable.split(","):[],onRequires:parseInt(t.dataset.entityListEnableRequires),offRequires:parseInt(t.dataset.entityListDisableRequires)},shown:{on:t.dataset.entityListShow?t.dataset.entityListShow.split(","):[],off:t.dataset.entityListHide?t.dataset.entityListHide.split(","):[],onRequires:parseInt(t.dataset.entityListShowRequires),offRequires:parseInt(t.dataset.entityListHideRequires)}};if(i===true||t.classList.contains("fa-check")){t.classList.remove("fa-check");t.classList.add("fa-times");r.checked=false}else{t.classList.remove("fa-times");t.classList.add("fa-check");r.checked=true}n(s,t,i,r,"enabled","on");n(s,t,i,r,"enabled","off");n(s,t,i,r,"shown","on");n(s,t,i,r,"shown","off")}function n(e,i,a,n,s,r){let o=n[s][r+"Requires"];let l="entityListItem"+WH.ucfirst(s);for(let c=0,u;u=n[s][r][c];c++){let c=e.childNodes[u-1];if(!c){continue}if(a!==true){c.dataset.animate="true"}if(o){if(c.dataset[l+"Method"]==="direct"){continue}let e=l+WH.ucfirst(r)+"Count";let t=parseInt(c.dataset[e])||0;if(a!==true){t+=n.checked?1:-1}c.dataset[e]=t;c.dataset[l]=t===o?JSON.stringify(r==="on"):JSON.stringify(r!=="on")}else{c.dataset[l]=n.checked?JSON.stringify(r==="on"):JSON.stringify(r!=="on");c.dataset[l+"Method"]="direct"}if(s==="enabled"){t(c,i)}}}};WH.markup.tags["entity-list-toggle-option"]={empty:false,attr:{disable:{req:false,valid:WH.markup.regex.intCsv},"disable-requires":{req:false,valid:WH.markup.regex.isInt},enable:{req:false,valid:WH.markup.regex.intCsv},"enable-requires":{req:false,valid:WH.markup.regex.isInt},hide:{req:false,valid:WH.markup.regex.intCsv},"hide-requires":{req:false,valid:WH.markup.regex.isInt},show:{req:false,valid:WH.markup.regex.intCsv},"show-requires":{req:false,valid:WH.markup.regex.isInt}},toNode:function(e){if(!e.show&&!e.hide&&!e.enable&&!e.disable){return WH.ce("div",{style:{display:"none"}})}let t=WH.ce("div",{className:"entity-list-toggle-option",id:WH.Strings.guid()});WH.preventSelectStart(t);["show","hide","enable","disable"].forEach((function(i){let a=WH.ucfirst(i);if(e[i]){t.dataset["entityList"+a]=e[i];if(e[i+"-requires"]){t.dataset["entityList"+a+"Requires"]=e[i+"-requires"]}}}));WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.filter={trim:true,itrim:true,attr:{unnamed:{req:true,valid:/^\w+$/},group:{req:true,valid:/^\w+$/}},toNode:function(e,t){let i=t.treeGuid;let a=WH.ce("span",{className:"markup-filter",dataset:{active:"",target:e.unnamed,group:e.group,markupTree:i}});let n=()=>{let e=WH.qsa(`.markup-filter-target[data-markup-tree="${i}"]`);e.forEach((e=>{e.dataset.active="true";let t=JSON.parse(e.dataset.target);for(let[a,n]of Object.entries(t)){let t=WH.qs(`.markup-filter[data-markup-tree="${i}"][data-group="${a}"][data-target="${n}"]`);if(t&&t.dataset.active==="false"){e.dataset.active="false";break}}}))};let s=()=>{let e=a.dataset.group;let t=WH.qsa(`.markup-filter[data-markup-tree="${i}"][data-group="${e}"]`);t.forEach((e=>{if(e.dataset.active!=="true"){e.dataset.active="false"}}));if(a.dataset.active==="true"){a.dataset.active="false"}else{a.dataset.active="true"}let n=WH.qsa(`.markup-filter[data-markup-tree="${i}"][data-group="${e}"][data-active="true"]`).length;if(n===0){t.forEach((e=>{e.dataset.active=""}))}};WH.aE(a,"click",(()=>{s();n()}));return a}};WH.markup.tags["filter-target"]={trim:true,itrim:true,attr:{unnamed:{req:true,valid:/\w+=\w+/}},toNode:function(e,t){let i={};e.unnamed.match(/\w+=\w+/g).forEach((e=>{let t=e.split("=");i[t[0]]=t[1]}));return WH.ce("div",{className:"markup-filter-target",dataset:{active:"",target:JSON.stringify(i),markupTree:t.treeGuid}})}};WH.markup.tags.grid={empty:false,itrim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{align:{req:false,valid:/^centered$/},"column-width":{req:false,valid:WH.markup.regex.cssUnitOrInt},style:{req:false,valid:/^[^"<>]+$/},width:{req:false,valid:WH.markup.regex.cssUnitOrInt}},toNode:function(e){let t=WH.ce("div",{className:"markup-grid"});if(e.align==="centered"){t.dataset.align="centered";if(e["column-width"]){setTimeout((()=>{t.childNodes.forEach((t=>{if(t.tagName!=="BR"){t.style.flexBasis=`${e["column-width"]}px`}}))}),0)}}else{if(e["column-width"]){if(/\d$/.test(e["column-width"])){e["column-width"]+="px"}t.style.gridTemplateColumns="repeat(auto-fill, minmax("+e["column-width"]+", 1fr))"}if(e.width){if(/\d$/.test(e.width)){e.width+="px"}t.style.width="100%";t.style.maxWidth=e.width}}return t}};WH.markup.tags.hr={empty:true,trim:true,allowedModes:{article:1,quickfacts:1,comment:1},toNode:function(e){return WH.ce("hr")},fromHtml:function(e){return e.replace(/<hr\b[\s\S]*?>/gi,"[hr]")}};for(let e=2;e<=6;e++)WH.markup.tags[`h${e}`]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:false,valid:/^first$/i},clear:{req:false,valid:/^(true|both|left|right)$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^.+$/i},type:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(t){if(!t.id){t.id=WH.Strings.slug(t.toc!=="false"&&t.toc||t._textContents,true)}let i=WH.ce(`h${e}`);WH.markup.applyCommonAttributes(i,t);i.className=(i.className?" ":"")+`heading-size-${e}`;if(t.first||t.unnamed){i.className+=" first"}if(t.last){i.className+=" last"}if(t.clear){if(t.clear=="true"){t.clear="both"}i.style.clear=t.clear}if(t.type==="bar"){i.classList.add("heading-bar")}return i},fromHtml:function(t){return t.replace(new RegExp("<h"+e+"\\b[\\s\\S]*?>([\\s\\S]*?)<\\/h"+e+">","gi"),`\n[h${e}]$1[/h${e}]`)}};WH.markup.tags.i={empty:false,allowInReplies:true,toNode:function(e){var t=WH.ce("i");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<(i|em)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[i]$2[/i]")}};WH.markup.tags.icon={empty:false,itrim:true,attr:{unnamed:{req:false,valid:/^class$/i},align:{req:false,valid:/^right$/i},color:{req:false,valid:WH.markup.regex.noWhitespace},float:{req:false,valid:/^(left|right)$/i},game:{req:false,valid:/\S+/},inline:{req:false,valid:/^true$/},name:{req:false,valid:/\S+/},preset:{req:false,valid:/\S+/},size:{req:false,valid:/^(tiny|small|medium|large)$/},type:{req:false,valid:WH.markup.regex.noWhitespace},url:{req:false,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,presets:{boss:WH.staticUrl+"/images/icons/boss.gif",heroic:WH.staticUrl+"/images/icons/heroic.gif",mythic:WH.staticUrl+"/images/icons/mythic.gif"},validate:function(e){if(!e.name&&!e.url&&!e.preset){return false}if(e.preset&&!WH.markup.tags.icon.presets[e.preset]){return false}return true},toNode:function(e){const t=WH.Game;var i=e.size?e.size:"tiny";if(!e.name){e.name=""}var a;let n=e.game?t.getByKey(e.game):t.DEFAULT;if(!n){WH.warn('Invalid game provided in icon markup for "'+e.name+'" icon: '+e.game);n=t.WOW;e.name=WH.Icon.UNKNOWN}if(i=="tiny"){a=WH.ce("span");WH.markup.applyCommonAttributes(a,e);if(e.unnamed==undefined){a.className=(a.className?" ":"")+"icontiny"+(e.align?"r":"");var s="";if(e.name){s=WH.Icon.getIconUrl(e.name,WH.Icon.TINY,n)}else if(e.preset){s=WH.markup.tags.icon.presets[e.preset]}else if(e.url&&WH.markup.isUrlSafe(e.url)){s=e.url}else{return document.createDocumentFragment()}a.style.backgroundImage="url("+s+")"}else{a.className=e.name}}else{let t=e.hasOwnProperty("inline");a=WH.ce(t?"span":"div");WH.markup.applyCommonAttributes(a,e);a.className=(a.className?" ":"")+"icon"+i;WH.aE(a,"click",Icon.showIconInfo.bind(null,a));if(e["float"]){a.style["float"]=e["float"]}let s=null;if(e.url&&WH.markup.isUrlSafe(e.url)){s=e.url}else if(e._textContents&&WH.markup.isUrlSafe(e._textContents)){s=e._textContents}while(e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}let r={color:e.color,game:n,span:t,type:e.type};a.appendChild(WH.Icon.create(e.name.toLowerCase(),i,s,r))}return a}};WH.markup.tags.iconlist={empty:false,block:true,ltrim:true,rtrim:true,attr:{domain:{req:false,valid:WH.markup.regex.domain}},invisibleContent:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{b:1,achievement:1,currency:1,event:1,faction:1,item:1,itemset:1,npc:1,object:1,pet:1,quest:1,spell:1,title:1,zone:1},toNode:function(e){var t=WH.markup.getDatabaseDomainInfo(e).subdomain;while(e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}var i={itemset:"item_set"};let a=WH.ce("div",{className:"icon-list-col"});let n=WH.ce("table",{className:"icon-list"});WH.ae(a,n);var s;var r;for(var o=0;o<e._nodes.length;++o){var l=e._nodes[o];l.attr.domain=t;l.attr.icon="false";var c=WH.markup.tags[l.name].toNode(l.attr);var u="";var d=WH.Types[(i[l.name]||l.name).toUpperCase()];if(d){var f=g_gathered_types[d];var h=parseInt(l.attr.unnamed,10);u=f.getIcon&&f.getIcon(h)||f[h]&&f[h].icon;if(Array.isArray(u)){u=u[0]}}s=WH.ce("tr");WH.ae(n,s);r=WH.ce("th");WH.ae(s,r);if(u){var p="";if(c.tagName==="A"){p=c.href}else{var m=c.querySelector("a");if(m){p=m.href}}WH.ae(r,WH.markup.tags.icon.toNode({name:u,size:"small",url:p,_contents:document.createDocumentFragment()}))}else{WH.ae(r,WH.ce("ul",{},WH.ce("li",{},WH.ct(WH.Strings.nbsp))))}WH.ae(s,WH.ce("td",{},c))}return a}};WH.markup.tags.img={empty:true,count:0,attr:{src:{req:false,valid:/\S+/},icon:{req:false,valid:/\S+/},id:{req:false,valid:/^[0-9]+$/},blog:{req:false,valid:/^[0-9]+$/},news:{req:false,valid:/^[0-9]+$/},size:{req:false,valid:/^(thumb|resized|normal|large|medium|small|tiny)$/i},width:{req:false,valid:/^[0-9%]+$/},height:{req:false,valid:/^[0-9]+$/},float:{req:false,valid:/^(left|right|center)$/i},border:{req:false,valid:/^[0-9]+$/},shadow:{req:false,valid:/^(true|false)$/},margin:{req:false,valid:/^[0-9]+$/},style:{req:false,valid:/^[^<>]+$/}},blogSize:/^(thumb|normal)$/i,idSize:/^(thumb|resized|normal)$/i,iconSize:/^(large|medium|small|tiny)$/i,allowedClass:WH.markup.CLASS.STAFF,validate:function(e){if(e.src){return true}else if(e.id){return e.size?WH.markup.tags.img.idSize.test(e.size):true}else if(e.icon){return e.size?WH.markup.tags.img.iconSize.test(e.size):true}else if(e.blog||e.news){return e.size?WH.markup.tags.img.blogSize.test(e.size):true}return false},toNode:function(e){var t=WH.ce("img",{loading:"lazy"});var i=t;var a=[];var n=[];WH.markup.applyCommonAttributes(t,e);t.removeAttribute("style");t.className="";let s="";if(e.src){s=e.src}else if(e.id){var r=WH.Gatherer.get(WH.Types.SCREENSHOT,e.id)||{};s=WH.getScreenshotUrl(e.id,e.size||"normal",{description:e.title,imageType:r.imageType})}else if(e.icon){s=WH.staticUrl+"/images/wow/icons/"+(e.size?e.size:"large")+"/"+e.icon+".jpg"}else if(e.blog||e.news){if(g_blogimages[e.blog||e.news]){var o=g_blogimages[e.blog||e.news];if(e.size&&e.size=="thumb"){var l=WH.staticUrl+"/uploads/blog/images/"+(e.blog||e.news)+(o.type==3?".png":".jpg");s=WH.staticUrl+"/uploads/blog/thumbs/"+(e.blog||e.news)+(o.type==3?".png":".jpg");t.alt=o.alt;t.width=o.thumbwidth;t.height=o.thumbheight;if(!g_screenshots[WH.markup.mediaUid]){g_screenshots[WH.markup.mediaUid]=[]}var c=WH.markup.tags.img.count++;i=WH.ce("a",{},i);i.href=l;i.id="img-thumb-"+c;setTimeout(function(e,t,i){var a=WH.ge("img-thumb-"+e);if(a){a.onclick=function(e,t,i){if(!WH.isLeftClick(i)){return}ScreenshotViewer.show({screenshots:e,pos:t});return false}.bind(null,t,i)}}.bind(null,c,""+WH.markup.mediaUid,g_screenshots[WH.markup.mediaUid].length),0);var u={url:l,caption:o.alt,width:o.width,height:o.height,noMarkup:true};g_screenshots[WH.markup.mediaUid].push(u)}else{s=WH.staticUrl+"/uploads/blog/images/"+(e.blog||e.news)+(o.type==3?".png":".jpg");t.alt=o.alt;if(!e.width&&!e.height){e.width=o.width;e.height=o.height}else if(!e.height){if(e.width.toString().indexOf("%")===-1){e.height=Math.round(o.height*e.width/o.width)}}else if(!e.width){e.width=Math.round(o.width*e.height/o.height)}}}else{return WH.ct(WH.TERMS.image+WH.TERMS.wordspace_punct+"#"+(e.blog||e.news))}}if(e.width){t.width=e.width}if(e.height){t.height=e.height}if(e["float"]){if(e["float"]=="center"){i=WH.ce("div",{},i);i.style.textAlign="center";n.push("margin:10px auto")}else{a.push("markup-float-"+e["float"]);if(e.margin){if(e["float"]=="left"){n.push("margin:0 "+e.margin+"px "+e.margin+"px 0")}else{n.push("margin:0 0 "+e.margin+"px "+e.margin+"px")}}}}if(e.border){if(e.border==0){a.push("no-border")}else{a.push("border");n.push("border-width:"+e.border+"px")}}else{a.push("content-image");if(e.shadow=="true"){a.push("content-image-shadowed")}}t.src=WH.Url.addMaxSizeParams(s,{width:t.width,height:t.height});t.alt=e.title||t.alt||"";if(e.style&&WH.markup.allow>=WH.markup.CLASS.STAFF){n.push(e.style)}if(a.length){t.className=a.join(" ")}if(n.length){t.setAttribute("style",n.join(";"))}return i},fromHtml:function(e){var t;if(t=e.match(/<img\b[\s\S]*?src="[\s\S]+?"[\s\S]*?>/gi)){for(var i=0;i<t.length;++i){var a=t[i].match(/src="([\s\S]+?)"/i),n=t[i].match(/width[:="]+\s*([0-9]+)/i),s=t[i].match(/height[:="]+\s*([0-9]+)/i),r=t[i].match(/border[:="]+\s*([0-9]+)/i);e=e.replace(t[i],"[img src="+a[1]+(n?" width="+n[1]:"")+(s?" height="+s[1]:"")+" border="+(r?r[1]:0)+"]")}}return e}};WH.markup.tags["inline-code"]={block:false,empty:false,attr:{wrap:{req:false,valid:/^(true|false)$/}},allowedChildren:{"<text>":1},toNode:function(e){var t=WH.ce("code");if(e.wrap==="true"){t.style.whiteSpace="normal"}else if(e.wrap==="false"){t.style.whiteSpace="nowrap"}if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.ins={empty:false,toNode:function(e){var t=WH.ce("ins");t.className="diffmod";WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.li={empty:false,itrim:true,attr:{class:{req:false,valid:/^[a-z0-9 _-]+$/i},icon:{req:false,valid:WH.markup.regex.noWhitespace},style:{req:false,valid:/^[^<>]+$/}},helpText:function(){var e="";e+="[ul]";for(var t=0;t<3;++t){e+="\n[li]"+WH.TERMS.listitem_stc+"[/li]"}e+="\n[/ul]\n\n";e+="[ol]";for(var t=0;t<3;++t){e+="\n[li]"+WH.TERMS.listitem_stc+"[/li]"}e+="\n[/ol]\n";return e.toLowerCase()},toNode:function(e){let t=WH.ce("li");WH.markup.applyCommonAttributes(t,e);if(e.icon){t.classList.add("fa","fa-"+e.icon)}WH.ae(t,WH.ce("div",{dataset:{markupContentTarget:1}}));return t},fromHtml:function(e,t){t=t||0;var i;if(i=WH.markup.matchOuterTags(e,"<li\\b[\\s\\S]*?>","</li>","g")){for(var a=0;a<i.length;++a){e=e.replace(i[a][1]+i[a][0]+i[a][2],"\n\t"+Array(t+1).join("\t")+"[li]"+WH.markup.tags.li.fromHtml(i[a][0],t+1)+"[/li]")}}return e}};WH.markup.tags["major-heading"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:false,valid:/^first$/i},clear:{req:false,valid:/^(true|both|left|right)$/i},style:{req:false,valid:/^[^"<>]+$/},type:{req:false,valid:WH.markup.regex.noWhitespace},toc:{req:false,valid:/^.+$/i}},toNode:function(e){if(!e.id){e.id=WH.Strings.slug(e.toc!=="false"&&e.toc||e._textContents,true)}var t=WH.ce("h2");t.classList.add("heading-size-2");if(e.first||e.unnamed){t.classList.add("first")}if(e.last){t.classList.add("last")}if(e.clear==="true"||e.clear==="both"){t.style.clear="both"}else if(e.clear){t.style.clear=e.clear}if(e.type==="bar"){t.classList.add("heading-bar")}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<h2\b[\s\S]*?>([\s\S]*?)<\/h2>/gi,"\n[major-heading]$1[/major-heading]")}};WH.markup.tags["minor-heading"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,attr:{unnamed:{req:false,valid:/^first$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^.+$/i},type:{req:false,valid:WH.markup.regex.noWhitespace}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){if(!e.id){e.id=WH.Strings.slug(e.toc!=="false"&&e.toc||e._textContents,true)}var t=WH.ce("h3");t.classList.add("heading-size-3");if(e.first||e.unnamed){t.classList.add("first")}if(e.last){t.classList.add("last")}if(e.clear==="true"||e.clear==="both"){t.style.clear="both"}else if(e.clear){t.style.clear=e.clear}if(e.type==="bar"){t.classList.add("heading-bar")}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<h3\b[\s\S]*?>([\s\S]*?)<\/h3>/gi,"\n[minor-heading]$1[/minor-heading]")}};WH.markup.tags.nav={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{"nav-item":1},toNode:function(e){var t="nav-markup-"+WH.Strings.guid();var i=document.createDocumentFragment();WH.ae(i,WH.ce("div",{className:"clear"}));var a=WH.ce("div",{className:"smooth-nav-wrapper",id:t});WH.ae(i,a);var n=WH.ce("div",{className:"smooth-nav-outer"});WH.ae(a,n);var s=WH.ce("div",{className:"smooth-nav-inner"});WH.ae(n,s);var r;var o;var l=e._contents;while(l.hasChildNodes()){o=l.removeChild(l.firstChild);r=WH.ce("a",{id:t+"-"+d,rel:"np"});if(o.whMarkupInfo.url){r.href=o.whMarkupInfo.url}if(o.whMarkupInfo.tooltip){WH.Tooltip.simple(r,o.whMarkupInfo.tooltip.replace(/&lt;br&gt;/g,"<br>"),"q")}while(o.hasChildNodes()){WH.ae(r,o.firstChild)}var c=false;var u=null;for(var d=0,f=r.childNodes.length;d<f;d++){if(r.childNodes[d].nodeType===Node.TEXT_NODE){r.dataset.text=WH.Strings.slug(r.childNodes[d].textContent,true,LOCALE_ENUS);c=true}else if(!c){u=r.childNodes[d].textContent||u}}if(!c&&u){r.dataset.text=WH.Strings.slug(u,true,LOCALE_ENUS)}WH.ae(s,r)}setTimeout(WH.setupSmoothNavClicks.bind(null,"#"+t),0);return i}};WH.markup.tags["nav-item"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{nav:1},attr:{unnamed:{req:false,valid:/\S+/},tooltip:{req:false,valid:/^.*$/}},toNode:function(e){var t=WH.ce("div");t.whMarkupInfo={tooltip:e.tooltip,url:e.unnamed};return t}};WH.markup.tags.n5={empty:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/}},toNode:function(e){return document.createTextNode(WH.getN5(e.unnamed))}};WH.markup.tags.minibox={empty:false,rtrim:true,itrim:true,attr:{float:{req:false,valid:/^(left|right)$/i}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("div");t.className="minibox";if(e["float"]=="left"){t.className+=" minibox-left"}WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.money={empty:true,attr:{unnamed:{req:false,valid:/^[0-9]+|[0-9]+-[0-9]+$/},items:{req:false,valid:/^[0-9,]+$/},currency:{req:false,valid:/^[0-9,]+$/},achievement:{req:false,valid:/\S+/},side:{req:false,valid:/^(alliance|horde|both)$/i},arena:{req:false,valid:/^[0-9]+$/},honor:{req:false,valid:/^[0-9]+$/},conquest:{req:false,valid:/^[0-9]+$/},justice:{req:false,valid:/^[0-9]+$/},valor:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=[];var i=[];if(e.items){var a=e.items.split(",");if(a.length>=2){for(var n=0,s=a.length;n<s-1;n+=2){t.push({id:a[n],count:a[n+1]})}}}if(e.currency){var r=e.currency.split(",");if(r.length>=2){var o=null;for(var l=0,c=r.length;l<c-1;l+=2){var u=r[l];var d=parseInt(r[l+1]);if(o&&o.id===u){if(o.increment===null&&d-o.max<=5){o.increment=d-o.max}if(o.increment&&(o.max+o.increment===d||o.max/d>.925)){o.values.push(d);o.max=d;o.value=o.min+"-"+o.max;continue}}o={id:u,increment:null,max:d,min:d,value:d,values:[d]};i.push(o)}}}if(e.arena&&!e.conquest){e.conquest=e.arena}if(e.honor){i.push({id:WH.Wow.Currency.ID_HONOR,value:e.honor})}if(e.conquest){i.push({id:WH.Wow.Currency.ID_CONQUEST,value:e.conquest})}if(e.justice){i.push({id:WH.Wow.Currency.ID_JUSTICE,value:e.justice})}if(e.valor){i.push({id:WH.Wow.Currency.ID_VALOR,value:e.valor})}var f=e.achievement;var h=document.createDocumentFragment();if(e.unnamed){var p=null;var m=null;if(e.unnamed.indexOf("-")!==-1){var g=e.unnamed.split("-");p=this.calculateMoney(g[0]);m=this.calculateMoney(g[1])}else{p=this.calculateMoney(e.unnamed)}if(m===null||JSON.stringify(p)===JSON.stringify(m)){this.displayMoney(h,p)}else if(p.length===1&&m.length===1&&p[0].type===m[0].type){p[0].value+="-"+m[0].value;this.displayMoney(h,p)}else{this.displayMoney(h,p);h.appendChild(WH.ct(" - "));this.displayMoney(h,m)}}if(t.length>5){if(h.hasChildNodes()){h.appendChild(WH.ct(" "));h.appendChild(WH.ct(WH.Strings.sprintf(WH.TERMS.oneOfEntityCount_format,t.length,WH.Types.getUpperPlural(WH.Types.ITEM))))}}else{for(var n=0,s=t.length;n<s;n++){var H=t[n];if(h.hasChildNodes()){h.appendChild(WH.ct(" "))}var W=g_items[H.id]||{};var v=W.icon||WH.Icon.UNKNOWN;var _=WH.staticUrl+"/images/wow/icons/tiny/"+v.toLowerCase()+".gif";h.appendChild(WH.ce("a",{href:WH.Entity.getPath(WH.Types.ITEM,H.id),className:"moneyitem no-wrap",style:{backgroundImage:'url("'+_+'")'}},WH.ct(H.count)))}}for(var T=0,b=i.length;T<b;T++){var E=i[T];if(h.hasChildNodes()){h.appendChild(WH.ct(" "))}var v=g_gatheredcurrencies.getIcon(E.id);if(v===WH.Icon.UNKNOWN){v=WH.Wow.Currency.getIcon(E.id)||v}var y=WH.ce("a",{href:WH.Entity.getPath(WH.Types.CURRENCY,E.id),className:"icontinyr tip q1 no-wrap",style:{backgroundImage:'url("'+WH.staticUrl+"/images/wow/icons/tiny/"+v.toLowerCase()+'.gif")'}});WH.ae(y,WH.ct(E.value));if(E.values&&E.values.length>2){WH.Tooltip.addTooltipText(y,WH.TERMS.oneOf_colon+Locale.formatList(E.values,"or",280))}h.appendChild(y)}if(f>0){if(h.hasChildNodes()){h.appendChild(WH.ct(" "))}h.appendChild(WH.markup.tags.achievementpoints.toNode({unnamed:f.toString()}))}return h},calculateMoney:function(e){var t=[];if(e>=1e4){t.push({type:"gold",value:WH.numberFormat(Math.floor(e/1e4))});e%=1e4}if(e>=100){t.push({type:"silver",value:WH.numberFormat(Math.floor(e/100))});e%=100}if(e>=1){t.push({type:"copper",value:WH.numberFormat(Math.floor(e))})}return t},displayMoney:function(e,t){var i=false;for(var a=0,n=t.length;a<n;a++){if(i){e.appendChild(WH.ct(WH.TERMS.wordspace_punct))}e.appendChild(WH.ce("span",{className:"money"+t[a].type},WH.ct(t[a].value)));i=true}}};WH.markup.tags.ol={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{li:1,ul:1,ol:1},toNode:function(e){var t=WH.ce("ol");var i=[];if(e.first){i.push("first")}if(e.last){i.push("last")}if(i.length>0){t.className=i.join(" ")}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e,t){t=t||0;var i;if(i=WH.markup.matchOuterTags(e,"<ol\\b[\\s\\S]*?>","</ol>","g")){for(var a=0;a<i.length;++a){e=e.replace(i[a][1]+i[a][0]+i[a][2],"\n"+Array(t+1).join("\t")+"[ol]"+WH.markup.tags.ol.fromHtml(i[a][0],t+1)+"\n"+Array(t+1).join("\t")+"[/ol]")}}return e}};WH.markup.tags.p={empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("p");t.style.lineHeight="1.4em";t.style.margin="1em 0 0 0";WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){var t;if(t=e.match(/<p\b[\s\S]*?>[\s\S]*?<\/p>/gi)){for(var i=0;i<t.length;++i){var a=t[i].match(/^<p\b[\s\S]*?text-align:\s*(center|left|right)/i);var n=t[i].match(/<p\b[\s\S]*?>([\s\S]*?)<\/p>/i);e=e.replace(t[i],"[pad][div"+(a?" align="+a[1]:"")+"]"+(n?n[1]:"")+"[/div][pad]")}}return e}};WH.markup.tags.pad={empty:true,block:true,trim:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("div");t.className="pad";if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.pre={empty:false,block:true,rtrim:true,toNode:function(e){var t=WH.ce("pre");t.className="code";if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<pre\b[\s\S]*?>([\s\S]*?)<\/pre>/gi,"[pre]$1[/pre]")}};WH.markup.tags.quote={block:true,empty:false,rtrim:true,ltrim:true,itrim:true,attr:{unnamed:{req:false,valid:/[\S ]+/},align:{req:false,valid:/^(left|right|center)$/i},blizzard:{req:false,valid:/^true$/},clear:{req:false,valid:/^(left|right|both)$/i},collapse:{req:false,valid:/^true$/},display:{req:false,valid:/^block$/},float:{req:false,valid:/^(left|right|none)$/i},pname:{req:false},type:{req:false,valid:WH.markup.regex.noWhitespace},url:{req:false,valid:WH.markup.regex.noWhitespace},wowhead:{req:false,valid:/^true$/}},allowedModes:{article:1,quickfacts:1,comment:1},validate:function(e){if(e.type||e.blizzard||e.wowhead||e.collapse||e.url){if(WH.markup.allow<WH.markup.CLASS.STAFF){return false}}return true},toNode:function(e){let t=WH.ce("div",{className:"quote"});WH.markup.applyCommonAttributes(t,e);if(e.display)t.style.display=e.display;if(e.align)t.style.textAlign=e.align;if(e.clear)t.style.clear=e.clear;if(e.first)t.classList.add("first");if(e.last)t.classList.add("last");if(e["float"])t.classList.add("markup-float-"+e["float"]);let i=e.type||"user";if(e.blizzard){i="blizzard"}else if(e.wowhead){i="wowhead"}t.dataset.type=i;let a=WH.ce("div",{className:"quote-header"});WH.ae(t,a);let n=WH.ce("div",{className:"quote-body",dataset:{markupContentTarget:1}});WH.ae(t,n);let s=WH.markup.getFixedUrl(e.url);if(i==="blizzard"){let t=s.match(/^https?:\/\/(us|eu)\.battle\.net\/wow\/en\/blog\/([0-9]+)/i)||s.match(/^https?:\/\/(us|eu)\.battle\.net\/wow\/en\/forum\/topic\/([0-9]+)/i)||s.match(/^https?:\/\/(www\.)?worldofwarcraft\.com\/en-us\/news\/([0-9]+)/i)||s.match(/^https?:\/\/(us|eu)\.battle\.net\/forums\/(?:en\/)?wow\/topic\/([0-9]+)/i);if(t||s&&WH.markup.isUrlSafe(s)){let i;if(t){i=WH.TERMS.officialPost;let e=["","blue-tracker","topic"];if(["us","eu"].includes(t[1])){e.push(t[1])}e.push(t[2]);WH.ae(a,WH.ce("a",{href:e.join("/"),target:"_blank"},WH.ct(WH.TERMS.bluetracker)));WH.ae(a,WH.ce("span",{className:"quote-header-separator"},WH.ct(" | ")))}else{i=e.pname||(s.indexOf("bluetracker")>=0?WH.TERMS.bluetracker:WH.TERMS.viewOriginal)}WH.ae(a,WH.ce("a",{href:s,target:"_blank"},WH.ct(i)))}}else if(s&&WH.markup.isUrlSafe(s)){WH.ae(a,WH.ce("a",{href:s,target:"_blank"},WH.ct(WH.TERMS.link)))}let r=e.unnamed&&e.unnamed.trim()||null;let o=!!r;t.dataset.hasSource=JSON.stringify(o);if(o){let t=WH.ce("div",{className:"quote-source"});WH.ae(n,t);if(i==="user"){if(e.url&&WH.markup.isUrlSafe(e.url)){let i=WH.ce("a",{href:WH.markup.getFixedUrl(e.url)},WH.ct(r));if(WH.markup.isUrlExternal(e.url)){i.target="_blank"}WH.ae(t,i)}else if(WH.User.isUsernameValid(r)){WH.ae(t,WH.ce("a",{href:"/user="+r},WH.ct(r)))}else{WH.ae(t,WH.ct(r))}WH.ae(t,WH.ct(" "+WH.TERMS.said_colon))}else{WH.ae(t,WH.ct(r))}}if(e._nodes&&e._nodes.length){let t=e._nodes[0].parent;let i=0;let a=t.parent;while(a&&a.name==="quote"){i++;a=a.parent}if(i>=2){e.collapse="true"}}if(i!=="user"||o||e.collapse){let i=WH.ce("a",{className:"quote-toggle",href:"javascript:"});WH.aE(i,"click",(function(){t.classList.toggle("quote-collapsed")}));WH.ae(a,i);if(e.collapse){t.classList.add("quote-collapsed")}}return t}};WH.markup.tags.reveal={empty:false,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){if(!WH.markup.inNewsType||WH.markup.inNewsType>1){return document.createDocumentFragment()}var t=document.createDocumentFragment();var i=WH.ce("span",{style:{display:"none"}});t.appendChild(i);t.appendChild(WH.ct(" "));var a=WH.ce("a",{className:"revealtoggle",href:"javascript:"});t.appendChild(a);WH.aE(a,"click",WH.markup.tags.reveal.toggleReveal.bind(null,a,i));WH.st(a,WH.TERMS.openparenthesis_punct+WH.TERMS.readmore.toLowerCase()+WH.TERMS.closedparenthesis_punct);return t},toggleReveal:function(e,t){e=$(e);t=$(t);if(t.is(":visible")&&e.is(":visible")){t.hide();e.text(WH.TERMS.openparenthesis_punct+WH.TERMS.readmore.toLowerCase()+WH.TERMS.closedparenthesis_punct)}else{t.show();if(e.hasClass("changelog")){e.hide()}else{e.text(WH.TERMS.openparenthesis_punct+WH.TERMS.hide.toLowerCase()+WH.TERMS.closedparenthesis_punct)}}}};WH.markup.tags.s={empty:false,allowInReplies:true,toNode:function(e){var t=WH.ce("del");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){e=e.replace(/<del\b[\s\S]*?>([\s\S]*?)<\/del>/gi,"[s]$1[/s]");return e.replace(/<s\b[\s\S]*?>([\s\S]*?)<\/s>/gi,"[s]$1[/s]")}};WH.markup.tags.section={empty:false,ltrim:true,rtrim:true,trim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{},toNode:function(e){var t=WH.ce("div");t.className="secheader";t.dataset.markupContentTarget=1;t.appendChild(WH.ce("var"));return t}};WH.markup.tags.small={empty:false,toNode:function(e){var t=WH.ce("small");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<small\b[\s\S]*?>([\s\S]*?)<\/small>/gi,"[small]$1[/small]")}};WH.markup.tags.span={empty:false,attr:{class:{req:false,valid:/^[a-z0-9 _-]+$/i},style:{req:false,valid:/^[^<>]+$/},unnamed:{req:false,valid:/^(hidden|invisible)$/},tooltip:{req:false,valid:/\S+/},tooltip2:{req:false,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("span");WH.markup.applyCommonAttributes(t,e);if(e.unnamed=="hidden"){t.style.display="none"}else if(e.unnamed=="invisible"){t.style.visibility="hidden"}if(e.tooltip&&WH.markup.tooltipTags[e.tooltip]){WH.aE(t,"mouseover",(function(t){WH.Tooltip.showAtCursor(t,WH.markup.tooltipTags[e.tooltip],0,0,WH.markup.tooltipTagsWithRawText[e.tooltip]?null:"q",e.tooltip2&&WH.markup.tooltipTags[e.tooltip2]?WH.markup.tooltipTags[e.tooltip2]:null)}));WH.aE(t,"mousemove",WH.Tooltip.cursorUpdate);WH.aE(t,"mouseout",WH.Tooltip.hide)}return t},fromHtml:function(e){return e.replace(/<span\b([\s\S]*?)>([\s\S]*?)<\/span>/gi,(function(e,t,i){var a=/style="[\s\S]*?color:\s?#(\w{6});?/i;var n=t.match(a);if(n){var s={ffd100:"q","9d9d9d":"q0",ffffff:"q1","1eff00":"q2","0070dd":"q3",a335ee:"q4",ff8000:"q5",e5cc80:"q6","00ccff":"q8","71d5ff":"q9",ff4040:"q10",ffff98:"q13",ff8040:"r1",ffff00:"r2","40bf40":"r3",808080:"r4",c69b6d:"c1",f48cba:"c2",aad372:"c3",fff468:"c4",c41e3b:"c6","2359ff":"c7","68ccef":"c8","9382c9":"c9","008467":"c10",ff7c0a:"c11"};var r=s[n[1]];if(r){return"[color="+r+"]"+i+"[/color]"}}return e}))}};WH.markup.tags.spoiler={block:true,empty:false,attr:{unnamed:{req:false,valid:/^.*$/}},rtrim:true,ltrim:true,itrim:true,timer:null,toNode:function(e){var t=document.createDocumentFragment();t.appendChild(WH.ce("div",{className:"pad"}));var i=WH.ce("div",{className:"spoiler-wrapper"});t.appendChild(i);var a=WH.ce("div",{className:"spoiler-desc"});WH.ae(i,a);WH.ae(a,WH.ce("b",{},WH.ct(WH.TERMS.spoiler_colon)));if(e.unnamed){WH.ae(a,WH.ct(WH.TERMS.wordspace_punct+e.unnamed))}WH.ae(a,WH.ct(" "));var n=WH.ce("button",{type:"button",className:"spoiler-revealer btn btn-small btn-site"});WH.st(n,WH.TERMS.revealspoiler);WH.aE(n,"click",(function(){i.classList.add("spoiler-reveal")}));WH.ae(a,n);var s=WH.ce("button",{type:"button",className:"spoiler-hider btn btn-small btn-site"});WH.st(s,WH.TERMS.hidespoiler);WH.aE(s,"click",(function(){i.classList.remove("spoiler-reveal")}));WH.ae(a,s);var r=WH.ce("div",{className:"spoiler",dataset:{markupContentTarget:1}});WH.markup.applyCommonAttributes(r,e);WH.ae(i,r);return t}};WH.markup.tags.sub={empty:false,toNode:function(e){var t=WH.ce("sub");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<sub\b[\s\S]*?>([\s\S]*?)<\/sub>/gi,"[sub]$1[/sub]")}};WH.markup.tags.sup={empty:false,toNode:function(e){var t=WH.ce("sup");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<sup\b[\s\S]*?>([\s\S]*?)<\/sup>/gi,"[sup]$1[/sup]")}};WH.markup.tags.tabs={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{tab:1},attr:{name:{req:true,valid:/\S+/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},toNode:function(e){e.id=WH.Strings.slug(e.name,true,Locale.getId());var t=document.createDocumentFragment();WH.ae(t,WH.ce("div",{className:"clear"}));WH.ae(t,WH.ce("div",{id:"dsf67g4d-"+e.id+(WH.markup.isPreview?"-preview":"")}));var i=WH.ce("div");WH.ae(t,i);if(e.width){i.style.width=e.width}var a=WH.ce("div",{className:"tabbed-contents"});WH.ae(i,a);var n;var s;var r=[];while(e._contents.hasChildNodes()){s=e._contents.removeChild(e._contents.firstChild);n=s.whMarkupInfo;r.push(n);var o=WH.ce("div",{id:"tab-"+e.id+"-"+n.id});o.style.display="none";while(s.hasChildNodes()){WH.ae(o,s.firstChild)}WH.ae(o,WH.ce("div",{className:"clear"}));WH.ae(a,o)}setTimeout(function(e,t,i){var a=new Tabs({parent:WH.ge("dsf67g4d-"+e.id+(i?"-preview":"")),forum:1,noScroll:i?true:false});for(var n=0;n<t.length;++n){var s=t[n];a.add(s.name,{id:e.id+"-"+s.id,icon:s.icon,class:s["class"]})}a.flush()}.bind(null,e,r,WH.markup.isPreview?"preview":""),0);return t}};WH.markup.tags.tab={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{tabs:1},attr:{name:{req:true,valid:/[\S ]+/},icon:{req:false,valid:/\S+/},id:{req:false,valid:/[\S ]+/}},toNode:function(e){var t=e.id?WH.Strings.slug(e.id,true,Locale.getId()):null;if(!t){t=WH.Strings.slug(e.name,true,Locale.getId())}if(!t){t=WH.Strings.guid()}e.name=WH.stringReplace(e.name,"_"," ");if(typeof e["class"]!="undefined"){e["class"]=WH.stringReplace(e["class"],"_"," ")}var i=WH.ce("div");i.whMarkupInfo={id:t,name:e.name,icon:e.icon,class:e["class"]};return i}};WH.markup.tags.table={empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{tr:1},attr:{background:{req:false,valid:WH.markup.regex.noWhitespace},border:{req:false,valid:/^[0-9]+$/},cellspacing:{req:false,valid:/^[0-9]+$/},cellpadding:{req:false,valid:/^[0-9]+$/},style:{req:false,valid:/^[^<>]+$/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},toNode:function(e){var t=WH.ce("table");WH.markup.applyCommonAttributes(t,e);if(e.background){t.dataset.background=e.background}if(typeof e.border!=="undefined"){t.border=e.border;if(t.className){t.className+=" clean-markup-table-borders"}else{t.className="clean-markup-table-borders"}}if(typeof e.cellspacing!=="undefined"){t.cellSpacing=e.cellspacing}if(typeof e.cellpadding!=="undefined"){t.cellPadding=e.cellpadding}if(typeof e.width!=="undefined"){t.style.width=e.width}t.appendChild(WH.ce("tbody"));return t},fromHtml:function(e,t){t=t||0;var i;if(i=WH.markup.matchOuterTags(e,"<table\\b[\\s\\S]*?>","</table>","g")){for(var a=0;a<i.length;++a){var n=i[a][1].match(/border[:="]+\s*([0-9]+)/i),s=i[a][1].match(/width[:="]+\s*([0-9]+)/i),r=i[a][1].match(/cellspacing="([\s\S]+?)"/i),o=i[a][1].match(/cellpadding="([\s\S]+?)"/i);e=e.replace(i[a][1]+i[a][0]+i[a][2],"\n"+Array(t+1).join("\t")+"[table"+(n?" border="+n[1]:"")+(s?" width="+s[1]:"")+(r?" cellspacing="+r[1]:"")+(o?" cellpadding="+o[1]:"")+"]"+WH.markup.tags.table.fromHtml(i[a][0],t+1)+"\n"+Array(t+1).join("\t")+"[/table]")}}return e}};WH.markup.tags.tier={empty:false,itrim:true,allowedChildren:{"tier-label":1,"tier-content":1},toNode:function(){return WH.ce("div",{className:"tier-list-tier"})}};WH.markup.tags["tier-content"]={trim:true,itrim:true,toNode:function(){return WH.ce("div",{className:"tier-content"})}};WH.markup.tags["tier-label"]={trim:true,itrim:true,attr:{bg:{req:false,valid:WH.markup.regex.noWhitespace},icon:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(e){let t=WH.ce("div",{className:"tier-label",dataset:{background:e.bg||"q0"}});if(e.icon){t.classList.add("fa","fa-"+e.icon)}let i=e._contents&&e._contents.lastChild;if(i&&i.nodeType===Node.TEXT_NODE){let e=i.nodeValue;let t=e.match(/[+-]$/);if(t){i.parentNode.replaceChild(WH.ce("span",{className:"tier-label-text",innerText:e.substr(0,e.length-1)},WH.ce("span",{className:"tier-label-superscript",innerText:t[0]})),i)}}return t}};WH.markup.tags["tier-list"]={block:true,empty:false,itrim:true,trim:true,allowedChildren:{tier:1},attr:{unnamed:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(e){return WH.ce("div",{className:e.unnamed?"tier-list-"+e.unnamed:"tier-list-rows"})}};WH.markup.tags.tr={empty:false,itrim:true,allowedChildren:{td:1},allowedParents:{table:1},attr:{background:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(e){var t=WH.ce("tr");WH.markup.applyCommonAttributes(t,e);if(e.background){t.dataset.background=e.background}return t},fromHtml:function(e,t){t=t||0;var i;if(i=WH.markup.matchOuterTags(e,"<tr\\b[\\s\\S]*?>","</tr>","g")){for(var a=0;a<i.length;++a){e=e.replace(i[a][1]+i[a][0]+i[a][2],"\n\t"+Array(t+1).join("\t")+"[tr]"+WH.markup.tags.tr.fromHtml(i[a][0],t+1)+"\n"+Array(t+1).join("\t")+"[/tr]")}}return e}};WH.markup.tags.td={empty:false,itrim:true,allowedParents:{tr:1},attr:{unnamed:{req:false,valid:/^header$/},align:{req:false,valid:/^(right|left|center|justify)$/i},background:{req:false,valid:WH.markup.regex.noWhitespace},colspan:{req:false,valid:/^[0-9]+$/},rowspan:{req:false,valid:/^[0-9]+$/},valign:{req:false,valid:/^(top|middle|bottom|baseline)$/i},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},toNode:function(e){var t=WH.ce(e.unnamed?"th":"td");WH.markup.applyCommonAttributes(t,e);if(e.align!=undefined){t.style.textAlign=e.align}if(e.valign!=undefined){t.style.verticalAlign=e.valign}if(e.colspan!=undefined){t.colSpan=e.colspan}if(e.rowspan!=undefined){t.rowSpan=e.rowspan}if(e.width!=undefined){t.style.width=e.width}if(e.background){t.dataset.background=e.background}return t},fromHtml:function(e,t){t=t||0;var i=["td","th"],a;for(var n=0;n<i.length;++n){if(a=WH.markup.matchOuterTags(e,"<"+i[n]+"\\b[\\s\\S]*?>","</"+i[n]+">","g")){for(var s=0;s<a.length;++s){var r=a[s][1].match(/width[:="]+\s*([0-9]+)/i),o=a[s][1].match(/align="([\s\S]+?)"/i),l=a[s][1].match(/valign="([\s\S]+?)"/i),c=a[s][1].match(/colspan="([\s\S]+?)"/i),u=a[s][1].match(/rowspan="([\s\S]+?)"/i);e=e.replace(a[s][1]+a[s][0]+a[s][2],"\n\t\t"+Array(t+1).join("\t")+"[td"+(i[n]=="th"?"=header":"")+(r?" width="+r[1]:"")+(o?" align="+o[1]:"")+(l?" valign="+l[1]:"")+(c?" colspan="+c[1]:"")+(u?" rowspan="+u[1]:"")+"]"+WH.markup.tags.td.fromHtml(a[s][0],t+1)+"[/td]")}}}return e}};WH.markup.tags.toc={block:true,post:true,trim:true,ltrim:true,rtrim:true,collect:{h2:1,h3:1,"major-heading":1,"minor-heading":1,toggler:1},exclude:{tabs:{h2:1,h3:1,"major-heading":1,"minor-heading":1},minibox:{h2:1,h3:1,"major-heading":1,"minor-heading":1}},allowedClass:WH.markup.CLASS.STAFF,attr:{h3:{req:false,valid:/^false$/},"minor-heading":{req:false,valid:/^false$/}},postParseNode:function(e,t){var i=document.createDocumentFragment();var a=WH.ce("h3",{className:"heading-size-3"});WH.ae(i,a);if(e.first){a.classList.add("first")}if(e.last){a.classList.add("last")}WH.markup.applyCommonAttributes(a,e);WH.st(a,WH.TERMS.tableofcontents);var n;var s;var r;var o=[i];r=WH.ce("ul");WH.ae(o[o.length-1],r);o.push(r);var l=WH.ce("b");var c=WH.ge("guide-view-toc");var u=null;if(c){i.removeChild(a);l=false;u=WH.ge("guide-navigation")}var d="";var f=e.h3!="false"&&e["minor-heading"]!="false";var h=[];for(var p in t.h2){h.push(t.h2[p])}for(var p in t["major-heading"]){h.push(t["major-heading"][p])}for(var p in t.h3){h.push(t.h3[p])}for(var p in t["minor-heading"]){h.push(t["minor-heading"][p])}for(var p in t.toggler){h.push(t.toggler[p])}h.sort((function(e,t){return e.offset-t.offset}));var m=false;for(var g in h){if(h[g].name=="h2"||h[g].name=="major-heading"){m=true;break}}for(let e in h){p=h[e];let i=p.attr.toc||(p.name==="toggler"?p.attr.name:p.attr._textContents);let a=WH.Strings.slug(p.attr.id||i,true);let n={href:"#"+a,rel:"np"};let c=function(e){WH.aE(WH.qs("a",e),"click",(function(e){e.preventDefault();WH.setHash(a);WH.scrollTo(WH.ge(a))}))};switch(p.name){case"toggler":if(p.attr.toc!="false"&&p.attr.name){var H=p.attr.size||3;if(H==3&&d=="h2"){r=WH.ce("ul");WH.ae(o[o.length-1],r);o.push(r)}else if(H==2&&d=="h3"){o.pop()}s=WH.ce("li");WH.ae(o[o.length-1],s);if(l){s.appendChild(l.cloneNode(false))}WH.ae(l?s.firstChild:s,WH.ce("a",n,WH.ct(i)));c(s);d="h"+H}break;case"h2":case"major-heading":if(p.attr.toc!="false"){if(d=="h3"){o.pop()}s=WH.ce("li");WH.ae(o[o.length-1],s);if(l){s.appendChild(l.cloneNode(false))}WH.ae(l?s.firstChild:s,WH.ce("a",n,WH.ct(i)));c(s);d="h2"}break;case"h3":case"minor-heading":if(f&&p.attr.toc!="false"&&(d!=""||t.h2.length==0||t["major-heading"].length==0)){if(d=="h2"){r=WH.ce("ul");WH.ae(o[o.length-1],r);o.push(r)}else if(!d&&m){WH.ae(o[o.length-1],WH.ce("li",{},WH.ct(WH.TERMS.overview)));r=WH.ce("ul");WH.ae(o[o.length-1],r);o.push(r)}s=WH.ce("li");WH.ae(o[o.length-1],s);if(l){s.appendChild(l.cloneNode(false))}WH.ae(l?s.firstChild:s,WH.ce("a",n,WH.ct(i)));c(s);d="h3"}break}}if(c){if(u){let e=WH.qs('a[href$="wowhead.com'+location.pathname+'"]',u);if(e){let t=WH.closest(c,"table");if(t){WH.de(t.parentNode)}e.classList.add("current");let a=WH.closest(e,"li");if(a){a.classList.add("fa","fa-arrow-right")}e.after(i);return null}}$(c).empty().append(i);return null}return i}};WH.markup.tags.toggler={empty:false,attr:{id:{req:false,valid:/^[a-z0-9_-]+$/i},closed:{req:false,valid:/^(true|false)$/i},class:{req:false,valid:/^[a-z0-9 _-]+$/i},icon:{req:false,valid:/^[a-z0-9 _-]+$/i},name:{req:false,valid:/^.+$/i},size:{req:false,valid:/^[2-6]$/i},toc:{req:false,valid:/^.+$/i},unnamed:{req:false,valid:/^hidden$/i}},toNode:function(e){if(e.id){var t=WH.ce("a");t.href="javascript:";t.className="disclosure-"+(e.unnamed?"off":"on");WH.aE(t,"click",WH.disclose.bind(null,"#"+e.id,t));return t}var i=document.createDocumentFragment();var a=(e.toc!=="false"&&e.toc?WH.Strings.slug(e.toc,true):"")||(e.name?WH.Strings.slug(e.name,true):"")||WH.Strings.guid();var n=WH.getMajorHeading("",e.size||3,undefined,{id:a});i.appendChild(n);var s=WH.ce("div");i.appendChild(s);s.dataset.markupContentTarget=1;if(e.closed=="true"){s.style.display="none"}var t=WH.ce("a");WH.ae(n,t);t.href="javascript:";t.className="toggler-"+(e.closed=="true"?"off":"on");WH.aE(t,"click",WH.toggle.bind(t,s));WH.ae(t,WH.ce("span",{className:"fa fa-chevron-right fa-fw"}));var r=WH.ce("span");WH.ae(t,r);r.className="toggler-title";if(e.icon){r.className+=" toggler-title-with-icon";r.appendChild(Icon.create(e.icon,0,null,false,null,null,null,null,true))}if(e["class"]){r.className+=" "+e["class"]}WH.ae(r,WH.ct(e.name||WH.TERMS.clicktotoggledisplay_stc));return i}};WH.markup.tags.u={empty:false,allowInReplies:true,toNode:function(e){var t=WH.ce("ins");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<(ins|u)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[u]$2[/u]")}};WH.markup.tags.ul={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{li:1,ul:1,ol:1},toNode:function(e){var t=WH.ce("ul");var i=[];if(e.first){i.push("first")}if(e.last){i.push("last")}if(i.length>0){t.className=i.join(" ")}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e,t){t=t||0;var i;if(i=WH.markup.matchOuterTags(e,"<ul\\b[\\s\\S]*?>","</ul>","g")){for(var a=0;a<i.length;++a){e=e.replace(i[a][1]+i[a][0]+i[a][2],"\n"+Array(t+1).join("\t")+"[ul]"+WH.markup.tags.ul.fromHtml(i[a][0],t+1)+"\n"+Array(t+1).join("\t")+"[/ul]")}}return e}};WH.markup.tags.url={allowedClass:WH.markup.CLASS.USER,allowInReplies:true,empty:false,helpText:"[url=https://www.google.com]"+WH.TERMS.link+"[/url]",attr:{unnamed:{req:false,valid:/\S+/},newwindow:{req:false,valid:/^true$/},onclick:{req:false,valid:/[\S ]+/},rel:{req:false,valid:/\S+/},style:{req:false,valid:/^[^"<>]+$/},tooltip2:{req:false,valid:/\S+/},tooltip:{req:false,valid:/\S+/}},validate:function(e){if(e.onclick&&WH.markup.allow<WH.markup.CLASS.ADMIN){return false}if(e.tooltip&&WH.markup.allow<WH.markup.CLASS.STAFF){return false}if(e.unnamed&&/^(mailto:|irc:)/i.test(e.unnamed.trim())&&WH.markup.allow<WH.markup.CLASS.STAFF){return false}if(e.unnamed&&/^(javascript:)/i.test(e.unnamed.trim())){return false}if(e.unnamed&&e.unnamed.match(/^\/\/https?:\/\//)){return false}return true},toNode:function(attr){let url;if(attr.unnamed){url=attr.unnamed;url=url.replace(/&amp;/,"&");if(url==="#"){url="javascript:"}else if(!url.match(/^([^:\\.\/]+):/i)&&url.charAt(0)!=="/"&&url.charAt(0)!=="#"){url="/"+url}}else{url=attr._textContents;url=url.replace(/&amp;/,"&")}if(!WH.markup.isUrlSafe(url,true)){return document.createDocumentFragment()}let a=WH.ce("a");let fixedUrl=url;let isExternal=false;WH.markup.applyCommonAttributes(a,attr);if(url[0]!=="#"){fixedUrl=WH.markup.getFixedUrl(url);isExternal=WH.markup.isUrlExternal(fixedUrl);if(WH.Url.isRelative(fixedUrl)){fixedUrl=WH.Url.generatePath(fixedUrl,WH.getDataEnv(),Locale.getId())}}a.href=fixedUrl;if(isExternal||attr.newwindow){a.target="_blank"}if(attr.rel){a.rel=attr.rel}if(attr.onclick){WH.aE(a,"click",function(code){return function(){eval(code)}}(attr.onclick))}if(attr.tooltip&&WH.markup.tooltipTags[attr.tooltip]){WH.aE(a,"mouseover",(function(e){WH.Tooltip.showAtCursor(e,WH.markup.tooltipTags[attr.tooltip],0,0,WH.markup.tooltipTagsWithRawText[attr.tooltip]?null:"q",attr.tooltip2&&WH.markup.tooltipTags[attr.tooltip2]?WH.markup.tooltipTags[attr.tooltip2]:null)}));WH.aE(a,"mousemove",WH.Tooltip.cursorUpdate);WH.aE(a,"mouseout",WH.Tooltip.hide)}return a},fromHtml:function(e){return e.replace(/<a\b[^>]*?href=\"(.+?)\"[\s\S]*?>([\s\S]*?)<\/a>/gi,"[url=$1]$2[/url]")}};WH.markup.tags.wowheadresponse={block:true,empty:false,rtrim:true,ltrim:true,itrim:true,attr:{unnamed:{req:true,valid:/[\S ]+/},roles:{req:true,valid:/[0-9]+/}},allowedModes:{article:1,quickfacts:1,comment:1},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=e.unnamed.trim();if(t.length<=0){return document.createDocumentFragment()}var i=WH.ce("div",{className:"quote",dataset:{markupContentTarget:1}});WH.markup.applyCommonAttributes(i,e);if(e.first){i.classList.add("firstmargin")}if(e.last){i.classList.add("last")}var a="comment-role-moderator";if(e.roles&U_GROUP_ADMIN){a="comment-role-admin"}i.classList.add(a);var n=WH.ce("small",{className:"icon-wowhead"});WH.ae(i,n);var s=WH.ce("b",{className:a});WH.ae(n,s);var r=WH.ce("a",{href:"/user="+t},WH.ct(t));WH.ae(s,r);WH.ae(n,WH.ct(WH.TERMS.wordspace_punct+WH.TERMS.said_colon));WH.ae(i,WH.ce("div",{className:"pad"}));return i}};WH.markup.tags["<text>"]={empty:true,noHelp:true,allowInReplies:true,toNode:function(){const e=new RegExp("(.*\\.)?("+["allakhazam.com","battle.net","be-imba.hu","blizzard.com","curse.com","elitistjerks.com","eq2interface.com","eqinterface.com","fanbyte.com","guildfans.com","guildwork.com","hearthhead.com","hearthstonetopdecks.com","joystiq.com","lotrointerface.com","mmo-champion.com","mmoui.com","raidbots.com","raider.io","sc2ranks.com","tankspot.com","thottbot.com","torchlightarmory.com","torhead.com","vginterface.com","vindictusdb.com","warcraftlogs.com","worldoflogs.com","worldofwarcraft.com","wow-europe.com","wow-heroes.com","wowhead.com","wowinsider.com","wowinterface.com","wowpedia.org","wowwiki.com","zam.com"].join("|").replace(/\./g,"\\.")+")","i");const t=/\/t?way(?: +([^/;\n\d]+|#\d+))? +(\d+(?:[.,]\d+)?),? +(\d+(?:[.,]\d+)?)(?: +([^/;\n]*[^ /;\n]\b\)?(?!:\/\/)))?/;const i=/(https?:\/\/|www\.)([\/_a-z0-9%?#@\-+~&=;:'|]|\.[a-z0-9\-])+/gi;function a(e){let t=[];WH.qsa(":scope > span[data-map-pin-json]",e.parentNode).forEach((function(e){try{let i=JSON.parse(e.dataset.mapPinJson);if(i){t.push([i.x,i.y])}}catch(e){}}));return t}function n(e){let t=[];WH.qsa(":scope > span[data-map-pin-json]",e.parentNode).forEach((function(e){try{let i=JSON.parse(e.dataset.mapPinJson);if(i&&i.uiMapId){let e=i.name;if(i.uiMapName){if(e){e=WH.term("parens_format",e,i.uiMapName)}else{e=i.uiMapName}}t.push(WH.Wow.UiMap.generateInGamePinLinkCommand(i.uiMapId,i.x,i.y,e))}}catch(e){}}));return t}function s(e){let t=[];WH.qsa(":scope > span[data-map-pin-json]",e.parentNode).forEach((function(e){try{let i=JSON.parse(e.dataset.mapPinJson);if(i){t.push(WH.Wow.UiMap.generateTomTomCommand([i.x,i.y],{uiMapId:i.uiMapId,uiMapName:i.uiMapName,name:i.name}))}}catch(e){}}));return t}function r(t){let i=t.match("[a-z]+://([a-z0-9.-]+)");return!i||i[1].search(e)===0}function o(){i.lastIndex=0;t.lastIndex=0}return function(e,l){l=l||$.noop;if(e._rawText===" "&&!l.noNbsp){e._rawText=WH.Strings.nbsp}e._rawText=e._rawText.replace(/\\\[/g,"[");e._rawText=e._rawText.replace(/&nbsp;/g,WH.Strings.nbsp).replace(/&ndash;/g,"–").replace(/&mdash;/g,"—");if(l&&l.needsRaw){return WH.ct(e._rawText)}let c=e._rawText.split("\n");let u=document.createDocumentFragment();let d=!(l&&l.noLink);let f;let h=function(e){if(e.index>0){WH.ae(u,WH.ct(f.substr(0,e.index)));f=f.substr(e.index)}let t=e[0];t=t.replace(/^www/,"https://www");if(WH.markup.allow<WH.markup.CLASS.USER&&!r(t)){let e=WH.ce("span",{className:"tip"},WH.ct(WH.TERMS.linkremoved));WH.Tooltip.simple(e,WH.TERMS.linkremoved_tip,"q");WH.ae(u,e)}else{let i=WH.ce("a",{href:t});if(WH.markup.isUrlExternal(t)){i.target="_blank"}WH.st(i,e[0]);WH.ae(u,i)}f=f.substr(e[0].length)};let p=function(e){if(e.index>0){WH.ae(u,WH.ct(f.substr(0,e.index)));f=f.substr(e.index)}let t;let i;let r=e[1]&&e[1].match(/^#(\d+)$/);if(r){t=r[1]}else{i=e[1]}let o=e[2].replace(/[.,]/,WH.TERMS.decimal_punct);let l=e[3].replace(/[.,]/,WH.TERMS.decimal_punct);let c=e[4];let d={name:c,x:o,y:l};let h=WH.ce("span",{className:"tip"},WH.ct(e[0]));let p={getAllCoords:a.bind(null,h),getAllInGameMapPins:n.bind(null,h),getAllTomTomCommands:s.bind(null,h),includeTomTom:true};if(t){d.uiMapId=t;p.uiMapId=t}else if(window.g_pageInfo&&g_pageInfo.uiMapId){d.uiMapId=g_pageInfo.uiMapId;p.uiMapId=g_pageInfo.uiMapId}if(i){d.uiMapName=i;p.uiMapName=i}if(c){p.name=c}h.dataset.mapPinJson=JSON.stringify(d);WH.Wow.UiMap.clickToCopyCoordinates(h,[o,l],p);WH.ae(u,h);f=f.substr(e[0].length)};let m;let g;if(!d){for(let e=0,i=c.length;e<i;e++){f=c[e];if(e>0){WH.ae(u,WH.ce("br"))}while(g=t.exec(f)){p(g);o()}if(f.length){WH.ae(u,WH.ct(f))}}}else{for(let e=0,a=c.length;e<a;e++){f=c[e];if(e>0){WH.ae(u,WH.ce("br"))}while(true){m=i.exec(f);g=t.exec(f);if(m&&g){if(g.index<m.index){p(g)}else{h(m)}}else if(m){h(m)}else if(g){p(g)}else{o();break}o()}if(f.length){WH.ae(u,WH.ct(f))}}}return u}}(),toText:function(e){return e._rawText}};WH.markup.tags.achievementpoints={empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("span",{className:"moneyachievement tip"},WH.ct(WH.numberFormat(e.unnamed)));WH.markup.applyCommonAttributes(t,e);WH.Tooltip.simple(t,"<b>"+WH.TERMS.achievementpoints_stc+"</b>","q1");return t}};WH.markup.tags.anchor={empty:true,ltrim:true,rtrim:true,attr:{unnamed:{req:false,valid:/\S+/}},validate:function(e){if(!e.unnamed&&!e.id){return false}return true},toNode:function(e){if(!e.unnamed&&e.id){e.unnamed=e.id;e.id=null}var t=WH.ce("a",{id:e.unnamed});WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.db={empty:true,attr:{unnamed:{req:true,valid:/^(live|ptr|beta|classic|tbc|bc|mop|wod|legion|bfa|shadowlands|sl|d2)$/}},toNode:function(e){WH.markup.setDataEnv(e.unnamed);return null},toText:function(e){WH.markup.setDataEnv(e.unnamed);return""}};WH.markup.tags.feedback={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{mailto:{req:false,valid:/^true$/i}},toNode:function(e){var t=WH.ce("a",{href:"mailto:feedback@wowhead.com"},WH.ct("feedback@wowhead.com"));if(!e.mailto){t.href="javascript:";WH.aE(t,"click",(function(){ContactTool.show()}))}var i=WH.ce("span",{className:"icontiny",style:{backgroundImage:"url("+WH.staticUrl+"/images/icons/email.gif)"}},t);return WH.ce("b",{},i)}};WH.markup.tags.forumrules={empty:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("a",{href:"/forums/topic/2"},WH.ct("forum rules"));var i=WH.ce("span",{className:"icontiny",style:{backgroundImage:"url("+WH.staticUrl+"/images/icons/favicon.gif)"}},t);return WH.ce("b",{},i)}};WH.markup.tags.html={empty:false,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{"<text>":1},rawText:true,invisibleContent:true,toNode:function(e){let t=e._contents.textContent;while(e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}t=t.replace(/http:\/\/([^\/:@]+\.)?(zamimg|wowhead)\.com\//g,"https://$1$2.com/");let i=WH.ce("div",{innerHTML:t});var a=i.getElementsByTagName("script");while(a.length){a[0].parentNode.replaceChild(WH.ct(a[0].outerHTML),a[0])}var n=document.createDocumentFragment();while(i.hasChildNodes()){n.appendChild(i.firstChild)}WH.markup.tags.html.removeEventAttributes(n);return n},removeEventAttributes:function(e){var t=e.childNodes;for(var i=0;i<t.length;i++){WH.markup.tags.html.removeEventAttributes(t[i])}if(e instanceof Element){var a=/^\s*javascript:/i;var n=e.getAttributeNames();for(var i=0;i<n.length;i++){if(n[i].substr(0,2).toLowerCase()==="on"||a.test(e.getAttribute(n[i]))){e.removeAttribute(n[i])}}}}};WH.markup.tags.markupdoc={empty:true,attr:{tag:{req:false,valid:/[a-z0-9]+/i}},allowedClass:WH.markup.CLASS.STAFF,validate:function(e){if(e.tag&&!WH.markup.tags[e.tag]){return false}return true},toNode:function(e){let t="";if(e.tag){t=WH.markup.tags.markupdoc.generateTagDocs(e.tag)}else{for(var i in WH.markup.tags){if(t!==""){t+='<div class="pad3"></div>'}t+=WH.markup.tags.markupdoc.generateTagDocs(i)}}let a=t;var n=WH.ce("div");n.innerHTML=a;var s=document.createDocumentFragment();while(n.firstChild!=null){s.appendChild(n.removeChild(n.firstChild))}return s},generateTagDocs:function(e){var t=WH.markup.tags[e];if(!t){return""}var i="";i='<div><h3 class="heading-size-3 first">Tag: ['+WH.markup.getEscapedHtml(e)+"]</h3>";i+='<table class="grid">';if(t.attr){i+='<tr><td align="right" width="200">Attributes:</td><td>';for(var a in t.attr){i+='<div style="margin: 5px; display: inline-block"><table><tr><th style="background-color: #242424; font-weight: bolder" colspan="2">';if(a=="unnamed"){i+="Self (["+e+"=???])"}else{i+=a}i+="</th></tr>";i+='<tr><td align="right">Required:</td><td>'+(t.attr[a].req?"Yes":"No")+"</td></tr>";i+='<tr><td align="right">Valid:</td><td>'+(t.attr[a].valid?WH.markup.getEscapedHtml(t.attr[a].valid.toString()):"--")+"</td></tr></table></div>"}i+="</td></tr>"}i+='<tr><td align="right" width="200">Has closing tag:</td><td>'+(t.empty?"No":"Yes")+"</td></tr>";i+='<tr><td align="right">Required group:</td><td>';if(t.allowedClass==WH.markup.CLASS.ADMIN){i+="Administrator"}else if(t.allowedClass==WH.markup.CLASS.STAFF){i+="Staff"}else if(t.allowedClass==WH.markup.CLASS.PREMIUM){i+="Premium"}else if(t.allowedClass&&t.allowedClass!=WH.markup.CLASS.PENDING){i+="Not pending"}else{i+="None"}i+="</td></tr>";if(t.allowedChildren){i+='<tr><td align="right">Allowed children:</td><td>';for(var n in t.allowedChildren){i+=WH.markup.getEscapedHtml(n)+"<br />"}i+="</td></tr>"}if(t.allowedParents){i+='<tr><td align="right">Allowed parents:</td><td>';for(var n in t.allowedParents){i+=WH.markup.getEscapedHtml(n)+"<br />"}i+="</td></tr>"}if(t.presets){i+='<tr><td align="right">Preset values:</td><td><table>';for(var s in t.presets){i+='<tr><td align="right">'+s+"</td><td>"+WH.markup.getEscapedHtml(t.presets[s])+"</td></tr>"}i+="</table></td></tr>"}if(t.trim){i+='<tr><td colspan="2">Trim whitespace</td></tr>'}if(t.ltrim){i+='<tr><td colspan="2">Trim preceding whitespace</td></tr>'}if(t.rtrim){i+='<tr><td colspan="2">Trim following whitespace</td></tr>'}if(t.itrim){i+='<tr><td colspan="2">Trim whitespace around interior content</td></tr>'}if(t.block){i+='<tr><td colspan="2">Automatically remove top padding if not the first item</td></tr>'}i+="</table></div>";return i}};WH.markup.tags.menu={empty:true,trim:true,ltrim:true,rtrim:true,attr:{tab:{req:true,valid:/^[0-9]+$/},path:{req:true,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=e.path.split(",");WH.Layout.set({activeTab:e.tab,breadcrumb:t});return null}};WH.markup.tags.random={empty:false,itrim:true,allowedChildren:{randomoption:1},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=[];for(var i=0;i<e._nodes.length;i++){if(e._nodes[i].name=="randomoption"){t.push(e._nodes[i].attr._contents)}}if(t.length==0){return e._contents}return t[Math.floor(Math.random()*t.length)]}};WH.markup.tags.randomoption={empty:false,rtrim:true,ltrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{random:1},toNode:function(e){return null}};WH.markup.tags.script={ltrim:true,rtrim:true,empty:false,attr:{src:{req:false,valid:/^\S+$/}},allowedClass:WH.markup.CLASS.ADMIN,allowedChildren:{"<text>":1},rawText:true,invisibleContent:true,toNode:function(e){if(e.src){$.getScript(e.src,(function(){try{$.globalEval(e._contents.textContent)}catch(e){WH.error("Markup script error:",e)}}))}else{try{$.globalEval(e._contents.textContent)}catch(e){WH.error("Markup script error:",e)}}return null}};WH.markup.tags["set-content-phase"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{type:{req:true,valid:/^\d+$/},typeid:{req:true,valid:/^\d+$/},phase:{req:true,valid:/^\d+(\.\d+)?$/}},toNode:function(e){var t=document.createDocumentFragment();var i=WH.ce("span");WH.ae(t,i);var a=WH.ce("a",{href:"javascript:",className:"fa fa-edit",style:{paddingLeft:"0.5em"},dataset:{phase:e.phase}});WH.ae(t,a);WH.aE(a,"click",(function(){var t=a.dataset.phase;if(t==0){t=undefined}WH.Wow.showContentPhasePrompt(e.type,[e.typeid],t,(function(e){a.dataset.phase=e?e:0;WH.st(i,e?e:"??")}))}));return t}};WH.markup.tags.style={ltrim:true,rtrim:true,empty:false,allowedClass:WH.markup.CLASS.ADMIN,allowedChildren:{"<text>":1},rawText:true,invisibleContent:true,toNode:function(e){WH.addCss(e._contents.textContent);return null}};WH.markup.tags["video-ad"]={allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:false,value:/^(left|right)$/}},empty:true,trim:true,toNode:function(e){if(!WH.WAS.showAds()){return WH.ce("div")}var t=WH.ce("div",{id:"video-pos-page"});if(e.unnamed){t.className="video-pos-"+e.unnamed}return t}};WH.markup.tags.visitedpage={empty:false,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){$.post("/visited-page",{id:e.unnamed},(function(){AchievementCheck()}));return null}};WH.markup.tags["--"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,trim:true,ltrim:true,rtrim:true,attr:{unnamed:{req:false}},toNode:function(e){return null},toText:function(e){return""}};WH.markup.Tree=function(){const e=WH.Strings;const t={collection:{},currentNode:null,currentOffset:0,guid:e.guid(),nodes:[],postNodes:[]};this.closeTag=function(e){if(WH.markup.tags[e].empty||WH.markup.tags[e].post){return false}if(!t.currentNode){return false}else if(t.currentNode.name===e){if(t.currentNode.nodes.length>0){let e=t.currentNode.nodes.length-1;if(WH.markup.tags[t.currentNode.name].itrim&&t.currentNode.nodes[e].name==="<text>"){let i=t.currentNode.nodes[e];i.attr=WH.markup.utility.rtrimText(i.attr);t.currentNode.nodes[e]=i}}t.currentNode=t.currentNode.parent}else if(WH.markup.tags[t.currentNode.name].allowedChildren&&WH.markup.tags[t.currentNode.name].allowedChildren[e]===undefined){return false}else{let i=function(t){for(let i=t.length-1;i>=0;i--){if(t[i].name===e){return i}}return-1};let a=t.currentNode.parent?i(t.currentNode.parent.nodes):i(t.nodes);if(a===-1){return false}}return true};this.openTag=function(e,i){let a=WH.markup.tags[e];if(e!=="<text>"&&a&&!a.allowedClass){a.allowedClass=WH.markup.CLASS.PENDING}if(!a){return false}else if(a.allowedModes&&a.allowedModes[WH.markup.modes[WH.markup.mode]]===undefined){return false}else if(a.allowedClass&&a.allowedClass>WH.markup.allow){return false}if(WH.markup.mode===WH.markup.MODE.REPLY&&!a.allowInReplies){return false}let n={attr:i,name:e,nodes:[],parent:null};Object.keys(n.attr).forEach((function(e){if(typeof n.attr[e]==="string"){n.attr[e]=n.attr[e].replace(/^http:\/\/([^\/:@]+\.)?(zamimg|wowhead)\.com\//,"https://$1$2.com/")}}));if(t.currentNode){n.parent=t.currentNode}if(a.allowedParents){if(n.parent!=null){if(a.allowedParents[n.parent.name]===undefined){return false}}else if(WH.markup.root===undefined||a.allowedParents[WH.markup.root]===undefined){return false}}if(n.parent&&WH.markup.tags[n.parent.name].allowedChildren&&WH.markup.tags[n.parent.name].allowedChildren[e]===undefined){return false}if(t.currentNode){if(t.currentNode.nodes.length===0&&n.name==="<text>"&&WH.markup.tags[t.currentNode.name].itrim){n.attr=WH.markup.utility.ltrimText(n.attr)}else if(t.currentNode.nodes.length>0){let e=t.currentNode.nodes.length-1;let i=WH.markup.utility.checkSiblingTrim(t.currentNode.nodes[e],n);t.currentNode.nodes[e]=i[0];n=i[1]}if(n.name==="<text>"){if(n.attr._rawText.length>0){t.currentNode.nodes.push(n)}}else{t.currentNode.nodes.push(n)}}else{if(t.nodes.length>0){let e=t.nodes.length-1;let i=WH.markup.utility.checkSiblingTrim(t.nodes[e],n);t.nodes[e]=i[0];n=i[1]}if(n.name==="<text>"){if(n.attr._rawText.length>0){t.nodes.push(n)}}else{t.nodes.push(n)}}if(!a.empty&&!a.post){t.currentNode=n}return true};this.toHtml=function(){let e=WH.ce("div");WH.ae(e,a(t.nodes));return e.innerHTML.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')};this.toNode=function(){t.postNodes=[];for(let e in WH.markup.collectTags){t.collection[e]=[]}a(t.nodes,true);let e=i(t.nodes,0,{});for(let i=0;i<t.postNodes.length;i++){let a=e.querySelector("#postNode-replace-"+i);let n=t.postNodes[i];let s=WH.markup.tags[n.name].postParseNode(n.attr,t.collection);s=WH.markup.assembleDomNode(s);a.parentNode.replaceChild(s,a)}let n=e.querySelectorAll("a");for(let e=0;e<n.length;e++){let t=n[e].href.match(/^http(s)?:\/\/([^\/:@]+\.)?wowhead\.com[\/:]/);if(!t){continue}let i=t[2]||"";if(!t[1]){n[e].href=n[e].href.replace(/^http:/,"https:")}let a=WH.markup.regex.subdomainEnv;for(let t in a){if(!a.hasOwnProperty(t)){continue}if(WH.markup.disabledEnvironments[t]&&a[t].test(i)){n[e].href=n[e].href.replace(i,i.replace(a[t],"$1")||"www.")}}}return e};function i(e,a,n){let s=document.createDocumentFragment();let r;if(a===0){t.currentOffset=0}for(let o=0;o<e.length;o++){let l=e[o];if(WH.markup.blockTags[l.name]&&a===0&&o===0||l.parent&&WH.markup.blockTags[l.parent.name]&&a>0&&o===0){l.attr.first=true}if(WH.markup.blockTags[l.name]&&o===e.length-1){l.attr.last=true}if(WH.markup.excludeTags[l.name]){n[l.name]=n[l.name]?n[l.name]+1:1}for(let e in n){for(let t in WH.markup.excludeTags[e]){if(WH.markup.excludeTags[e][t][l.name]){l.attr[t]="false"}}}if(WH.markup.collectTags[l.name]){l.offset=t.currentOffset++;t.collection[l.name].push(l)}if(WH.markup.tags[l.name].post){let e=document.createElement("div");e.id="postNode-replace-"+t.postNodes.length;s.appendChild(e);t.postNodes.push(l)}else if(WH.markup.tags[l.name].empty){if(l.parent&&WH.markup.tags[l.parent.name].rawText){try{r=WH.markup.tags[l.name].toNode(l.attr,{needsRaw:true,treeGuid:t.guid})}catch(e){r=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error! Tag: "+l.name+" "+e));WH.error(e)}}else{try{r=WH.markup.tags[l.name].toNode(l.attr,{noLink:l.parent&&l.parent.name==="url",treeGuid:t.guid})}catch(e){r=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error! Tag: "+l.name+" "+e));WH.error(e)}}s.appendChild(WH.markup.assembleDomNode(r))}else{let e=i(l.nodes,a+1,n);l.attr._contents=e;l.attr._nodes=l.nodes;try{r=WH.markup.tags[l.name].toNode(l.attr,{treeGuid:t.guid})}catch(e){r=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error! Tag: "+l.name+" "+e));WH.error(e)}s.appendChild(WH.markup.assembleDomNode(r,e))}if(n[l.name]){n[l.name]--;if(n[l.name]===0){delete n[l.name]}}}return s}function a(e,i){let n=document.createDocumentFragment();for(let s=0;s<e.length;s++){let r=e[s];let o=a(r.nodes,i);if(i){r.attr._textContents=o.textContent}else{r.attr._contents=o}if(r.name==="<text>"){n.appendChild(WH.markup.assembleDomNode(WH.markup.tags[r.name].toNode(r.attr,{noLink:true,noNbsp:true,treeGuid:t.guid})))}else if(WH.markup.tags[r.name].toText){n.appendChild(document.createTextNode(WH.markup.tags[r.name].toText(r.attr)))}if(!WH.markup.tags[r.name].invisibleContent){n.appendChild(o)}}return n}};WH.markup.utility=new function(){this.ltrimText=function(e){e._rawText=e._rawText.trimStart();return e};this.rtrimText=function(e){e._rawText=e._rawText.trimEnd();return e};this.checkSiblingTrim=function(e,t){if(t.name=="<text>"&&(WH.markup.tags[e.name].rtrim||WH.markup.tags[e.name].trim)){t.attr=WH.markup.utility.ltrimText(t.attr)}else if(e.name=="<text>"&&(WH.markup.tags[t.name].ltrim||WH.markup.tags[t.name].trim)){e.attr=WH.markup.utility.rtrimText(e.attr)}return[e,t]}};WH.markup.init();WH.MD5=new function(){function e(e,t){var r=e[0],o=e[1],l=e[2],c=e[3];r=i(r,o,l,c,t[0],7,-680876936);c=i(c,r,o,l,t[1],12,-389564586);l=i(l,c,r,o,t[2],17,606105819);o=i(o,l,c,r,t[3],22,-1044525330);r=i(r,o,l,c,t[4],7,-176418897);c=i(c,r,o,l,t[5],12,1200080426);l=i(l,c,r,o,t[6],17,-1473231341);o=i(o,l,c,r,t[7],22,-45705983);r=i(r,o,l,c,t[8],7,1770035416);c=i(c,r,o,l,t[9],12,-1958414417);l=i(l,c,r,o,t[10],17,-42063);o=i(o,l,c,r,t[11],22,-1990404162);r=i(r,o,l,c,t[12],7,1804603682);c=i(c,r,o,l,t[13],12,-40341101);l=i(l,c,r,o,t[14],17,-1502002290);o=i(o,l,c,r,t[15],22,1236535329);r=a(r,o,l,c,t[1],5,-165796510);c=a(c,r,o,l,t[6],9,-1069501632);l=a(l,c,r,o,t[11],14,643717713);o=a(o,l,c,r,t[0],20,-373897302);r=a(r,o,l,c,t[5],5,-701558691);c=a(c,r,o,l,t[10],9,38016083);l=a(l,c,r,o,t[15],14,-660478335);o=a(o,l,c,r,t[4],20,-405537848);r=a(r,o,l,c,t[9],5,568446438);c=a(c,r,o,l,t[14],9,-1019803690);l=a(l,c,r,o,t[3],14,-187363961);o=a(o,l,c,r,t[8],20,1163531501);r=a(r,o,l,c,t[13],5,-1444681467);c=a(c,r,o,l,t[2],9,-51403784);l=a(l,c,r,o,t[7],14,1735328473);o=a(o,l,c,r,t[12],20,-1926607734);r=n(r,o,l,c,t[5],4,-378558);c=n(c,r,o,l,t[8],11,-2022574463);l=n(l,c,r,o,t[11],16,1839030562);o=n(o,l,c,r,t[14],23,-35309556);r=n(r,o,l,c,t[1],4,-1530992060);c=n(c,r,o,l,t[4],11,1272893353);l=n(l,c,r,o,t[7],16,-155497632);o=n(o,l,c,r,t[10],23,-1094730640);r=n(r,o,l,c,t[13],4,681279174);c=n(c,r,o,l,t[0],11,-358537222);l=n(l,c,r,o,t[3],16,-722521979);o=n(o,l,c,r,t[6],23,76029189);r=n(r,o,l,c,t[9],4,-640364487);c=n(c,r,o,l,t[12],11,-421815835);l=n(l,c,r,o,t[15],16,530742520);o=n(o,l,c,r,t[2],23,-995338651);r=s(r,o,l,c,t[0],6,-198630844);c=s(c,r,o,l,t[7],10,1126891415);l=s(l,c,r,o,t[14],15,-1416354905);o=s(o,l,c,r,t[5],21,-57434055);r=s(r,o,l,c,t[12],6,1700485571);c=s(c,r,o,l,t[3],10,-1894986606);l=s(l,c,r,o,t[10],15,-1051523);o=s(o,l,c,r,t[1],21,-2054922799);r=s(r,o,l,c,t[8],6,1873313359);c=s(c,r,o,l,t[15],10,-30611744);l=s(l,c,r,o,t[6],15,-1560198380);o=s(o,l,c,r,t[13],21,1309151649);r=s(r,o,l,c,t[4],6,-145523070);c=s(c,r,o,l,t[11],10,-1120210379);l=s(l,c,r,o,t[2],15,718787259);o=s(o,l,c,r,t[9],21,-343485551);e[0]=f(r,e[0]);e[1]=f(o,e[1]);e[2]=f(l,e[2]);e[3]=f(c,e[3])}function t(e,t,i,a,n,s){t=f(f(t,e),f(a,s));return f(t<<n|t>>>32-n,i)}function i(e,i,a,n,s,r,o){return t(i&a|~i&n,e,i,s,r,o)}function a(e,i,a,n,s,r,o){return t(i&n|a&~n,e,i,s,r,o)}function n(e,i,a,n,s,r,o){return t(i^a^n,e,i,s,r,o)}function s(e,i,a,n,s,r,o){return t(a^(i|~n),e,i,s,r,o)}function r(t){var i=t.length,a=[1732584193,-271733879,-1732584194,271733878],n;for(n=64;n<=t.length;n+=64){e(a,o(t.substring(n-64,n)))}t=t.substring(n-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<t.length;n++)s[n>>2]|=t.charCodeAt(n)<<(n%4<<3);s[n>>2]|=128<<(n%4<<3);if(n>55){e(a,s);for(n=0;n<16;n++)s[n]=0}s[14]=i*8;e(a,s);return a}function o(e){var t=[],i;for(i=0;i<64;i+=4){t[i>>2]=e.charCodeAt(i)+(e.charCodeAt(i+1)<<8)+(e.charCodeAt(i+2)<<16)+(e.charCodeAt(i+3)<<24)}return t}var l="0123456789abcdef".split("");function c(e){var t="",i=0;for(;i<4;i++)t+=l[e>>i*8+4&15]+l[e>>i*8&15];return t}function u(e){for(var t=0;t<e.length;t++)e[t]=c(e[t]);return e.join("")}function d(e){return u(r(e))}function f(e,t){return e+t&4294967295}if(d("hello")!="5d41402abc4b2a76b9719d911017c592"){function f(e,t){var i=(e&65535)+(t&65535),a=(e>>16)+(t>>16)+(i>>16);return a<<16|i&65535}}this.hash=function(e){return d(e)}};var Menu=new function(){const e=this;const t=WH.Game;const i="menu-item-heading";const a="menu-item-spacer";const n="unlinked";var s=100;var r=333;const o=0;const l=1;const c=2;const u=3;const d=4;e.ITEM_CRUMB=o;e.ITEM_LABEL=l;e.ITEM_URL=c;e.ITEM_SUBMENU=u;e.ITEM_OPTIONS=d;var f=520;var h=4;var p=2;var m=26;var g=6;var H=6;var W=[mn_icons];var v=[{menu:mn_classHalls,paths:[[30]]},{menu:mn_forums,paths:[["classes"]]},{menu:mn_items,paths:[[4,1],[4,2],[4,3],[4,4],[1],[0],[16],[7],[6],[9],[-2,0,"*"],[-2,1,"*"],[-2,2],[-2,16],[-2,4],[-2,5],[-2,6],[-2,7],[-3]]},{menu:mn_spells,paths:[[7],[-17],[-18],[-13],[-16],[-12],[-2],[50],[52],[54],[-3],[-3,"*"],[-7],[11],[9]]},{menu:mn_zones,paths:[[9],["classHalls"]]}];const _={currentMenu:null,divCache:{},menuItemsCache:{},menuOpener:null,nextUniqueId:0,openLinks:{},showingHeaderMenu:false,timer:{hideMenu:null,showMenu:null},visibleMenus:{}};e.add=function(e,t,i,a){i=i||{};var n;if(typeof e==="string"){e=WH.qs(e);n=$(e)}else if(e instanceof jQuery){if(!e.length){WH.error("Tried to add a menu to an empty jQuery object.");return}n=e;e=e.get(0)}else{n=$(e)}if(!e){WH.error("Tried to add a menu to an invalid target.");return}if(i.onShow){t.onShow=i.onShow}if(i.onHide){t.onHide=i.onHide}if(i.padded){t.padded=i.padded}n.data("menu",t);T(e,i);if(i.showImmediately){if(i.showAtCursor){J.call(this,a)}else{ee.call(this,a)}}};e.addButtons=function(t,i,a){var n=$(t);if(!n.length){return}var s=$('<span class="menu-buttons"></span>');$.each(i,(function(t,n){if(B(n)){return}if(!G(n)){return}var r=$("<a></a>");var o=$("<span></span>",{text:n[l]}).appendTo(r);e.linkifyItem(n,r);r.data("parentMenu",i).data("menuItem",n);if(n[d]&&n[d].rel){r.attr("rel",n[d].rel)}var c=e.getSubmenu(n);if(c){o.addClass("hassubmenu");if(Platform.isTouch()){pe.add(r.get(0),c)}else{e.add(r,c,{padded:a&&a.padded,showAtElement:a&&a.menusOnClick})}}s.append(r)}));n.append(s)};e.addToSubmenu=function(t,i){var a=e.getSubmenu(t);if(a){a.push(i)}else{t[u]=[i]}};this.createItem=function(t){let i=[];["crumb","label","url","submenu","options"].forEach((function(a){if(t.hasOwnProperty(a)){i[e["ITEM_"+a.toUpperCase()]]=t[a]}}));if(i[o]==null){i[o]=""}return i};this.createHeading=function(t){let i=[];["crumb","label","url","submenu","options"].forEach((function(a){if(t.hasOwnProperty(a)){i[e["ITEM_"+a.toUpperCase()]]=t[a]}}));if(!i[d]){i[d]={}}i[d].heading=true;return i};this.createSpacer=function(){return[null,null,null,null,{spacer:true}]};e.findItem=function(t,i){return e.getFullPath(t,i).pop()};e.getFeaturedNavigationMenu=function(){const i=WH.Wow.PlayerClass;const a=WH.Wow.PlayerClass.Specialization;let n=e.getMenu("featuredNav_"+WH.getDataTreeKey())||[];if(!n.length){n=e.getMenu({[WH.dataTree.CLASSIC]:"classic_featuredContent",[WH.dataTree.TBC]:"burningCrusade_featuredContent",[WH.dataTree.RETAIL]:"featuredContent"}[WH.getDataTree()]||"")||[]}if(t.get()===t.WOW&&!Menu.findItem(n,["classes"])){var s=[];for(var r=0,c=mn_specialization.length;r<c;r++){var u=mn_specialization[r];let t=Menu.getSubmenu(u);if(!t){continue}let n=u[o];s.push(Menu.createHeading({crumb:n,label:u[l]}));for(let r=0,c;c=t[r];r++){let t=JSON.parse(JSON.stringify(c[d]));t.className="c"+n;s.push(e.createItem({crumb:c[o],label:c[l],url:"/"+a.getSlug(n,c[o])+"-"+i.getSlug(n)+"-guide",options:t}))}}var f=[];while(f.length<2){var h=Math.floor(Math.random()*12)+1;if(f.indexOf(h)===-1){f.push(h)}}n.unshift(["classes",WH.TERMS.classes,"/classes",s,{className:"header-nav-classes first-"+f[0]+" second-"+f[1],zulNoHref:true}])}return n};e.getFullPath=function(t,i){var a=[];var n=function(i,a){if(!t){return null}var s=C(t,i);if(s!==-1){var r=[];var o=t[s];if(o[d]&&o[d].breadcrumbParent){var l=n(o[d].breadcrumbParent,true);if(l){r.push(l.pop())}}o.parentMenu=t;if(!a){t=e.getSubmenu(o)}r.push(o);return r}return null};for(var s=0;s<i.length;++s){var r=n(i[s]);if(r){for(var o=0,l;l=r[o];o++){a.push(l)}}}return a};e.getItemCrumb=function(e){if(!e[o]){e[o]={}}return e[o]};e.getItemOptions=function(e){if(!e[d]){e[d]={}}return e[d]};e.getItemUrl=function(e){var t=e[c];if(!t){return null}if(e.modifyUrl){t=WH.modifyUrl(t,e.modifyUrl.params,e.modifyUrl.opt,e)}return t};e.getLabel=function(e,t){let i=e[l];if(e[d]){let a=e[d];if(a.generateText){i=a.generateText(e)}if(t===true){if(a.breadcrumb){i=a.breadcrumb}}else{if(typeof a.prefix==="string"){i=a.prefix+i}else if(typeof a.prefix==="object"){let e=a.prefix[0];for(let t in a.prefix.replacements){if(a.prefix.replacements.hasOwnProperty(t)){e=e.replace(t,a.prefix.replacements[t])}}i=e+i}}if(a.replacements){for(let e in a.replacements){if(a.replacements.hasOwnProperty(e)){i=i.replace(e,a.replacements[e])}}}}return i};e.getMenu=function(e){if(e===undefined){e="path"}return window["mn_"+e]};e.getOpener=function(){return Y()?_.menuOpener:null};e.getSubmenu=function(e){var t=e[u];if(typeof t==="string"){t=Menu.getMenu(t)}return t&&t.length?t:null};e.hasSubmenuContent=function(t){return P(e.getSubmenu(t))};e.hide=function(e){re(false);if(Platform.isTouch()){pe.closeAllMenus();return}Q(null,e);z()};e.isHeading=function(e){return B(e)};e.linkifyItem=function(t,i){var a=e.getItemOptions(t);if(typeof t[d]=="object"&&t[d].className){i.addClass(t[d].className)}if(typeof t[d]=="object"&&t[d].onMouseOver){i.mouseover(t[d].onMouseOver)}if(typeof t[d]=="object"&&t[d].onMouseOut){i.mouseout(t[d].onMouseOut)}if(!t[c]){i.attr("href","javascript:");i.addClass(n);if(a.tooltip){i.attr("href",a.tooltip);i.click(WH.rf)}return false}if(typeof t[c]=="function"){i.attr("href","javascript:");i.click(U);if(a.tooltip){i.attr("href",a.tooltip);i.click(function(e,t){e(t);return false}.bind(null,t[c]))}else{i.click(t[c])}if(a.rel){i.attr("rel",a.rel)}}else{var s=e.getItemUrl(t);i.attr("href",s);if(a.newWindow||WH.isExternalUrl(s)){i.attr("target","_blank")}if(a.rel){i.attr("rel",a.rel)}else if(typeof s==="string"&&(s.indexOf("/guides/")===0||s.indexOf("/guide=")===0)){i.attr("rel","np")}}return true};e.map=function(t,i,a){i.className+=" menu-map";for(var n=0,s;s=t[n];n++){if(s[d]&&s[d].menuMapHide){continue}WH.ae(i,WH.getMajorHeading(typeof s[c]=="string"?'<a href="'+e.getItemUrl(s)+'">'+s[l]+"</a>":s[l],2));var r=e.getSubmenu(s);if(r instanceof Array){var o=WH.ce("div",{className:"menu-map-section"});var u=null;var f=WH.ce("div",{className:"menu-map-submenu-group"});for(var h=0,p=r.length;h<p;h++){var m=r[h];if(m[d]&&m[d].menuMapHide){continue}if(B(m)){WH.ae(o,f);f=WH.ce("div",{className:"menu-map-submenu-group"});u=m[l];WH.ae(o,WH.getMajorHeading(typeof m[c]=="string"?'<a href="'+e.getItemUrl(m)+'">'+m[l]+"</a>":m[l],3));continue}var g=e.getSubmenu(m);if(a&&a.noEmptySubmenus&&!g){continue}var H=WH.getMajorHeading(typeof m[c]=="string"?'<a href="'+e.getItemUrl(m)+'">'+m[l]+"</a>":m[l],4);var W=WH.ce("div",{className:"menu-map-submenu"},H);if(m[l]==u){W.setAttribute("data-duplicate-heading","true")}if(g){e.addButtons(W,g,{menusOnClick:true})}WH.ae(f,W)}WH.ae(o,f);WH.ae(i,o)}}};e.modifyUrl=function(e,t,i){var a={params:t,opt:i};he(e,(function(e){e.modifyUrl=a}));WH.Layout.updateBreadcrumb()};e.prepareForZul=function(e,t){b();return ie(e,t)};e.render=function(e,t){return ne(e,0,true,t)};this.setItemOption=function(e,t,i){if(!e[d]){e[d]={}}e[d][t]=i};e.setSubmenu=function(e,t){e[u]=t};e.show=function(e,t){if(Platform.isTouch()){pe.onRootNodeClick.call(t,null,e)}else{re(WH.closest(t,".header")!==undefined);oe(e,t)}};e.showAtCursor=function(e,t){if(Platform.isTouch()){pe.onNodelessClick(e,t);return}_.currentMenu=e;le(e,t.pageX,t.pageY)};e.sort=function(e,t){if(WH.inArray(e,true,B)!==-1){ue(e,t)}else{ce(e,t)}};e.sortGlobalMenus=function(){if(Locale.getId()===LOCALE_ENUS){return}for(var e=0,t=W.length;e<t;e++){Menu.sort(W[e])}for(var i=0,a=v.length;i<a;i++){de(v[i].menu,v[i].paths)}};e.updateItem=function(t){var i=t.$a;if(!i){return}var a=e.getItemOptions(t);i.removeClass("checked tinyicon icon");i.css("background-image","");if(t.checked){i.addClass("checked fonticon");i.prepend('<i class="fa fa-check fa-size-s fa-color-white fonticon-icon"/>')}else{var n=false;var s=function(e){switch(typeof e){case"string":return e;break;case"function":var i=e(t);if(typeof i=="string"){return i}break}return false};if(!n&&a.armory){var r=s(a.armory);if(r){n=true;i.addClass("armoryicon");i.css("background-image","url("+r+")")}}if(!n&&a.fontIcon){var o=s(a.fontIcon);if(o){n=true;i.addClass("fonticon");i.prepend('<i class="fa fa-'+o+' fonticon-icon"/>')}}if(!n&&a.tinyIcon){var l=s(a.tinyIcon);if(l){n=true;i.addClass("tinyicon");i.css("background-image","url("+WH.getTinyIconUrl(l)+")")}}if(!n&&a.icon){var c=s(a.icon);if(c){n=true;i.addClass("icon");i.css("background-image","url("+c+")")}}if(!n&&a.socketColor){var u=s(a.socketColor);if(u&&g_file_gems[u]){n=true;i.addClass("socket-"+g_file_gems[u])}}}if(a.np){i.attr("rel","np")}var d=a["class"]||a.className;if(d){i.addClass(d)}if(a.attributes){for(var f in a.attributes){if(a.attributes.hasOwnProperty(f)){i.attr(f,a.attributes[f])}}}};function T(e,t){if(t.noEvents){return}if(Platform.isTouch()){WH.aE(e,"click",pe.onRootNodeClick);return}if(t.showAtCursor){if(t.leftAndRightClick){e.oncontextmenu=WH.rf;WH.aE(e,"click",(function(e){if(e.which===2){return}J.call(this,e);e.preventDefault()}));WH.aE(e,"mouseup",X.bind(this,J))}else if(t.rightClick){e.oncontextmenu=WH.rf;WH.aE(e,"mouseup",X.bind(this,J))}else{WH.aE(e,"click",J)}}else if(t.showAtElement){if(t.leftAndRightClick){e.oncontextmenu=WH.rf;WH.aE(e,"click",(function(e){if(e.which===2){return}ee.call(this,e);e.preventDefault()}));WH.aE(e,"mouseup",X.bind(this,ee));WH.aE(e,"mouseleave",Q)}else if(t.rightClick){e.oncontextmenu=WH.rf;WH.aE(e,"mouseup",X.bind(this,ee));WH.aE(e,"mouseleave",Q)}else{WH.aE(e,"click",(function(e){if(e.which===2||this.classList.contains("open")){return}ee.call(this,e);e.preventDefault()}));WH.aE(e,"mouseleave",Q)}}else{WH.aE(e,"mouseenter",ee);WH.aE(e,"mouseleave",Q)}}function b(){Menu.findItem(mn_lists,[101])[c]=WH.Profiler.create;$(window).keyup(function(e,t){if(t.keyCode==27){e()}}.bind(null,U));var e=$('<div class="menu"><a href="#"><span>ohai</span></a></div>').css({left:"-1000px",top:"-1000px"}).appendTo(document.body);var t=e.children("a").outerHeight();e.remove();if(t&&!isNaN(t)&&t!=m){m=t}b=function(){}}function E(t){var i=e.getItemOptions(t);if(typeof i.regenerateMenuItem==="function"){WH.cO(t,i.regenerateMenuItem(t))}if(i.checkedUrl&&location.href.match(i.checkedUrl)){t.checked=true}if(typeof i.checkedFunc=="function"){t.checked=i.checkedFunc(t)}}function y(t){if(t.onBeforeShow){t.onBeforeShow(t)}for(var i=0,a=t.length;i<a;i++){if(!(t[i]instanceof Array)){return}var n=e.getItemOptions(t[i]);if(n.onBeforeShow){n.onBeforeShow(t[i])}}}function S(e){while(_.openLinks[e]){_.openLinks[e].classList.remove("open");_.openLinks[e]=null;e++}}function w(e,t,i,a){var n;if(!isNaN(t)&&_.divCache[t]){n=_.divCache[t];n.children().detach();n.css({left:0,top:0});se(n[0],e);if(i.padded&&WH.isRetailTree()){n.addClass("menu-padded")}return n}n=$("<div></div>").data("depth",t).mouseenter(Z.bind(null,t)).mouseleave(K).delegate("a","mouseenter",{depth:t},j).delegate("a","click",V);se(n[0],e);if(i.padded&&WH.isRetailTree()){n.addClass("menu-padded")}if(a!==true&&!isNaN(t)){_.divCache[t]=n}return n}function I(e,t){var a=e.length;var n=$(window).height()-p*2-g;var s=Math.floor(Math.max(0,n)/m);var r=Math.floor(f/m);var o;var l=false;if(a>0){o=e[0].find("a").first();if(r<s&&!o.data("noSoftColumns")){l=true;s=r}}var c=[];var u=-1;if(a>0){if(o.data("column")){e.each((function(){var e=$(this).find("a").first().data("column");if(e){u=e-1}if(!c[u]){c[u]=$("<td/>",{class:"menu-column"})}c[u].append(this)}))}else if(s<a){var d=Math.min(h,Math.ceil(a/s));var H=Math.ceil(a/d);var W=0;var v=a;var _=0;while(v>0){u++;var T=Math.min(v,H);var b=W;var E=b+T;if(l){if(_!=0){E+=_;T+=_;_=0}if(e[E-1]&&e[E-1].hasClass(i)){E--;T--;_=1}if(e[E]&&!e[E].hasClass(i)){if(e[E-2]&&e[E-1]&&e[E]&&e[E-2].hasClass(i)&&!e[E-1].hasClass(i)){if(e[E+1]&&e[E+2]&&!e[E+1].hasClass(i)&&e[E+2].hasClass(i)){E+=2;T+=2}else{E-=2;T-=2;_=2}}if(e[E]&&e[E+1].hasClass(i)){E+=1;T+=1}if(e[E+1]&&e[E+2]&&!e[E+1].hasClass(i)&&e[E+2].hasClass(i)){E+=2;T+=2}}}e.slice(b,E).each((function(){if(!c[u]){c[u]=$("<td/>",{class:"menu-column"})}c[u].append(this)}));W+=T;v-=T}}}if(c.length){var y=WH.ce("div",{className:"menu-outer"});var S=WH.ce("div",{className:"menu-inner"});var w=WH.ce("table",{className:"menu-columns"});var I=WH.ce("tbody");var N=$("<tr/>");WH.ae(y,S);WH.ae(S,w);WH.ae(w,I);for(var R=0,M;M=c[R];R++){N.append(M)}N.appendTo(I);return{columns:c.length,menu:y,padded:t}}var A=$('<div class="menu-outer"></div>');var k=$('<div class="menu-inner"></div>');e.each((function(){k.append(this)}));A.append(k);return{menu:A,padded:t}}function N(t){E(t);var s=$("<div/>",{class:"menu-item"});var r=$("<a/>").appendTo(s);t.$a=r;r.data("menuItem",t);let o=e.getLabel(t);let l=true;if(t[d]&&t[d].spacer){r.addClass(a);r.addClass(n);l=false}else{if(B(t)){r.addClass(i);r.text(o);l=false}e.linkifyItem(t,r)}e.updateItem(t);if(t[d]){if(t[d].column){r.data("column",t[d].column)}if(t[d].noSoftColumns){r.data("noSoftColumns",t[d].noSoftColumns)}if(t[d].modifyTooltip){r.get(0)._fixTooltip=t[d].modifyTooltip}if(t[d].modifyTooltip2){r.get(0)._fixTooltip2=t[d].modifyTooltip2}if(t[d].extraActions){for(var c=0,u=t[d].extraActions.length;c<u;c++){var f=t[d].extraActions[c];var h=WH.ce("a");if(f.fontIcon){h.classList.add("fa");if(f.fontIcon.indexOf(" ")!==-1){var p=f.fontIcon.split(" ");for(var m=0,g=p.length;m<g;m++){h.classList.add("fa-"+p[m])}}else{h.classList.add("fa-"+f.fontIcon)}}else{h.classList.add("fa");h.classList.add("fa-circle");h.classList.add("fa-size-s")}if(typeof f.url==="string"){h.href=f.url}else if(typeof f.callback==="function"){WH.aE(h,"click",f.callback)}if(typeof f.tooltipText!=="undefined"){WH.Tooltip.simple(h,f.tooltipText,typeof f.tooltipClass!=="undefined"?f.tooltipClass:"q2",true)}for(var H in f){if(!f.hasOwnProperty(H)){continue}switch(H){case"callback":case"fontIcon":case"tooltipClass":case"tooltipText":case"url":break;default:h.setAttribute(H,f[H])}}s.append(h)}}}if(l){let i;if(typeof o=="object"&&o!=null&&"tagName"in o&&o.tagName.toLowerCase()==="span"){let e;while(e=o.getElementsByTagName("span")[0]){let t=document.createElement("div");t.className=e.className;$.extend(t.style,e.style);t.style.display="inline";let i;while(i=e.firstChild){i.parentNode.removeChild(i);t.appendChild(i)}e.parentNode.insertBefore(t,e);e.parentNode.removeChild(e)}i=$(o).clone()}else{i=$("<span></span>");i.text(o)}i.appendTo(r);if(e.getSubmenu(t)){i.addClass("hassubmenu")}}return s}function R(e,t){var i=D(e);if(_.menuItemsCache[i]){return _.menuItemsCache[i]}let a;let n=[];$.each(e,(function(e,i){if(!(i instanceof Array)){i=["","Error: Invalid menu item",null,null,{className:"q10"}];WH.error("Trying to render an invalid menu item.",typeof i)}if(!G(i)){return}var s=N(i);if(!t&&B(i)){a=s;return}if(a){n.push(a);a=null}n.push(s)}));var s=$(n);_.menuItemsCache[e]=s;return s}function M(e,t,i){S(0);A(e,0,t,i);q(1)}function A(e,t,i,a,n){b();if(typeof e=="function"){e=e()}y(e);var s=ne(e,t);s.appendTo(document.body);var r=!Y(t);_.visibleMenus[t]=s;for(let e=0,i;i=_.visibleMenus[e];e++){i.attr("data-reverse-tier",t-e+1)}let o=t===0?L(s,t,_.showingHeaderMenu,i,a):O(s,t,_.showingHeaderMenu,n);s.css({position:_.showingHeaderMenu?"fixed":"absolute",left:o.x+"px",top:o.y+"px"});var l=WH.createRect(o.x,o.y,s.width(),s.height());WH.WAS.intersect(l,true);if(r){s.addClass("animated-reveal")}s.show()}function k(t,i){t.splice(0,t.length);i.forEach((function(i){if(i[l]){t.push(e.createHeading({crumb:i[o],label:i[l],url:i[c],options:i[d]}))}let a=e.getSubmenu(i);if(a){a.forEach((function(e){t.push(e)}))}}))}function C(e,t){t=t.toString();return e.findIndex((e=>(e[o]==null?"":e[o].toString())===t))}function L(e,t,i,a,n){var s=WH.getViewport();var r=e.width();var o=e.height();var l=r+H;var c=o+g;var u=a!=null&&n!=null;if(u){if(n+c>s.b){n=Math.max(s.t,s.b-c)}}else{let e=WH.getOffset(_.menuOpener,i);a=e.left;n=e.top+_.menuOpener.offsetHeight;if(_.menuOpener.classList.contains("imitation-select")){a-=2}if(n+c>s.b&&e.top>=c){n=e.top-c}}if(a+l>s.r){a=Math.max(s.l,s.r-l)}return{x:a,y:n}}function O(e,t,i,a){var n=WH.getViewport();var s=e.width();var r=e.height();var o=s+H;var l=r+g;let c=_.openLinks[t-1];let u=WH.getOffset(c,i);var d=u.left+c.offsetWidth-5;var f=u.top-2;if(WH.isClassicTree()||WH.isTbcTree()){if(WH.Theme.isClassic()&&a){f--}else if(WH.Theme.isThottbot()){f+=2}}if(d+o>n.r){d=Math.max(n.l,u.left-s)}if(f+l>n.b){f=Math.max(n.t,n.b-l)}return{x:d,y:f}}function D(e){if(e.uniqueId==null){e.uniqueId=_.nextUniqueId++}return e.uniqueId}function x(t){var i=e.getItemOptions(t);if(i&&i.requiredAccess&&!WH.User.hasRole(i.requiredAccess)){return false}return true}function P(e){if(!e||!e.length){return false}for(let t=0,i=e.length;t<i;t++){if(!B(e[t])&&G(e[t])){return true}}return false}function U(){re(false);if(Platform.isTouch()){pe.closeAllMenus();return}if(_.menuOpener){_.menuOpener.classList.remove("open")}q(0)}function q(e){while(_.visibleMenus[e]){_.visibleMenus[e].stop().hide();_.visibleMenus[e]=null;++e}if(!_.visibleMenus[0]){z();WH.WAS.restoreHidden()}}function F(e){var t=[];var i;if(!B(e[0])){i=[];t.push([0,"",null,i])}$.each(e,(function(e,a){if(B(a)){i=[];t.push([a[o],a[l],a[c],i,a[d]])}else{if(i){i.push(a)}else{t.push(a)}}}));return t}function B(e){return e[o]==null||e[d]&&e[d].heading}function G(t){if(!(t instanceof Array)){return false}if(!x(t)){return false}if(t[d]){if(t[d].hide){return false}if(t[d].requiredTrees&&!t[d].requiredTrees.includes(WH.getDataTree())){return false}if(typeof t[d].condition==="function"){if(!t[d].condition()){return false}}}if(!t.checkingVisibility){var i=e.getSubmenu(t);if(i){t.checkingVisibility=true;var a=P(i);delete t.checkingVisibility;if(!a&&false){return false}}}return true}function Y(e){return _.visibleMenus[e||0]!=null}function z(){if(_.currentMenu&&_.currentMenu.onHide){_.currentMenu.onHide.call(_.menuOpener,_.currentMenu)}_.currentMenu=null;_.menuOpener=null}function V(t){var i=$(this);var a=i.data("menuItem");if(!a){return}var n=e.getItemOptions(a);if(n.onClick){n.onClick(t)}}function j(t){clearTimeout(_.timer.hideMenu);clearTimeout(_.timer.showMenu);var i=t.data.depth;S(i);var a=$(this).data("menuItem");if(a){var n=e.getSubmenu(a);if(n){this.classList.add("open");_.openLinks[i]=this;var r=function(e,t,i){var a=WH.closest(i,".menu-item");var n=a?a.matches(":first-child"):false;A(e,t+1,undefined,undefined,n);q(t+2)};if(!Y(i+1)){_.timer.showMenu=setTimeout(r.bind(this,n,i,this),s)}else{r(n,i,this)}return}}q(i+1)}function K(){clearTimeout(_.timer.hideMenu);clearTimeout(_.timer.showMenu);_.timer.hideMenu=setTimeout(U,r)}function Z(e,t){clearTimeout(_.timer.hideMenu);var i=!t.target.className;if(!i){var a=t.target.className.split(" ");i=a.indexOf("open")==-1&&a.indexOf("hassubmenu")==-1&&a.indexOf("fonticon-icon")==-1}if(i){clearTimeout(_.timer.hideMenu);clearTimeout(_.timer.showMenu);S(e);q(e+1)}}function J(t){clearTimeout(_.timer.hideMenu);clearTimeout(_.timer.showMenu);var i=$(this);var a=i.data("menu");re(WH.closest(this,".header")!==undefined);_.menuOpener=this;_.currentMenu=a;e.showAtCursor(i.data("menu"),t);te(this,a,t)}function X(e,t){if(t.button===2||t.shiftKey||t.ctrlKey){e.call(this,t)}}function Q(e,t){clearTimeout(_.timer.hideMenu);clearTimeout(_.timer.showMenu);if(Y()){if(t===true){U()}else{_.timer.hideMenu=setTimeout(U,r)}}}function ee(e){clearTimeout(_.timer.hideMenu);clearTimeout(_.timer.showMenu);let t=function(e){let t=$(this);let i=t.data("menu");re(WH.closest(this,".header")!==undefined);oe(i,this);te(this,i,e)}.bind(e.currentTarget||e.target,e);if(Y()){t()}else{_.timer.showMenu=setTimeout(t,s)}}function te(e,t,i){if(t.onShow){t.onShow.call(e,t,i)}}function ie(e,t){if(!(e instanceof Array)){return null}var i=[];let a;for(let n=0,s;s=e[n];n++){let e=ae(s,t);if(!e){continue}if(B(s)){a=e;continue}if(a){i.push(a);a=null}i.push(e)}return i}function ae(t,i){var a=t[d]||{};if(a.zulHide){return null}if(t[d]&&t[d].requiredAccess&&!WH.User.hasRole(t[d].requiredAccess)){return null}var n={type:"link"};var s="";if(B(t)){n.heading=true}n.text=t[l];if(typeof n.text!="string"){n.text=""}n.name="null";if(t[d]&&t[d].hasOwnProperty("zulName")){n.name=t[d].zulName}if(a.zulNoHref){}else if(typeof a.zulHref=="function"){n.href=a.zulHref}else{switch(typeof t[c]){case"string":n.href=Menu.getItemUrl(t);break;case"function":n.click=t[c];break}}if(t[d]){if(a.zulGetMobileMenu){if(!n.menu){n.menu={}}n.menu.mobile=a.zulGetMobileMenu}if(a.fontIcon){n.fontIcon=a.fontIcon}if(a.icon){n.imageIcon={url:a.icon,enlargeIcon:true}}if(a.tinyIcon){n.imageIcon={url:WH.getTinyIconUrl(a.tinyIcon),enlargeIcon:true}}if(a.armory){n.imageIcon={url:a.armory,enlargeIcon:true};s=(s?" ":"")+"zul-bar-icon-armory"}if(typeof n.imageIcon=="object"&&typeof n.fontIcon!="undefined"){delete n.fontIcon}if(t.checked){n.checked=true}else if(a.checkedUrl&&location.href.match(a.checkedUrl)){n.checked=true}else if(typeof a.checkedFunc=="function"){n.checked=a.checkedFunc(t)}else if(a.checked){n.checked=true}}var r=e.getSubmenu(t);if(r){if(!n.menu){n.menu={}}n.menu.mobile=ie(r)}if(s){n.className=s}if(i){n.condition=i}else if(a.zulCondition){n.condition=a.zulCondition}return n}function ne(e,t,i,a){var n=t===0?e.padded:false;if(!e||e.length===0){e=[["","Error: Menu is empty",null,null,{className:"q10"}]];WH.error("Trying to render an empty menu.")}var s=R(e,a);var r=I(s,n);let o=w(e,t,r,i);o.append(r.menu);return o}function se(e,t){e.className="menu";if(t.classes){for(let i=0,a=t.classes.length;i<a;i++){e.classList.add(t.classes[i])}}}function re(e){if(_.showingHeaderMenu===e){return}_.showingHeaderMenu=e;document.body.dataset.showingHeaderMenu=JSON.stringify(e)}function oe(e,t){if(_.menuOpener){_.menuOpener.classList.remove("open")}_.currentMenu=e;_.menuOpener=t;t.classList.add("open");M(e)}function le(e,t,i){clearTimeout(_.timer.hideMenu);clearTimeout(_.timer.showMenu);M(e,t,i)}function ce(t,i){if(!(t instanceof Array)){WH.error("Trying to do a menu sort on a non-array.",typeof t,t);return}t.sort((function(e,t){return WH.stringCompare(e[l],t[l])}));if(i){for(var a=0,n;n=t[a];a++){var s=e.getSubmenu(n);if(s){Menu.sort(s,i)}}}}function ue(t,i){let a=F(t);$.each(a,(function(t,a){var a=e.getSubmenu(a);if(a){ce(a,i)}}));k(t,a)}function de(t,i){$.each(i,(function(a,n){var s;if(n[n.length-1]==="*"){if(n.length>1){var r=e.findItem(t,n.slice(0,n.length-1));s=e.getSubmenu(r)}else{s=t}if(s instanceof Array){for(var o=0,l;l=s[o];o++){var c=e.getSubmenu(l);if(c){e.sort(c)}}}else{WH.error("Could not find submenus to sort.",t,i)}}else{s=e.findItem(t,n);if(s){var c=e.getSubmenu(s);if(c){e.sort(c)}}}}))}function fe(e,t){$.each(e,(function(e,i){he(i,t)}))}function he(t,i){i(t);var a=e.getSubmenu(t);if(a){fe(a,i)}}var pe=new function(){var t={container:null,containerArrow:null,currentMenu:null,menuOpener:null,path:[]};this.add=function(e,t){var i=$(e);i.data("menu",t);i.click(pe.onRootNodeClick)};this.closeAllMenus=function(){$(".header-nav dt > a.active").removeClass("active");$("#header-nav-subnav").removeClass("touch-menu").empty();if(t.container){t.container.empty().css({display:"none"})}t.currentMenu=null;t.path=[];t.containerArrow=null;if(t.menuOpener){t.menuOpener.removeClass("touch-menu-active")}t.menuOpener=null;z()};this.onNodelessClick=function(e,i){_.currentMenu=e;_.menuOpener=null;if(t.menuOpener){t.menuOpener.removeClass("touch-menu-active");t.menuOpener=null}t.currentMenu=e;re(false);u(e,{atPosition:[i.pageX,i.pageY+5]});te(null,e,i);if(i){i.preventDefault();i.stopPropagation()}};this.onRootNodeClick=function(e,i){var a=$(this);if(a.hasClass("active")||a.hasClass("touch-menu-active")){pe.closeAllMenus();if(e){e.preventDefault();e.stopPropagation()}return}var n=a.parent();var s=a.data("menuItem");re(WH.closest(this,".header")!==undefined);if(!i){i=a.data("menu")}if(typeof i==="function"){i=i()}_.currentMenu=i;_.menuOpener=this;if(t.menuOpener){t.menuOpener.removeClass("touch-menu-active");t.menuOpener=null}if(n[0].tagName==="DT"){pe.closeAllMenus();a.addClass("active");t.currentMenu=null;t.path=[s[o]];u(i)}else{t.menuOpener=a;t.menuOpener.addClass("touch-menu-active");t.currentMenu=i;t.path=s?[s[o]]:[null];u(i,{atElement:a})}te(this,i,e);if(e){e.preventDefault();e.stopPropagation()}};function i(i,a,n){var s=i.menu||Menu.getMenu();var r,c,u,f;if(n){for(u in t.path){r=t.path[u];for(f in s){c=s[f];if(c[o]===r){s=e.getSubmenu(c);break}}}t.path=t.path.concat(a)}var h,p,m;for(u in a){r=a[u];h=null;for(f in s){c=s[f];if(c[o]===r){h=c;break}}if(!h){break}p=WH.ce("li");m=WH.ce("a");m.href="javascript:";e.linkifyItem(h,$(m));m.innerHTML=h[l];m.onclick=d;WH.ae(p,m);WH.ae(i,p)}}function a(e,t){var i=null,a;for(var o in t){a=t[o];if(!G(a)){continue}if(B(a)){n(e,a);i=s(e);continue}if(!i){i=s(e)}WH.ae(i,r(a))}}function n(t,i){let a=WH.ce("a");let n=$(a);i.$a=n;n.data("menuItem",i);e.linkifyItem(i,n);e.updateItem(i);n.text(i[l]);WH.ae(t,WH.getMajorHeading(n.get(0),2))}function s(e){var t=WH.ce("ul");WH.ae(e,t);return t}function r(t){N(t);E(t);var i=$("<a></a>");t.$a=i;i.data("menuItem",t);var a=e.linkifyItem(t,i);e.updateItem(t);var n;var s=e.getLabel(t),r,o,l;if(typeof s=="object"&&"tagName"in s&&s.tagName.toLowerCase()=="span"){while(r=s.getElementsByTagName("span")[0]){o=document.createElement("div");o.className=r.className;$.extend(o.style,r.style);o.style.display="inline";while(l=r.firstChild){l.parentNode.removeChild(l);o.appendChild(l)}r.parentNode.insertBefore(o,r);r.parentNode.removeChild(r)}n=$(s)}else{n=$("<span></span>");n.text(e.getLabel(t))}n.appendTo(i);var u=WH.ce("li");i.appendTo(u);if(e.getSubmenu(t)){if(a){i.addClass("has-sub");n.addClass("has-sub");var d=WH.ce("a");d.className="view-sub";d.href="javascript:";d.onclick=c;$(d).data("menuItem",t);WH.ae(u,d)}else{i.addClass("only-sub").data("menuItem",t).click(c);n.addClass("only-sub")}}return u}function c(){var a=$(this).data("menuItem");var n=$(".touch-menu-breadcrumb");if(n.length){i(n.get(0),[a[o]],true)}else{t.path.push(null)}f(e.getSubmenu(a),{animate:this})}function u(e,a){if(!a){a={}}var n;if(a.atElement||a.atPosition){var s=false;if(!t.container){t.container=$("<div/>",{class:"floating-touch-menu-container",css:{display:"none"}});t.container.appendTo("body")}else{var r=t.container.offset();s=r.top}t.container.empty();n=$("<div/>",{class:"floating-touch-menu"});t.containerArrow=$("<div/>",{class:"floating-touch-menu-arrow"});n.append(t.containerArrow).appendTo(t.container);var o=$("<a/>",{class:"floating-touch-menu-closer"});o.click(pe.closeAllMenus);t.container.append(o);var l=a.atElement?a.atElement.offset():{left:a.atPosition[0],top:a.atPosition[1]};var c=l.top;if(a.atElement){c+=a.atElement.outerHeight()}var u=parseInt(c+7);var d=u!=s;t.container.css({display:"block",top:(d?u-10:u)+"px"});var h=l.left;if(a.atElement){h+=a.atElement.outerWidth()/2}t.containerArrow.css({display:"block",left:parseInt(h-10)+"px"});if(d){t.container.css({opacity:"0"});setTimeout((function(){t.container.animate({opacity:"1",top:"+=10px"})}),0)}}else{t.container=null;t.containerArrow=null;n=$("#header-nav-subnav");if(!n.length){n=$("<div/>",{class:"header-nav-subnav",id:"header-nav-subnav"});n.insertAfter(".header-nav")}n.empty()}var p=false;if(!a.atElement&&!a.atPosition||a.atElement&&a.atElement.data("menuItem")){p=true}if(p){if(t.container){t.container.addClass("has-breadcrumb")}var m=WH.ce("ul");m.className="touch-menu-breadcrumb";if(a.atElement){var g=$(a.atElement);if(g.data("parentMenu")){m.menu=$(a.atElement).data("parentMenu")}else if(g.html()){m.menu=[[0,g.html(),null,e]]}}i(m,t.path)}else if(t.container){t.container.removeClass("has-breadcrumb")}if(t.container){if(a.atElement&&a.atElement.parents("div.breadcrumb")){t.container.addClass("from-breadcrumb")}else{t.container.removeClass("from-breadcrumb")}}var H=WH.ce("div");H.className="touch-menu-items";H.style.left="0%";f(e,{target:H});var W=WH.ce("div");W.className="touch-menu-items-wrapper";WH.ae(W,H);if(p){n.append(m)}n.append(W).attr("class","touch-menu")}function d(){var i=$(this).parent();if(i.is(":last-child")){return true}var a=i.index();var n=Menu.getMenu();for(var s=0;s<=a;s++){for(var r in n){if(n[r][o]===t.path[s]){n=e.getSubmenu(n[r]);break}}}i.nextAll().remove();f(n,{reverse:t.path.length-a-1,targetPathIndex:a});t.path=t.path.slice(0,a+1);return false}function f(e,i){if(i.animate){var n=$(".touch-menu-items");$(i.animate).parent().addClass("chosen");n.addClass("chosen");setTimeout((function(){var i=WH.ce("div");i.className="touch-menu-items";var s=(t.path.length-2)*-10+2;i.style.left=s+"%";a(i,e);var r=$(i);var o=n.last();o.after(r);var l=o.height();n.each((function(){var e=$(this);if(e.data("height")){e.css({height:"1px"}).animate({left:"-=12%"})}else{e.data("height",e.height()).css("height",e.height()+"px").animate({left:"-=12%",height:"1px"})}}));var c=r.height();r.css("height",l+"px").animate({left:"-=12%",height:c+"px"})}),100)}else if(i.reverse){var s=$(".touch-menu-items");var r=$(s.get(i.targetPathIndex));var o=i.reverse*12;var l=s.last();r.css({height:l.height()+"px"}).animate({left:"+="+o+"%",height:r.data("height")+"px"},{complete:function(){$(this).css("height","")}});l.css({height:"1px"});s.not(r).animate({left:"+="+o+"%"},{complete:function(){r.removeClass("chosen");$(".chosen",r).removeClass("chosen");r.nextAll().stop().remove()}})}else if(i.target){$(i.target).empty();a(i.target,e)}}};e.addTouch=pe.add};WH.Notifications=new function(){const e=this;this.GA_ACTION_GENERAL="General";this.GA_ACTION_DELIVERY_WEB_PUSH="Web Push Delivery Method";this.GA_ACTION_EVENT_NEWS_PUBLISHED="News Published Events";this.GA_CATEGORY="Notifications";const t="notifications-dialog";const i="notifications-error-seen";const a=1;const n=2;const s=3;const r=4;const o=5;const l={1:"allNewsPosts",2:"classicWowNewsOnly",3:"nonClassicNewsOnly",4:"devNewsOnly",5:"otherGamesOnly"};const c=[a,n,s,r,o];const u="/js-local/WH/ServiceWorkers/Notifications/WebPush.js";const d={newSubInfo:null,postSubscriptionCallback:null};this.browserSupportsNotifications=function(){return!!(window.Promise&&navigator.serviceWorker&&window.PushManager)};this.getNewsGroupsOptions=function(e,t){let i=document.createDocumentFragment();for(let a=0;a<c.length;a++){let n=c[a];let s=t.indexOf(n)!==-1;let r=WH.ce("input",{name:"newsGroups["+e+"]["+n+"]",type:"checkbox",checked:s});r.dataset.subId=e.toString();r.dataset.group=n.toString();WH.aE(r,"click",m.bind(null,e));if(a!==0){WH.ae(i,WH.ce("br"))}let o=WH.ce("label",undefined,r);WH.ae(o,WH.ct(WH.TERMS[l[n]]));WH.ae(i,o)}return i};this.isBrowserDenied=function(){return Notification.permission==="denied"};this.getNewSubInfo=function(){return d.newSubInfo};this.getSubscription=function(){return navigator.serviceWorker.getRegistrations().then((function(e){for(let t=0;t<e.length;t++){let i=e[t];WH.debug(i,new RegExp(u));if(i.active.scriptURL.match(new RegExp(u))){return i.pushManager.getSubscription()}}return null}))};this.enableNewsNotifications=function(){v()};this.setPostSubscriptionCallback=function(e){d.postSubscriptionCallback=e};this.showSubscriptionListError=function(){T("subscription-list-error",WH.TERMS.notificationsSubscriptionListFailed_tip)};function f(e){let i="."+t+"-buttons";let a=WH.qsa(i+" .btn");for(let e=0;e<a.length;e++){a[e].disabled=true}let n=WH.qs(i+"-"+e);if(n){n.classList.add("working")}}function h(){WH.LocalStorage.remove(i)}function p(){WH.de("."+t)}function m(e,t){if(t.target.checked===false){return}let i=WH.qsa('input[data-sub-id="'+e+'"]');let n=parseInt(t.target.dataset.group)===a;for(let e=0;e<i.length;e++){let t=parseInt(i[e].dataset.group);if(n&&t!==a){i[e].checked=false}else if(!n&&t===a){i[e].checked=false}}}function g(){if(WH.PageMeta.page==="account"){WH.debug("Notifications onboarding disabled on this page (legacy mechanism).");return}if(WH.getPageData("notifications.disable-onboarding")){WH.debug("Notifications onboarding disabled on this page.");return}if(!WH.LocalStorage.isSupported()){WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Browser does not support local storage");WH.error("This browser does not support local storage.");return}if(!e.browserSupportsNotifications()){WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Browser does not support notifications");WH.error("This browser does not support notifications.");return}if(WH.Notifications.Onboarding.isComplete()){WH.debug("Notifications onboarding already complete.");return}if(!window.Notification||Notification.permission==="denied"){WH.debug("Stage 2 is denied.");WH.Notifications.Onboarding.setComplete();return}if(WH.Notifications.Onboarding.isStage1Denied()){WH.debug("Stage 1 is denied.");return}if(WH.Notifications.Onboarding.isStage1Granted()){WH.debug("Stage 1 is granted.");_();return}S()}function H(){WH.debug("Sleeping stage 1.");WH.Track.interactiveEvent(e.GA_CATEGORY,e.GA_ACTION_EVENT_NEWS_PUBLISHED,"Temporarily closed notifications request");p();WH.Notifications.Onboarding.stage1Sleep()}function W(){WH.debug("Denying stage 1.");WH.Track.interactiveEvent(e.GA_CATEGORY,e.GA_ACTION_EVENT_NEWS_PUBLISHED,"Declined notifications request");p();WH.Notifications.Onboarding.stage1Deny();WH.Notifications.Onboarding.setComplete()}function v(t){WH.debug("Granting stage 1.");h();WH.Notifications.Onboarding.stage1Grant();if(t===true){WH.Track.interactiveEvent(e.GA_CATEGORY,e.GA_ACTION_EVENT_NEWS_PUBLISHED,"Accepted notifications request");f("accept");if(WH.getDataEnv()!==WH.dataEnv.MAIN||Locale.getId()!==LOCALE_ENUS){WH.Notifications.Onboarding.setComplete();let e=WH.Url.generate("/notifications/settings",{subdomain:WH.Url.getSubdomain(WH.dataEnv.MAIN,LOCALE_ENUS)});if(Locale.getId()!==LOCALE_ENUS){e+="?locale="+Locale.getId()}let t=WH.ce("form",{action:e,method:"POST"});let i=WH.ce("input",{type:"hidden",name:"accept",value:"1"});WH.ae(t,i);WH.ae(document.body,t);t.submit();return}}_()}function _(){var t=false;e.getSubscription().then((function(e){t=e===null;return navigator.serviceWorker.register(u)})).then((function(e){let i=e.installing||e.waiting||e.active;if(i){if(i.state==="activated"){I(e,t)}else{i.addEventListener("statechange",(function(i){if(i.target.state==="activated"){I(e,t)}}))}}}))["catch"]((function(t){p();WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Failed to register service worker");WH.error("Could not register push notifications service worker.",t);w()}))}function T(i,a){WH.debug("show message",i,a);p();let n=WH.ce("div",{className:t});n.dataset.dialog=i;let s=WH.ce("div",{className:t+"-message"},WH.ct(a));WH.ae(n,s);let r=WH.ce("div",{className:t+"-buttons"});WH.ae(n,r);WH.ae(r,WH.ce("button",{className:"btn btn-site "+t+"-buttons-close",onclick:function(){WH.Track.interactiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Closed "+i+"message");p()},type:"button"},WH.ct(WH.TERMS.close)));WH.ae(document.body,n)}function b(t){WH.debug("Saving subscription...");return $.ajax({url:"/notifications/subscribe",method:"POST",type:"json",data:{subscription:JSON.parse(JSON.stringify(t)),platform:window.navigator.platform,userAgent:window.navigator.userAgent},success:function(t){WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Saved push subscription on backend");WH.debug("Save successful.");d.newSubInfo=t;WH.Notifications.Onboarding.setComplete()}})}function E(e,t){$.ajax({url:"/notifications/save-subscription-settings",method:"post",data:{id:d.newSubInfo.id,endpointUrl:d.newSubInfo.endpoint,name:e,newsGroups:t},complete:function(){WH.debug("Saved the sub name as",e);p();d.newSubInfo.name=e;d.newSubInfo.groups=t;N()}})}function y(){WH.debug("Showing ask-for-name popup");WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Requesting device name after subscribing");p();let i=WH.ce("div",{className:t});i.dataset.dialog="ask-for-name";let n=WH.TERMS.notificationsDeviceName_tip;let s=WH.ce("div",{className:t+"-message"},WH.ct(n));WH.ae(i,s);let r=WH.ce("div",{className:t+"-form"});WH.ae(i,r);let o=WH.ce("input",{name:"name",placeholder:WH.TERMS.name,type:"text"});WH.ae(r,o);let l=WH.ce("div",{style:{verticalAlign:"top"}});WH.ae(l,WH.ct(WH.TERMS.newsGroup+WH.TERMS.colon_punct));WH.ae(l,WH.ce("br"));WH.ae(l,e.getNewsGroupsOptions(0,[a]));WH.ae(r,l);let c=WH.ce("div",{className:t+"-buttons"});WH.ae(i,c);let u=function(){WH.Track.interactiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Saved device name after subscribing");let t=[];let i=WH.qsa('input[name*="newsGroups"]',l);for(let e=0;e<i.length;e++){let a=i[e];if(a.checked){t.push(a.dataset.group)}}E(o.value,t);f("save")};WH.aE(o,"keydown",(function(e){if(e.key==="Enter"){u()}}));let d=WH.ce("button",{className:"btn btn-site "+t+"-buttons-save",onclick:u,type:"button"},WH.ct(WH.TERMS.save));WH.ae(c,d);WH.ae(c,WH.ce("button",{className:"btn "+t+"-buttons-close",onclick:function(){WH.Track.interactiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Closed device settings dialog after news sub");p();N()},type:"button"},WH.ct(WH.TERMS.close)));WH.ae(document.body,i);o.focus()}function S(){if(WH.Notifications.Onboarding.isStage1Sleeping()){WH.debug("Stage 1: sleeping");return}WH.debug("Showing stage1 popup");WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_EVENT_NEWS_PUBLISHED,"Showing notifications request to user");let i=WH.ce("div",{className:t});i.dataset.dialog="stage-1";let a=WH.ce("div",{className:t+"-message"},WH.ct(WH.TERMS.enableNewsNotifications_tip));WH.ae(i,a);let n=WH.ce("div",{className:t+"-buttons"});WH.ae(i,n);let s=v.bind(null,true);WH.ae(n,WH.ce("button",{className:t+"-buttons-accept btn btn-site",onclick:s,type:"button"},WH.ct(WH.TERMS.accept)));WH.ae(n,WH.ce("button",{className:t+"-buttons-decline btn",onclick:W,type:"button"},WH.ct(WH.TERMS.decline)));WH.ae(n,WH.ce("button",{className:t+"-buttons-maybe-later btn",onclick:H,type:"button"},WH.ct(WH.TERMS.maybeLater)));WH.ae(document.body,i)}function w(){if(WH.LocalStorage.get(i)==="1"){return}T("subscription-error",WH.TERMS.notificationsSubscriptionFailed_tip);WH.LocalStorage.set(i,"1")}function I(t,i){WH.debug("Subscribing with reg:",t);t.pushManager.subscribe({userVisibleOnly:true,applicationServerKey:WH.getPageData("notifications.public-key")}).then((function(e){if(!e){throw"Did not find subscription"}WH.debug("Got subscription:",e,JSON.stringify(e));return b(e)})).then((function(e){p();if(e&&WH.User.isLoggedIn()&&i){y()}else{N()}}))["catch"]((function(t){p();WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Failed to subscribe");WH.error("Could not subscribe user to push notifications.",t);w()}))}function N(){if(d.postSubscriptionCallback){d.postSubscriptionCallback()}}WH.onLoad(g)};WH.Notifications.Onboarding=new function(){const e={complete:false,stage1SleepTime:0};const t="notifications.onboarding";const i="denied";const a="granted";this.isComplete=function(){if(WH.getCookies("notifications")==="1"||n().complete){WH.debug("Onboarding already complete, so setting both cookie and LS.");this.setComplete()}return n().complete};this.isStage1Denied=function(){return n().stage1Status===i};this.isStage1Granted=function(){return n().stage1Status===a};this.isStage1Sleeping=function(){return n().stage1SleepTime>WH.Time.unix()};this.reset=function(){WH.LocalStorage.remove(t)};this.setComplete=function(){WH.debug("Marking onboarding complete.");let e=n();e.complete=true;s(e);if(!WH.getCookies("notifications")){WH.setCookie("notifications",3650,"1","/",".wowhead.com")}};this.stage1Deny=function(){let e=n();e.stage1Status=i;s(e)};this.stage1Grant=function(){let e=n();e.stage1Status=a;s(e)};this.stage1Sleep=function(){let e=n();e.stage1SleepTime=WH.Time.unix()+WH.Time.SEC_DAY*3;s(e)};this.stage1Wake=function(){let e=n();e.stage1SleepTime=0;s(e)};function n(){return JSON.parse(WH.LocalStorage.get(t))||e}function s(e){WH.LocalStorage.set(t,JSON.stringify(e))}};WH.Page=new function(){this.init=function(){for(let e in WH.Page){if(WH.Page.hasOwnProperty(e)&&WH.Page[e]._init){WH.Page[e]._init()}}};this.commentsLocked=function(){return e().commentsLocked===true};this.getId=function(){return e().entityId};this.getType=function(){return e().entityType};function e(){return WH.getPageData("page.info")||{}}};WH.Paperdoll=new function(){this.BONUS_INDEX_START=11;this.EQUIPSET_MAX_BONUSES=16;this.TIMEWALKER_LEVEL_INDEX=28};WH.convertRawItemDataForPaperdoll=function(e){var t={};t.slotId=e[0];t.itemId=e[1];t.transmogId=e[9];t.hidden=e[10];t.rawBonuses=e.slice(WH.Paperdoll.BONUS_INDEX_START,WH.Paperdoll.BONUS_INDEX_START+WH.Paperdoll.EQUIPSET_MAX_BONUSES);t.bonuses=[];for(var i in t.rawBonuses){if(t.rawBonuses.hasOwnProperty(i)&&t.rawBonuses[i]){t.bonuses.push(t.rawBonuses[i])}}return t};WH.convertPaperdollItemDataToRaw=function(e){var t=[];for(var i=0;i<WH.Paperdoll.BONUS_INDEX_START+WH.Paperdoll.EQUIPSET_MAX_BONUSES;i++){t[i]=0}t[0]=e.slotId;t[1]=e.itemId;t[9]=e.transmogId?e.transmogId:0;t[10]=e.hidden?e.hidden:0;t[WH.Paperdoll.BONUS_INDEX_START]=e.itemBonus?e.itemBonus:0;return t};const Platform=new function(){const e=this;this.known=false;this.initialized=false;this.initSteps={};let t=false;let i=false;let a=false;let n=navigator.userAgent||navigator.vendor||window.opera;this.get=function(){if(this.isMobile())return"mobile";if(this.isTablet())return"tablet";return"pointer"};this.getBrowserInfo=function(e,t){e=e||navigator.userAgent;t=t||navigator.platform;let i={browser:{name:e,version:undefined},os:{name:t,version:undefined}};let a;if(/Edge/.test(e)){i.browser.name="Old Edge";if(a=e.match(/Edge\/(\d+[.]\d+)/)){i.browser.version=a[1]}}else if(/Edg/.test(e)){i.browser.name="Edge";if(a=e.match(/Edg\/(\d+[.]\d+)/)){i.browser.version=a[1]}}else if(/MSIE/.test(e)){i.browser.name="Internet Explorer";if(a=e.match(/MSIE (\d+[.]\d+)/)){i.browser.version=a[1]}}else if(/Trident/.test(e)){i.browser.name="Internet Explorer";if(a=e.match(/ rv:(\d+[.]\d+)/)){i.browser.version=a[1]}}else if(/Opera/.test(e)){i.browser.name="Opera"}else if(/Firefox/.test(e)){i.browser.name="Firefox";if(a=e.match(/Firefox\/([.\d]+)/)){i.browser.version=a[1]}}else if(/Chrome/.test(e)){i.browser.name="Chrome";if(a=e.match(/Chrome\/([\d.]+)/)){i.browser.version=a[1]}if(/CrOS/.test(e)){t="CrOS"}}else if(/Safari/.test(e)){i.browser.name="Safari";if(/iPhone/.test(e)||/iPad/.test(e)||/iPod/.test(e)){i.os.name="iOS"}}else if(/Android/.test(e)){i.browser.name="Android WebKit Browser";i.os.name=(/Android\s[.\d]+/.exec(e)||[])[0]||i.os.name}if(!i.browser.version){if(a=e.match(/Version\/([.\d]+)/)){i.browser.version=a[1]}else{if(a=e.match(/Opera\/([.\d]+)/)){i.browser.version=a[1]}}}if(t==="MacIntel"||t==="MacPPC"){i.os.name="Mac OS X";if(a=e.match(/10([._\d]+)/)){i.browser.version=a[1];if(/[_]/.test(i.os.version)){i.os.version=i.os.version.split("_").join(".")}}}else if(t==="CrOS"){i.os.name="ChromeOS"}else if(t==="Win32"||t==="Win64"){i.os.name="Windows"}else if(!i.os.name){if(/Android/.test(e)){i.os.name="Android"}else if(/Linux/.test(t)){i.os.name="Linux"}else if(/Windows/.test(e)){i.os.name="Windows"}}return i};this.getViewportHeight=function(){return this.getViewportSize().height};this.getViewportSize=function(){return{width:window.innerWidth,height:window.innerHeight}};this.getViewportWidth=function(){return this.getViewportSize().width};this.init=function(){if(Platform.initSteps["3"]||Platform.initialized)return;if(Platform.isTouch()){Platform.preInit1();Platform.preInit2()}WH.prepInfobox();WH.Responsive.test(true);c();WH.Layout.showClassicLinkOrRedirect();Platform.initSteps["3"]=true;Platform.initialized=true};this.isMobile=function(){return t};this.isTablet=function(){return i};this.isTouch=function(){return this.isMobile()||this.isTablet()};this.preInit1=function(){if(Platform.initSteps["1"])return;s();$("html").addClass(Platform.get()+"-device"+(a?" forced-device":""));if(Platform.isTouch()){o()}WH.Layout.setBodyAttributes();Platform.initSteps["1"]=true};this.preInit2=function(){if(Platform.initSteps["2"])return;if(Platform.isTouch())l();Platform.initSteps["2"]=true};this.setTouchScrollable=function(e){if(!Platform.isTouch()){return}document.querySelector("html").style.overflow=e?"auto":"hidden";document.querySelector("body").style.overflow=e?"auto":"hidden"};function s(){let e=Locale.getPreferred();if(e==undefined){return}Locale.setPreferred(e);if(e===Locale.getId()){return}if(!document.referrer){return}let t;try{t=new URL(document.referrer)}catch(e){return}if(/\.wowhead\.com$/.test("."+t.hostname)){return}let i=WH.Url.getSubdomain();let a=WH.Url.getSubdomain(undefined,e);if(i===a){return}if(location.href.indexOf(location.origin)!==0){WH.warn("Could not determine path by removing origin",location);return}let n=WH.Url.generate(location.href.substr(location.origin.length),{locale:e});if(location.href!==n){location.href=n}}function r(){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))){t=true}if(!t)if(/(android|ipad|playbook|silk)/i.test(n))i=true;let s=WH.getGets();if(typeof s.testmobile!="undefined"&&!t){a=true;t=true}if(typeof s.testtablet!="undefined"&&!i){a=true;i=true}e.known=true}function o(){$("html").addClass("touch-device")}function l(){Platform.preInit1();document.body.dataset.sidebar="false";$(".sidebar .vertical-block-bg, .sidebar .sidebar-block-bg, .sidebar .block-block-bg").remove();$(".header-expand-site-tab").remove()}function c(){setTimeout((function(){WH.Layout.updateContentHeight();if(!WH.qs(".sidebar")||!WH.qs(".main-contents")){return}if(MutationObserver){let e=undefined;let t=function(t,i){if(e!==undefined){return}e=setTimeout((function(){t();e=undefined}),i)};let i=new MutationObserver(t.bind(null,WH.Layout.updateContentHeight,200));let a={childList:true,attributes:true,characterData:true,subtree:true};i.observe(WH.qs(".sidebar"),a);i.observe(WH.qs(".main-contents"),a)}else{setInterval(WH.Layout.updateContentHeight,200)}}),9)}r();WH.onLoad(e.init)};var PoundChecker=new function(){var e=null;var t=null;var i=1e3;var a=function(){if(!t){PoundChecker.stop();return}if(location.hash)t()};this.start=function(n,s){if(t){if(WH.isDev())alert("Multiple pound checkers are bad, mmkay?");return}t=n;if(s)i=s;e=setInterval(a,i)};this.stop=function(){clearInterval(e);e=t=null;i=1e3};this.pause=function(){clearInterval(e)};this.resume=function(){if(t)e=setInterval(t,i)}};WH.Profiler=new function(){const e=this;this.create=function(t,i,a,n,s){if(!t||typeof t!=="string"||!i||typeof i!=="string"||!a||typeof a!=="string"){if(n===true){alert(WH.TERMS.filloutdetails_tip)}if(s){return}(new Dialog).show("fetchlist",{data:{region:t,realm:i,character:a},onSubmit:function(t){e.create(t.region,t.realm,t.character,true,false);return false}});return}location.href="/list/"+WH.Strings.slug(t+"-"+i+"-"+a,true)};this.getAvatarUrl=function(e){if(e.region){if(e.thumbnail){return WH.BlizzardApi.getCharacterThumbnailUrl(e.region,e.thumbnail)}else if(e.race&&(e.gender===0||e.gender===1)){return"https://"+e.region.toLowerCase()+".battle.net/wow/static/images/2d/avatar/"+e.race+"-"+e.gender+".jpg"}}return null};this.getFavorite=function(){var e=null;if(g_user.lists instanceof Array){for(var t=0,i=g_user.lists.length;t<i;t++){if(g_user.lists[t].pinned&&(e===null||new Date(g_user.lists[t].updated)>new Date(e.updated))){e=g_user.lists[t]}}}return e};this.getMenuItem=function(e,t){var i={className:e.mode!=1||e.armory&&!e.errcode?"listmanager-mode"+e.mode:"q10"};if(t&&e.region){var a=WH.Profiler.getAvatarUrl(e);if(a){i.armory=a}}if(!i.armory&&e.mode==1&&e.pinned){i.fontIcon="thumb-tack"}return[e.id,e.name,WH.Profiler.getPath(e),null,i]};this.getPath=function(e){return"/list="+e.id+(e.url?"/"+e.url:"")}};function li_onSaveTab(xhr,opt){var text=xhr.responseText;if(text.charAt(0)!="{"||text.charAt(text.length-1)!="}"){return}var list=null;try{list=JSON&&JSON.parse(text)||eval(text)}catch(e){return}if(!list||!list.id){return}return list}function li_getCurrentUserList(e){if(g_user.lists&&g_user.lists.length){for(var t in g_user.lists){if(g_user.lists[t].id==e){return g_user.lists[t]}}}return null}function li_getListStatus(id,onSuccess){new Ajax("/list&status="+id+"&t="+Math.random(),{method:"POST",onSuccess:function(xhr,opt){var response=eval(xhr.response)[0];if(!response.id)return;li_setButtonStatus(WH.ge("list-status"),response);if(response.refresh){setTimeout(li_getListStatus,response.refresh,id,onSuccess);return}if(response.status==3&&onSuccess)onSuccess()}})}function li_setButtonStatus(e,t){var i=t.statusText;var a=$("#list-delete");a.hide();if(t.errcode>0){i=WH.term("parens_format",t.errorText,"#"+t.errcode);a.show()}var n="";if(t.status==1||t.status==2){e.blur();n=" fa-spin";if(t.position===0){i+=WH.TERMS.colon_punct+WH.TERMS.nextInLine}else{i+=WH.TERMS.colon_punct+WH.sprintf(WH.TERMS.inline_format,WH.numberFormat(t.position))}}if(e){var s=" btn-";switch(t.status){case 1:case 2:s+="warning";break;case 3:s+="success";break;case 4:s+="danger";break;case 0:default:s+="primary"}e.className=e.className.replace(/ +btn-[^ ]+\b/,s).replace(/( fa-spin)?( +status-[^ ]+\b)?/,n+" status-"+t.status);e.innerHTML=i;if(t.errcode==104){WH.ae(e,WH.ce("div",{style:{padding:"1em",textAlign:"left"}},WH.BlizzardApi.getNotFoundMessage()))}}}function li_updateRealmSelect(e,t){WH.ee(t);var i=WH.Wow.Realm.getAll();if(!i){WH.ae(t,WH.ce("option",{},WH.ct(WH.TERMS.loading_ellipsis)));i={};WH.Wow.Realm.fetchData(li_updateRealmSelect.bind(null,e,t))}WH.ae(t,WH.ce("option"));if(!i[e]){return}var a=[];for(var n in i[e]){if(!i[e].hasOwnProperty(n)){continue}a.push(i[e][n])}a.sort((function(e,t){return e.name.localeCompare(t.name)}));for(var s,r=0;s=a[r];r++){if(s.name.indexOf(s.name_enus)>=0){continue}var o=WH.ce("option");o.value=s.name_enus;WH.st(o,s.name);WH.ae(t,o)}a.sort((function(e,t){return e.name_enus.localeCompare(t.name_enus)}));for(var s,r=0;s=a[r];r++){var o=WH.ce("option");o.value=s.name_enus;WH.st(o,s.name_enus);WH.ae(t,o)}}Dialog.templates.createlist={title:WH.TERMS.createnewlist,width:400,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"name",label:WH.TERMS.name,required:1,type:"text"}]};Dialog.templates.fetchlist={title:WH.TERMS.lookupblizzardbattlenetprofile,width:400,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"region",label:WH.TERMS.region,required:1,type:"select",options:{US:"US",EU:"EU",KR:"KR",TW:"TW"},compute:function(e,t,i,a,n,s){e.id="dialog-region";$(e).change((function(){li_updateRealmSelect($(this).val(),$("#dialog-realm").get(0))}))}},{id:"realm",label:WH.TERMS.realm,required:1,type:"select",options:[],compute:function(e,t,i,a,n,s){e.id="dialog-realm";li_updateRealmSelect($("#dialog-region").val(),e)}},{id:"character",label:WH.TERMS.character,required:1,type:"text"}]};var ProgressBar=function(e){this.opts={text:"",hoverText:"",color:"rep6",width:0,progress:0};this.elements={text:null,hoverText:null,textContainer:null,progress:null,container:null};WH.cO(this.opts,e);this.build()};ProgressBar.prototype.build=function(){var e=$("<a/>",{class:"progressbar",href:"javascript:"});if(this.opts.width>0)e.css("width",this.opts.width+"px");else e.css("width","auto");var t=$("<div/>",{class:"progressbar-text"});if(this.opts.text){this.elements.text=$("<del/>",{text:this.opts.text});t.append(this.elements.text)}if(this.opts.hoverText){this.elements.hoverText=$("<ins/>",{text:this.opts.hoverText});t.append(this.elements.hoverText)}e.append(t);var i=$("<div/>",{class:"progressbar-"+this.opts.color,css:{width:this.opts.progress+"%"},text:WH.Strings.nbsp});e.append(i);if(this.opts.text)t.append($("<div/>",{class:"progressbar-text progressbar-hidden",text:this.opts.text}));this.elements.container=e;this.elements.progress=i;this.elements.textContainer=t;return e};ProgressBar.prototype.setText=function(e){this.opts.text=e;if(this.elements.text)this.elements.text.text(this.opts.text);else{this.elements.text=$("<del/>",{text:this.opts.text});if(this.opts.hoverText)this.opts.hoverText.before(this.elements.text);else this.elements.textContainer.append(this.elements.text)}};ProgressBar.prototype.setHoverText=function(e){this.opts.hoverText=e;if(this.elements.hoverText)this.elements.hoverText.text(this.opts.hoverText);else{this.elements.hoverText=$("<ins/>",{text:this.opts.hoverText});this.elements.textContainer.append(this.elements.hoverText)}};ProgressBar.prototype.setProgress=function(e){this.opts.progress=e;this.elements.progress.css("width",this.opts.progress+"%")};ProgressBar.prototype.setWidth=function(e){this.opts.width=e;if(this.opts.width>0)this.elements.container.css("width",this.opts.width+"px");else this.elements.container.css("width","auto")};ProgressBar.prototype.getText=function(){return this.opts.text};ProgressBar.prototype.getHoverText=function(){return this.opts.hoverText};ProgressBar.prototype.getWidth=function(){return this.opts.width};ProgressBar.prototype.getContainer=function(){return this.elements.container};WH.Raidbots=new function(){this.createForm=function(a){var n=WH.ce("form",{action:"https://www.raidbots.com/simbot/"+a,method:"get",className:"raidbots-form"});var s=WH.ce("select",{name:"region"});WH.ae(s,e(WH.TERMS.region));var r=WH.ce("select",{name:"realm"});WH.ae(r,e(WH.TERMS.realm));WH.ae(r,e(WH.TERMS.selectRegion_tip,false));WH.aE(s,"change",t.bind(this,r,s));var o=WH.ce("input",{type:"text",name:"name",placeholder:WH.TERMS.characterName,required:true});WH.aE(r,"change",(function(){o.focus()}));var l=WH.ce("button",{className:"fa fa-external-link",type:"submit"});WH.st(l,WH.TERMS.submit);WH.ae(n,s);WH.ae(n,r);WH.ae(n,o);WH.ae(n,l);WH.Wow.Realm.fetchData(i.bind(this,s,r));return n};function e(e,t){var i=WH.ce("option",{disabled:true,selected:typeof t==="boolean"?t:true,required:true});WH.st(i,e);return i}function t(i,a,n){var s=WH.Wow.Realm.getAll();if(!s){WH.Wow.Realm.fetchData(t.bind(this,i,a));return}WH.ee(i);var r=a.options&&a.options[a.selectedIndex]?a.options[a.selectedIndex].value:null;if(r===null){WH.ae(i,e("Invalid region",false));return}if(!s[r]){WH.ae(i,e("No realms found for that region ("+r+")",false));return}WH.ae(i,e(WH.Strings.sprintf(WH.TERMS.realms_format,r)));var o=[];for(var l in s[r]){if(s[r].hasOwnProperty(l)&&s[r][l]){o.push(s[r][l])}}o.sort((function(e,t){return e.name.localeCompare(t.name)}));for(var c=0,u=o.length;c<u;c++){var d=o[c];var f=WH.ce("option",{value:d.slug});WH.st(f,d.name);WH.ae(i,f)}if(typeof n==="undefined"||n){i.focus()}}function i(a,n){var s=WH.Wow.Realm.getAll();if(!s){WH.Wow.Realm.fetchData(i.bind(this,a,n));return}WH.ee(a);WH.ae(a,e(WH.TERMS.region));var r=[];for(var o in s){r.push(o)}r.sort();for(var l=0,c=r.length;l<c;l++){var u=WH.ce("option",{value:r[l],selected:r[l].toUpperCase()==="US"});WH.st(u,r[l]);WH.ae(a,u)}t(n,a,false)}};WH.Responsive=new function(){this.BREAKPOINTS={MOBILE_MODE:767};this.CONSTANTS={INTERIOR_SIDEBAR_REMOVAL_BREAKPOINT:768,SIDEBAR_REMOVAL_BREAKPOINT:1200};const e={platformInitComplete:false,testCount:0};this.removeFixedPosition=function(){t.removeFixedPosition()};this.test=function(a){e.testCount++;i.test();t.test();if(a){e.platformInitComplete=true}};var t=new function(){var e=["db-action-buttons"];var t=["announcement","infobox-original-position","lntlwentlsdn35"];const i={elements:{bodyPosition:undefined,container:undefined,fixedPosition:undefined,pagePosition:undefined,staticPosition:undefined}};this.removeFixedPosition=function(){if(!i.elements.fixedPosition){return}var e=i.elements.fixedPosition;i.elements.fixedPosition=undefined;this.test();WH.de(e)};this.test=function(){if(!WH.WAS.showAds()){return}if(!i.elements.container){if(i.elements.container===false){return}i.elements.container=WH.ge("video-pos-inner");if(!i.elements.container){return}}if(!i.elements.staticPosition&&!i.elements.fixedPosition){i.elements.staticPosition=WH.ge("video-pos-static");i.elements.fixedPosition=WH.ge("video-pos-fixed")}if(i.elements.pagePosition==null){i.elements.pagePosition=WH.ge("video-pos-page");if(i.elements.pagePosition){if(i.elements.staticPosition){WH.de(i.elements.staticPosition)}if(i.elements.bodyPosition){WH.de(i.elements.bodyPosition)}i.elements.staticPosition=i.elements.pagePosition;i.elements.bodyPosition=i.elements.pagePosition}else if(document.readyState==="complete"){i.elements.pagePosition=false}}a();if(!i.elements.bodyPosition&&!i.elements.staticPosition){return}var e=i.elements.container.parentNode.id;var t=window.aclrePlayerMoved||function(){};if(Platform.getViewportSize().width<=WH.Responsive.CONSTANTS.SIDEBAR_REMOVAL_BREAKPOINT){if(i.elements.bodyPosition&&e!==i.elements.bodyPosition.id){WH.ae(i.elements.bodyPosition,i.elements.container);t()}}else if(i.elements.staticPosition){if(WH.isElementInView(i.elements.staticPosition,true)||!i.elements.fixedPosition){if(e!==i.elements.staticPosition.id){WH.ae(i.elements.staticPosition,i.elements.container);t()}}else{if(i.elements.fixedPosition&&e!==i.elements.fixedPosition.id){WH.ae(i.elements.fixedPosition,i.elements.container);t()}}}};function a(){if(i.elements.bodyPosition){return}if(i.elements.bodyPosition=WH.ge("video-pos-body")){return}var e=WH.ge("main-contents");if(!e){return}var t=n(e);if(!t){return}i.elements.bodyPosition=WH.ce("div",{id:"video-pos-body"});t.parentNode.insertBefore(i.elements.bodyPosition,t.nextSibling)}function n(i){e:for(var a=0;a<i.childNodes.length;a++){var s=i.childNodes[a];if(!s||s.nodeType!==Node.ELEMENT_NODE||s.tagName==="SCRIPT"||s.tagName==="NOSCRIPT"){continue}if(s.id){for(var r=t.length,o=0;o<r;o++){if(s.id.indexOf(t[o])===0){continue e}}}if(s.className){for(var l=e.length,c=0;c<l;c++){if(s.className.match(new RegExp("\\b"+e[c]+"\\b"))){continue e}}}if(!$(s).is(":visible")){continue}if(a+1===i.childNodes.length){break}if(s.classList.contains("text")){return n(s)}return s}return null}};var i=new function(){var t;this.test=function(){if(!t&&(!e.platformInitComplete||e.testCount<5)){t=WH.ge("infobox-alternate-position")}var n=$(".infobox");i(n);a(n)};function i(e){if(!t||!e.length){return}var i=Platform.getViewportSize();var a=e.closest(".interior-sidebar");if(a.length){if(i.width<=WH.Responsive.CONSTANTS.INTERIOR_SIDEBAR_REMOVAL_BREAKPOINT){a.appendTo(t)}else if(!a.parent().hasClass("interior-sidebar-wrapper")){$(".interior-sidebar-wrapper").prepend(a)}}else{if(i.width<=WH.Responsive.CONSTANTS.SIDEBAR_REMOVAL_BREAKPOINT){e.appendTo(t)}else if(e.parent().attr("id")!=="infobox-original-position"){$("#infobox-original-position").append(e)}}}function a(e){var t=Platform.getViewportSize().width-54;if(!Platform.isTouch()){t-=20}$(".icon-db-link div",e).each((function(){this.style.width="auto";window.requestAnimationFrame(function(){this.style.width=Math.min(t,this.parentNode.offsetWidth)+"px"}.bind(this))}))}};$(window).scroll(t.test)};$(window).resize(WH.Responsive.test);function ss_submitAScreenshot(){tabsContribute.focus(1)}function ss_validateForm(e){if(!e.elements["screenshotfile"].value.length){alert(WH.TERMS.selectscreenshot_tip);return false}return true}function ss_appendSticky(){let e=WH.ge("infobox-sticky-ss");if(!e){return}let t=WH.inArray(lv_screenshots,1,(function(e){return e.sticky}));if(t<0&&lv_screenshots.length){t=0;for(let e=1;e<lv_screenshots.length;e++){if(Date.parse(lv_screenshots[e].date)>Date.parse(lv_screenshots[t].date)){t=e}}}if(t!=-1){e.className="has-thumb";let i=lv_screenshots[t];let a=WH.ce("a");a.href="#screenshots:id="+i.id;a.onclick=function(e){ScreenshotViewer.show({screenshots:lv_screenshots,pos:t});return WH.rfWithoutControlKey(e)};let n=[300,300];let s=WH.ce("img");let r=Math.min(n[0]/i.width,n[1]/i.height);s.src=WH.getScreenshotUrl(i.id,"small",{imageType:i.imageType});s.width=Math.round(r*i.width);s.height=Math.round(r*i.height);s.className="border";WH.ae(a,s);WH.ae(e,a);$("#infobox-screenshots").append(" ("+lv_screenshots.length+")").wrapInner($('<a href="#screenshots"></a>').click((function(){tabsRelated.focus(tabsRelated.getTabById("screenshots"));return false})))}else{let t=WH.ce("div");let i=WH.ce("a",{href:"javascript:"},WH.ct(WH.TERMS.submitone_stc));if(!g_user.id){i.href="/account=signin"}t.innerHTML=WH.sprintf(WH.TERMS.noneyet_format,i.outerHTML);if(g_user.id>0){i=t.querySelector("a");WH.aE(i,"click",(function(){ss_submitAScreenshot()}))}WH.ae(e,t);let a=WH.ge("wh-mv-view-in-3d-button");if(a&&a.dataset.mvDisplayId){let t="";if(a.dataset.mvType==WH.Types.NPC){t=WH.Wow.Npc.getThumbUrl(parseInt(a.dataset.mvDisplayId))}else if(a.dataset.mvType==WH.Types.ITEM){let e=WH.Gatherer.get(parseInt(a.dataset.mvType),parseInt(a.dataset.mvTypeId));let i=e&&e.jsonequip&&e.jsonequip.races;let n=WH.Wow.Models.getRaceIdFromMask(i);if(e.classs!==WH.Wow.Item.CLASS_ARMOR){n=undefined}t=WH.Wow.Item.getThumbUrl(parseInt(a.dataset.mvDisplayId),n)}if(t){let i=WH.ce("img",{src:t,width:300,height:300,className:"border",style:{display:"none"},id:"sticky-screenshot-model-substitute"});WH.aE(i,"load",(function(){i.style.display="";e.classList.add("has-thumb-substitute")}));WH.aE(i,"error",(function(){i.style.display="none";e.classList.remove("has-thumb-substitute")}));WH.ae(e,i)}}}ss_appendSticky=function(){}}var g_screenshots={};window.ScreenshotViewer=new function(){const e=WH.DOM;const t=170-Lightbox.BLEED_SIZE;const i=20;const a=50;var n,s,r,o,l,c,u,d=0,f,h,p,m,g,H,W,v,_,T,b,E,y,S="screenshots";function w(e){var t=n[e],i="#"+S;if(d==0)i+=t?":id="+t.id:"";else i+=":"+f+":"+(t?e+1:e+.5);return i}function I(e){var t="";if(typeof g_gathered_types=="object"&&g_gathered_types[e.type]&&g_gathered_types[e.type][e.typeId]&&g_gathered_types[e.type][e.typeId]["name_"+Locale.getName()]){t=g_gathered_types[e.type][e.typeId]["name_"+Locale.getName()]}else if(typeof g_pageInfo=="object"&&g_pageInfo.type&&g_pageInfo.typeId&&g_pageInfo.name){t=g_pageInfo.name}if(e.caption){if(t){t+=WH.TERMS.hyphen_punct+e.caption}else{t=e.caption}}return t}function N(e){clearTimeout(y);P();if(e&&!c&&Platform.getViewportHeight()>h.offsetHeight+Lightbox.BLEED_SIZE){return}h.style.visibility="hidden";var t=n[s];var i=I(t);var a=t.url||WH.getScreenshotUrl(t.id,"normal",{description:i,imageType:t.imageType});var u='<img src="'+a+'"'+' width="'+o+'"'+' height="'+l+'"'+">";m.innerHTML=u+'<div class="screenshotviewer-image-inner" style="padding-top:'+l/o*100+'%"></div>';if(!e){WH.Track.interactiveEvent("Screenshots","Show",t.id+(t.caption&&t.caption.length?" ("+t.caption+")":""));if(t.url){v.href=a;v.style.display="block"}else{v.href=WH.getScreenshotUrl(t.id,"normal",{description:i,imageType:t.imageType});v.style.display="block"}if(!t.user&&typeof g_pageInfo=="object")t.user=g_pageInfo.username;var d=t.date&&t.user,f=n.length>1;if(d){var p=new Date(t.date),b=(WH.getServerTime()-p)/1e3;var E=_.firstChild.childNodes[1];E.href="/user="+t.user;E.innerHTML=t.user;var S=_.firstChild.childNodes[3];WH.ee(S);S.removeAttribute("class");S.removeAttribute("title");WH.formatDate(S,b,p);_.firstChild.title=WH.TERMS.from+t.user+" "+WH.formatDate(null,b,p);_.firstChild.style.display=""}else _.firstChild.style.display="none";var S=_.childNodes[1];WH.ee(S);if(t.user){if(d)WH.ae(S,WH.ct(" "+WH.TERMS.dash_punct+" "));var E=WH.ce("a");E.href="javascript:";E.onclick=ContactTool.show.bind(ContactTool,{mode:3,screenshot:t});E.className="fa fa-exclamation-triangle fa-size-s";WH.Tooltip.simple(E,WH.TERMS.reportingoptions_tip,"q2");WH.ae(E,WH.ct(WH.TERMS.report));WH.ae(S,E)}S=_.childNodes[2];if(f){var N="";if(t.user)N=WH.TERMS.dash_punct;if(s%1!=0){N+=WH.sprintf(WH.TERMS.advertisementbetweenimages_tip,s+.5,s+1.5,n.length)}else{N+=s+1+WH.TERMS.of_lc+n.length}S.innerHTML=N;S.style.display=""}else S.style.display="none";_.style.display=d||f?"":"none";if(Locale.getId()!=LOCALE_ENUS&&t.caption)t.caption="";var M=t.caption!=null&&t.caption.length;var A=t.subject!=null&&t.subject.length&&t.type&&t.typeId;if(M||A){u="";if(A){var k=WH.ce("div");WH.ae(k,WH.ct(WH.Types.getUpperSingular(t.type)+WH.TERMS.colon_punct));WH.ae(k,WH.ce("a",{href:WH.Entity.getPath(t.type,t.typeId)},WH.ct(t.subject)));u+=k.innerHTML}var C=document.createDocumentFragment();if(M){if(A){u+=WH.TERMS.dash_punct}C=t.noMarkup?document.createTextNode(t.caption):WH.markup.getDomFragment(t.caption,{mode:WH.markup.MODE.SIGNATURE})}$(T).html(u).append(C);T.style.display=""}else T.style.display="none";if(n.length>1){H.href=w(R(-1));W.href=w(R(1));H.style.display=W.style.display=""}else{H.style.display=W.style.display="none"}if(s!=r||Platform.isTouch()){g.style.display="none"}location.replace(w(s))}Lightbox.reveal();h.style.visibility="visible"}function R(e){var t=s;t+=e;if(t<0)t=n.length-1;else if(t>=n.length)t=0;return t}function M(e){s=R(e);O();return false}function A(e){switch(e.keyCode){case 37:M(-1);break;case 39:M(1);break}}function k(){N(1)}function C(){D();if(n.length>1)WH.dE(document,"keyup",A);if(u&&d==0){if(u.indexOf(":id=")!=-1)u="#"+S;WH.setHash(u)}else WH.clearHash()}function L(e,t,i){if(typeof i.screenshots=="string"){n=g_screenshots[i.screenshots];d=1;f=i.screenshots}else{n=i.screenshots;d=0;f=null}h=e;s=0;if(i.pos&&i.pos>=0&&i.pos<n.length)s=i.pos;r=s;if(t){e.className+=" has-lightbox-caption screenshotviewer";p=WH.ce("div");p.className="lightbox-content screenshotviewer-screen";g=WH.ce("div");g.className="screenshotviewer-keystip";g.innerHTML=WH.TERMS.sceenshotviewerkeys_tip;WH.ae(e,g);var a=WH.ce("div");var o=WH.ce("div");a.className="screenshotviewer-page-wrapper screenshotviewer-prev-wrapper";o.className="screenshotviewer-page-wrapper screenshotviewer-next-wrapper";H=WH.ce("a");W=WH.ce("a");H.className="screenshotviewer-prev";W.className="screenshotviewer-next";H.href="javascript:";W.href="javascript:";var l=WH.ce("span");l.className="fa fa-chevron-left";WH.ae(H,l);l=WH.ce("span");l.className="fa fa-chevron-right";WH.ae(W,l);WH.aE(H,"click",M.bind(H,-1));WH.aE(H,"tap",M.bind(H,-1));WH.aE(W,"click",M.bind(W,1));WH.aE(W,"tap",M.bind(W,1));WH.ae(a,H);WH.ae(o,W);WH.ae(p,a);WH.ae(p,o);m=WH.ce("div",{className:"screenshotviewer-image",innerHTML:'<div class="screenshotviewer-image-inner"></div>'});WH.ae(p,m);WH.ae(e,p);var c=WH.ce("a");c.className="dialog-option fa fa-times";c.href="javascript:";c.onclick=Lightbox.hide;WH.ae(c,WH.ct(WH.TERMS.close));WH.ae(e,c);v=WH.ce("a");v.className="dialog-option fa fa-external-link";v.href="javascript:";v.target="_blank";WH.ae(v,WH.ct(WH.TERMS.original));WH.ae(e,v);var b=WH.ce("div",{className:"lightbox-caption"});_=WH.ce("div");_.className="screenshotviewer-from";var E=WH.ce("span");WH.ae(E,WH.ct(WH.TERMS.from));WH.ae(E,WH.ce("a"));WH.ae(E,WH.ct(" "));WH.ae(E,WH.ce("span"));WH.ae(_,E);WH.ae(_,WH.ce("span"));WH.ae(_,WH.ce("span"));WH.ae(b,_);T=WH.ce("div");T.className="screenshotviewer-caption";WH.ae(b,T);WH.ae(e,b)}u=location.hash;if(n.length>1)WH.aE(document,"keyup",A);O()}function O(){var e=n[s];if(e&&(!e.width||!e.height)){if(b){b.onload=null;b.onerror=null}else{h.className="";E=[];while(h.firstChild){E.push(h.firstChild);WH.de(h.firstChild)}}clearTimeout(y);y=setTimeout((function(){e.width=126;e.height=22;P();e.width=null;e.height=null;var t=WH.ce("div");t.className="screenshotviewer-loading";var i=WH.ce("img");i.src=WH.staticUrl+"/images/ui/misc/progress-anim.gif";i.width=126;i.height=22;WH.ae(t,i);WH.ae(h,t);Lightbox.reveal();h.style.visiblity="visible"}),150);b=new Image;b.onload=function(e,t){clearTimeout(t);e.width=this.width;e.height=this.height;b=null;x();N()}.bind(b,e,y);b.onerror=function(e){clearTimeout(e);b=null;Lightbox.hide();x()}.bind(b,y);b.src=e.url||WH.getScreenshotUrl(e.id,"normal",{description:I(e),imageType:e.imageType})}else N()}function D(){if(!b)return;b.onload=null;b.onerror=null;b=null;x()}function x(){if(!E)return;WH.ee(h);h.className="lightbox-frame has-lightbox-caption screenshotviewer";for(var e=0;e<E.length;++e)WH.ae(h,E[e]);E=null}function P(){let r=Platform.getViewportSize();let u=n[s];o=u.width;l=u.height;let d=o;let f=r.width-Lightbox.BLEED_SIZE-t-i;let h=Math.min(o,f);c=false;if(h<o){c=true;d=h}let p=h*(l/o);let g=p+Lightbox.BLEED_SIZE+a;if(g>r.height){c=true;let e=r.height-Lightbox.BLEED_SIZE-a-10;d=e*(o/l)}Lightbox.setSize(Math.floor(d+i));e.setRelativeHeight(WH.qs(".screenshotviewer-image-inner",m),o,l)}this.getScreenshotDescription=function(e){return I(e)};this.checkPound=function(){if(location.hash&&location.hash.indexOf("#"+S)==0){if(!g_listviews[S]){var e=location.hash.split(":");if(e.length==3){var t=g_screenshots[e[1]],i=parseInt(e[2]);if(t&&i>=1&&i<=t.length){ScreenshotViewer.show({screenshots:e[1],pos:i-1,hashname:S})}}}}};this.show=function(e){if("hashname"in e){S=e.hashname;delete e.hashname}Lightbox.show("screenshotviewer",{onShow:L,onHide:C,onResize:k},e)};$(document).ready(this.checkPound)};WH.Seo=new function(){this.addJsonLdBreadcrumb=function(e){var t=WH.Url.getCanonicalPath().replace(/[?&].*$/,"");var i=false;var a={"@context":"http://schema.org","@type":"BreadcrumbList",itemListElement:[]};var n=function(e,n){var s={"@type":"ListItem",position:e+1,item:{name:n.name}};if(n.url){s.item["@id"]=n.url;if(WH.Url.getPathFromUrl(n.url).indexOf(t)>=0){i=true}}if(n.image){s.item.image=WH.ensureUrlProtocol(n.image)}a.itemListElement.push(s)};for(var s=0,r=e.length;s<r;s++){n(s,e[s])}var o=WH.ge("json-ld-breadcrumbs");if(o){WH.de(o)}if(a.itemListElement.length){if(!i){var l=window.g_pageInfo?g_pageInfo.name:undefined;if(!l){var c=WH.qsa(".heading-size-1");if(c.length===1){l=c[0].textContent}}if(l){n(s,{name:l,url:WH.Url.getCanonical(),image:undefined})}}WH.ae(document.head,WH.ce("script",{id:"json-ld-breadcrumbs",text:JSON.stringify(a),type:"application/ld+json"}))}};this.slugId=function(e,t){let i=WH.Strings.slug(t);return(i?i+"-":"")+e.toString()};function e(){var e=WH.qsa('script[type="application/ld+json"]')||[];for(var t=0,i=e.length;t<i;t++){try{var a=JSON.parse(e[t].textContent)}catch(e){continue}if(a.mainEntityOfPage&&a.image&&a.image.url){return a.image.url}}return undefined}function t(){if(!WH.User.hasRole(U_GROUP_ADMIN|U_GROUP_BLOGGER|U_GROUP_EDITOR)&&WH.User.getId()!==1788274&&!WH.isDev()){return}if(WH.PageMeta.skipSeoValidation){return}WH.onLoad(i)}function i(){if(!document.title){WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,"No page title!")}$((function(){setTimeout((function(){if(!WH.PageMeta.skipSeoHeadingValidation&&!WH.qs("h1")){WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,"No H1!")}}),1e3)}));var e=$('meta[name="description"]').attr("content");if(e){var t='[span class="q0"]SEO Description:[/span] '+e.replace("[","\\[");var i=false;if(e.length<130){t+=' [span class="q0"](short)[/span]';i=true}else if(e.length>160){t+=' [span class="q0"](long)[/span]';i=true}if(WH.Strings.hasReplacementValues(e)){WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,t,true)}else if(i){WH.Admin.Debug.warn(WH.Admin.Debug.TYPE_SEO,t,true)}}else{WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,"No SEO description!")}var a=$('meta[name="keywords"]').attr("content");if(a){if(WH.Strings.hasReplacementValues(a)){var t='[span class="q0"]SEO Keywords:[/span] '+a.replace("[","\\[").split(",").join(", ");WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,t,true)}}else{WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,"No SEO keywords!")}}requestAnimationFrame(t)};var ShowOnMap=function(e,t,i){const a=this;a.data=e;a.currentPath=[];if(t==null)t=myMapper;a.mapper=t;a._legend=null;a._legendLabel=null;a._legendContents=null;a._legendHorde=null;a._legendAlliance=null;a._menu=[];a._trackingIcons=[];a._controlsdiv=i?$(typeof i=="string"?"#"+i:i):$("#lenrlkn4");a.construct()};ShowOnMap.prototype.onExpand=function(){this.expanded=true;location.replace(this.pound+".map")};ShowOnMap.prototype.onCollapse=function(){this.expanded=false;var e=WH.getHash();if(e.indexOf("#show")==0&&e.indexOf(".map")>0){this.pound=e.substr(0,e.indexOf(".map"));location.replace(this.pound)}};ShowOnMap.prototype.construct=function(){if(!this.data)return;var e=this._controlsdiv;var t=function(e,t){return WH.stringCompare(e[1],t[1])};var i=[];var a=[];for(var n in this.data){if(this.data[n].length===undefined){var s=[];var r=[];var o={};var l=this.data[n];for(var c in l){var u=false;for(var d=0,f=l[c].length;d<f;++d){if(l[c][d].paths){u=true;break}}var h=WH.Strings.slug(c);if(l[c][0].name_enus!==undefined){h=WH.Strings.slug(l[c][0].name_enus)}var p={};var m={};var g=[h];var H=ShowOnMap.combinePins(l[c],false,u);var W=H[0];var v=H[1];var _=0;for(var d=0;d<W.length;++d){var T=W[d];var b=ShowOnMap.buildTooltip(T.list);var E=b[2];var y=null;if(E=="javascript:")y=b[3];if(T.list.length==1){E=g_types[T.list[0].type]&&T.list[0].id?WH.Entity.getPath(T.list[0].type,T.list[0].id):""}if(n=="rare"||n=="herb"||n=="vein")b[1]=s.length+1;if(p[T.level]==undefined)p[T.level]=[];p[T.level].push([T.coord[0],T.coord[1],{url:E,label:b[0],menu:y,type:b[1],lines:T.list[0].paths}]);_++}if(_>0){var E=g_types[l[c][0].type]&&l[c][0].id?WH.Entity.getPath(l[c][0].type,l[c][0].id):"";m[s.length+1]=[c,E];g.push(c+WH.sprintf(WH.TERMS._paren,v));g.push(this.showStuff.bind(this,p,[n,h],m));s.push(g);for(var S in p){if(r[S])r[S]=r[S].concat(p[S]);else r[S]=p[S]}o[s.length]=[c,E]}}if(s.length>0){s.sort(t);var g=[n,ShowOnMap.getPinTypeName(n),this.showStuff.bind(this,r,[n],o),s];this._menu.push(g);var w=[[null,ShowOnMap.getPinTypeName(n)],["all",WH.TERMS.all,g[2]]];for(x=0;x<s.length;x++)w.push(s[x]);this._trackingIcons.push([n,undefined,o,w])}}else{if(this.data[n].length==0)continue;var u=false;for(var d=0,f=this.data[n].length;d<f;++d){if(this.data[n][d].paths){u=true;break}}var g=[n];var p={};var I={},N={};var R={},M={};var m={};var A={};var k={};var H=ShowOnMap.combinePins(this.data[n],false,u);var v=H[1];var _=0,C=0,L=0,O=0,D=0;var P=function(e,t){for(var i=0;i<t.length;++i){var a=t[i];var s=e;a.list.key=n;var r=ShowOnMap.buildTooltip(a.list,e=="hordedailyquests"||e=="alliancedailyquests"?true:false);var o=r[2];var l=null;if(o=="javascript:")l=r[3];if(a.list.length==1)o=g_types[a.list[0].type]&&a.list[0].id?WH.Entity.getPath(a.list[0].type,a.list[0].id):"";var c=[a.coord[0],a.coord[1],{url:o,label:r[0],menu:l,type:r[1],lines:a.list[0].paths}];if(p[a.level]==undefined){p[a.level]=[];I[a.level]=[];N[a.level]=[];R[a.level]=[];M[a.level]=[]}if(a.list[0].mapicon){c[2].mapicon=a.list[0].mapicon}if(s!="mailbox"&&s!="vignettes"&&s!="rare"&&s!="spirithealer"&&s!="book"&&s!="forge"&&s!="treasure"&&s!="anvil"&&s!="hordequests"&&s!="alliancequests"&&s!="hordedailyquests"&&s!="alliancedailyquests"&&s!="boss"){if(r[1]==2||r[1]==0){if(r[1]==2)A[2]=[WH.TERMS.horde,null];else A[0]=[WH.TERMS.neutral,null];I[a.level].push(c);C++}if(r[1]==3||r[1]==0){if(r[1]==3)k[3]=[WH.TERMS.alliance,null];else k[0]=[WH.TERMS.neutral,null];R[a.level].push(c);O++}}else if(s=="hordequests"){s="quest";if(r[1]==2)A[2]=[WH.TERMS.horde,null];else A[0]=[WH.TERMS.neutral,null];I[a.level].push(c);C++}else if(s=="hordedailyquests"){s="daily";if(r[1]==2)A[2]=[WH.TERMS.horde,null];else A[0]=[WH.TERMS.neutral,null];N[a.level].push(c);L++}else if(s=="alliancequests"){s="quest";if(r[1]==3)k[3]=[WH.TERMS.alliance,null];else k[0]=[WH.TERMS.neutral,null];R[a.level].push(c);O++}else if(s=="alliancedailyquests"){s="daily";if(r[1]==3)k[3]=[WH.TERMS.alliance,null];else k[0]=[WH.TERMS.neutral,null];M[a.level].push(c);D++}else{p[a.level].push(c);_++}}return s};var U=P(n,H[0]);if(n=="alliancequests"){var q=ShowOnMap.combinePins(this.data[n],true);if(q[1]>0)P("alliancedailyquests",q[0])}else if(n=="hordequests"){var F=ShowOnMap.combinePins(this.data[n],true);if(F[1]>0)P("hordedailyquests",F[0])}if(U=="rare")v=this.data[U].length;else if(U=="forge"||U=="anvil"||U=="treasure"||U=="mailbox")v=H[0].length;if(_>0){var g=[U,ShowOnMap.getPinTypeName(U)+WH.sprintf(WH.TERMS._paren,v),this.showStuff.bind(this,p,[U],m)];this._menu.push(g);this._trackingIcons.push([U,p,m])}if(C>0){var g=[U,ShowOnMap.getPinTypeName(U)+WH.sprintf(WH.TERMS._paren,C),this.showStuff.bind(this,I,["horde",U],A),null];if(U=="quest"){g.push({tinyIcon:"quest_start"});if(L>0){a.push(g);g=["daily",WH.TERMS.questgiversdaily+WH.sprintf(WH.TERMS._paren,L),this.showStuff.bind(this,N,["horde","daily"],A),null,{tinyIcon:"quest_start_daily"}];this._trackingIcons.push(["daily",N,A])}}a.push(g);this._trackingIcons.push([U,I,A])}if(O>0){var g=[U,ShowOnMap.getPinTypeName(U)+WH.sprintf(WH.TERMS._paren,O),this.showStuff.bind(this,R,["alliance",U],k),null];if(U=="quest"){g.push({tinyIcon:"quest_start"});if(D>0){i.push(g);g=["daily",WH.TERMS.questgiversdaily+WH.sprintf(WH.TERMS._paren,D),this.showStuff.bind(this,M,["alliance","daily"],k),null,{tinyIcon:"quest_start_daily"}];this._trackingIcons.push(["daily",M,k])}}i.push(g);this._trackingIcons.push([U,R,k])}}}i.sort(t);a.sort(t);this._menu.sort(t);if(a.length>0)this._menu.unshift(["horde",WH.TERMS.horde,"",a,{tinyIcon:"side_horde"}]);if(i.length>0)this._menu.unshift(["alliance",WH.TERMS.alliance,"",i,{tinyIcon:"side_alliance"}]);var B=[-1,WH.TERMS.nothing,this.showStuff.bind(this,[],[-1],{})];B.checked=true;this._menu.push(B);var G=WH.createButton(WH.TERMS.showonmap_ellipsis,null,{class:"mapper-som-button fa fa-search"});Menu.add(G,this._menu,{showAtElement:true});e.append(G);var Y;if(!this._legend){this._legend=$("<div/>",{class:"mapper-legend",css:{display:"none"}});var z=$("<div/>",{class:"mapper-legend-container"});this._legendLabel=WH.ce("b",undefined,WH.ct(WH.TERMS.symbolLegend));z.append(this._legendLabel);this._legendContents=$("<div/>",{css:{float:"right"}});z.append(this._legendContents);var Y=$("<div/>",{css:{clear:"right"}});z.append(Y);this._legend.append(z)}e.append(this._legend);Y=$("<div/>",{css:{clear:"left"}});e.append(Y);this.setTrackingIcons();var V=[];var j=WH.getHash();if(j.indexOf("#show:")!=-1){V=j.split(".")}else if(this.data.instance){V.push("#show:boss")}if(V.length>0){if(V.length==2&&V[1]=="map"){this.expanded=true;this.mapper.toggleZoom()}var K=V[0].split(":");if(K.length<2)return;var Z=this._menu;for(var d=1;d<K.length;++d){var J=K.length-1;for(var c=0;c<Z.length;++c){if(Z[c][0]==K[d]){if(Z[c][3]&&d<J)Z=Z[c][3];else Z=Z[c];break}}}if(Z&&Z[2]&&jQuery.isFunction(Z[2]))Z[2]()}};ShowOnMap.prototype.setTrackingIcons=function(){var e=this.mapper.parent;var t={repair:"repair",auctioneer:"auctioneer",banker:"banker",battlemaster:"battlemaster",innkeeper:"inn",guildmaster:"guild",stablemaster:"stablemaster",flightmaster:"flightmaster",trainer:"trainer-profession",vendor:"vendor-food",quest:"quest",daily:"daily",anvil:"blacksmithing",herb:"herbalism",vein:"mining",book:"trainer-class",forge:"smelting",spirithealer:"spirithealer",boss:"boss",rare:"hostile-npc",vignettes:"resource",treasure:"treasure",mailbox:"mailbox"};var i=[{name:WH.Types.getUpperPlural(WH.Types.NPC),icons:["repair","auctioneer","banker","battlemaster","innkeeper","guildmaster","stablemaster","flightmaster","trainer","vendor","spirithealer","boss","rare"],elements:[]},{name:WH.Types.getUpperPlural(WH.Types.QUEST),icons:["quest","daily"],elements:[]},{name:WH.GlobalStrings.TRADE_SKILLS,icons:["anvil","herb","vein","book","forge"],elements:[]},{name:WH.TERMS.loot,icons:["vignettes","treasure"],elements:[]},{name:WH.TERMS.goal,icons:["mailbox"],elements:[]}];var a=this._trackingIcons;a.sort((function(e,t){return WH.stringCompare(e[0],t[0])}));for(var n=1;n<a.length;n++){if(a[n][0]==a[n-1][0]){var s={};for(var r in a[n][1]){if(!a[n][1].hasOwnProperty(r))continue;s[r]=a[n][1][r]}for(r in a[n-1][1]){if(!a[n-1][1].hasOwnProperty(r))continue;if(!s.hasOwnProperty(r))s[r]=a[n-1][1][r];else s[r]=s[r].concat(a[n-1][1][r])}a[n-1][1]=s;var o={};for(var l in a[n][2]){if(!a[n][2].hasOwnProperty(l))continue;o[l]=a[n][2][l]}for(l in a[n-1][2]){if(!a[n-1][2].hasOwnProperty(l))continue;o[l]=a[n-1][2][l]}a[n-1][2]=o;a.splice(n--,1)}}a.sort((function(e,t){return WH.stringCompare(ShowOnMap.getPinTypeName(e[0]),ShowOnMap.getPinTypeName(t[0]))}));var c=WH.ce("div",{className:"mapper-legend-icons"});for(var u=0,d;d=a[u];u++){if(!t.hasOwnProperty(d[0]))continue;var f=WH.ce("div");f.className="mapper-legend-icon "+t[d[0]];f.setAttribute("data-legend-icon",d[0]);f.onmousedown=WH.rf;if(d[1]){var h=[d[0]];if(d[0]!="vignettes"&&d[0]!="treasure"){h.splice(0,0,-2)}WH.aE(f,"click",this.showStuff.bind(this,d[1],h,d[2],f))}if(d[3]){Menu.add(f,d[3],{showAtElement:true})}WH.Tooltip.simpleNonTouch(f,ShowOnMap.getPinTypeName(d[0]));var p=false;for(var m=0,g;g=i[m];m++){if(g.icons.indexOf(d[0])>-1){p=true;i[m].elements.push(f);break}}if(!p){WH.error("Could not find group for map icon.",d[0])}}for(var H=0,W;W=i[H];H++){if(W.elements.length){var v=WH.ce("div",{className:"mapper-legend-icons-group"});var _=WH.ce("div",{className:"mapper-legend-icons-heading",innerHTML:W.name});var T=WH.ce("div",{className:"mapper-legend-icons-icons"});if(W.style){for(var b in W.style){if(W.style.hasOwnProperty(b)){v.style[b]=W.style[b]}}}for(var E=0,y;y=W.elements[E];E++){WH.ae(T,y)}WH.ae(v,_);WH.ae(v,T);WH.ae(c,v)}}var S=WH.ce("div",{className:"mapper-legend-icons-tip",innerHTML:WH.TERMS.clickicontoshowonmap_tip});$("> span:first-child",this.mapper.parent).append(S);WH.ae(e,c);e.className+=" mapper-autoheight"};ShowOnMap.prototype.setLegend=function(e){this._legendContents.empty();var t=$("<div/>");var i=0;for(var a in e){var n=$("<span/>",{class:"mapper-pin mapper-pin-"+a+" mapper-legend-pin"});if(e[a][1]){var s=$("<a/>",{href:e[a][1],text:e[a][0]});n.append(s)}else n.text(e[a][0]);t.append(n);if(++i%4==0)t.append($("<br/>"))}this._legendContents.append(t)};ShowOnMap.prototype.showStuff=function(e,t,i){if(WH.isEqualSimpleObject(t,this.currentPath)){this.showStuff.call(this,[],[-1],{});return}Menu.hide();var a=false;for(var n=0,s;s=t[n];n++){if(typeof s!="string"){continue}var r=$('[data-legend-icon="'+s+'"]');if(r.length){r.parents(".mapper-legend-icons").find(".mapper-legend-icon").removeClass("active");r.addClass("active");a=true;break}}if(!a){$(".mapper-legend-icon",this.mapper.parent).removeClass("active")}var o={coords:e,preservelevel:true};if(typeof g_pageInfo!="undefined"&&g_pageInfo.hasOwnProperty("id"))o.zone=g_pageInfo.id;this.mapper.update(o);this.setLegend(i);this.checkMenu(t);this.currentPath=t;if(t.length==1&&t[0]==-1||t[0]==-2){this.pound="";WH.clearHash();return}this.pound="#show:"+t.join(":");if(this.pound!="#show:boss")location.replace(this.pound+(this.expanded?".map":""))};ShowOnMap.prototype.clearChecks=function(e){for(var t=0;t<e.length;++t){e[t].checked=false;if(e[t][3]&&e[t][3].length>0)this.clearChecks(e[t][3])}this._legend.hide()};ShowOnMap.prototype.checkMenu=function(e){this.clearChecks(this._menu);if(e[0]!=-1)this._legend.show();else this._legend.hide();var t=this._menu;var i=[];for(var a=0;a<e.length;++a){for(var n=0;n<t.length;++n){if(t[n][0]==e[a]){t[n].checked=true;i.push([t[n][0],t[n][1]]);t=t[n][3];break}}}if(e[0]==-2){i.push([e[1],ShowOnMap.getPinTypeName(e[1])])}var s=i.length-1;var r="";var o={rare:true,herb:true,vein:true};for(var a=0;a<i.length;++a){if(a>0&&o[i[0][0]]){var l=$("span",this._legendContents);l.removeClass("mapper-legend-pin");l.append($("<b/>",{text:" "+i[a][1].substr(i[a][1].lastIndexOf("("))}))}else{if(a==s)r+="<span>";else r+='<span class="breadcrumb-arrow">';r+=i[a][1]+"</span>"}}this._legendLabel.innerHTML=r};ShowOnMap.combinePins=function(e,t,i){var a={};var n=null,s=null;var r,o;var l=0;var c=function(e,t){var i=Math.floor(e[0]);var n=Math.floor(e[1]);if(!t){if(i%2==1)i+=1;if(n%2==1)n+=1}if(a[i]===undefined)a[i]={};if(a[i][n]===undefined)a[i][n]=[];return[i,n]};for(var u=0;u<e.length;++u){var d=e[u];if(t){if(!d.quests)continue;var f=true;for(var h=0;h<d.quests.length;++h){if(d.quests[h].daily){f=false;break}}if(f)continue}else if(i&&d.id!=0){n=c([d.id,0],true);r=n[0];o=n[1];var p=WH.dO(d);p.coord=d.coords[0];a[r][o].push(p);l++;continue}if(d.point=="start"||d.point=="end"){n=c(d.coord);r=n[0];o=n[1];if(a[r][o].length>3){var m=a[r][o];a[r][o]=[];for(var g=0;g<m.length;++g){s=c(m[g].coord,true);a[s[0]][s[1]].push(m[g])}}a[r][o].push(d);l++}else{for(var H=0;H<d.coords.length;++H){n=c(d.coords[H]);r=n[0];o=n[1];var p=WH.dO(d);p.coord=d.coords[H];if(a[r][o].length>3){var m=a[r][o];a[r][o]=[];for(var g=0;g<m.length;++g){s=c(m[g].coord,true);a[s[0]][s[1]].push(m[g])}}a[r][o].push(p);l++}}}var W=[];for(r in a)for(o in a[r])W.push({coord:[a[r][o][0].coord[0],a[r][o][0].coord[1]],level:a[r][o][0].level,list:a[r][o]});return[W,l]};ShowOnMap.buildTooltip=function(e,t){var i="";var a="";var n=[];var s=-1;var r={};var o=0;var l={};var c=1;for(var u=0;u<e.length;++u){var d=e[u];a=g_types[d.type]&&d.id?WH.Entity.getPath(d.type,d.id):"";var f=a+d.item;var h=a+d.point;if(!r[f]){r[f]={url:a,obj:d,coords:[d.coord],all:[d]};o++}else{if(!l[h])r[f].all.push(d);r[f].coords.push(d.coord)}l[h]=1}var u=0;for(var f in r){var a=r[f].url;var p=r[f].all;var d=r[f].obj;var m=r[f].coords;if(u>0)i+="<br />";n.push([u++,d.name,a]);c=d.type;if(!d.point){if(d.reacthorde==1&&d.reactalliance<1||d.side==2){if(s==2||s==-1)s=2;else s=0}else if(d.reactalliance==1&&d.reacthorde<1||d.side==1){if(s==3||s==-1)s=3;else s=0}else s=0}i+='<b class="q'+(s==2?" icon-horde":"")+(s==3?" icon-alliance":"")+'">'+d.name+"</b>";if(m.length>0)i+=" ("+m[0][0]+", "+m[0][1]+")<br />";if(d.quests){if(d.quests.length>1)i+=WH.TERMS.starsthefollowingquests_colon;else i+=WH.TERMS.startsthefollowingquest_colon;i+='<div class="indent">';for(var g=0;g<d.quests.length;++g){var H=d.quests[g];if(t&&!H.daily)continue;i+='<span class="q0">['+H.level+"]</span> "+H.name+(H.series&&!H.first?'<sup style="font-size: 8px">(*)</sup>':"")+(H.category<0&&g_quest_sorts[H.category]?' <i class="q0">'+g_quest_sorts[H.category]+"</i>":"")+"<br />"}i+="</div>"}else if(d.description)i+=d.description+"<br />";else if(d.point){for(var u=0;u<p.length;++u){var W=p[u];switch(W.point){case"start":i+=WH.TERMS.startsthequest_stc+"<br />";if(s=="end")s="startend";else if(s!="startend")s="start";break;case"end":i+=WH.TERMS.endsthequest_stc+"<br />";if(s=="start")s="startend";else if(s!="startend")s="end";break;case"sourcestart":i+=WH.TERMS.sourceofqueststart_colon+"<br />";i+='<div class="indent">'+W.item+"</div>";if(s=="end")s="startend";else if(s!="startend")s="start";break;case"sourceend":i+=WH.TERMS.sourceofquestend_colon+"<br />";i+='<div class="indent">'+W.item+"</div>";if(s=="start")s="startend";else if(s!="startend")s="end";break;case"requirement":i+=WH.TERMS.objectiveofthequest_stc+"<br />";if(s==-1)s=W.objective;break;case"sourcerequirement":i+=WH.TERMS.sourceofaquestobjective_colon+"<br />";i+='<div class="indent">'+W.item+"</div>";if(s==-1)s=W.objective;break}}}}i+='<div class="q2">';if(e.length==1)i+=e[0].type==1&&e[0].id!=0?WH.TERMS.clicktoviewthisnpc_stc:e[0].type==2&&e[0].id!=0?WH.TERMS.clicktoviewthisobject_stc:"";else if(o==1)i+=c==1&&d.id!=0?WH.TERMS.clicktoviewthisnpc_stc:c==2&&d.id!=0?WH.TERMS.clicktoviewthisobject_stc:"";else i+="<br />"+WH.TERMS.clicktoview_ellipsis;i+="</div>";var v=[];v.push(i);v.push(s);if(e.length==1||o==1){v.push(a);v.push(null)}else{v.push("javascript:");v.push(n)}return v};ShowOnMap.getPinTypeName=function(e){let t=ShowOnMap.getPinTypeName;return(t.nameMap=t.nameMap||WH.getPageData("maps.showOnMap.typeNames")||{})[e]||e};WH.SiteAchievement=new function(){const e=1;const t=2;const i=3;const a={};a[e]=WH.TERMS.copper;a[t]=WH.TERMS.silver;a[i]=WH.TERMS.gold;this.getQualityName=function(e){return a[e]}};(function(e){var t=3;var i=new Array;var a=2650;var n=e("<audio />").get(0),s=WH.staticUrl+"/sfx/wsa.wav",r=1,o=0,l=3,c;function u(t,i){if(i<=0){if(t==true||t=="true"){e("#wsa-overflow").fadeOut(1e3,(function(){e("#wsa-overflow").remove();r=1}))}else{e("#wsa-overflow").remove();r=1}clearInterval(c)}return i-1}function d(e,t,i){var a=new Date;a.setDate(a.getDate()+i);var n=escape(t)+(i==null?"":"; expires="+a.toUTCString());document.cookie=e+"="+n}function f(e){var t,i,a,n=document.cookie.split(";");for(t=0;t<n.length;t++){i=n[t].substr(0,n[t].indexOf("="));a=n[t].substr(n[t].indexOf("=")+1);i=i.replace(/^\s+|\s+$/g,"");if(i==e)return unescape(a)}}function h(){for(key in i)clearTimeout(i[key])}e((function(){e("body").delegate(".wsa-vol","click",(function(){e(this).toggleClass("alt");if(e(this).hasClass("alt")==true){e.post("/account=setsound",{muted:1})}else{e.post("/account=setsound",{muted:0})}})).delegate(".wsa-notification","mouseover mouseout",(function(t){if(t.type=="mouseover"){h();e(".wsa-notification").stop();e(this).css("z-index",15e5);if(e(this).attr("data-animated")=="true"){e(".wsa-notification").fadeTo(100,1)}}else{e(this).css("z-index",999999);if(e(this).attr("data-persistent")!="true"){e(".wsa-notification").each((function(t,a){var n=e(this).attr("id");if(e(this).attr("data-animated")=="true"){i[n]=setTimeout("$('#"+n+"').fadeOut(3000,function(){ $('#"+n+"').remove(); })",1e3)}else{i[n]=setTimeout("$('#"+n+"').remove()",3e3)}}))}}})).delegate(".wsa-notification","click",(function(t){if(!(e(t.target).is("a")||e(t.target).hasClass("wsa-vol"))){e(this).remove()}}))}));e.fn.wsaNotification=function(d){var f={caption:"??? No name",rank:1,href:"/user#achievements",animate:true,playsfx:true,desc:"",persist:false};var d=e.extend(f,d);var h=e("body").children("#wsa-overflow").length;var p=e("body").children(".wsa-notification").length;if(p<t&&h==0){var m=new Date,m="wsan"+m.getTime();if(p!=o%t)o=0;var g=!d.playsfx;var H=d.rank==0?WH.TERMS.newprivilege:WH.sprintf(WH.TERMS.achievementunlocked_format,WH.SiteAchievement.getQualityName(d.rank));var W='<div class="wsa-notification" data-animated="'+d.animate+'" data-persistent="'+d.persist+'" style="bottom: '+(o%t*125+15).toString()+'px" id="'+m+'"><em></em><ins></ins><span class="wsar'+d.rank+'"></span><div><var><i>'+H+'</i><a title="'+d.desc+'" href="'+d.href+'">'+WH.TERMS.viewdetails+" &rarr;</a></var>"+WH.getImitationHeading(d.caption,2).outerHTML+"</div>"+'<div class="wsa-vol'+(g?" alt":"")+'"></div>'+"</div>";e("body").prepend(W);if(d.playsfx==true||d.playsfx=="true"){if(!e(n).attr("src"))e(n).attr("src",s);if(n.play){n.play()}else{e(".wsa-sound").remove();e("body").append('<embed class="wsa-sound" src="'+s+'" autostart="true" hidden="true" loop="false" />')}}if(d.animate==true||d.animate=="true"){e("#"+m+" em").css("filter","");e("#"+m+" em").fadeOut(750,(function(){e("#"+m+" em").remove()}));e("#"+m+" ins").delay(250).animate({marginLeft:"355px",opacity:0},750,(function(){e(this).remove();if(!d.persist)i[m]=setTimeout("$('#"+m+"').fadeOut(3000,function(){ $('#"+m+"').remove(); })",a)}))}else{e("#"+m+" em").remove();e("#"+m+" ins").remove();if(!d.persist)i[m]=setTimeout("$('#"+m+"').remove()",a+1e3)}o++}else{var W='<div class="wsa-overflow" id="wsa-overflow" style="bottom: '+0+'px"><a href="/user">'+WH.sprintf(WH.TERMS.wsamore_format,1)+"</a></div>";if(h==0){e("body").prepend(W);l=3;if(d.animate==true||d.animate=="true")e("#wsa-overflow").slideDown();else e("#wsa-overflow").show();c=setInterval((function(){l=u(d.animate,l)}),1e3)}else{l=3;r++;e("#wsa-overflow b").text(r)}}}})(jQuery);function AchievementCheck(){$.ajax({cache:false,url:"/ajax-achievement-check",type:"POST",success:function(e){if(e&&e.length){for(var t=0;t<e.length;t++){$().wsaNotification(e[t])}}}})}var Slider=new function(){const e=this;var t;var i;var a;function n(e){i=this;t=WH.getCursorPos(e);WH.aE(document,"mousemove",s);WH.aE(document,"mouseup",r);return false}function s(e){if(!t||!i){return}var a=WH.getCursorPos(e);var n=a.x-t.x;var s=u(i,i._pos+n);var r=f(i);if(r&&i.elements.input){i.elements.input.value=r.value}if(!s){t=a}if(i.onMove){i.onMove(e,i,r)}}function r(e){if(i.onMove){i.onMove(e,i,f(i))}i=null;t=null;WH.dE(document,"mousemove",s);WH.dE(document,"mouseup",r);return false}function o(e,a){i=e;t=WH.getCursorPos(a);var n=WH.ac(i.parentNode);var o=Math.floor(p(i)/2);u(i,t.x-n.x-o);var l=f(i);if(l&&i.elements.input){i.elements.input.value=l.value}if(i.onMove){i.onMove(a,i,l)}WH.aE(document,"mousemove",s);WH.aE(document,"mouseup",r);return false}function l(e,t){if(a){clearTimeout(a)}if(t.type==="change"||t.type==="keypress"&&t.which===13){c(e,t)}else{a=setTimeout(c.bind(0,e,t),1e3)}}function c(e,t){let i=e.elements.input.value;let a=f(e);if(isNaN(i)){i=a.value}if(i>e._max){i=e._max}if(i<e._min){i=e._min}Slider.setValue(e,i);if(e.onMove){e.onMove(t,e,f(e))}}function u(e,t,i){let a=false;let n=d(e);if(t<0){t=0;a=true}else if(t>n){t=n;a=true}let s=p(e);if(!s&&typeof i==="number"){i=Math.min(Math.max(i,0),100)}else{i=parseFloat(t)/n;i-=s/h(e)*i;i*=100}e.elements.trackBarProgress.style.width=i+"%";e.style.left=i+"%";e._pos=t;return a}function d(e){return h(e)-p(e)}function f(e){var t=e._pos/d(e);var i=Math.round(t*(e._max-e._min)+e._min);var a=[t,i];a.percent=t;a.value=i;return a}function h(e){if(e._tsz>0){return e._tsz}return e.elements.track.offsetWidth}function p(e){return typeof e._hsz==="number"?e._hsz:e.offsetWidth}this.getInput=function(e){return e.elements.input};this.getPercent=function(e){return f(e).percent};this.getValue=function(e){return f(e).value};this.setMax=function(e,t){e._max=t;if(e.elements.maxLabel){WH.st(e.elements.maxLabel,t)}Slider.setValue(e,f(e).value)};this.setValue=function(e,t,i){if(t<e._min){t=e._min}else if(t>e._max&&i!==true){t=e._max}if(t>e._max){e.elements.container.classList.add("exceeded-max")}else{e.elements.container.classList.remove("exceeded-max")}if(e.elements.input){e.elements.input.value=t}let a=(t-e._min)/(e._max-e._min);u(e,d(e)*a,100*a)};this.setValueDisplay=function(e,t){if(!e.elements.values){WH.error("Can't set the slider value display, this slider doesn't support labels.",t,e);return}WH.ee(e.elements.values);WH.st(e.elements.values,t)};this.setSize=function(e,t){var i=f(e);var a=d(e);e.elements.container.style.width=t+"px";if(a!==d(e)){this.setValue(e,i.value)}};this.setTitle=function(e,t){if(!e.elements.labels){WH.error("Can't set the slider title, this slider doesn't support labels.",t,e);return}if(!e.elements.title){e.elements.title=WH.ce("span",{className:"slider-labels-title"});WH.aef(e.elements.labels,e.elements.title)}WH.ee(e.elements.title);WH.st(e.elements.title,t)};this.init=function(t,i){t.classList.add("slider");t.dataset.track=i.remaining?"remaining":"progress";let a=WH.ce("div",{className:"slider-track-handle",onmousedown:n});let s=WH.ce("div",{className:"slider-track",onmousedown:o.bind(0,a)});let r=WH.ce("div",{className:"slider-track-bar"});let c=WH.ce("div",{className:"slider-track-bar-progress"});WH.ae(t,s);WH.ae(s,a);WH.ae(s,r);WH.ae(r,c);a.elements={container:t,input:undefined,labels:undefined,maxLabel:undefined,title:undefined,track:s,trackBarProgress:c,values:undefined};a._min=1;a._max=100;a._pos=0;a._tsz=0;a._hsz=null;if(i!=null){if(i.minValue||i.minValue===0){a._min=i.minValue}if(i.maxValue){a._max=i.maxValue}if(i.onMove){a.onMove=i.onMove}if(i.trackSize){a._tsz=i.trackSize}if(typeof i.handleSize==="number"){a._hsz=i.handleSize}if(i.editable===false){t.classList.add("not-editable");a._hsz=0}if(i.hasOwnProperty("value")){e.setValue(a,i.value,true)}if(i.showLabels!==false){t.classList.add("has-labels");a.elements.labels=WH.ce("div",{className:"slider-labels"});WH.ae(t,a.elements.labels);a.elements.values=WH.ce("span",{className:"slider-labels-values"});WH.ae(a.elements.labels,a.elements.values);let n;if(i.valueDisplay!==undefined){e.setValueDisplay(a,i.valueDisplay);n=function(){}}else{let e=WH.ce("span",{className:"slider-labels-values-sizer"});WH.ae(a.elements.values,e);if(a._min!==1){let e=WH.ce("span",{className:"slider-labels-values-min"},WH.ct(WH.TERMS.minimum_abbrev+WH.TERMS.colon_punct+a._min));WH.ae(a.elements.values,e)}a.elements.input=WH.ce("input",{className:"slider-labels-values-input",value:i.hasOwnProperty("value")?i.value:a._max,type:"text"});WH.ae(a.elements.values,a.elements.input);a.elements.maxLabel=WH.ce("span",{className:"slider-labels-values-max"},WH.ct(a._max));WH.ae(a.elements.values,a.elements.maxLabel);n=function(){WH.st(e,a.elements.input.value);window.requestAnimationFrame((function(){a.elements.input.style.width=(e.offsetWidth||20)+"px"}))}}if(typeof i.title==="string"){e.setTitle(a,i.title)}n();$(a.elements.input).bind("focus",(function(){this.parentNode.classList.add("input-focused")})).bind("blur",(function(){this.parentNode.classList.remove("input-focused")})).bind("change",n).bind("click",(function(){this.select()})).bind("keypress",(function(e){let t=[];let i=e.which;for(let e=48;e<58;e++){t.push(e)}if(!(WH.inArray(t,i)>=0)&&i!==13){e.preventDefault()}n()})).bind("keyup keydown change",(function(e){l(a,e);if(e.which===13||e.which===27){this.blur()}n()}))}}return a}};WH.StatusWidget=function(e,t){const i=this;const a=["remaining","title","value","valueDisplay"];const n={elements:{container:undefined,info:undefined},slider:undefined,updateFunction:undefined};this.getElement=function(e){if(!n.elements.hasOwnProperty(e)){WH.error("Status widget element not found.",e)}return n.elements[e]};this.update=function(){if(n.updateFunction){n.updateFunction(n.slider,this)}};function s(e,t){n.elements.container=e;n.updateFunction=t.updateFunction;n.elements.container.classList.add("status-widget");let s={editable:false,maxValue:t.hasOwnProperty("maxValue")?t.maxValue:100,minValue:t.hasOwnProperty("minValue")?t.minValue:1};for(let e=0,i;i=a[e];e++){if(t.hasOwnProperty(i)){s[i]=t[i]}}let r=WH.ce("div",{className:"status-widget-slider"});WH.ae(n.elements.container,r);n.slider=Slider.init(r,s);n.elements.info=WH.ce("div",{className:"status-widget-info"});WH.ae(n.elements.container,n.elements.info);if(typeof t.updateFunction==="function"){if(typeof t.updateInterval==="number"){setInterval(i.update,t.updateInterval)}requestAnimationFrame(i.update)}}s.apply(this,arguments)};WH.Strings=new function(){const e=this;this.laquo="«";this.lsaquo="‹";this.nbsp=" ";this.raquo="»";this.rsaquo="›";const t=80;const i={guidIndex:0,guidPrefix:undefined};this.camelKebab=function(e){return/(?=[A-Z])/[Symbol.split](e).map((function(e){return e.toLowerCase()})).join("-")};this.escapeHtml=function(e){return WH.ce("div",{},WH.ct(e)).innerHTML};this.escapeRegExp=function(e){return e.replace(/[\s\S]/g,(function(e){let t=e.charCodeAt(0).toString(16);let i=t.length>2;return"\\"+(i?"u":"x")+("0000"+t).slice(i?-4:-2)}))};this.formatNumber=function(e,t,i,a){i=i||0;a=a||i;var n=WH.Strings.formatNumber.supportsOptions;if(n===undefined){n=WH.Strings.formatNumber.supportsOptions=!!(typeof Intl=="object"&&Intl&&typeof Intl.NumberFormat=="function")}var s=e;if(!e instanceof Number){e=new Number(e)}if(isNaN(e)){WH.error("Tried to convert an invalid number",s);e=0}let r=function(e){return e.replace("-",/[1-9]/.test(e)?"-":"")};if(!n){if(t){e*=100}return r(e.toFixed(a)+(t?"%":""))}return r(e.toLocaleString(undefined,{style:t?"percent":"decimal",useGrouping:true,minimumFractionDigits:i,maximumFractionDigits:a}))};this.guid=function(){if(!i.guidPrefix){i.guidPrefix=["wowhead-guid",Date.now(),WH.getServerTime().valueOf(),e.hashCode(location.href),""].join("-")}return i.guidPrefix+i.guidIndex++};this.hashCode=function(e){let t=0;for(let i=0;i<e.length;i++){t=(t<<5)-t+e.charCodeAt(i);t|=0}return t};this.hasReplacementValues=function(e){return!!e.match(/(%[sd]|%\d+\$s|\$\d)/)};this.slug=function(e,i,a){if(typeof e!=="string"){WH.error("Tried to convert a variable of type "+typeof e+" to kebab case.",e);return""}var n=WH.ce("textarea");n.innerHTML=e.replace(/</g,"&lt;").replace(/>/g,"&gt;");e=n.value;if(Locale.exists(a)||Locale.isLocaleName(a)){if(a===LOCALE_ENUS||a===Locale.getName(LOCALE_ENUS)){e=e.replace(" & "," and ")}else{e=e.replace(WH.TERMS.wordspace_punct+WH.TERMS.ampersand_punct+WH.TERMS.wordspace_punct,WH.TERMS.wordspace_punct+WH.TERMS.and_lc+WH.TERMS.wordspace_punct)}}e=e.replace(/%\w|['#]|^\s*|\s*$/g,"");if(i){e=e.replace(/ \/ |_|[^\u00C0-\u1FFF\u2C00-\uD7FF\w]+/g,"-")}else{e=WH.removeAccents(e).replace(/ \/ |_|[^a-z0-9]/gi,"-")}e=e.toLocaleLowerCase();e=e.replace(/-{2,}/g,"-");e=e.replace(/^-+|-+$/g,"");if(e.length>t){let i=e.substr(t,1)==="-";e=e.substr(0,t);let a;if(!i&&(a=e.lastIndexOf("-"))!==-1){e=e.substr(0,a)}}return e};this.sprintf=function(){"use strict";var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function t(e){return i(n(e),arguments)}function i(i,a){var n=1,s=i.length,r,o="",l,c,u,d,f,h,p,m;for(l=0;l<s;l++){if(typeof i[l]==="string"){o+=i[l]}else if(typeof i[l]==="object"){u=i[l];if(u.keys){r=a[n];for(c=0;c<u.keys.length;c++){if(r==undefined){throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',u.keys[c],u.keys[c-1]))}r=r[u.keys[c]]}}else if(u.param_no){r=a[u.param_no]}else{r=a[n++]}if(e.not_type.test(u.type)&&e.not_primitive.test(u.type)&&r instanceof Function){r=r()}if(e.numeric_arg.test(u.type)&&(typeof r!=="number"&&isNaN(r))){throw new TypeError(t("[sprintf] expecting number but found %T",r))}if(e.number.test(u.type)){p=r>=0}switch(u.type){case"b":r=parseInt(r,10).toString(2);break;case"c":r=String.fromCharCode(parseInt(r,10));break;case"d":case"i":r=parseInt(r,10);break;case"j":r=JSON.stringify(r,null,u.width?parseInt(u.width):0);break;case"e":r=u.precision?parseFloat(r).toExponential(u.precision):parseFloat(r).toExponential();break;case"f":r=u.precision?parseFloat(r).toFixed(u.precision):parseFloat(r);break;case"g":r=u.precision?String(Number(r.toPrecision(u.precision))):parseFloat(r);break;case"o":r=(parseInt(r,10)>>>0).toString(8);break;case"s":r=String(r);r=u.precision?r.substring(0,u.precision):r;break;case"t":r=String(!!r);r=u.precision?r.substring(0,u.precision):r;break;case"T":r=Object.prototype.toString.call(r).slice(8,-1).toLowerCase();r=u.precision?r.substring(0,u.precision):r;break;case"u":r=parseInt(r,10)>>>0;break;case"v":r=r.valueOf();r=u.precision?r.substring(0,u.precision):r;break;case"x":r=(parseInt(r,10)>>>0).toString(16);break;case"X":r=(parseInt(r,10)>>>0).toString(16).toUpperCase();break}if(e.json.test(u.type)){o+=r}else{if(e.number.test(u.type)&&(!p||u.sign)){m=p?"+":"-";r=r.toString().replace(e.sign,"")}else{m=""}f=u.pad_char?u.pad_char==="0"?"0":u.pad_char.charAt(1):" ";h=u.width-(m+r).length;d=u.width?h>0?f.repeat(h):"":"";o+=u.align?m+r+d:f==="0"?m+d+r:d+m+r}}}return o}var a=Object.create(null);function n(t){if(a[t]){return a[t]}var i=t,n,s=[],r=0;while(i){if((n=e.text.exec(i))!==null){s.push(n[0])}else if((n=e.modulo.exec(i))!==null){s.push("%")}else if((n=e.placeholder.exec(i))!==null){if(n[2]){r|=1;var o=[],l=n[2],c=[];if((c=e.key.exec(l))!==null){o.push(c[1]);while((l=l.substring(c[0].length))!==""){if((c=e.key_access.exec(l))!==null){o.push(c[1])}else if((c=e.index_access.exec(l))!==null){o.push(c[1])}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}}}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}n[2]=o}else{r|=2}if(r===3){throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported")}s.push({placeholder:n[0],param_no:n[1],keys:n[2],sign:n[3],pad_char:n[4],align:n[5],width:n[6],precision:n[7],type:n[8]})}else{throw new SyntaxError("[sprintf] unexpected placeholder")}i=i.substring(n[0].length)}return a[t]=s}return t}();this.toFixedTrimmed=function(e,t){return e.toFixed(t).replace(/\D?0*$/,"")};this.unescapeHtml=function(e){let t={"&gt;":">","&lt;":"<","&amp;":"&","&apos;":"'","&quot;":'"'};let i;return e.replace(/&(?:(?:#\d+)|(?:#x[0-9a-f]+)|[a-z]+);/gi,(function(e){if(t.hasOwnProperty(e)){return t[e]}i=i||new DOMParser;return t[e]=i.parseFromString(e,"text/html").documentElement.textContent}))};this.vsprintf=function(e,t){return this.sprintf.apply(null,[e].concat(t||[]))}};WH.Switcher=function(e,t,i){const a="active";const n="inactive";const s={elements:{container:undefined,indicator:undefined},toggleable:false};this.activateChoice=function(e){let t=WH.qs('.switcher-choice[data-switcher-id="'+e+'"]',s.elements.container);if(t){t.click()}else{WH.error("Could not find switcher choice with ID "+e)}};this.setChoiceLabel=function(e,t){let i=WH.qs('.switcher-choice[data-switcher-id="'+e+'"]',s.elements.container);if(i){if(typeof t==="string"){WH.st(i,t)}else{WH.ee(i);WH.ae(i,t)}}else{WH.error("Could not find switcher choice with ID "+e)}};function r(e){let t=WH.ce("a",{className:"switcher-choice",dataset:{state:e.active?a:n}},WH.ct(e.name));WH.ae(s.elements.container,t);if(e.id){t.dataset.switcherId=e.id}if(e.active){c(t)}WH.aE(t,"click",l.bind(t,e));WH.preventSelectStart(t);WH.onMutate(t,(function(){if(this.dataset.state===a){c(this)}}));if(e.nonTouchTooltip){WH.Tooltip.simpleNonTouch(t,e.nonTouchTooltip,undefined,true)}else if(e.tooltip){WH.Tooltip.simple(t,e.tooltip,undefined,true)}}function o(e,t,i){i=i||{};if(i.toggleable){s.toggleable=true}s.elements.container=e;s.elements.container.classList.add("switcher");s.elements.indicator=WH.ce("div",{className:"switcher-indicator"});WH.ae(s.elements.container,s.elements.indicator);for(let e=0,i;i=t[e];e++){r(i)}WH.aE(window,"resize",(function(){let e=WH.qs('.switcher-choice[data-state="active"]',s.elements.container);if(e){c(e)}}))}function l(e,t){let i=s.toggleable&&this.dataset.state===a?n:a;WH.setData('.switcher-choice[data-state="active"]',"state",n,this.parentNode);this.dataset.state=i;c(this,true);if(e.onChange){e.onChange.apply(this,arguments)}}function c(e,t){let i=e.parentNode;if(!i){WH.error("Cannot update switcher indicator position, no switcher choice parent found.",e);return}if(t!==true){s.elements.indicator.style.transition="none"}if(e.dataset.state===a){let t=i.offsetHeight-(e.offsetTop+e.offsetHeight);s.elements.indicator.style.bottom=t+"px";s.elements.indicator.style.left=e.offsetLeft+"px";s.elements.indicator.style.width=e.getBoundingClientRect().width+"px"}else{s.elements.indicator.style.bottom="";s.elements.indicator.style.left="";s.elements.indicator.style.width=""}if(t!==true){requestAnimationFrame((function(){requestAnimationFrame((function(){s.elements.indicator.style.transition=""}))}))}}o.apply(this,arguments)};function Tabs(e){WH.cO(this,e);if(this.parent){this.parent=WH.ge(this.parent)}if(!this.parent){WH.error("Tabs cannot be created without a parent.");return}this.selectedTab=-1;this.ul=null;this.tabs=[];this.nShows=0;if(this.maxRows==null&&Platform.getViewportWidth()<768){this.maxRows=4}if(this.poundable==null)this.poundable=1;this.poundedTab=null;if(this.onLoad==null)this.onLoad=Tabs.onLoad.bind(this);if(this.onShow==null)this.onShow=Tabs.onShow.bind(this);if(this.onHide)this.onHide=this.onHide.bind(this);this.trackClick=Tabs.trackClick.bind(this);if(e.tabs instanceof Array){for(var t=0,i=e.tabs.length;t<i;t++){this.add(e.tabs[t].name,e.tabs[t].options)}this.flush()}}Tabs.prototype={add:function(e,t){let i;let a=this.tabs.length;i={caption:e,index:a,owner:this};WH.cO(i,t);this.tabs.push(i);if(this.ul){let e=this.createTab(i);WH.ae(this.ul,e)}return a},hide:function(e,t){if(this.tabs[e]){var i=this.selectedTab;if(e==0&&i==-1)this.poundedTab=this.selectedTab=i=0;if(e!=this.poundedTab)this.selectedTab=-1;this.tabs[e].hidden=!t;this.flush();if(!t&&e==i){this.selectedTab=i;for(var a=0,n=this.tabs.length;a<n;++a){if(a!=e&&!this.tabs[a].hidden)return this.show(a,1)}}}},unlock:function(e,t){if(this.tabs[e]){this.tabs[e].locked=t;let i=WH.gE(this.ul,"a");$(".fa-lock",i[e]).remove();if(t){$("div, b",i[e]).prepend('<span class="fa fa-lock" />')}let a=location.hash.substr(1).split(";")[0];if(this.tabs[e].id==a){this.show(e,1)}}},focus:function(e){if(e<0)e=this.tabs.length+e;this.forceScroll=1;WH.gE(this.ul,"a")[e].onclick({},true);this.forceScroll=null},show:function(e,t,i){var a;if(isNaN(e)||e<0)e=0;else if(e>=this.tabs.length)e=this.tabs.length-1;if(t==null&&e==this.selectedTab||this.tabs[e].hidden)return;if(this.tabs[e].locked)return this.onShow(this.tabs[e],this.tabs[this.selectedTab]);if(this.selectedTab!=-1){a=this.tabs[this.selectedTab];if(this.onHide&&!this.onHide(a))return;if(a.onHide&&!a.onHide())return}++this.nShows;a=WH.gE(this.ul,"a");if(this.selectedTab!=-1)a[this.selectedTab].className="";a[e].className="selected";if(this.maxRows){var n=function(e){var t=$(e).parent().siblings(".tab-responsive-list");if(t.length){if(e.parentNode.getAttribute("data-responsive-hidden")=="true"){$("a",t).addClass("selected");$("div, b",t).html(this.getMoreTabName(true,$("b",e).html()))}else{$("a",t).removeClass("selected");$("div, b",t).html(this.getMoreTabName(true))}}};if(i){setTimeout(n.bind(this,a[e]),250)}else{n.call(this,a[e])}}a=this.tabs[e];if(a.onLoad){a.onLoad();a.onLoad=null}this.onShow(this.tabs[e],this.tabs[this.selectedTab]);if(a.onShow)a.onShow(this.tabs[this.selectedTab]);this.selectedTab=e;window.dispatchEvent(new CustomEvent("scroll"))},flush:function(e){var t;var i=WH.ce("div");i.className="tabs-container";var a="ul";this.ul=WH.ce(a);this.ul.className="tabs";WH.ae(i,this.ul);for(var n=0;n<this.tabs.length;++n){var s=this.tabs[n];var r=this.createTab(s);WH.ae(this.ul,r)}WH.ee(this.parent);WH.ae(this.parent,i);if(this.onLoad){let t=this.onLoad();if(t!=null){this.poundedTab=e=t}}this.show(e,null,true);if(this.maxRows){setTimeout(function(){this.collapseExtraTabs()}.bind(this),1)}},createTab:function(e){var t,i,a;t=WH.ce("li");i=WH.ce("b");var n=WH.ce("a");n.rel=e.rel||"np";if(e.className){t.className=e.className}if(e.hidden){t.style.display="none"}if(this.poundable&&!e.noPound){n.href="#"+e.id}else{n.href="javascript:"}if(e.menu){Menu.add(n,e.menu,{showAtElement:true,onShow:e.onShowMenu,onHide:e.onHideMenu})}else{n.onclick=Tabs.onClick.bind(e,n)}var s=WH.ce("div");if(e.locked){a=WH.ce("span",{className:"fa fa-lock"});WH.ae(s,a)}else if(e.icon){a=WH.ce("span",{className:"icontiny"});a.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/tiny/"+e.icon.toLowerCase()+".gif)";WH.ae(s,a)}else if(e.image){a=WH.ce("img");$.extend(a,e.image);WH.ae(s,a)}else if(e.fontIcon){a=WH.ce("i",{className:"fa fa-"+e.fontIcon});WH.ae(s,a)}if(e.tooltip){n.onmouseover=function(e,t){WH.Tooltip.showAtCursor(t,e,0,0,"q")}.bind(n,e.tooltip);n.onmousemove=WH.Tooltip.cursorUpdate;n.onmouseout=WH.Tooltip.hide}if(e["class"]){s.className=e["class"]}WH.ae(s,WH.ct(e.caption));WH.ae(n,s);if(e.locked){a=WH.ce("span",{className:"fa fa-lock"});WH.ae(i,a)}else if(e.icon){a=WH.ce("span",{className:"icontiny"});a.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/tiny/"+e.icon.toLowerCase()+".gif)";WH.ae(i,a)}else if(e.image){a=WH.ce("img");$.extend(a,e.image);WH.ae(i,a)}else if(e.fontIcon){a=WH.ce("i",{className:"fa fa-"+e.fontIcon});WH.ae(i,a)}WH.ae(i,WH.ct(e.caption));WH.ae(n,i);WH.ae(t,n);n.tabSettings=e;return t},collapseExtraTabs:function(){var e=$(this.ul);var t=e.find("> li:first-child").outerHeight(true);if(e.height()>t*this.maxRows){var i=$("> li",e);var a=[];var n=[];var s=this.maxRows;i.each((function(e){var i=$(this);var r=i.position();if(r.top>t*s-t){n.push(i)}else{a.push(i);while(a.length>2){a.shift()}}}));while(n.length>0&&a.length>0){n.unshift(a.pop())}var r=i.length-n.length;var o=[];var l=/<img[^>]+src="([^">]*)"[^>]*>\s*/;for(var c=0,u;u=n[c];c++){u.attr("data-responsive-hidden","true");var d=[c,$("b",u).html(),function(e){$("a",e).trigger("click");if(Platform.getViewportWidth()<768){$("html, body").animate({scrollTop:$(this.ul).offset().top-42},150)}}.bind(this,u),null,{checkedFunc:function(e){return this.selectedTab==e}.bind(this,c+r)}];let e=d[Menu.ITEM_LABEL].match(l);if(e){d[Menu.ITEM_OPTIONS].icon=e[1]}d[Menu.ITEM_LABEL]=d[Menu.ITEM_LABEL].replace(/<[^>]*>/,"");o.push(d)}this.add(this.getMoreTabName(false),{className:"tab-responsive-list",fontIcon:"bars",menu:o,onShowMenu:function(){$(this.currentTabContents).addClass("tab-fade")}.bind(this),onHideMenu:function(){$(".tab-fade").removeClass("tab-fade")}.bind(this),noPound:false})}},getMoreTabName:function(e,t){var i=e?'<i class="fa fa-bars"></i>':"";if(t){i+=" &ndash; "+t}return i},setTabIcon:function(e,t){let i=WH.gE(this.ul,"a")[e];i.tabSettings.icon=t;WH.qs("span.icontiny",i).style.backgroundImage='url("'+WH.Icon.getIconUrl(t,WH.Icon.TINY)+'")'},setTabName:function(e,t){this.tabs[e].caption=t;var i=WH.gE(this.ul,"a");WH.setTextNodes(i[e],t)},setTabPound:function(e,t){if(!this.poundable){return}let i=WH.gE(this.ul,"a");i[e].href="#"+this.tabs[e].id+(t?";"+t:"")},setTabTooltip:function(e,t){this.tabs[e].tooltip=t;var i=WH.gE(this.ul,"a");if(t==null)i[e].onmouseover=i[e].onmousemove=i[e].onmouseout=null;else{i[e].onmouseover=function(e){WH.Tooltip.showAtCursor(e,t,0,0,"q2")};i[e].onmousemove=WH.Tooltip.cursorUpdate;i[e].onmouseout=WH.Tooltip.hide}},getSelectedTab:function(){return this.selectedTab},getTabById:function(e){for(var t=0,i=this.tabs.length;t<i;++t){if(this.tabs[t].id==e)return t}}};Tabs.onClick=function(e,t,i){if(i==null&&this.index==this.owner.selectedTab)return;var a=WH.rfWithoutControlKey(t);if(a==null)return;Menu.hide();this.owner.show(this.index,i);if(this.owner.poundable&&!this.locked){let t=e.href.indexOf("#");if(t!==-1){let i=e.href.substr(t);if(location.hash.indexOf(i)!==0){location.replace(i)}}}return a};Tabs.onLoad=function(){if(!this.poundable||!location.hash.length){return}let e=location.hash.substr(1).split(/[;:]/)[0];if(e){for(let t=0,i;i=this.tabs[t];t++){if(i.id===e&&!i.locked){return t}}}};Tabs.onShow=function(e,t){if(e.hidden||e.locked)return;if(t)WH.ge("tab-"+t.id).style.display="none";if(this.poundedTab!=null||t)this.trackClick(e);var i=WH.ge("tab-"+e.id);i.style.display="";this.currentTabContents=i;WH.Tools.Bloodmallet.updateChartsSizes(i);if((this.nShows===1&&typeof this.poundedTab==="number"&&this.poundedTab>=0||this.forceScroll)&&!this.noScroll){setTimeout(WH.scrollTo.bind(WH,this.parent,{animated:!WH.pageWasReloaded()}),100)}};Tabs.trackClick=function(e){if(!this.trackable||e.tracked){return}WH.Track.interactiveEvent("Tabs","Show",this.trackable+": "+e.id);e.tracked=1};WH.Theme=new function(){const e=this;this.THEME_CLASSIC="classic";this.THEME_STANDARD="standard";this.THEME_THOTTBOT="thottbot";this.TYPE_CLASSIC="classic";this.TYPE_STANDARD="standard";var t={};t[this.THEME_STANDARD]=this.TYPE_STANDARD;t[this.THEME_CLASSIC]=this.TYPE_CLASSIC;t[this.THEME_THOTTBOT]=this.TYPE_CLASSIC;this.getTheme=function(){return WH.PageMeta.theme||e.THEME_STANDARD};this.getThemePath=function(){var t=e.getTheme();if(t===e.THEME_STANDARD){return""}return t+"/"};this.getThemes=function(){if(WH.isClassicTree()||WH.isTbcTree()){return[e.THEME_CLASSIC,e.THEME_THOTTBOT]}return[e.THEME_STANDARD]};this.getThemeType=function(){return t[e.getTheme()]};this.isClassic=function(){return e.getTheme()===e.THEME_CLASSIC};this.isClassicType=function(){return e.getThemeType()===e.TYPE_CLASSIC};this.isStandard=function(){return e.getTheme()===e.THEME_STANDARD};this.isStandardType=function(){return e.getThemeType()===e.TYPE_STANDARD};this.isThottbot=function(){return e.getTheme()===e.THEME_THOTTBOT};this.set=function(t){if(e.getThemes().indexOf(t)<0){alert(WH.TERMS.invalidOption);WH.error("Tried to set an invalid theme:",t);return}WH.User.saveOption("theme",t,(function(){window.location=window.location.href}))}};WH.Tools=new function(){const e={cta:{},includedCss:[]};this.createMountCollectionTrackerCta=function(){return e.cta.mountTracker=e.cta.mountTracker||t("mount",WH.TERMS.mountCollectionTracker,"/mount-collection-tracker")};this.createBattlePetCollectionTrackerCta=function(){return e.cta.battlePetTracker=e.cta.battlePetTracker||t("pet",WH.TERMS.battlePetCollectionTracker,"/battle-pet-collection-tracker")};this.createToyCollectionTrackerCta=function(){return e.cta.toyTracker=e.cta.toyTracker||t("toy",WH.TERMS.toyCollectionTracker,"/toy-collection-tracker")};function t(e,t,a){i("collection-tracker-cta");var n=WH.ce("div",{className:"collection-tracker-cta"});n.setAttribute("data-type",e);var s=WH.ce("div",{className:"collection-tracker-cta-name"});WH.st(s,t);WH.ae(n,s);var r=WH.ce("div",{className:"collection-tracker-cta-name-all-new"});WH.st(r,WH.TERMS.allNew_tip);WH.aef(s,r);var o=WH.createButton(WH.TERMS.collectionCta_button);WH.ae(n,o);WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-primary"}));WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-left"}));WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-center"}));WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-right"}));WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-gradient"}));WH.ae(n,WH.ce("a",{className:"collection-tracker-cta-cover",href:a}));return n}function i(t){if(e.includedCss.includes(t)){return}let i=WH.staticUrl+"/css/"+WH.Theme.getThemePath()+"tools/partials/"+t+".css";if(WH.PageMeta.scriptVersionQueryString){i+="?"+WH.PageMeta.scriptVersionQueryString}WH.ae(document.head,WH.ce("link",{rel:"stylesheet",type:"text/css",href:i}))}};WH.Tooltip.titleToTooltip=function(e){$(e).each((function(){WH.Tooltip.simple(this,'<span class="no-wrap">'+this.title+"</span>","q");this.removeAttribute("title");this.classList.add("tip")}))};WH.Track=new function(){var e={adsBlocked:3,adsUnblocked:4,loggedInUserIsPremium:2,userIsLoggedIn:1,userShouldSeeAds:5};var t=false;var i=1e4;var a=10;this.addClickEvents=function(e,t,i){if(!t||!t.actions||!t.category){if(WH.isDev()){WH.log("Tried to add analytics event without appropriate parameters.");WH.log(e);WH.log(t)}return}var a=t.category;var s=WH.gE(e,"a");for(var r=0,o;o=s[r];r++){var l="Follow link";for(var c in t.actions){if(t.actions.hasOwnProperty(c)&&t.actions[c]&&t.actions[c](o)){l=c;break}}var u=(i?i+"-":"")+n(o);$(o).click(WH.Track.interactiveEvent.bind(null,a,l,u))}};this.gaInit=function(i){if(!window.ga||!ga.create){if(!i){i=1}if(i>100){return}setTimeout(WH.Track.gaInit.bind(WH.Track,i+1),i*9);return}ga("create","UA-574613-1","wowhead.com");s(e.userShouldSeeAds,WH.WAS.showAds());s(e.userIsLoggedIn,WH.User.isLoggedIn());if(WH.User.isLoggedIn()){s(e.loggedInUserIsPremium,WH.User.isPremium())}if(WH.WAS.showAds()){var a=WH.ce("ins",{className:"AdSense",style:{display:"block",height:"1px",position:"absolute",top:"-1px"}});document.body.appendChild(a);s(e.adsBlocked,!a.clientHeight);document.body.removeChild(a)}ga("set","anonymizeIp",true);ga("send","pageview");t=true};this.interactiveEvent=function(e,t,i,a){o(e,t,i,a)};this.linkClick=function(e,i,a){if(!t){return}if(typeof i=="function"){i=i(e)}if(typeof a=="function"){a=a(e)}WH.debug("Track Click:",i,a,e.href);ga("send","event",i,"click",a,e.href,{transport:"beacon"});if(a&&a.indexOf("News - View Article")==0){ga("send","event","News","View full version",WH.News.getSubjectFromChild(e),{nonInteraction:1,transport:"beacon"})}};this.nonInteractiveEvent=function(e,t,i,a){o(e,t,i,a,true)};this.setLinkClickEvent=function(e,t,i){if(!e.href||e.href.indexOf("javascript:")===0){return}WH.aE(e,"click",WH.Track.linkClick.bind(null,e,t,i))};function n(e){var t="unknown";var i=WH.getFirstTextContent(e);if(i){t=WH.Strings.slug(i)}else if(e.title){t=WH.Strings.slug(e.title)}else if(e.id){t=WH.Strings.slug(e.id)}return t}function s(e,t){ga("set","dimension"+e,t)}function r(){var e={"database-logo":{category:"Homepage Logo",actions:{"Click image":function(e){return true}}}};for(var t in e){var i=WH.ge(t);if(i){WH.Track.addClickEvents(i,e[t])}}}function o(e,n,s,r,l,c){var u=WH.debug.bind(null,"Track Event:",e,n,s,r,l,c);if(!c){u()}if(!t){if(WH.isDev()){return}if(!c){c=0}c++;if(c*a>i){return}setTimeout(o.bind(null,e,n,s,r,l,c),a);return}if(c){u()}if(typeof l==="boolean"){ga("send","event",e,n,s,r,{nonInteraction:l?1:0})}else{ga("send","event",e,n,s,r)}}$(r)};WH.Url=new function(){const e=this;var t="wowhead.com";this.addGet=function(e,t,i){if(e instanceof Location){e=""+e}if(typeof e!=="string"){WH.error("Tried to add a get arg to a non-string!",e,t,i);return e}if(e.substr(-12)==="wowhead.com/"){e+="home"}var a=t+"\\b(=*[^&]+)?";if(e.indexOf("?"+t)>-1){e=e.replace(new RegExp("\\?"+a),"")}if(e.indexOf("&"+t)>-1){e=e.replace(new RegExp("&"+a),"")}return e+(e.indexOf("?")===-1&&e.indexOf("&")===-1?"?":"&")+t+(i?"="+i:"")};this.addMaxSizeParams=function(t,a){let n=/^https?:\/\/wow\.zamimg\.com/.test(t);n|=t.substr(0,WH.staticUrl.length)===WH.staticUrl;if(!n){return t}if(/^https?:\/\/[^\/]+\/modelviewer\//.test(t)){return t}let s=WH.PageMeta.staticResizing||{limit:600,throttle:{start:600,percent:0}};let r=i(t);let o=e.parseQueryString(t);let l=function(e){e=e.toLowerCase();for(let t in o){if(!o.hasOwnProperty(t)){continue}if(t.toLowerCase()===e){return t}}};let c=Math.max(1,Math.ceil((window.devicePixelRatio||1)*2)/2);let u=false;let d=false;["width","height"].forEach((function(e){if(!a[e]){return}let t=/^(\d+)(?:px)?$/.exec(a[e]);if(t===null){return}let i=Math.ceil(parseInt(t[1])*c);if(i>s.limit){return}if(r[e]&&i>=r[e]){return}d=d||i>s.throttle.start;let n="max"+e.substr(0,1).toUpperCase()+e.substr(1);n=l(n)||n;let f=o[n];if(f){if(/\D/.test(f)){return}f=parseInt(f)}if(f>i){return}u=true;o[n]=i}));if(!u){return t}if(d){if(parseInt(WH.MD5.hash(t).substr(-2),16)/255>s.throttle.percent/100){return t}}let f="";{let e=t.indexOf("#");if(e>=0){f=t.substr(e);t=t.substr(0,e)}}{let e=t.indexOf("?");if(e>=0){t=t.substr(0,e)}}let h=e.buildQuery(o);return t+"?"+h+f};this.buildQuery=function(e){let t=[];let i=Object.keys(e);i.sort((function(e,t){return e.localeCompare(t)}));for(let a,n=0;a=i[n];n++){if(!e.hasOwnProperty(a)){continue}if(e[a]===""){t.push(a)}else{t.push(a+"="+encodeURIComponent(e[a]).replace(/%3a/gi,":"))}}return t.join("&")};this.ensurePathSlash=function(e){if(e.substr(0,1)!=="/"){e="/"+e}return e};this.generate=function(i,a){a=a||{};let n=t;let s="https:";let r=typeof a.subdomain==="string"?a.subdomain:a.hasOwnProperty("dataEnv")||a.hasOwnProperty("locale")?e.getSubdomain(a.dataEnv,a.locale):undefined;if(a.production){if(r){n=r+"."+n}}else{n=e.getHost(r);s=location.protocol}if(n===t){n="www."+n}return s+"//"+n+e.generatePath(i,a.dataEnv||WH.getDataEnv(),a.locale||Locale.getId())};this.generatePath=function(t,i,a){let n=WH.Game.getSelectorByDataEnv(i);if(n===null){return e.ensurePathSlash(t)}let s=[n];if(a!==Locale.DEFAULT){s.push(Locale.getCode(a))}return"/"+s.join("/")+e.ensurePathSlash(t)};this.getBetaSubdomain=function(){return WH.BETA_DOMAIN||WH.dataEnvKey[WH.dataEnv.BETA]};this.getCanonical=function(){var e=WH.qs('link[rel="canonical"]');if(!e){return location.protocol+"//"+location.host+location.pathname+(location.search||"")}return e.href};this.getCanonicalPath=function(){var t=WH.qs('link[rel="canonical"]');if(!t){return location.pathname+(location.search||"")}return e.getPathFromUrl(t.href,true)};this.getDataPageUrl=function(e,t){let i=WH.getPageData("url.dataPageVersions")||{};let a={locale:Locale.getId(),dataEnv:t||WH.getDataEnv(),dv:i[e]||0,b:WH.getDataBuild()};return WH.Url.generate("/data/"+e+"?"+WH.Url.buildQuery(a),{dataEnv:a.dataEnv})};this.getHost=function(i){var a=t;var n="";if(WH.isDev()){n=location.hostname.replace("."+a,"");var s=n.lastIndexOf(".");if(s>=0){n=n.substr(s+1)}}if(n){a=n+"."+a}if(i===undefined){i=e.getSubdomain()}if(!i&&!n){i="www"}if(i){a=i+"."+a}return a};this.getLoginPath=function(e){let t="/account=signin";e=(e===undefined?location.pathname:e).replace(/^\//,"");if(e){t+="?next="+encodeURIComponent(e)}return t};this.getModifiedPageQuery=function(e){let t=location.pathname;let i=location.search;let a=location.hash;if(!i){if(t.indexOf("&")>=0){i="?"+t.substr(t.indexOf("&")+1);t=t.substr(0,t.indexOf("&"))}}let n=WH.parseQueryString(i);e(n);let s=t;if(Object.keys(n).length){s+="?"+WH.Url.buildQuery(n)}s+=a;return s};this.getPathFromUrl=function(e,t){if(t===true){return e.replace(/^(?:(?:https?:)?\/\/[^/]+)?\/?([^#]+).*$/,"/$1")}return e.replace(/^(?:(?:https?:)?\/\/[^/]+)?\/?([^?&#]+).*$/,"/$1")};this.getRegistrationPath=function(){return"/account=signup"};this.getSubdomain=function(t,i){t=t||WH.getDataEnv();var a=Locale.getDataEnvForcedLocale(t);if(a!==undefined){i=a}else if(i===undefined){i=Locale.getId()}var n=[];if(i!==LOCALE_ENUS){n.push(WH.getDomainFromLocale(i))}switch(t){case WH.dataEnv.MAIN:break;case WH.dataEnv.BETA:n.push(e.getBetaSubdomain());break;default:n.push(WH.dataEnvKey[t])}return n.join(".")};this.isRelative=function(e){return!/^(https?:)?\/\//.test(e)};this.parseQueryString=function(e){let t;if((t=e.indexOf("#"))>=0){e=e.substr(0,t)}t=e.indexOf("?");if(t<0){return{}}return WH.parseQueryString(e.substr(t+1))};this.replacePageQuery=function(t){let i=e.getModifiedPageQuery(t);if(i){history.replaceState({},"",i)}};function i(e){let t;if(t=e.match(/\/uploads\/blog\/(images|thumbs)\/(\d+)/)){let e=g_blogimages[t[2]];switch(t[1]){case"thumbs":return e?{width:e.thumbwidth,height:e.thumbheight}:{width:200,height:200};case"images":return e?{width:e.width,height:e.height}:{}}return{}}if(t=e.match(/\/uploads\/screenshots\/(normal|resized|small|thumb)\/(\d+)/)){let e=WH.Gatherer.get(WH.Types.SCREENSHOT,t[2]);let i;let a;switch(t[1]){case"normal":return e?{width:e.width,height:e.height}:{};case"resized":i=772;a=618;break;case"small":i=300;a=300;break;case"thumb":i=150;a=150;break}if(!i||!a){return{}}if(!e){return{width:i,height:a}}let n=e.width/e.height;let s=Math.min(i,e.width);let r=Math.round(s/n);if(r>a){r=a;s=Math.round(r*n)}return{width:s,height:r}}if(t=e.match(/\/uploads\/guide\/images\/(\d+)/)){let e=WH.Gatherer.get(WH.Types.GUIDE_IMAGE,t[1]);return e?{width:e.width,height:e.height}:{}}return{}}};WH.UserAgent=new function(){var e=["ahrefsbot","baiduspider","bingbot","bitdiscovery","blexbot","comscore.com/web-crawler","dotbot","duckduckbot","exabot","garlikcrawler","getintent","googlebot","ia_archiver","mail.ru_bot","mauibot","mediapartners-google","megaindex.com/crawler","mj12bot","naver.me/spd","petalbot","piplbot","protopage","rogerbot","semrushbot","sogou.com/docs/","viglink","weborama","yahoo! slurp","yandexbot","yandexmobilebot"];this.isWebCrawler=function(){var t=navigator.userAgent;if(!t){return false}t=t.toLowerCase();for(var i=0,a=e.length;i<a;i++){if(t.indexOf(e[i])!==-1){return true}}return false}};var vi_thumbnails={1:"//i3.ytimg.com/vi/$1/default.jpg"};var vi_siteurls={1:"https://www.youtube.com/watch?v=$1",2:"https://www.wowhead.com/video-stream/$1"};var vi_sitevalidation=[/https?:\/\/(?:www\.)?youtube\.com\/watch\?v=([^& ]{11})/i,/https?:\/\/(?:www\.)?youtu\.be\/([^& ]{11})/i];function vi_submitAVideo(){tabsContribute.focus(2)}function vi_validateForm(e){if(!e.elements["videourl"].value.length){alert(WH.TERMS.errorvideo_tip);return false}var t=false;for(var i in vi_sitevalidation){if(!vi_sitevalidation.hasOwnProperty(i)){continue}if(e.elements["videourl"].value.match(vi_sitevalidation[i])){t=true;break}}if(!t){alert(WH.TERMS.errorvideo_tip);return false}return true}function vi_appendSticky(){var e=WH.ge("infobox-sticky-vi");if(!e)return;var t=g_pageInfo.type;var i=g_pageInfo.typeId;var a=WH.inArray(lv_videos,1,(function(e){return e.sticky}));if(a!=-1){e.className="has-thumb";var n=lv_videos[a];var s=WH.ce("a");s.href="#videos:id="+n.id;s.onclick=function(e){VideoViewer.show({videos:lv_videos,pos:a});return WH.rfWithoutControlKey(e)};var r=WH.ce("img");r.src=WH.sprintf(vi_thumbnails[n.videoType].replace(/\/default\.jpg/,"/mqdefault.jpg"),n.videoId);r.className="border";WH.ae(s,r);WH.ae(e,s);var o=$("#infobox-videos");if(!o)o=$("th",$(e).parents().prev("tr"));o.append(" ("+lv_videos.length+")").wrapInner($('<a href="#videos"></a>').click((function(){tabsRelated.focus(tabsRelated.getTabById("videos"));return false})))}else if(g_user){var s;if(g_user.id>0)s='<a href="javascript:" onclick="vi_submitAVideo(); return false">';else s='<a href="/account=signin">';e.innerHTML=WH.sprintf(WH.TERMS.noneyet_format,s+WH.TERMS.suggestone_stc+"</a>")}else{$("#infobox-videos,#infobox-sticky-vi").closest("td, th").css("display","none")}vi_appendSticky=function(){}}var g_videos=[];window.VideoViewer=new function(){const e=170-Lightbox.BLEED_SIZE;const t=20;const i=50;var a,n,s,r,o,l,c=0,u,d,f,h,p,m,g,H,W,v;function _(e){var t=a[e],i="#videos:";if(c==0)i+="id="+t.id;else i+=u+":"+(e+1);return i}function T(e){R();if(e&&o==1&&WH.getWindowSize().h>d.offsetHeight)return;d.style.visibility="hidden";var t=a[n];if(!e){var i=t.caption!=null&&t.caption.length;WH.Track.interactiveEvent("Videos","Show",t.id+(i?" ("+t.caption+")":""));H.href=WH.sprintf(vi_siteurls[t.videoType],t.videoId);switch(t.videoType){case 1:$(h).empty().append(WH.markup.getDomFragment("[youtube="+t.videoId+" width="+s+" height="+r+"]"));break;case 2:WH.ee(h);WH.ae(h,WH.ce("video",{controls:true,width:s,height:r},WH.ce("source",{src:WH.Url.generate("/video-stream/"+t.id+"-"+t.videoId,{dataEnv:WH.dataEnv.MAIN,locale:LOCALE_ENUS})})));H.href=WH.sprintf(vi_siteurls[t.videoType],t.id+"-"+t.videoId);break}if(!t.user&&typeof g_pageInfo=="object")t.user=g_pageInfo.username;var l=t.date&&t.user,c=a.length>1;if(l){var u=new Date(t.date),f=(WH.getServerTime()-u)/1e3;var T=W.firstChild.childNodes[1];T.href="/user="+t.user;T.innerHTML=t.user;var E=W.firstChild.childNodes[3];WH.ee(E);WH.formatDate(E,f,u);W.firstChild.style.display=""}else W.firstChild.style.display="none";var E=W.childNodes[1];WH.ee(E);E=W.childNodes[2];if(c){var y="";if(t.user)y=WH.TERMS.dash_punct;y+=n+1+WH.TERMS.of_lc+a.length;E.innerHTML=y;E.style.display=""}else E.style.display="none";W.style.display=l||c?"":"none";var S=t.subject!=null&&t.subject.length&&t.type&&t.typeId;if(i||S){var w="";if(S){var I=WH.ce("div");WH.ae(I,WH.ct(WH.Types.getUpperSingular(t.type)+WH.TERMS.colon_punct));WH.ae(I,WH.ce("a",{href:WH.Entity.getPath(t.type,t.typeId)},WH.ct(t.subject)));w+=I.innerHTML}var N=document.createDocumentFragment();if(i){if(S){w+=WH.TERMS.dash_punct}N=t.noMarkup?document.createTextNode(t.caption):WH.markup.getDomFragment(t.caption,{mode:WH.markup.MODE.SIGNATURE})}$(v).html(w).append(N);v.style.display=""}else v.style.display="none";if(a.length>1){p.href=_(b(-1));m.href=_(b(1));p.style.display=m.style.display="";g.style.display="none"}else{p.style.display=m.style.display="none";g.style.display=""}location.replace(_(n))}else $("object, embed",h).each((function(){this.width=s;this.height=r}));Lightbox.reveal();d.style.visibility="visible"}function b(e){var t=n;t+=e;if(t<0)t=a.length-1;else if(t>=a.length)t=0;return t}function E(){n=b(-1);T();return false}function y(){n=b(1);T();return false}function S(e){switch(e.keyCode){case 37:E();break;case 39:y();break}}function w(){T(1)}function I(){WH.ee(h);if(a.length>1)WH.dE(document,"keyup",S);if(l&&c==0){if(l.indexOf(":id=")!=-1)l="#videos";WH.setHash(l)}else WH.clearHash()}function N(e,t,i){if(typeof i.videos=="string"){a=g_videos[i.videos];c=1;u=i.videos}else{a=i.videos;c=0;u=null}d=e;n=0;if(i.pos&&i.pos>=0&&i.pos<a.length)n=i.pos;if(t){e.className+=" has-lightbox-caption screenshotviewer";f=WH.ce("div");f.className="lightbox-content screenshotviewer-screen";var s=WH.ce("div");var r=WH.ce("div");s.className="screenshotviewer-page-wrapper screenshotviewer-prev-wrapper";r.className="screenshotviewer-page-wrapper screenshotviewer-next-wrapper";p=WH.ce("a");m=WH.ce("a");p.className="screenshotviewer-prev";m.className="screenshotviewer-next";p.href="javascript:";m.href="javascript:";var o=WH.ce("span");o.className="fa fa-chevron-left";WH.ae(p,o);o=WH.ce("span");o.className="fa fa-chevron-right";WH.ae(m,o);p.onclick=E;m.onclick=y;g=WH.ce("a");g.className="screenshotviewer-cover";g.href="javascript:";g.onclick=Lightbox.hide;var _=WH.ce("span");var b=WH.ce("b");WH.ae(b,WH.ct(WH.TERMS.close));WH.ae(_,b);WH.ae(g,_);WH.ae(s,p);WH.ae(r,m);WH.ae(f,s);WH.ae(f,r);WH.ae(f,g);h=WH.ce("div",{className:"screenshotviewer-image"});WH.ae(f,h);WH.ae(e,f);var w=WH.ce("a");w.className="dialog-option fa fa-times";w.href="javascript:";w.onclick=Lightbox.hide;WH.ae(w,WH.ct(WH.TERMS.close));WH.ae(e,w);H=WH.ce("a");H.className="dialog-option fa fa-external-link";H.href="javascript:";H.target="_blank";WH.ae(H,WH.ct(WH.TERMS.original));WH.ae(e,H);var I=WH.ce("div",{className:"lightbox-caption"});W=WH.ce("div");W.className="screenshotviewer-from";var N=WH.ce("span");WH.ae(N,WH.ct(WH.TERMS.from));WH.ae(N,WH.ce("a"));WH.ae(N,WH.ct(" "));WH.ae(N,WH.ce("span"));WH.ae(W,N);WH.ae(W,WH.ce("span"));WH.ae(W,WH.ce("span"));WH.ae(I,W);v=WH.ce("div");v.className="screenshotviewer-caption";WH.ae(I,v);WH.ae(e,I)}l=location.hash;if(a.length>1)WH.aE(document,"keyup",S);T()}function R(){let a=Platform.getViewportSize();s=Math.floor(a.width-Lightbox.BLEED_SIZE-e-t);r=Math.floor(s*(9/16));let n=r+Lightbox.BLEED_SIZE+i;if(n>a.height){r=Math.floor(a.height-Lightbox.BLEED_SIZE-i);s=Math.floor(r*(16/9))}Lightbox.setSize(s+t)}this.checkPound=function(){if(location.hash&&location.hash.indexOf("#videos")==0){if(!g_listviews["videos"]){var e=location.hash.split(":");if(e.length==3){var t=g_videos[e[1]],i=parseInt(e[2]);if(t&&i>=1&&i<=t.length){VideoViewer.show({videos:e[1],pos:i-1})}}}}};this.show=function(e){Lightbox.show("videoviewer",{onShow:N,onHide:I,onResize:w},e);return false};$(document).ready(this.checkPound)};WH.WarcraftLogs=new function(){const e=WH.Gatherer;const t=WH.Types;this.displayTopSpells=function(e,t,i,a,n){var s=WH.ce("div",{className:i});WH.ae(s,WH.getImitationHeading(t,6));var r=WH.ce("table");var o=WH.ce("tr",{className:i+"-popularity"});var l=WH.ce("tr",{className:i+"-icon"});WH.ae(r,o);WH.ae(r,l);var c=0;if(a){for(var u=0,d;d=a[u];u++){var f=WH.Gatherer.get(WH.Types.SPELL,d.id);if(!f){continue}var h=WH.Wow.Spell.getPath(d.id,f.name);var p=WH.Icon.create(f.icon,WH.Icon.SMALL,h,{span:true});var m=Icon.getLink(p);m.setAttribute("data-whattach","true");if(n){m.target="_blank"}var g=WH.ce("td");WH.ae(g,p);WH.ae(o,WH.ce("td",{innerHTML:Math.round(d.pop)+"%"}));WH.ae(l,g);c++}}var H=0;if(!c){WH.de(l);var W=WH.ce("td",{innerHTML:WH.TERMS.notenoughdata});WH.ae(o,W);H++}WH.ae(s,r);if(e instanceof jQuery){e.append(s)}else{WH.ae(e,s)}return H};this.getCovenantTooltip=function(i){let a=WH.ce("div");WH.ae(a,WH.ce("b",{className:"q1"},WH.ct(e.getName(t.COVENANT,i.id))));let n=WH.ce("table",{style:{marginTop:"10px"}});WH.ae(a,n);i.soulbinds.forEach((function(i){let a=WH.ce("td",{className:"q",style:{paddingRight:"3px",textAlign:"right"}},WH.ct(WH.Strings.formatNumber(i.pop/100,true,0,1)));let s=i.id?e.getName(t.SOULBIND,i.id):null;if(!s){if(i.pop<.5){return}s=WH.TERMS.unknown+" / "+WH.TERMS.none}let r=WH.ce("td",{className:"q",style:{whiteSpace:"nowrap"}},WH.ct(s));let o=WH.ce("tr");WH.ae(o,a);WH.ae(o,r);WH.ae(n,o)}));return a.innerHTML}};WH.WAS=new function(){const e=this;const t=WH.DOM;const i=WH.Layout;const a=WH.Time;this.ANIMATION_DURATION_MS=333;var n=1e3*60*10;var s="Other";var r="Other";var o=100;const l=["https://securepubads.g.doubleclick.net/tag/js/gpt.js","https://cdn.dotaoutpost.com/stable/js/wowhead.js?type=ab","https://www.googletagmanager.com/gtm.js?id=GTM-KN7HXDF","https://zaf.services.zam.com/stable/js/wowhead.js"];var c="skinned";const u=Math.floor(Date.now()/1e3)%10===0;const d="horizontal";const f="horizontalBTF";const h="mobileFooter";const p="mobileMedrec";const m="skin";const g="vertical";const H={};H[d]="horizontal-block-bg is-atf";H[f]="horizontal-block-bg is-btf";H[g]="vertical-block-bg is-atf";H[m]="skin-block-bg";H[h]="mobile-fixed-footer-block-bg";H[p]="block-block-bg is-btf";const W={channelGroup:"",channelName:"",elements:{headerWrapper:undefined},headerWrapperHeight:undefined,postSkinSetupCallbacks:[],rejected:{},removeVideoCallbackRegistered:false,removed:false,skin:null};this.init=function(t,i,a){if(!e.showAds()){return}M();x(i);P(t);if(a instanceof Array){I(t,i,a)}};this.addMobileMedrec=function(e){if(Platform.getViewportWidth()>=768){return}if(WH.ge("ad-"+p)){return}let t=WH.qs(e);if(!(t instanceof Node)){WH.error("Failed to find mobile medrec target.",e);return}WH.ae(t,WH.ce("div",{className:"block-block-bg"},WH.ce("div",{id:"ad-"+p})));this.display(p)};this.addPostSkinSetupCallback=function(e){if(typeof e=="function"){W.postSkinSetupCallbacks.push(e)}};this.addVideoCloser=function(){let e=WH.ge("video-pos-inner");let t=WH.ge("video-pos-fixed");if(!e){if(!t){if(document.readyState!=="complete"){WH.onLoad(WH.WAS.addVideoCloser)}else if(WH.isDev()){WH.warn("Could not find the video container.")}return}WH.onMutate(t,WH.WAS.addVideoCloser,{triggerOnce:true});return}if(!WH.qs(".cnx-main-container",e)){let t=WH.qs(".ac-player-playlist");if(!WH.qs(".ac-player-ph")||t&&t.style.display!=="none"){WH.onMutate(e,WH.WAS.addVideoCloser,{triggerOnce:true});return}}let i=WH.ce("a",{className:"video-pos-closer-x"});WH.aE(i,"click",WH.Responsive.removeFixedPosition);WH.ae(e,WH.ce("div",{className:"video-pos-closer"},i));if(t){WH.ae(document.body,t)}};this.display=function(e){zamaf.cmd.push((function(){zamaf.displaySync("ad-"+e)}))};this.displaySkin=function(e){if(window.innerWidth<1250||F()){B("Skin rejected by Wowhead",window.innerWidth<1250?"Not enough space":"Suppressing ads for Blizzard");WH.WAS.removeSkin();return false}if(W.skin!==null){WH.WAS.removeSkin(true)}W.skin=e;document.body.classList.add(c);if(e.sidesOnly){document.body.classList.add(c+"-sides-only")}else{document.body.classList.add(c+"-H");if(e.usePageLeaderboard){document.body.classList.add(c+"-use-page-leaderboard")}document.body.classList.add(c+"-height-"+T(e))}WH.WAS.updateSkinPosition(true);WH.aE(window,"scroll",WH.WAS.updateSkinPosition);k(e);WH.Track.nonInteractiveEvent("Skin","Skin Displayed",e.creative,e.lineItem);return true};this.fillDynamicUnits=function(){if(!WH.WAS.showAds()){return}zamaf.cmd.push((function(){zamaf.displayAllDynamic()}))};this.getChannelGroup=function(){return W.channelGroup||s};this.getChannelName=function(){return W.channelName||r};this.getDfpLog=function(){var e=WH.LocalStorage.get("dfpLog");if(e){try{e=JSON.parse(e)}catch(e){}}if(!(e instanceof Array)){return[]}return e};this.hideAll=function(){var e=y();e.attr("data-hidden-by-was","true")};this.initVideo=function(){if(!e.showAds()){e.removeVideo(false);return}e.addVideoCloser();WH.Responsive.test()};this.intersect=function(e,t){var i;var a;var n=y();for(var s=0,r=n.length;s<r;++s){var o=n[s];if(o){if(!N(o)){i=WH.ac(o);a=WH.createRect(i.x,i.y,o.offsetWidth,o.offsetHeight);if(WH.intersectRect(e,a)){if(t){S(o)}return o}}}}return false};this.isSkinned=function(){return W.skin!==null||document.body.classList.contains("skinned")};this.remove=function(e,t){D("ad-"+e,t)};this.removeAll=function(t){W.removed=true;t=t!==false;e.removeVideo(t);D("ad-"+g,t);D("ad-"+d,t);D("ad-"+f,t);D("ad-"+h,t);D("ad-"+p,t);let i=WH.qsa(".dynamic-ad");if(i.length){if(t){$(i).slideUp({complete:function(){i.forEach(WH.de)},duration:e.ANIMATION_DURATION_MS})}else{i.forEach(WH.de)}}setTimeout((function(){WH.qsa("[data-contains-block]").forEach((function(e){delete e.dataset.containsBlock}));WH.qsa("[data-left-contains-block]").forEach((function(e){delete e.dataset.leftContainsBlock}))}),t?e.ANIMATION_DURATION_MS+1:1);WH.WAS.removeSkin()};this.removeSkin=function(e){if(e!==true){$("#ad-skin, .skin--link").remove();document.body.classList.remove("body--skin","body--prelude");document.body.style.background=""}Array.prototype.slice.call(document.body.classList).forEach((function(e){if(e.indexOf(c)===0){document.body.classList.remove(e)}}));if(W.skin&&!W.skin.sidesOnly&&!W.skin.usePageLeaderboard){var t=WH.qs(".sidebar-wrapper");if(t){t.style.top="10px"}}$("#video-pos-static").appendTo(".main > .blocks");W.skin=null;WH.Layout.Responsive.updateHeaderOffset()};this.removeVideo=function(i){if(document.readyState==="loading"&&!W.removeVideoCallbackRegistered){W.removeVideoCallbackRegistered=true;WH.onLoad(e.removeVideo.bind(this,i))}WH.qsa("#video-pos-body, #video-pos-fixed, #video-pos-page, #video-pos-static").forEach(WH.de);WH.qsa('[data-has-video-unit="true"]').forEach((function(e){e.dataset.hasVideoUnit="false"}));let a=WH.qs("#main > .blocks");if(a&&t.isEmpty(a)){O(d,a,i!==false)}};this.restoreHidden=function(){$('[data-hidden-by-was="true"]').attr("data-hidden-by-was","false")};this.showAds=function(){return g_user.ads&&!W.removed};this.updateSkinPosition=function(t){if(!W.elements.headerWrapper){W.elements.headerWrapper=WH.qs(".header-wrapper");if(!W.elements.headerWrapper){if(document.readyState==="complete"){e.updateSkinPosition=function(){}}return}}var i=W.elements.headerWrapper.getBoundingClientRect().height;var a=e.isSkinned()?i:undefined;if(W.headerWrapperHeight!==a||t===true){document.body.style.backgroundPosition=a?"center "+a+"px":null;W.headerWrapperHeight=a}if(WH.Theme.isClassicType()){var n=WH.Layout.getElement("page-content");if(n){var s=W.skin!==null?T(W.skin):e.isSkinned()?250:null;n.style.marginTop=s?i+s+10+"px":null}}};this.validateUnit=function(t){if(!e.showAds()||W.rejected[t]){delete W.rejected[t];D(t)}};function v(e,t,i){var a=i?"block-premium-info":"block-remove";if([m,h].indexOf(e)>-1||$("."+a,t).length){return}var n=WH.ce("a",{innerHTML:i?"<b>"+WH.TERMS.wowheadpremium+"</b><br>"+WH.TERMS.premiumupgradeshort_tip:WH.TERMS.removeallads,href:"/premium",className:a});WH.ae(t,n)}function _(e,t,i){var a=WH.WAS.getChannelName().match(/\bTest\b/)||WH.isDev()||WH.User.hasRole(U_GROUP_ADMIN);var n=[0,0];var s=WH.ge(t);if(s.dataset.unitWidth&&s.dataset.unitHeight){n=[parseInt(s.dataset.unitWidth),parseInt(s.dataset.unitHeight)]}if(!R(n,i)){var r=WH.qs("iframe",t);if(r){n=[parseInt(r.getAttribute("width")),parseInt(r.getAttribute("height"))];if(a){WH.warn("IFRAME UNIT SIZES:",n[0],n[1],"FROM THIS IFRAME:",r)}}}return n}function T(e){return e.sidesOnly?null:W.skin.splitHeight||90}function b(e){if(e.id&&e.id.indexOf("skin")!==-1){return e}if(e.getAttribute("data-was-unit")==="true"){return e.parentNode}if(e.getAttribute("data-was-parent")==="true"){return e}if(e.parentNode.getAttribute("data-was-unit")==="true"){return e.parentNode.parentNode}if(e.parentNode.getAttribute("data-was-parent")==="true"){return e.parentNode}if(e.className){var t=E();var i=false;if(t.indexOf(e.className)>-1){i=true}if(!i){for(var a=0,n;n=t[a];a++){if(e.className.indexOf(n)>-1){i=true;break}}}if(!i){return e.parentNode}}else{return e.parentNode}return e}function E(){var e=[];for(var t in H){if(e.indexOf(H[t])===-1){e.push(H[t])}}E=function(e){return e}.bind(null,e);return e}function y(){return $("."+E().join(", ."))}function S(e){var t=b(e);t.setAttribute("data-hidden-by-was","true")}function w(){if(!e.showAds()){return}if(document.monetization){B("Coil monetization detected");WH.ae(document.head,WH.ce("meta",{content:"$ilp.uphold.com/bq2m3aJwgwxZ",name:"monetization"}));let e=parseInt(WH.LocalStorage.get("cmStarted"));let t=!!(!isNaN(e)&&e+a.MS_DAY>=(new Date).getTime());try{document.monetization.addEventListener("monetizationstart",(function(){WH.LocalStorage.set("cmStarted",(new Date).getTime());B("Coil monetization validated");if(!t){i.expandSite(false)}}))}catch(e){}if(t){i.expandSite(false);return}}window.zamaf=window.zamaf||{};zamaf.cmd=zamaf.cmd||[];var t=WH.isBlizzardReferral();if(t){var s=Date.now?Date.now():(new Date).getTime();WH.LocalStorage.set("blizz-skin-suppression",s+n);if(t==="brl"){var r=(""+location.href).replace(/[\?&]brl=[^\?&#]*/,"").replace(/[\?&]brl\b/,"").replace(/^(https?:\/\/[^\/]+\/)home$/,"$1");if(window.history&&window.history.replaceState){window.history.replaceState({},"",r)}else{location.replace(r)}}}}function I(e,t,i){zamaf.setTargeting=function(){googletag.pubads().setTargeting("Channel",e);googletag.pubads().setTargeting("ChannelGroup",t)};zamaf.slotRenderCallback=q.bind(this);zamaf.skinRenderCallback=WH.WAS.displaySkin.bind(this);zamaf.cmd.push({event:"zaf:slot:rejected",handler:C})}function N(e,t){var i=b(e);if(i){if(t){return i.style.visibility=="hidden"}else{return i.getAttribute("data-hidden-by-was")=="true"}}return false}function R(e,t){if([m,h].indexOf(t)>=0){return true}return e&&e[0]&&e[1]&&e[0]!==1&&e[1]!==1}function M(){window.googletag=window.googletag||{};googletag.cmd=googletag.cmd||[];window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:"gtm.js","gtm.start":(new Date).getTime()});for(let e=0,t;t=l[e];e++){WH.ae(document.head,WH.ce("script",{async:true,src:t}))}}function A(e,t,i){var a={_time:(new Date).toUTCString(),_slot:t,_channelName:WH.WAS.getChannelName(),_channelGroup:WH.WAS.getChannelGroup()};if(i){a._error=i}for(var n in e){if(e.hasOwnProperty(n)&&(typeof e[n]!=="object"||!e[n]||n==="size")){a[n]=e[n]}}var s=WH.WAS.getDfpLog().slice(0,o-1);s.unshift(a);WH.LocalStorage.set("dfpLog",JSON.stringify(s))}function k(e){if(!e.sidesOnly){$("#video-pos-static").prependTo(".page-content")}if(!e.usePageLeaderboard&&!e.sidesOnly){D("ad-"+d);WH.de("#main > .blocks")}WH.Layout.updateContentHeight();for(var t=0,i;i=W.postSkinSetupCallbacks[t];t++){i(e)}if((WH.Page.Guide||{}).collapseInteriorSidebar){WH.Page.Guide.collapseInteriorSidebar()}$(".element-highlight:not(#highlight-highlight-classic)").remove()}function C(e,t){if(e&&typeof e.elementId==="string"){B("Unit rejected by ZAF",e.elementId);WH.debug(e.elementId+" unit rejected by ZAF.",e);D(e.elementId)}else{WH.debug("Unknown unit rejected by ZAF.",e)}}function L(i,a,n){if(!i){return}let s=i.parentNode;if(!s){return}WH.de(i);switch(a){case d:case f:let r=WH.closest(s,".block-pair");let o=WH.closest(r,".blocks");WH.de(r);O(a,o,n);break;case p:let l=function(){WH.de(i);if(t.isEmpty(s)){WH.de(s)}};if(n){$(i).slideUp({complete:l,duration:e.ANIMATION_DURATION_MS})}else{l()}break;case g:WH.de(".sidebar-wrapper");document.body.dataset.sidebar="false";WH.Layout.updateContentHeight();break}if(zamaf._getGlobals){let e=zamaf._getGlobals().globalSlots["ad-"+a];if(e){zamaf.destroySlot(e.elementId,e.slot)}}}function O(i,a,n){if(a){let i=function(){if(t.isEmpty(a)){WH.de(a)}};if(n){a.style.height="250px";a.style.minHeight="0";$(a).slideUp({complete:i,duration:e.ANIMATION_DURATION_MS})}else{i()}}if(i===d){document.body.classList.add("no-horizontal");let t=WH.qs(".sidebar");if(t){if(n){$(t).animate({top:"0px"},e.ANIMATION_DURATION_MS,false)}else{t.style.top="0px"}}}}function D(e,t){WH.debug("Removing "+e+" unit.");if(typeof e!=="string"){return}var i=WH.ge(e);if(!i){W.rejected[e]=true;return}if(e.indexOf("video-pos-")===0){WH.WAS.removeVideo(false)}else{L(b(i)||i,e.replace(/^ad-/,""),t===true)}}function x(e){W.channelGroup=e}function P(e){W.channelName=e}function U(e,t,i,a){var n=b(t);if(!n){B("Impression shown but slot callback failed",e);return}i=parseInt(i);a=parseInt(a);n.className=n.className.replace(/ *\bis-[0-9]+x[0-9]+\b/g,"");n.className+=" is-"+i+"x"+a;v(e,n);v(e,n,true);if(e===h){if(!n.querySelector(".mobile-footer-closer")){var s=WH.ce("a",{className:"mobile-footer-closer"});s.onclick=function(){WH.de(this.parentNode)};n.appendChild(s)}}var r=i+"x"+a;if(i===728||i===970){var o=n.parentNode.parentNode;o.setAttribute("data-contains-block",r);if(o.parentNode&&o.parentNode.parentNode&&o.parentNode.parentNode.parentNode&&o.parentNode.parentNode.parentNode.setAttribute){o.parentNode.parentNode.parentNode.setAttribute("data-contains-block",r)}}else if(typeof e==="string"&&e.match(/^vertical/)){let e=WH.closest(t,".sidebar");if(e){e.dataset.containsSidebarBlock=r}let i=WH.qs(".layout-wrapper");if(i){i.dataset.containsSidebarBlock=r}WH.Layout.updateContentHeight()}}function q(e){var t=e.slot.getSlotElementId();var i=t.replace("ad-","");if(i===m){let e=WH.ge("ad-skin");if(e){WH.onMutate(e,WH.Layout.Responsive.check.bind(null,true),{attributes:true})}WH.Layout.Responsive.check(true);return}var a=WH.ge(t);if(a&&a.className.indexOf("zamaf-au")>-1){return}if(!a){var n='Div for DFP unit "'+i+'" not found!';WH.debug(n);A(e,i,n);return}if(e.isEmpty){WH.info("No slot rendered in DFP event!",e);A(e,null,"No slot rendered in DFP event.");return}A(e,i);var s=_(e,a,i);U(i,a,s[0],s[1]);if(WH.qs(".block-report",a.parentNode)){return}var r=WH.ce("a",{text:WH.TERMS.reportad,className:"block-report",onclick:function(e,t){WH.Layout.expandSite();ContactTool.show();$('select[name="reason"]').val(9);setTimeout((function(){$('input[name="email"]').focus()}),1)}.bind(null,a,i)});WH.ae(a.parentNode,r)}function F(){var e=WH.isBlizzardReferral();var t=WH.LocalStorage.get("blizz-skin-suppression");if(t){t=parseInt(t);var i=Date.now?Date.now():(new Date).getTime();if(!isNaN(t)&&t>i&&t<i+n+1e3*20){e=true}else{WH.LocalStorage.remove("blizz-skin-suppression")}}F=function(e){return e}.bind(null,e);return e}function B(e,t,i){if(u){WH.Track.nonInteractiveEvent("Ads",e,t,i)}}w()};var WAS={displaySkin:WH.WAS.displaySkin};WH.WebP=new function(){const e=this;var t=10;var i={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};this.feature=Object.freeze({lossy:"lossy",lossless:"lossless",alpha:"alpha",animation:"animation"});const a={bodyFrameWaitCount:0,supports:{lossy:undefined,lossless:undefined,alpha:undefined,animation:undefined}};this.getImageExtension=function(){return a.supports.alpha?".webp":".png"};this.supportsFeature=function(e,t){if(typeof a.supports[e]==="boolean"){requestAnimationFrame((function(){t(e,a.supports[e])}));return}var n=new Image;n.onload=function(){var i=n.width>0&&n.height>0;a.supports[e]=i;t(e,i)};n.onerror=function(){a.supports[e]=false;t(e,false)};n.src="data:image/webp;base64,"+i[e]};function n(){e.supportsFeature(e.feature.alpha,(function(e,t){s(t)}))}function s(e){if(!document.body){if(a.bodyFrameWaitCount>t){window.addEventListener("DOMContentLoaded",s.bind(this,e));return}a.bodyFrameWaitCount++;requestAnimationFrame(s.bind(this,e));return}document.body.classList.add(e?"webp":"no-webp")}n()};WH.Weights=new function(){this.allowWeights=function(){return!WH.isRetailTree()};this.getCategoryNames=function(){return WH.getPageData("items.weightPresets.categoryNames")||{}};this.getPresets=function(){return WH.getPageData("items.weightPresets")||{}}};function wt_getScaleFacetOptions(e,t){var i=[];if(e){if(e.weights){for(var a in e.weights){if(e.weights.hasOwnProperty(a)){i.push([a,e.weights[a]])}}}else{for(var a=0,n;n=items_filterConfig.filters[a];a++){if(n.stat&&WH.Wow.Item.Stat.jsonToName(n.stat)&&e[n.stat]){i.push([n.id,e[n.stat]])}}}}i.sort((function(e,t){return-WH.stringCompare(e[1],t[1])}));var s=[],r=[];for(var o=0,l;l=i[o];o++){s.push(l[0]);r.push(l[1])}if(s.length&&r.length){var c={weights:s.join(":"),"weight-values":r.join(":")};if(t){c["gem-quality"]=3}return c}return{}}function wt_getScaleFilter(e,t){if(!WH.Weights.allowWeights()){return""}var i=wt_getScaleFacetOptions(e,t);if(i.weights&&i["weight-values"]){var a=";";if(t){a="&"}else if(typeof i["gem-quality"]!="undefined"){a+="gm="+i["gem-quality"]+";"}a+="weights="+i.weights+(t?"&":";")+"weight-values="+i["weight-values"];return a}return""}function wt_getScaleUrlSegment(e,t){var i=wt_getScaleFacetOptions(e,t);if(i.weights&&i["weight-values"]){var a="";if(!t&&typeof i["gem-quality"]!="undefined"){a+="/gem-quality:"+i["gem-quality"]}a+="/weights:"+i.weights+"/weight-values:"+i["weight-values"];return a}return""}function wt_showClassPresetMenu(e,t,i,a,n,s){if(!(t&&a&&n)){return}var r=[[,WH.TERMS.chooseclassspec]];var o="/items";for(var l=0,c;c=items_filterConfig.categories[l];l++){if(c.id==a){o+="/"+c.url;break}}if(a==4&&n){o+="/slot:"+n}var u="";var d="/live-only:on/group-by:"+(a==2?"slot":"source")+"?filter=161;1;0";if(a==2){if(Locale.getName()=="enus"){if(g_item_slots[n]){d+="#"+WH.Strings.slug(g_item_slots[n])}}else{d+="#slot-"+n}}if(g_user.weightscales&&g_user.weightscales.length){var f=[0,WH.TERMS.custom,undefined,[]];r.push(f);for(var h=0,p;p=g_user.weightscales[h];h++){u=wt_getScaleUrlSegment(p)+"/upgrade-for:"+t;if(i&&i.length){u+="/upgrade-bonuses:"+i.join(":")}f[3].push([p.id,p.name,o+u+d])}}var m=WH.isSet("g_items")&&g_items[t]?g_items[t].specs:null;let g=WH.Weights.getPresets();let H=WH.Weights.getCategoryNames();for(var W in g){if(!g.hasOwnProperty(W)){continue}var v=[W,WH.Wow.PlayerClass.getName(W),undefined,[],{className:"c"+W,tinyIcon:"class_"+g_file_classes[W]}];if(m!=null&&m.length>0&&g_chr_specs_by_class[W]){var _=g_chr_specs_by_class[W];var T=false;for(var b in _){if(_.hasOwnProperty(b)&&WH.inArray(m,_[b])!=-1){T=true;break}}if(!T){continue}}r.push(v);var E=0;var y=0;for(let e in g[W]){if(!g[W].hasOwnProperty(e)){continue}v[Menu.ITEM_SUBMENU].push([undefined,H[e]||WH.term("itemlevel_format",e)]);y++;for(let a in g[W][e]){if(!g[W][e].hasOwnProperty(a)){continue}T=m==null||m.length==0;if(!T){for(let e in m){if(m.hasOwnProperty(e)&&a===m[e]){T=true;break}}}if(T){u="/class:"+W+wt_getScaleUrlSegment(g[W][e][a])+"/upgrade-for:"+t;if(i&&i.length){u+="/upgrade-bonuses:"+i.join(":")}v[Menu.ITEM_SUBMENU].push([E,g[W][e][a].meta.label,o+u+d,,{tinyIcon:g[W][e][a].meta.__icon}]);E++}}}if(y===1){v[Menu.ITEM_SUBMENU].shift()}}Menu.sort(r);Menu.show(r,e)}WH.Wow=new function(){const e=this;this.GENDER_FEMALE=1;this.GENDER_MALE=0;this.INVENTORY_SLOT_AMMO=0;this.INVENTORY_SLOT_HEAD=1;this.INVENTORY_SLOT_NECK=2;this.INVENTORY_SLOT_SHOULDERS=3;this.INVENTORY_SLOT_SHIRT=4;this.INVENTORY_SLOT_CHEST=5;this.INVENTORY_SLOT_WAIST=6;this.INVENTORY_SLOT_LEGS=7;this.INVENTORY_SLOT_FEET=8;this.INVENTORY_SLOT_WRISTS=9;this.INVENTORY_SLOT_HANDS=10;this.INVENTORY_SLOT_FINGER_1=11;this.INVENTORY_SLOT_FINGER_2=12;this.INVENTORY_SLOT_TRINKET_1=13;this.INVENTORY_SLOT_TRINKET_2=14;this.INVENTORY_SLOT_BACK=15;this.INVENTORY_SLOT_MAIN_HAND=16;this.INVENTORY_SLOT_OFF_HAND=17;this.INVENTORY_SLOT_RANGED=18;this.INVENTORY_SLOT_TABARD=19;this.INVENTORY_SLOTS_WITH_MODELS=[this.INVENTORY_SLOT_HEAD,this.INVENTORY_SLOT_SHOULDERS,this.INVENTORY_SLOT_SHIRT,this.INVENTORY_SLOT_CHEST,this.INVENTORY_SLOT_WAIST,this.INVENTORY_SLOT_LEGS,this.INVENTORY_SLOT_FEET,this.INVENTORY_SLOT_WRISTS,this.INVENTORY_SLOT_HANDS,this.INVENTORY_SLOT_BACK,this.INVENTORY_SLOT_MAIN_HAND,this.INVENTORY_SLOT_OFF_HAND,this.INVENTORY_SLOT_TABARD];if(WH.isClassicTree()||WH.isTbcTree()){this.INVENTORY_SLOTS_WITH_MODELS.push(this.INVENTORY_SLOT_RANGED)}this.PAPERDOLL_SLOT_ORDER=[this.INVENTORY_SLOT_HEAD,this.INVENTORY_SLOT_NECK,this.INVENTORY_SLOT_SHOULDERS,this.INVENTORY_SLOT_BACK,this.INVENTORY_SLOT_CHEST,this.INVENTORY_SLOT_SHIRT,this.INVENTORY_SLOT_TABARD,this.INVENTORY_SLOT_WRISTS,this.INVENTORY_SLOT_HANDS,this.INVENTORY_SLOT_WAIST,this.INVENTORY_SLOT_LEGS,this.INVENTORY_SLOT_FEET,this.INVENTORY_SLOT_FINGER_1,this.INVENTORY_SLOT_FINGER_2,this.INVENTORY_SLOT_TRINKET_1,this.INVENTORY_SLOT_TRINKET_2,this.INVENTORY_SLOT_MAIN_HAND,this.INVENTORY_SLOT_OFF_HAND,this.INVENTORY_SLOT_RANGED,this.INVENTORY_SLOT_AMMO];this.SIDE_ANY=0;this.SIDE_ALLIANCE=1;this.SIDE_HORDE=2;this.SIDE_BOTH=3;var t={0:"male",1:"female"};const i=[this.INVENTORY_SLOT_HEAD,this.INVENTORY_SLOT_SHOULDERS,this.INVENTORY_SLOT_CHEST,this.INVENTORY_SLOT_WAIST,this.INVENTORY_SLOT_LEGS,this.INVENTORY_SLOT_FEET,this.INVENTORY_SLOT_WRISTS,this.INVENTORY_SLOT_HANDS];const a={};a[e.SIDE_ANY]="any";a[e.SIDE_ALLIANCE]="alliance";a[e.SIDE_HORDE]="horde";a[e.SIDE_BOTH]="both";const n=1e4;const s=100;const r=1;const o=WH.getPageData("wow.versions")||[];this.buildMoney=function(e){var t={};if(e.copper){t.unnamed=e.copper.toString()}if(e.items&&e.items.length){t.items="";for(var i,a=0;i=e.items[a];a++){t.items+=(t.items?",":"")+i[0]+","+i[1]}}if(e.currencies&&e.currencies.length){t.currency="";for(var n,a=0;n=e.currencies[a];a++){t.currency+=(t.currency?",":"")+n[0]+","+n[1]}}if(e.achievementPoints){t.achievement=e.achievementPoints.toString()}return WH.markup.tags.money.toNode(t)};this.getGenderName=function(e){return WH.TERMS[t[e]]};this.getGenderString=function(e){return t[e]};this.getPatchVersionObject=function(e,t){var i=t||WH.Wow.getVersionList();var a=false;if(!e){e=Date.now();a=true}var n="?????";var s={build:999999,timestamp:9999999999999,version:n,versionNum:999999};for(var r=0,o;o=i[r];r++){if(o.timestamp<=e&&(s.version=="?????"||s.build<o.build)){s=o}}if(WH.isDev()&&s.version===n){if(a){WH.error("Could not find a build for the current time!",e,"Versions:",i)}else{WH.error("Could not find a build for timestamp "+e+"!","Versions:",i)}}return s};this.getSideTerm=function(e){return a[e]};this.getVersionList=function(){return o};this.getVersionNumFromStr=function(e){let t=e.split(".");while(t.length<3){t.push(0)}let i=parseInt(t[0])*n||0;if(t[1]){i+=parseInt(t[1])*s||0}if(t[2]){i+=parseInt(t[2])*r||0}return i};this.getVersionStrFromNum=function(e){e=parseInt(e);if(isNaN(e)){return""}return Math.floor(e/1e4)+"."+Math.floor(e%1e4/100)+"."+e%100};this.getVersionString=function(e){return WH.PageMeta.dataEnv.versions[e||WH.getDataEnv()]};this.getVersionStringFromTimestamp=function(e,t){return WH.Wow.getPatchVersionObject(e,t).version};this.hasVersion=function(t,i){return e.getVersionNumFromStr(e.getVersionString(i))>=t};this.isBodyArmorSlot=function(e){return i.includes(e)};this.showContentPhasePrompt=function(e,t,i,a){if((g_user.roles&U_GROUP_STAFF)==0||WH.isRetailTree()){WH.error("Asked to show content phase prompt when we are not allowed.");return}if(!t.length){WH.error("Should call the content phase prompt with at least one type ID");return}if(isNaN(i)){i=""}var n=t.length===1?"this entity":"these "+t.length+" entities";var s=prompt("What should the content phase be for "+n+"?",i);if(s===null){return}var r=undefined;if(s===""){r=0}else{r=parseFloat(s);if(isNaN(r)||r<0){alert("Invalid response ("+s+"): must be a positive number");return}}$.ajax({url:"/admin/content-phase/set",data:{type:e,typeIdCsv:t.join(","),phase:r.toFixed(2)},method:"POST",error:function(e,t,i){alert("Could not update content phase: "+t+"\n"+i)},success:function(e){if(a){a(e.phase)}else{alert("Updated "+e.typeIds.length+" "+(e.typeIds.length==1?"entity":"entities")+" to content phase "+(e.phase||"(None)")+".")}}})}};var ZUL=new function(){var e="has-mobile-zul-bar";var t={scriptLocation:function(){var e=document.getElementsByTagName("script");var t=e[e.length-1].src.split("?")[0];return t.split("/").slice(0,-1).join("/")+"/"}(),menuShowDelay:333,menuHideDelay:333};var i=false;var a={};var n={mobile:false,mobileScrollSetUp:false,mouseOver:false,iScroll:null,submenuCount:0,submenuTier:0,submenuTiers:[],timers:{menuExpand:null,menuExpandComplete:null,menuOut:null,menuOutPost:null,menuOverPost:null,mobileMenuToggle:null}};this.setOptions=function(e){if(typeof e!="object"){return}if(typeof i!="object"){i={}}for(var t in e){if(!e.hasOwnProperty(t))continue;i[t]=e[t]}};this.closeMobileMenu=function(){k()};this.addToMenu=function(e){if(!i.states){i.states={}}if(!i.states.universal){i.states.universal={}}if(!i.states.universal.content){i.states.universal.content=[]}if(e instanceof Array){i.states.universal.content=i.states.universal.content.concat(e)}else if(typeof e=="object"){i.states.universal.content.push(e)}ZUL.regenerateMenu()};this.regenerateMenu=function(){k();if(a.mobileMenu){u(a.barMobile)}};this.setMobileMode=function(e){if(n.mobile!==Boolean(e)){T(e);return true}return false};this.init=function(e){if(typeof e=="object"){ZUL.setOptions(e)}s()};function s(){if(!document.body){setTimeout(s,5);return}if(a.bar){a.barMobile=null;a.bar.parentElement.removeChild(a.bar)}a.bar=document.createElement("div");a.bar.id=a.bar.className="zul-bar";var e=false;if(typeof i.mobileLoadCheck=="function"){if(i.mobileLoadCheck()){e=true}}else if(i.mobileLoadCheck){e=true}T(e);document.body.insertBefore(a.bar,document.body.firstChild);r();w();if(typeof i.onCreateBar=="function"){i.onCreateBar()}}function r(){if(typeof i.mobileWidthCheck==="function"){T(i.mobileWidthCheck())}else if(typeof i.mobileWidthCheck==="number"){T(document.documentElement.offsetWidth<i.mobileWidthCheck)}}function o(){if(a.barMobile||!a.bar){return}a.barMobile=document.createElement("div");a.barMobile.id=a.barMobile.className="zul-bar-mobile";a.barMobile.className+=" zul-bar-mobile-top-menu";a.barMobile.setAttribute("data-tier","0");c(a.barMobile);l(a.barMobile);u(a.barMobile);a.bar.appendChild(a.barMobile);if(typeof i.onCreateMobileBar=="function"){i.onCreateMobileBar()}}function l(e){if(a.mobileBarContent){a.mobileBarContent.parentNode.removeChild(a.mobileBarContent);a.mobileBarContent=null}var t=function(){if(a.mobileBarContent){return}a.mobileBarContent=document.createElement("div");a.mobileBarContent.id=a.mobileBarContent.className="zul-bar-mobile-content"};var i=D();var n=x();if(n.mobileBarPre){t();W(a.mobileBarContent,n.mobileBarPre,false)}if(i.mobileBarPre){t();W(a.mobileBarContent,i.mobileBarPre,false)}if(n.mobileBarContent){t();W(a.mobileBarContent,n.mobileBarContent,false)}if(i.mobileBarPost){t();W(a.mobileBarContent,i.mobileBarPost,false)}if(n.mobileBarPost){t();W(a.mobileBarContent,n.mobileBarPost,false)}if(a.mobileBarContent){e.appendChild(a.mobileBarContent)}}function c(e){if(a.mobileMenuButton){a.mobileMenuButton.parentNode.removeChild(a.mobileMenuButton)}a.mobileMenuButton=document.createElement("div");a.mobileMenuButton.id=a.mobileMenuButton.className="zul-bar-mobile-menu-button";a.mobileMenuButtonLink=document.createElement("a");$(a.mobileMenuButtonLink,"click",M);a.mobileMenuButton.appendChild(a.mobileMenuButtonLink);e.appendChild(a.mobileMenuButton)}function u(e){if(a.mobileMenu){a.mobileMenu.parentNode.removeChild(a.mobileMenu)}a.mobileMenu=document.createElement("div");a.mobileMenu.id=a.mobileMenu.className="zul-bar-mobile-menu";a.mobileMenuList=d();p(a.mobileMenuList.firstChild);a.mobileMenu.appendChild(a.mobileMenuList);e.appendChild(a.mobileMenu);_()}function d(e,t){var i=document.createElement("div");i.className="zul-bar-mobile-menu-list-wrapper";i.id=i.className+(e?"-"+e:"");i.setAttribute("data-tier",t||0);i.style.left=U(t?1:0);var a=document.createElement("ul");a.className="zul-bar-mobile-menu-list";a.id=a.className+(e?"-"+e:"");i.appendChild(a);return i}function f(){var e=document.createElement("li");e.className="zul-bar-mobile-row";return e}function h(e){n.submenuCount++;var t=d(n.submenuCount,1);W(t.firstChild,e,true);a.mobileMenu.appendChild(t);E(true)}function p(e){var t=D();var i=x();W(e,i.pre,true);W(e,t.pre,true);W(e,i.content,true);W(e,t.post,true);W(e,i.post,true)}function m(e,t){var a=document.createElement("form");a.id="zul-bar-form-"+t.name;a.className="zul-bar-form "+a.className;if(typeof t.action=="function"){a.action=t.action(e,i,t)}else{a.action=t.action||"/"}if(typeof a.method=="function"){a.method=t.method(e,i,t)}else{a.method=t.method||"post"}for(var n=0,s;s=t.fields[n];n++){g(a,s,t)}e.appendChild(a)}function g(e,t,a){var n=false;var s=false;var r="input";var o={};switch(t.type){case"text":o.type="text";if(typeof t.label=="function"){o.placeholder=t.label(e,i,t)}else if(t.label){o.placeholder=t.label}else if(typeof t.placeholder=="function"){o.placeholder=t.placeholder(e,i,t)}else if(t.placeholder){o.placeholder=t.placeholder}if(typeof t.value=="function"){o.value=t.value(e,i,t)}else if(t.value){o.value=t.value}break;case"password":o.type="password";if(typeof t.label=="function"){o.placeholder=t.label(e,i,t)}else if(t.label){o.placeholder=t.label}else if(typeof t.placeholder=="function"){o.placeholder=t.placeholder(e,i,t)}else if(t.placeholder){o.placeholder=t.placeholder}if(typeof t.value=="function"){o.value=t.value(e,i,t)}else if(t.value){o.value=t.value}break;case"checkbox":o.type="checkbox";if(typeof t.label=="function"){s=t.label(e,i,t)}else{s=t.label}if(typeof t.checked=="function"){o.checked=t.value(e,i,t)}else if(t.checked){o.checked="checked"}break;case"hidden":r="hidden";if(typeof t.value=="function"){o.value=t.value(e,i,t)}else{o.value=t.value}break;case"button":r="button";if(typeof t.typeHTML=="function"){o.type=t.typeHTML(e,i,t)}else if(t.typeHTML){o.type=t.typeHTML}else{o.type="button"}if(typeof t.label=="function"){o.innerHTML=t.label(e,i,t)}else{o.innerHTML=t.label}break;case"link":return v(e,t,true,false);break;default:alert("Invalid element type passed to ZUL bar: "+t.type);return false}var l=["click","mouseover","mouseout","change","keyup","keydown","focus","blur"];var c=["name","innerHTML"].concat(l);for(var u=0,d;d=c[u];u++){if(t.hasOwnProperty(d)){if(["name","innerHTML"].indexOf(d)>-1&&typeof t[d]=="function"){o[d]=t[d](e,i,t)}else{o[d]=t[d]}}}o.id="zul-bar-form-"+a.name+"-"+t.name;o.className="zul-bar-form-"+t.type;if(typeof t.className=="function"){o.className+=" "+t.className(e,i,t)}else if(t.className){o.className+=" "+t.className}var f=document.createElement(r);for(var h in o){if(!o.hasOwnProperty(h)){continue}if(l.indexOf(h)>-1&&typeof o[h]=="function"){$(f,h,o[h])}else{f[h]=o[h]}}if(n){var p=document.createElement("label");p.id=p.className=o.id+"-prelabel";p.className="zul-bar-form-prelabel zul-bar-form-"+t.type+"-prelabel "+p.className;p.htmlFor=f.id;p.innerHTML=n;$(p,"mousedown",(function(){return false}));e.appendChild(p)}e.appendChild(f);if(s){var m=document.createElement("label");m.id=m.className=o.id+"-postlabel";m.className="zul-bar-form-postlabel zul-bar-form-"+t.type+"-postlabel "+m.className;m.htmlFor=f.id;m.innerHTML=s;$(m,"mousedown",(function(){return false}));e.appendChild(m)}return true}function H(e,t){var a=[];for(var n=0,s;s=t[n];n++){if(s.type=="concatenation"){var r=s.content(e,i);if(r){a=a.concat(r)}}else{a.push(s)}}return a}function W(e,t,a){if(!(t instanceof Array)||!t.length){return}t=H(e,t);for(var n=0,s;s=t[n];n++){if(typeof s.condition=="function"){if(!s.condition(e,i)){continue}}var r=e;if(a){var o=f();e.appendChild(o);r=o}switch(s.type){case"link":v(r,s,false,a);break;case"form":m(r,s);break;case"custom":if(typeof s.custom=="function"){s.custom(r,i)}break;default:}}}function v(e,t,n,s){let r=WH.ce("a",{className:"zul-bar-mobile-item-"+(n?"form-":"")+t.name,dataset:{disableWowheadTooltip:"true"}});if(typeof t.id=="function"){var o=t.id(e,i,t);if(o){r.id=o}}else if(t.id){r.id=q(t.id)}if(typeof t.innerHTML=="function"){r.innerHTML=t.innerHTML(e,i,t)}else if(t.innerHTML){r.innerHTML=q(t.innerHTML)}else if(typeof t.text=="function"){r.appendChild(document.createTextNode(t.text(e,i,t)))}else if(t.text){r.appendChild(document.createTextNode(q(t.text)))}if(typeof t.href=="function"){var l=t.href(e,i,t);if(l){r.href=l}}else if(t.href){r.href=q(t.href)}if(typeof t.heading=="function"){if(t.heading(e,i,t)){r.className+=" zul-bar-mobile-heading"}}else if(t.heading){r.className+=" zul-bar-mobile-heading"}if(typeof i.mobileIconSpacing=="function"){if(i.mobileIconSpacing(e,i,t)){r.className+=" zul-bar-icon-spacing"}}else if(i.mobileIconSpacing){r.className+=" zul-bar-icon-spacing"}var c=false;if(t.checked){switch(typeof t.checked){case"function":if(t.checked(e,i,t)){r.className+=" zul-bar-checked";c=true}break;case"string":if(location.href.match(t.checked)){r.className+=" zul-bar-checked";c=true}break;default:r.className+=" zul-bar-checked";c=true}}if(!c){if(t.imageIcon){if(typeof t.imageIcon=="function"){t.imageIcon=t.imageIcon(e,i,t)}var u;if(typeof t.imageIcon!="object"){u=t.imageIcon}else if(t.imageIcon.url){u=t.imageIcon.url}if(u){r.style.backgroundImage="url("+u+")";r.className+=" zul-bar-has-image-icon"}if(t.imageIcon.enlargeIcon){r.className+=" zul-bar-enlarge-image-icon"}}var d=false;if(typeof t.fontIcon=="function"){var f=t.fontIcon(e,i,t);if(f){d=f}}else if(t.fontIcon){d=t.fontIcon}if(d){r.className+=" zul-bar-has-fa";var h=document.createElement("i");h.className="fa fa-fw fa-"+d;r.insertBefore(h,r.firstChild)}}if(typeof t.className=="function"){var p=t.className(e,i,t);if(p){r.className+=" "+p}}else if(t.className){r.className+=" "+t.className}var m=false;var g=!t.hasOwnProperty("tap")||typeof t.tap==="boolean"&&t.tap;for(var H=0,W;W=["click","mouseover","mouseout"][H];H++){if(t[W]){if(W==="tap"||s&&W==="click"&&g){$(r,"tap",function(e,t){C(this);setTimeout((function(){e.call(this,t)}),1)}.bind(r,t[W]));m=true}else if(s&&W==="click"){$(r,W,function(e,t){C(this);setTimeout((function(){e.call(this,t)}),1)}.bind(r,t[W]))}else{$(r,W,t[W])}}}if(s&&!m&&g){if(typeof r.href=="string"&&r.href&&r.href.charAt(0)!=="#"&&r.href.substring(0,11)!=="javascript:"){$(r,"tap",(function(e){var t=e.target;C(t);setTimeout((function(){window.location=t.href}),1)}));m=true}}if(m){r.className+=" has-tap-event"}e.appendChild(r);if(t.menu&&t.menu.mobile){if(typeof t.menu.mobile=="function"){t.menu.mobile=t.menu.mobile()}var v;if(typeof t.mobileMenuText=="function"){v=t.mobileMenuText(a.mobileMenuBackTitleText,i,t)}else if(t.mobileMenuText){v=q(t.mobileMenuText)}else if(typeof t.innerHTML=="function"){v=t.innerHTML(a.mobileMenuBackTitleText,i,t)}else if(t.innerHTML){v=t.innerHTML}else if(typeof t.text=="function"){v=Y(t.text(a.mobileMenuBackTitleText,i,t))}else if(t.text){v=Y(t.text)}if(m){e.className+=" zul-mobile-menu-action-with-submenu";var _=document.createElement("a");_.className="zul-mobile-menu-submenu-arrow has-tap-event";$(_,"tap",L.bind(_,v,t.menu.mobile));e.appendChild(_)}else{e.className+=" zul-mobile-menu-has-submenu";r.className+=" has-tap-event";$(r,"tap",L.bind(r,v,t.menu.mobile))}}}function _(){if(a.mobileMenuBackRow){a.mobileMenuBackRow.parentNode.removeChild(a.mobileMenuBackRow)}a.mobileMenuBackRow=document.createElement("div");a.mobileMenuBackRow.id=a.mobileMenuBackRow.className="zul-bar-mobile-menu-back-row";a.mobileMenuBackButton=document.createElement("a");a.mobileMenuBackButton.innerHTML=i.mobileBackText||"Back";a.mobileMenuBackButton.id=a.mobileMenuBackButton.className="zul-bar-mobile-menu-back-button";a.mobileMenuBackButton.onclick=O;a.mobileMenuBackRow.appendChild(a.mobileMenuBackButton);a.mobileMenuBackTitle=document.createElement("div");a.mobileMenuBackTitle.id=a.mobileMenuBackTitle.className="zul-bar-mobile-menu-back-title";a.mobileMenuBackTitleText=document.createElement("span");a.mobileMenuBackTitleText.id=a.mobileMenuBackTitleText.className="zul-bar-mobile-menu-back-title-text";a.mobileMenuBackTitle.appendChild(a.mobileMenuBackTitleText);a.mobileMenuBackRow.appendChild(a.mobileMenuBackTitle);if(i.mobileHeader){a.mobileMenuBackHeader=document.createElement("ul");a.mobileMenuBackHeader.id="zul-bar-mobile-menu-back-header";a.mobileMenuBackHeader.className=a.mobileMenuBackHeader.id+" zul-bar-mobile-menu-list";W(a.mobileMenuBackHeader,i.mobileHeader,true);a.mobileMenuBackRow.appendChild(a.mobileMenuBackHeader);a.barMobile.className+=" zul-bar-mobile-menu-has-mobile-header"}a.barMobile.appendChild(a.mobileMenuBackRow)}function T(t){if(t){o();n.mobile=true;document.documentElement.dataset.header="mobile";document.body.classList.add(e)}else{n.mobile=false;document.documentElement.dataset.header="standard";document.body.classList.remove(e)}}function b(e,t){var i;if(document.querySelectorAll){i=document.querySelectorAll((t||"#zul-bar-mobile-menu-list")+" .zul-bar-mobile-menu-active");if(i){for(var n=0,s;s=i[n];n++){s.className=s.className.replace(/ *zul-bar-mobile-menu-active\b/g,"")}}}else{i=(e||a.mobileMenuList).getElementsByTagName("a");if(i){for(var n=0,s;s=i[n];n++){if(s.className&&s.className.indexOf("zul-bar-mobile-menu-active")){s.className=s.className.replace(/ *zul-bar-mobile-menu-active\b/g,"")}}}}}function E(e){var t=e?-1:1;if(n.submenuTier+t>0){return false}N();n.submenuTier=n.submenuTier+t;if(!e){n.submenuTiers.pop()}S();a.barMobile.setAttribute("data-tier",n.submenuTier);if(n.submenuTier==0){a.barMobile.className+=" zul-bar-mobile-top-menu"}else{a.barMobile.className=a.barMobile.className.replace(/ *zul-bar-mobile-top-menu\b/g,"")}var i=a.mobileMenu.childNodes;var s=[];for(var r=0,o;o=i[r];r++){var l=parseInt(o.getAttribute("data-tier"))+t;if(l>0){o.setAttribute("data-tier","1");o.style.left=U(n.submenuTier);setTimeout(function(e){e.parentNode.removeChild(e)}.bind(null,o),251)}else{if(l==0){o.style.height="100%"}s.push(o);setTimeout(function(e,t){e.setAttribute("data-tier",t);e.style.left=U(n.submenuTier)}.bind(null,o,l),51)}}if(!e){b(i[i.length-2],"#"+i[i.length-2].id)}B(a.mobileMenu,250);setTimeout(function(e){for(var t=0,i;i=e[t];t++){if(t!=e.length-1){i.style.height="10px"}}R(e[e.length-1])}.bind(null,s),251);return true}function y(){if(!a.mobileMenu){return}var e=a.mobileMenu.childNodes;for(var t=0,i;i=e[t];t++){if(t>0){i.parentNode.removeChild(i)}else{i.setAttribute("data-tier","0");i.style.left=U(0)}}n.submenuTiers=[];n.submenuTier=0;a.barMobile.setAttribute("data-tier","0");a.barMobile.className+=" zul-bar-mobile-top-menu"}function S(){var e=n.submenuTiers[n.submenuTier*-1-1];if(e){a.mobileMenuBackTitleText.innerHTML=e}}function w(){$(window,"resize",r);w=function(){}}function I(){if(!n.mobileScrollSetUp){var e=function(e){if(n.mobileMenuShown){if(!document.getElementById("zul-bar-mobile").contains(e.target)){e.preventDefault()}}};$(document.body,"touchmove",e);$(document.body,"mousewheel",e);n.mobileScrollSetUp=true}}function N(){if(n.iScroll){n.iScroll.destroy();n.iScroll=null}}function R(e){N();n.iScroll=new IScroll(e,{mouseWheel:true,tap:true})}function M(){Menu.hide(true);WH.Tooltip.hide();if(n.mobileMenuShown){k()}else{A()}}function A(){z("mobileMenuToggle");z("mobileMenuToggleCallback");var e=document.getElementById("zul-bar-mobile-menu-list-wrapper");e.style.height="100%";if(!a.fade){a.fade=document.createElement("div");a.fade.id=a.fade.className="zul-bar-fade";$(a.fade,"click",M);a.bar.appendChild(a.fade)}document.body.className+=" zul-mobile-show-menu";n.timers.mobileMenuToggle=setTimeout((function(){document.body.className+=" zul-mobile-animate-menu"}),1);if(typeof i.onShowMobileBarEnd=="function"){n.timers.mobileMenuToggleCallback=setTimeout((function(){i.onShowMobileBarEnd()}),152)}I();R(e);n.mobileMenuShown=true}function k(){z("mobileMenuToggle");z("mobileMenuToggleCallback");if(typeof i.onHideMobileBarStart=="function"){i.onHideMobileBarStart()}N();if(a.fade){a.fade.parentNode.removeChild(a.fade);a.fade=null}var e=document.body;e.className=e.className.replace(/ *zul-mobile-animate-menu\b/g,"");n.timers.mobileMenuToggle=setTimeout((function(){e.className=e.className.replace(/ *zul-mobile-animate-menu\b/g,"").replace(/ *zul-mobile-show-menu\b/g,"");b();y();if(typeof i.onHideMobileBarEnd=="function"){i.onHideMobileBarEnd()}}),251);n.mobileMenuShown=false;y()}function C(e){var t=G(e,"ul");b(t,"#"+t.id);e.className+=" zul-bar-mobile-menu-active"}function L(e,t){n.submenuTiers.push(e);C(this);setTimeout((function(){h(t)}),1)}function O(){E(false)}function D(){if(!i.state){return{}}var e={name:i.state};return P(i.states,e)}function x(){if(i.states&&i.states&&i.states.universal){return i.states.universal}return{}}function P(e,t){if(e&&typeof e[t.name]=="object"){for(var i in e[t.name]){if(e[t.name].hasOwnProperty(i)){t[i]=e[t.name][i]}}}return t}function U(e){return parseInt(e)*100+"%"}function q(e){return e.indexOf("%")>-1?F(e,i.user):e}function F(e,t){if(!t){return e}for(var i in t){if(!t.hasOwnProperty(i))continue;e=e.replace("%"+i.toUpperCase()+"%",t[i])}return e}function $(e,t,i,a){if(e.addEventListener){e.addEventListener(t,i,a)}else if(e.attachEvent){e.attachEvent("on"+t,i)}}function B(e,t){var i=e.scrollTop/(t/15);var a=e.scrollLeft/(t/15);var n=setInterval((function(){if(e.scrollTop!=0||e.scrollLeft!=0){e.scrollTop=Math.max(0,e.scrollTop-i);e.scrollLeft=Math.max(0,e.scrollLeft-a)}else clearInterval(n)}),15)}function G(e,t){while(e.parentNode){if(e.parentNode.tagName==t.toUpperCase()){return e.parentNode}e=e.parentNode}return null}function Y(e){if(!a.htmlEscaper){a.htmlEscaper=document.createElement("div")}a.htmlEscaper.innerHTML="";a.htmlEscaper.appendChild(document.createTextNode(e));return a.htmlEscaper.innerHTML}function z(e){clearTimeout(n.timers[e]);n.timers[e]=null}};ZUL.setOptions({site:"wowhead",mobileLoadCheck:function(){return WH.Layout.Responsive.check()},mobileWidthCheck:function(){return WH.Layout.Responsive.check()},mobileBackText:WH.TERMS.back_verb,mobileIconSpacing:true,states:{loggedOut:{pre:[{type:"custom",custom:function(e,t){e.style.paddingLeft="32px";var i=WH.ce("span");i.id=i.className="zul-bar-mobile-loginwithcolon";i.innerHTML=WH.TERMS.loginwith_colon;WH.ae(e,i);i=WH.ce("span");i.id=i.className="zul-bar-mobile-logincolon";i.innerHTML=WH.TERMS.login+WH.TERMS.colon_punct;WH.ae(e,i);var a=WH.ce("a",{id:"zul-bar-mobile-battlenet",className:"zul-bar-mobile-item-battlenet btn btn-site",innerHTML:"Battle.net",href:WH.getRelativeHostPrefix()+"/account=battlenet"});WH.aE(a,"tap",(function(){WH.visitUrlWithPostData(WH.getRelativeHostPrefix()+"/account=battlenet",{r:1});return false}));WH.ae(e,a);var n=WH.ce("a",{id:"zul-bar-mobile-fanbyte",className:"zul-bar-mobile-item-fanbyte btn btn-site",innerHTML:"<span>"+WH.TERMS.fanbyte+"</span>",href:WH.Url.getLoginPath()});WH.aE(n,"tap",(function(){WH.goToLoginPage();return false}));WH.ae(e,n)}},{type:"link",name:"register",innerHTML:WH.TERMS.register,href:WH.Url.getRegistrationPath()},{type:"link",name:"get-premium",innerHTML:WH.TERMS.getpremium,href:"/premium",fontIcon:"star"}]},loggedIn:{pre:[{type:"link",name:"staff",innerHTML:WH.TERMS.staffemployees,href:"javascript:",className:"hassubmenu",menu:{mobile:function(){return Menu.prepareForZul(WH.Staff.getMenu())}},condition:function(e,t){return!!WH.Staff}},{type:"link",name:"favorites",innerHTML:WH.TERMS.favorites,href:"javascript:",className:"hassubmenu",menu:{mobile:function(){return Menu.prepareForZul(WH.Favorites.getMenu())}},condition:WH.Favorites.hasFavorites},{type:"link",name:"user",innerHTML:function(e,t){return t.user.name+" <small>("+WH.numberFormat(t.user.reputation)+" "+WH.TERMS.reputation+")</small>"},mobileMenuText:"%NAME%",menu:{mobile:function(){return Menu.prepareForZul(WH.Layout.User.getUserMenu())}}},{type:"link",name:"characters",innerHTML:WH.TERMS.myprofiles,menu:{mobile:function(){return Menu.prepareForZul(WH.Layout.User.getProfilerMenu())}}},{type:"link",name:"upgrade",innerHTML:WH.TERMS.upgradeavailable,href:"/premium",fontIcon:"arrow-up",condition:function(e,t){return!t.user.premium}}]},universal:{pre:[{type:"link",name:"mobileheader",href:"/",heading:true},{type:"concatenation",content:function(e,t){return Menu.prepareForZul(Menu.getFeaturedNavigationMenu())}},{type:"link",text:WH.TERMS.navigation,heading:true},{type:"concatenation",content:function(e,t){return Menu.prepareForZul(Menu.getMenu())}},{type:"link",text:"",heading:true}],content:[{type:"link",name:"feedback",innerHTML:WH.TERMS.feedback,href:"javascript:",fontIcon:"envelope",click:function(){ZUL.closeMobileMenu();ContactTool.show()}},{type:"link",name:"locale",innerHTML:function(e,t){return Locale.getDescription()||WH.TERMS.language},href:"javascript:",mobileMenuText:WH.TERMS.language,menu:{mobile:function(){return Menu.prepareForZul(WH.Layout.User.getLocaleMenu())}}},{type:"link",name:"theme",innerHTML:function(e,t){var i=WH.TERMS.unknown;switch(WH.Theme.getTheme()){case"classic":i=WH.TERMS.classic;break;case"standard":i=WH.TERMS.standard;break;case"thottbot":i=WH.TERMS.thottbot;break;default:WH.error("Unknown theme in ZUL configuration!",WH.Theme.getTheme())}return WH.TERMS.theme_format.replace("%s","<b>"+i+"</b>")},condition:function(e,t){return WH.Theme.getThemes().length>1},mobileMenuText:WH.TERMS.changeTheme,menu:{mobile:function(){var e=WH.Theme.getThemes();var t=[];for(var i=0,a=e.length;i<a;i++){var n=e[i];(function(e){t.push({name:"theme-"+e,type:"link",innerHTML:WH.TERMS.theme_format.replace("%s",WH.TERMS[e]),href:"javascript:",click:function(){var t=WH.qs(".zul-bar-mobile-item-theme-"+e);if(t){if(t.classList.contains("zul-bar-checked")){ZUL.closeMobileMenu();return}t.classList.add("zul-bar-has-fa");WH.aef(t,WH.ce("i",{className:"fa fa-refresh fa-spin"}))}if(!WH.User.isLoggedIn()){window.location="/account=signin?next="+encodeURIComponent(window.location.href);return}WH.Theme.set(e)},checked:function(t,i){return WH.Theme.getTheme()===e}})})(n)}return t}()}},{type:"link",name:"data-env",innerHTML:function(e,t){let i=WH.TERMS.live;switch(WH.getDataEnv()){case WH.dataEnv.PTR:i=WH.TERMS.ptr;break;case WH.dataEnv.BETA:i=WH.TERMS.beta;break;case WH.dataEnv.CLASSIC:i=WH.TERMS.classic;break;case WH.dataEnv.TBC:i=WH.TERMS.burningCrusade;break}return WH.sprintf(WH.TERMS.viewingdata_format,"<b>"+i+"</b>")},mobileMenuText:WH.TERMS.changedataview,menu:{mobile:function(){let e=function(e){if(WH.getDataEnv()===e){return"javascript:"}var t=WH.qs('.data-env-links a[data-env="'+WH.dataEnvKey[e]+'"]');if(t&&t.href){return t.href}return WH.Url.generate(location.pathname+location.search+location.hash,{dataEnv:e})};return[{type:"link",innerHTML:WH.sprintf(WH.TERMS.data_format,WH.TERMS.live),href:e(WH.dataEnv.MAIN),checked:function(e,t){return WH.getDataEnv()===WH.dataEnv.MAIN}},{type:"link",innerHTML:WH.sprintf(WH.TERMS.data_format,WH.TERMS.ptr),href:e(WH.dataEnv.PTR),checked:function(e,t){return WH.getDataEnv()===WH.dataEnv.PTR},condition:function(e,t){return WH.isPtrActive()}},{type:"link",innerHTML:WH.sprintf(WH.TERMS.data_format,WH.TERMS.beta),href:e(WH.dataEnv.BETA),checked:function(e,t){return WH.getDataEnv()===WH.dataEnv.BETA},condition:function(e,t){return WH.isBetaActive()}},{type:"link",innerHTML:WH.sprintf(WH.TERMS.data_format,WH.TERMS.classic),href:e(WH.dataEnv.CLASSIC),checked:function(e,t){return WH.getDataEnv()===WH.dataEnv.CLASSIC}},{type:"link",innerHTML:WH.sprintf(WH.TERMS.data_format,WH.TERMS.burningCrusade),href:e(WH.dataEnv.TBC),checked:function(e,t){return WH.getDataEnv()===WH.dataEnv.TBC}}]}}}],mobileBarContent:[{type:"form",name:"search",action:"/search",method:"get",fields:[{type:"text",name:"q",label:WH.TERMS.searchGuidesNewsDatabase_stc_ellipsis,value:function(){var e=function(){var t=$(".header-search form input");if(!t.length){setTimeout(e,5);return}$("#zul-bar-form-q").val(t.val()||"")};e();setTimeout((function(){LiveSearch.attach(WH.ge("zul-bar-form-search-q"))}),0);return""},focus:function(){document.body.scrollTop=0;document.body.scrollLeft=0;var e=WH.ge("zul-bar");e.style.position="absolute";setTimeout((function(){document.body.scrollTop=0;document.body.scrollLeft=0;var e=document.createElement("div");e.className="zul-bar-fade zul-bar-fade-body-only";e.onclick=function(){this.parentNode.removeChild(this)};$("#zul-bar").append(e)}),5)},blur:function(){$(".zul-bar-fade.zul-bar-fade-body-only").remove();var e=WH.ge("zul-bar");e.style.position="fixed"}}]},{type:"link",name:"share",className:"fa fa-share-square-o",click:function(){var e=location.href;var t=[[,WH.TERMS.shareon_colon],[0,WH.TERMS.twitter,WH.Layout.getShareUrl("twitter",e),undefined,{fontIcon:"twitter",newWindow:true}],[1,WH.TERMS.facebook,WH.Layout.getShareUrl("facebook",e),undefined,{fontIcon:"facebook-official",newWindow:true}],[2,WH.TERMS.reddit,WH.Layout.getShareUrl("reddit",e),undefined,{fontIcon:"reddit-alien",newWindow:true}]];Menu.show(t,this)}}]}}});WH.Admin.Debug=new function(){const e=this;this.TYPE_CODE="code";this.TYPE_MESSAGE="message";this.TYPE_QUERY="query";this.TYPE_SEO="seo";var t=0;var i=1;var a=2;var n="log";var s="warn";var r="error";const o={announcementId:1e5,footerInitialized:false,queue:[],queueElement:undefined};this.error=function(e,t,i){u({level:r,markup:i||false,message:t,type:e})};this.initFooter=function(){let e=WH.ce("a",{className:"debug-footer-toggle fa"});WH.preventSelectStart(e);let t=WH.ce("li",{className:"footer-list-item-debug"});WH.ae(WH.qs(".footer-utility-site-links"),t);WH.ae(t,e);WH.aE(e,"click",(function(){let t=WH.qs(".debug-footer");if(t.dataset.state==="hidden"){WH.st(this,"Hide debug");this.classList.add("fa-minus-circle");this.classList.remove("fa-plus-circle");t.dataset.state="visible";if(o.footerInitialized){WH.scrollTo(e)}}else{WH.st(this,"Show debug");this.classList.add("fa-plus-circle");this.classList.remove("fa-minus-circle");t.dataset.state="hidden"}}));if(WH.User.hasRole(U_GROUP_DEV)){WH.qs(".debug-footer").dataset.state="hidden"}WH.DOM.dispatchEvent(e,"click");o.footerInitialized=true};this.initFooterTabs=function(){let e=WH.qs(".debug-footer-inner");if(!e){return}WH.qsa(".debug-footer .tabs a").forEach((function(t){WH.aE(t,"click",(function(){let t;if(!this.tabSettings||!(t=WH.ge("tab-"+this.tabSettings.id))){return}let i=t.offsetHeight-2;if(e.style.minHeight){if(parseInt(e.style.minHeight)>=i){return}}else{let e;if(this.tabSettings.id!=="info"&&(e=WH.ge("tab-info"))){e.style.display="";let t=e.offsetHeight-2;e.style.display="none";if(t>i){i=t}}}i=Math.min(i,Platform.getViewportHeight());e.style.minHeight=i+"px"}))}))};this.log=function(e,t,i){u({level:n,markup:i||false,message:t,type:e})};this.warn=function(e,t,i){u({level:s,markup:i||false,message:t,type:e})};function l(){return WH.PageMeta.debug||false}function c(t){switch(t.type){case e.TYPE_CODE:case e.TYPE_QUERY:if(t.level!==r&&!WH.User.hasRole(U_GROUP_DEV)){return i}return a;case e.TYPE_SEO:if(t.level!==r&&!WH.User.hasRole(U_GROUP_BLOGGER|U_GROUP_EDITOR)){return i}return a;case e.TYPE_MESSAGE:return a;default:WH.error("Unknown debug message type.",t.type);return a}}function u(e){if(!l()){o.queue.push(e);return}switch(c(e)){case a:d(e);break;case t:break;case i:o.queue.push(e);g();break;default:WH.error("Debug message action could not be determined.",e.type,e);d(e)}}function d(e){if(!e.message){var t="Tried to display an empty debug message.";WH.error(t,e);alert(t);return}var i={allowMarkup:e.markup,class:"debug debug-type-"+(e.type||"unknown")+" debug-level-"+e.level,id:o.announcementId.toString(),nocookie:1,parent:"debug-message-wrapper-"+o.announcementId,text:e.message};var a=WH.ce("div",{id:i.parent});var n=WH.ge("announcement-0");if(n){n.parentNode.insertBefore(a,n)}else{if(document.readyState!=="complete"){WH.aE(document,"readystatechange",d.bind(this,e));return}else{var s=WH.qs(".main-contents");if(s){WH.aef(s,a)}else{WH.aef(document.body,a)}}}o.announcementId++;new WH.Announcement(i);$("#"+i.parent+"-markup .error-reveal-button").click((function(){$("#"+i.parent+"-markup > div").show();WH.de(this)}))}function f(){while(o.queue.length){d(o.queue.shift())}}function h(){var e={};for(var t=0,i=o.queue.length;t<i;t++){var a=o.queue[t];if(!e[a.level]){e[a.level]=0}e[a.level]++}return e}function p(){if(!o.queueElement){o.queueElement=WH.Layout.User.createDebugQueueElement();if(!o.queueElement){return undefined}WH.aef(o.queueElement,WH.ce("span",{className:"header-user-debug-messages-count"}));WH.aE(o.queueElement,"click",(function(){f();g()}));WH.Tooltip.simple(o.queueElement,m)}return o.queueElement}function m(){var e=h();var t="debug";var i=o.queue.length!==1?"s":"";var a=[];for(var n in e){if(!e.hasOwnProperty(n)){continue}if(e[n]===o.queue.length){t=n}else{a.push(e[n]+" "+n+(e[n]!==1?"s":""))}}var s=o.queue.length+" "+t+" message"+i+" queued.";if(a.length){s+="<br>Click to show "+Locale.formatList(a)+"."}else{s+="<br>Click to show."}return'<div class="no-wrap q2">'+s+"</div>"}function g(){if(!l()){return}if(!o.queue.length&&!o.queueElement){return}var e=p();if(!e){if(document.readyState!=="complete"){WH.aE(document,"readystatechange",g.bind(this))}else{f()}return}if(!o.queue.length){if(e.style.display!=="none"){e.style.display="none";WH.Layout.updateSearchWidth()}return}var t=h();if(t.hasOwnProperty(r)){e.dataset.level=r}else if(t.hasOwnProperty(s)){e.dataset.level=s}else{e.dataset.level=n}e.dataset.count=o.queue.length;var i=WH.qs(".header-user-debug-messages-count",e);if(i){i.innerHTML=e.dataset.level===n?"":o.queue.length}if(e.style.display==="none"){delete e.style.display;WH.Layout.updateSearchWidth();if(WH.Theme.isClassic()){WH.Layout.Responsive.updateNavOverflow()}}}};WH.Admin.Localization=new function(){var e=0;var t=1;var i={0:{class:"q10",name:"Error"},1:{class:"r1",name:"Warning"}};var a={default:":",2:" :",4:"："};var n={default:": ",2:" : ",4:"："};var s={default:"…"};var r={default:"!",4:"！"};var o={default:".",4:"。"};var l={default:"?",4:"？"};this.initValidation=function(e,t,i,a,n){let s;let r=$(t);if(e===LOCALE_ENUS){r.bind("keydown keyup change",function(e,t){clearTimeout(s);s=setTimeout(h.bind(null,e,t),300)}.bind(null,r,a))}else{r.bind("keydown keyup change",function(e,t,i,a,n){clearTimeout(s);s=setTimeout(H.bind(null,e,t,i,a,n),300)}.bind(null,e,r,$(i),a,n))}if(g_user.roles&U_GROUP_DEV){r.change()}};function c(e){var t=e.match(/%(?:\d+\$)?[sd]/g);return t?t.length:0}function u(e,t){var a=e.siblings(".localization-message");if(!a.length){a=$("<div/>",{class:"localization-message"}).appendTo(e.parent())}a.empty();if(t.length){for(var n=0,s=t.length;n<s;n++){var r=t[n];var o="localization-message-"+i[r.type].name.toLowerCase();$("<div/>",{class:o+" "+i[r.type]["class"],text:i[r.type].name+": "+r.message}).appendTo(a)}}}function d(t,i){var a=[];if(!i.match(/[<>]/)&&t.match(/[<>]/)){a.push({type:e,message:"This translation appears to have HTML in it, but the original does not."})}return a}function f(e,i){var a=[];var n=i.match(/\n/g);var s=e.match(/\n/g);n=n?n.length:0;s=s?s.length:0;if(n>=3){return a}if(s>0&&n===0){a.push({type:t,message:"This translation has line breaks, but the original does not."})}else if(n!==s){a.push({type:t,message:"The number of line breaks in this translation ("+s+") does not "+"match the original ("+n+")."})}return a}function h(e,i){let c=i||(e.is("input, textarea")?e.val():e.text());var d=[];if(c!==""){if(c.match(/[<>]/)){d.push({type:t,message:"Avoid using HTML in term text."})}if(c.indexOf("\t")>-1){d.push({type:t,message:"Avoid tabs in term text."})}if(c.indexOf(" ")===0){d.push({type:t,message:"Avoid starting with a space in term text."})}var f=false;var h=[o,r,l,s,n,a];for(var p=0,m=h.length;p<m;p++){var g=h[p]["default"];if(c.substr(-1*g.length)===g){f=true;break}}if(!f&&c.substr(-1)===" "){d.push({type:t,message:"Avoid ending with a space in term text, if it's not related to punctuation (such as "+"after a colon)."})}if(c.indexOf("  ")>-1){d.push({type:t,message:"Avoid using multiple sequential spaces in term text."})}if(c.match(/(\r\n|\r|\n)/)){d.push({type:t,message:"Avoid using line breaks in term text, if possible."})}}u(e,d)}function p(e,i,c){var u=[];var d=false;var f=function(a,n){var s=a["default"];var r=a[c]||s;if(i.substr(-1*s.length)===s){d=true;if(e.substr(-1*r.length)!==r){return[{type:t,message:"This translation doesn't end in matching "+n+" punctuation for this locale ("+r+")."}]}}else{if(e.substr(-1*r.length)===r||e.substr(-1*s.length)===s){if(r==="："&&s===":"&&i.substr(-2)===": "||r==="："&&s===": "&&i.substr(-1)===":"){return[]}return[{type:t,message:"This translation ends in "+n+" punctuation, but the original "+"does not."}]}}return[]};u=u.concat(f(o,"full stop"));u=u.concat(f(r,"exclamation"));u=u.concat(f(l,"question mark"));u=u.concat(f(s,"ellipsis"));u=u.concat(f(n,"colon"+(Locale.hasWordSpaces(c)?" (with a space)":"")));u=u.concat(f(a,"colon"+(Locale.hasWordSpaces(c)?" (without a space)":"")));if(!d){if(i.substr(-1)===" "){if(Locale.hasWordSpaces(c)||Locale.hasSentenceSpaces(c)){if(e.substr(-1)!==" "){u.push({type:t,message:"This translation doesn't end in a space, but the original does."})}}}else{if(e.substr(-1)===" "){u.push({type:t,message:"This translation ends in a space, but the original does not."})}}}return u}function m(e,i,a){var n=[];if(Locale.hasWordSpaces(a)||Locale.hasSentenceSpaces(a)){var s=e.substr(0,1);var r=i.substr(0,1);if(s===" "&&r!==" "){n.push({type:t,message:"This translation starts with a space, but the original does not."})}else if(s!==" "&&r===" "){n.push({type:t,message:"This translation does not start with a space, but the original does."})}}if(e.indexOf("\t")>-1&&i.indexOf("\t")){n.push({type:t,message:"This translation has a tab character, but the original does not."})}if(e.indexOf("  ")>-1&&i.indexOf("  ")===-1){n.push({type:t,message:"This translation has multiple spaces, but the original does not."})}return n}function g(e,i){var a=[];var n=c(e);var s=c(i);if(n!==s){a.push({type:t,message:"This translation has "+n+" string replacement placeholders, "+"but the original has "+s+"."})}return a}function H(e,t,i,a,n){a=a||(t.is("input, textarea")?t.val():t.text());n=n||(i.is("input, textarea")?i.val():i.text());let s=[];if(a!==""){s=s.concat(d(a,n));s=s.concat(g(a,n));s=s.concat(p(a,n,e));s=s.concat(m(a,n,e));s=s.concat(f(a,n))}u(t,s)}};WH.Layout.Footer=new function(){const e=[{url:"https://discord.gg/wowhead",className:"discord-icon"},{url:"https://twitter.com/Wowhead",className:"fa fa-twitter"},{url:"https://www.facebook.com/Wowhead",className:"fa fa-facebook"},{url:"https://www.youtube.com/user/Wowhead",className:"fa fa-youtube-play"},{url:"/news/rss/all",className:"fa fa-rss hassubmenu"},{crumb:"vk",url:"https://vk.com/wowheadrussia",className:"fa fa-vk"}];this.init=function(e){WH.Page.init();o();r();l();c();WH.setupFooterMenus();Menu.add(WH.qs(".footer-utility-social-links .fa-rss"),e)};function t(e,t){if(Menu.hasSubmenuContent(e)){Menu.add(t,Menu.getSubmenu(e))}}function i(e,i){let a=WH.ce("li");let n=WH.ce("a",{href:Menu.getItemUrl(e)},WH.ct(Menu.getLabel(e)));n.dataset.disableWowheadTooltip="true";t(e,n);WH.ae(a,n);WH.ae(i,a)}function a(e){Menu.getMenu("footer").forEach((i=>{let a;if(Menu.getItemCrumb(i)==="advertise"){a="mailto:advertising@fanbyte.com"}else{a=Menu.getItemUrl(i)||"javascript:"}let n=WH.ce("a",{href:a},WH.ct(Menu.getLabel(i)));n.dataset.disableWowheadTooltip="true";t(i,n);let s=WH.ce("li",{className:"footer-list-item"});WH.ae(s,n);WH.ae(e,s)}))}function n(){let t=WH.ce("ul",{className:"footer-utility-social-links"});e.forEach((e=>{if(e.crumb==="vk"&&Locale.getId()!==LOCALE_RURU){return}let i=WH.ce("li");let a=WH.ce("a",{className:e.className,href:e.url});WH.ae(i,a);WH.ae(t,i)}));return t}function s(){let e=WH.ce("img",{src:"/images/logos/wh-logo-thumbnail.png"});let t=WH.ce("a",{href:"/"},e);let i=WH.ce("li",{className:"footer-utility-logo"},t);let n=WH.ce("ul",{className:"footer-utility-site-links"},i);a(n);return n}function r(){let e=WH.qs(".footer");let t=WH.ce("section",{className:"footer-content-links"});let i=WH.ce("section",{className:"footer-content"});Menu.getMenu("footerLinks").forEach((e=>{let i=WH.ae(t,WH.ce("ul",{className:"footer-list"}));let a=WH.ce("li",{className:"footer-list-item-heading"});let n=WH.ce("a",{href:Menu.getItemUrl(e)},WH.ct(Menu.getLabel(e)));n.dataset.disableWowheadTooltip="true";WH.ae(a,n);WH.ae(i,a);if(Menu.hasSubmenuContent(e)){Menu.getSubmenu(e).forEach((e=>{let t=WH.ce("li",{className:"footer-list-item"});let a=WH.ce("a",{href:Menu.getItemUrl(e)},WH.ct(Menu.getLabel(e)));a.dataset.disableWowheadTooltip="true";WH.ae(t,a);WH.ae(i,t)}))}}));let n=WH.ae(t,WH.ce("ul",{className:"footer-list"}));let s=WH.ce("li",{className:"footer-list-item-heading"},WH.ct(WH.TERMS.siteLinks));WH.ae(n,s);a(n);WH.ae(i,t);WH.ae(e,i)}function o(){let e=WH.qs(".footer");let t=WH.ce("section",{className:"footer-navigation"});let a=WH.ce("section",{className:"footer-navigation-bar"});let n=WH.ce("ul",{className:"footer-navigation-bar-links"});let s=WH.ce("ul",{className:"footer-navigation-bar-links"});let r=Menu.getMenu().filter((e=>{let t=Menu.getItemOptions(e);return!t.breadcrumbOnly}));r.slice(0,r.length/2).forEach((e=>{i(e,n)}));r.slice(r.length/2,r.length).forEach((e=>{i(e,s)}));let o=WH.ce("section",{className:"footer-navigation-bar-logo"});let l=WH.ce("section",{className:"footer-navigation-bar-logo-link"});let c=WH.ce("a",{href:"/"});WH.ae(c,l);WH.ae(o,c);WH.ae(a,n);WH.ae(a,o);WH.ae(a,s);WH.ae(t,a);WH.ae(e,t);let u=()=>{let e=[0,1,2,4];let t=window.innerWidth;let i=t>=1366?e[3]:t>=768?e[2]:t>=426?e[1]:e[0];a.dataset.columns=i.toString();let n=17;let s=i===4?"ul":"li";for(let t of WH.qsa(s,a)){if(t.clientHeight>n){a.dataset.columns=(e.indexOf(i)-1).toString();break}}};u();WH.aE(window,"resize",u)}function l(){let e=WH.qs(".footer-content");let t=WH.ce("span",{className:"footer-button-top-label"},WH.ct(WH.TERMS.topOfPage_short));let i=WH.ce("div",{className:"footer-button-outer"},t);let a=WH.ce("button",{className:"footer-button-top-icon fa fa-angle-double-up"});WH.ae(i,a);WH.ae(e,i);WH.aE(a,"click",(()=>{scroll({top:0,behavior:"smooth"})}));WH.aE(t,"click",(()=>{scroll({top:0,behavior:"smooth"})}))}function c(){let e=WH.qs(".footer");let t=WH.ce("section",{className:"footer-utility-bar"});let i=WH.ce("section",{className:"footer-utility"});let a=s();let r=n();WH.ae(t,a);WH.ae(t,r);WH.ae(i,t);WH.ae(e,i)}};WH.Layout.Responsive=new function(){const e=this;const t=WH.DOM;const i=WH.DynamicFixedElement;const a=WH.Layout;const n=105;const s=54;const r="header-nav-collapsed";const o="compact";const l="standard";const c=2;const u=247;const d=2;const f={CLASSIC:WH.Theme.isClassic(),CLASSIC_TYPE:WH.Theme.isClassicType(),STANDARD_TYPE:WH.Theme.isStandardType(),THOTTBOT:WH.Theme.isThottbot()};const h={elements:{collapsibleNavLinks:undefined,firstMenuItem:undefined,fullscreenModeIcon:undefined,header:undefined,headerNav:undefined,headerNavEllipsis:undefined,headerNavFeatures:undefined,headerNavFeaturesEllipsis:undefined,headerNavFeaturesLinks:undefined,headerNavLinks:undefined,headerNavWrapper:undefined,headerUser:undefined,headerWrapper:undefined,layoutWrapper:undefined,logo:undefined,search:undefined,themeSwitcher:undefined},featuredNavCompact:undefined,featuredNavCompactHiddenViewportWidths:[0,0],featuredNavOverflowMenu:[],hiddenHeader:undefined,initialized:false,logoShrinkViewportWidth:0,collapsibleNavLinkCount:undefined,maxMobileNavigationWidth:767,mobileMode:false,navOverflowLastNavState:undefined,navOverflowLastResponsiveStep:{compact:0,standard:0},navOverflowLastViewportWidth:{compact:0,standard:0},navOverflowMenu:[],navScrollLimitEnabled:false,responsiveNavStep:{compact:0,standard:0},responsiveNavStepWidths:{compact:[0,0],standard:[0,0]},shrinkHeader:false,updateSearchWidth:false};this.check=function(e){if(!h.initialized){return h.mobileMode}let t=h.mobileMode;if(M()){a.disableLayoutAnimation();P(!h.mobileMode);ZUL.setMobileMode(h.mobileMode);if(!h.mobileMode&&M()){P(!h.mobileMode);ZUL.setMobileMode(h.mobileMode)}setTimeout((function(){requestAnimationFrame(a.enableLayoutAnimation)}),10)}if(!h.mobileMode&&f.CLASSIC_TYPE){WH.WAS.updateSkinPosition()}if(e===true||e!==false&&t&&!h.mobileMode){h.updateSearchWidth=true;R();N()}if(h.updateSearchWidth){requestAnimationFrame(a.updateSearchWidth.bind(a,false));h.updateSearchWidth=false}return h.mobileMode};this.disableNavScrollLimit=function(){h.elements.headerWrapper.style.position="";h.elements.headerWrapper.style.top="";requestAnimationFrame((function(){requestAnimationFrame((function(){h.elements.headerWrapper.style.transition=""}))}));h.navScrollLimitEnabled=false};this.init=function(t){h.initialized=true;h.elements.collapsibleNavLinks=t.collapsibleNavLinks;h.elements.header=t.header;h.elements.headerNav=t.nav;h.elements.headerNavEllipsis=t.navEllipsis;h.elements.headerNavFeatures=t.featuredNav;h.elements.headerNavFeaturesEllipsis=t.featuredEllipsis;h.elements.headerNavFeaturesLinks=t.featuredLinks;h.elements.headerNavLinks=t.navLinks;h.elements.headerNavWrapper=t.navWrapper;h.elements.headerUser=WH.qs(".header-user");h.elements.headerWrapper=t.headerWrapper;h.elements.layoutWrapper=WH.qs(".layout-wrapper");h.elements.search=WH.qs(".header-search form");h.collapsibleNavLinkCount=h.elements.collapsibleNavLinks.length;WH.onMutate(document.body,(function(){if(h.navScrollLimitEnabled){U(window.scrollY)}}));WH.onMutate(h.elements.headerUser,x.bind(e,true));WH.aE(window,"scroll",R);WH.aE(window,"resize",N);if(document.fonts){document.fonts.load("14px Open Sans").then(N)}R();N()};this.updateHeaderOffset=function(){if(f.STANDARD_TYPE){e.updateHeaderOffset=function(){};return}if(!h.elements.header){return}let i=a.getElement("page-content");if(!i){return}a.disableLayoutAnimation();requestAnimationFrame(a.enableLayoutAnimation);let r=a.getFullscreenMode()?s:n;let o=t.getInnerHeight(h.elements.header)+r+"px";i.style.borderTopWidth=o;h.elements.headerWrapper.style.marginBottom="-"+o;if(!e.isZulInMobileMode()){document.documentElement.style.scrollPaddingTop=h.elements.headerWrapper.getBoundingClientRect().height+10+"px"}WH.WAS.updateSkinPosition()};this.updateNavOverflow=function(){x(true)};this.isZulInMobileMode=function(){return Boolean(document.body.className&&document.body.className.indexOf("has-mobile-zul-bar")>-1)};function p(e,t,i,a){for(let n=e;n<h.collapsibleNavLinkCount;n++){let s=h.elements.collapsibleNavLinks[n];if(y(t,i,a)){s.classList.add(r);e++;h.navOverflowMenu.push(s.menuItem);if(i===s){break}}else{s.classList.remove(r)}}return e}function m(e){h.mobileMode=true;let t=e+d;if(t>h.maxMobileNavigationWidth){h.maxMobileNavigationWidth=t}}function g(){let e=WH.ge("ad-skin");return e?e.offsetHeight:null}function H(){if(h.elements.headerNavEllipsis&&!h.elements.headerNavEllipsis.classList.contains(r)){return h.elements.headerNavEllipsis}let e=h.elements.headerNavLinks||WH.qsa(".header-nav a");for(let t=e.length-1;t>=0;t--){if(!e[t].classList.contains(r)){return e[t]}}return undefined}function W(){if(h.elements.fullscreenModeIcon===undefined){h.elements.fullscreenModeIcon=WH.qs(".header-user-fullscreen")}return h.elements.fullscreenModeIcon}function v(e,t){let i=e.getBoundingClientRect();let a=getComputedStyle(e).getPropertyValue("padding-right");let n=i.right-parseInt(a||0)-2;let s=n-(t.originalWidth||56);return{rect:i,right:n,rightWithEllipsis:s}}function _(){return h.featuredNavCompact?o:l}function T(){E(h.elements.headerNavFeaturesLinks,h.elements.headerNavFeaturesEllipsis,h.featuredNavOverflowMenu);T=function(){}}function b(){E(h.elements.headerNavLinks,h.elements.headerNavEllipsis,h.navOverflowMenu);b=function(){}}function E(e,t,i){for(let t=0,i=e.length;t<i;t++){e[t].originalWidth=e[t].getBoundingClientRect().width}t.originalWidth=t.getBoundingClientRect().width;Menu.add(t,i)}function y(e,t,i){let a=t.getBoundingClientRect();if(a.top!==e.rect.top){return true}return a.left+t.originalWidth>(i?e.right:e.rightWithEllipsis)}function S(e){if(!f.STANDARD_TYPE){return false}if(h.elements.headerNavFeaturesLinks&&!h.featuredNavCompact){let e=h.elements.headerNavFeaturesLinks[0];let t=h.elements.headerNavFeaturesLinks[h.elements.headerNavFeaturesLinks.length-1];if(e&&t&&e.getBoundingClientRect().top!==t.getBoundingClientRect().top){return true}}return false}function w(e){let t=_();x();let i=0;for(let a=1;a<=c;a++){if(e<=(h.responsiveNavStepWidths[t][a-1]||0)){i=a}}if(i!==h.responsiveNavStep[t]){A(t,i);h.updateSearchWidth=true}let a=H();if(f.CLASSIC_TYPE){let e=a?a.getBoundingClientRect():null;if(f.CLASSIC){if(h.responsiveNavStep[t]<1&&e&&e.right>h.elements.headerUser.getBoundingClientRect().left){A(t,1)}}else if(f.THOTTBOT){if(typeof h.elements.logo==="undefined"){h.elements.logo=WH.qs(".header-logo")}if(typeof h.elements.themeSwitcher==="undefined"){h.elements.themeSwitcher=WH.qs(".header-theme-switcher")}if(h.elements.logo&&h.elements.themeSwitcher){let e=h.elements.logo.getBoundingClientRect();let t=h.elements.themeSwitcher.getBoundingClientRect();if(e.right>t.left){return true}}}if(typeof h.elements.firstMenuItem==="undefined"){h.elements.firstMenuItem=WH.qs(".header-nav a:first-child")}if(h.elements.firstMenuItem&&e){return e.top>h.elements.firstMenuItem.getBoundingClientRect().top}return false}if(a&&!(h.featuredNavCompact&&document.body.dataset.hideFeaturedNavWhileScrolling!=="true")){let i=h.responsiveNavStep[t];let n=h.elements.headerNav.getBoundingClientRect().top;let s=C(t,n,a,i);if(typeof s==="number"){if(e>h.responsiveNavStepWidths[t][s-1]){h.responsiveNavStepWidths[t][s-1]=e}if(s!==i){h.updateSearchWidth=true}}else{return true}}return false}function I(e){if(!f.STANDARD_TYPE){return false}let t=h.elements.header.dataset.logo==="small";let i=h.elements.search.offsetWidth;if(e<h.logoShrinkViewportWidth||!t&&i<u){if(!t&&h.logoShrinkViewportWidth<e){h.logoShrinkViewportWidth=e}h.elements.header.dataset.logo="small";if(t&&i&&i<u){return true}}else if(e>h.logoShrinkViewportWidth&&t){delete h.elements.header.dataset.logo;if(h.elements.search.offsetWidth<u){h.logoShrinkViewportWidth=e;h.elements.header.dataset.logo="small";if(h.elements.search.offsetWidth<u){return true}}}return false}function N(){if(h.mobileMode){return}e.updateHeaderOffset()}function R(e){if(h.mobileMode){return}let t=g();let i=window.scrollY;D(i,t);q(i,t,e);U(i)}function M(){let e=h.mobileMode;let t=window.innerWidth;h.mobileMode=t<=h.maxMobileNavigationWidth;if(!h.mobileMode){if(w(t)){m(t)}}if(!h.mobileMode&&h.elements.search&&I(t)){m(t)}if(!h.mobileMode&&S(t)){m(t)}return h.mobileMode!==e}function A(e,t){if(h.responsiveNavStep[e]===t){return}h.responsiveNavStep[e]=t;document.body.dataset.responsiveNavStep=""+t}function k(e,t,i){let a=e.getBoundingClientRect();if(t.left!==a.left||t.top!==a.top||i&&e.classList.contains(r)){Menu.hide(true)}}function C(e,t,i,a){if(i.getBoundingClientRect().top!==t){let n=a+1;if(n>c){return null}A(e,n);return C(e,t,i,n)}return a}function L(){if(h.navOverflowMenu.length===0){h.elements.headerNavEllipsis.classList.add(r)}else{h.elements.headerNavEllipsis.classList.remove(r);h.navOverflowMenu.reverse()}if(h.featuredNavOverflowMenu.length===0){h.elements.headerNavFeaturesEllipsis.classList.add(r)}else{h.elements.headerNavFeaturesEllipsis.classList.remove(r)}}function O(e,t){if(h.mobileMode||!h.featuredNavCompact||h.featuredNavOverflowMenu.length!==h.elements.headerNavFeaturesLinks.length&&document.body.dataset.hideFeaturedNavWhileScrolling!=="true"){return}let i=h.responsiveNavStep[_()]-1;let a=e<=h.featuredNavCompactHiddenViewportWidths[i];if(!a){let t=h.elements.headerNavFeaturesEllipsis.getBoundingClientRect();let n=h.elements.headerNavFeatures.getBoundingClientRect();if(t.width>n.width||t.top!==n.top){h.featuredNavCompactHiddenViewportWidths[i]=e;a=true}}if(t!==true||t===true&&a){document.body.dataset.hideFeaturedNavWhileScrolling=JSON.stringify(a)}if(t!==true&&!a){O(e,true)}}function D(e,t){if(t!==null){document.body.dataset.fixedHeader=JSON.stringify(e>=t)}let i=a.getFullscreenMode()&&e>=(t||0)+70;if(h.hiddenHeader!==i){h.hiddenHeader=i;document.body.dataset.hideHeader=JSON.stringify(h.hiddenHeader)}}function x(e){if(h.mobileMode||!h.elements.headerNav){return}let t=window.innerWidth;let i=_();if(h.navOverflowLastNavState===i&&h.navOverflowLastResponsiveStep[i]===h.responsiveNavStep[i]&&h.navOverflowLastViewportWidth[i]===t&&e!==true){return}h.navOverflowLastNavState=i;h.navOverflowLastResponsiveStep[i]=h.responsiveNavStep[i];h.navOverflowLastViewportWidth[i]=t;if(f.CLASSIC){b();h.navOverflowMenu.length=0;for(let e=0,t=h.elements.collapsibleNavLinks.length;e<t;e++){h.elements.collapsibleNavLinks[e].classList.remove(r)}let e=h.elements.headerUser.getBoundingClientRect();for(let t=0;t<h.collapsibleNavLinkCount;t++){let i=h.elements.collapsibleNavLinks[t];if(H().getBoundingClientRect().right>e.left){i.classList.add(r);h.navOverflowMenu.push(i.menuItem)}else{i.classList.remove(r)}}L();return}let a=0;if(h.featuredNavCompact){T();for(let e=0,t=h.elements.collapsibleNavLinks.length;e<t;e++){h.elements.collapsibleNavLinks[e].classList.remove(r)}h.navOverflowMenu.length=0;h.featuredNavOverflowMenu.length=0;let e=v(h.elements.headerNavFeatures,h.elements.headerNavFeaturesEllipsis);let i=false;for(let t=0,n=h.elements.headerNavFeaturesLinks.length;t<n;t++){let s=h.elements.headerNavFeaturesLinks[t];if(!i){let r=t===n-1;a=p(a,e,s,r);i=y(e,s,r)}if(i){s.classList.add(r);h.featuredNavOverflowMenu.push(s.menuItem)}else{s.classList.remove(r)}}L();O(t)}else{b();h.navOverflowMenu.length=0;let e=v(h.elements.headerNav,h.elements.headerNavEllipsis);for(let t=0,i=h.elements.headerNavLinks.length;t<i;t++){let n=h.elements.headerNavLinks[t];if(a<h.collapsibleNavLinkCount&&!n.classList.contains(r)){a=p(a,e,n,t===i-1)}}L()}}function P(e){if(!e){document.body.classList.add("no-header")}else{document.body.classList.remove("no-header")}}function U(t){if(h.hiddenHeader){return}let i=a.getElement("main-contents");if(!i||!h.elements.headerWrapper){if(document.readyState==="complete"){U=function(){}}return}let n=t+i.getBoundingClientRect().bottom-h.elements.headerWrapper.getBoundingClientRect().height;if(t>=n){if(!h.navScrollLimitEnabled){h.elements.headerWrapper.style.position="absolute";h.elements.headerWrapper.style.top=n+"px";h.elements.headerWrapper.style.transition="none";h.navScrollLimitEnabled=true}}else{if(h.navScrollLimitEnabled){e.disableNavScrollLimit()}}}function q(t,n,s){n=n||0;let r=a.getFullscreenMode()||(f.CLASSIC_TYPE?h.shrinkHeader&&t>n+15||!h.shrinkHeader&&t>=n+70:t>=n+70);if(h.shrinkHeader===r&&s!==true){return}let o=Menu.getOpener();let l;if(o&&WH.closest(o,".header-wrapper")){l=o.getBoundingClientRect()}h.shrinkHeader=r;h.featuredNavCompact=r&&f.STANDARD_TYPE;document.body.dataset.shrinkHeader=JSON.stringify(r);document.body.dataset.navLayout=_();F();x(s);if(h.featuredNavCompact){requestAnimationFrame(x.bind(e,true))}if(l){let e=k.bind(this,o,l,r);if(f.CLASSIC_TYPE){requestAnimationFrame((function(){requestAnimationFrame(e)}))}else{e()}}i.checkAll();if(WH.Theme.isClassicType()){setTimeout(i.checkAll,150)}e.check(f.CLASSIC_TYPE)}function F(){if(!f.STANDARD_TYPE||h.mobileMode){return}let e=W();let t=h.elements.headerNavWrapper.getBoundingClientRect();let i=t.right-e.getBoundingClientRect().left+10;if(h.featuredNavCompact){i+=17;h.elements.headerNavWrapper.style.paddingRight=i+"px";h.elements.headerNav.style.paddingRight=""}else{h.elements.headerNav.style.paddingRight=i+"px";h.elements.headerNavWrapper.style.paddingRight=""}}};WH.Layout.User=new function(){const e=this;const t=WH.Url;const i={userMenu:undefined};this.createDebugQueueElement=function(){var e=WH.qs(".header-user");if(!e){WH.error("Cannot create debug queue element, .header-user not found.");return undefined}var t=a(e,"debug-messages","Debug Messages");WH.aef(e,t);return t};this.getLocaleMenu=function(){let e=location.pathname+location.search+location.hash;let t=Locale.getId();let i=[Menu.createHeading({label:WH.TERMS.language})];let a=WH.getPageData("layout.user.preferredLanguageTips")||{};let n=function(e,i,n){if(!a.hasOwnProperty(e)){return}let s=Locale.getName(i);let r="";if(n){r=WH.TERMS[WH.getDataEnvTerm()]}else{r=WH.GlobalStrings["LFG_LIST_LANGUAGE_"+s.toUpperCase()]||Locale.getDescription(i)}let o=[WH.Strings.sprintf(a[e][t],r)];if(i!==t){o.push(WH.Strings.sprintf(a[e][i],n?a[WH.getDataEnvTerm()][i]:Locale.getDescription(i)))}return o.map(WH.Strings.escapeHtml).join("<br>")};let s=function(e){let t=e[Menu.ITEM_CRUMB];if(Locale.getPreferred()===t){return n("preferredLanguageRemove_format",t,false)}if(e[Menu.ITEM_URL]){return n("preferredLanguageUse_format",t,false)}return n("preferredLanguageSet_format",t,false)};let r=function(e){let t=e[Menu.ITEM_CRUMB];let i=Menu.getItemOptions(e).extraActions[0];i.fontIcon=Locale.getPreferred()===t?"star":"star-o"};$.each(Locale.getAllByName(),(function(a,o){let l=WH.Url.generate(e,{locale:o.id});if(l===location.href){l=undefined}let c=Menu.createItem({crumb:o.id,label:o.description,url:l,options:{checkedFunc:function(){return o.id===t},extraActions:[{fontIcon:"star-o","data-preferred-locale":o.id,callback:function(e){if(Locale.getPreferred()===o.id){Locale.setPreferred(null)}else{Locale.setPreferred(o.id);if(l&&o.id!==t){location.href=l}}WH.qsa(".menu-item [data-preferred-locale]").forEach((function(e){let t=parseInt(e.dataset.preferredLocale);let a=Menu.findItem(i,[t]);r(a);let n=Menu.getItemOptions(a).extraActions[0];e.classList.remove("fa-star","fa-star-o");e.classList.add("fa-"+n.fontIcon)}));let a=Menu.findItem(i,[o.id]);let n=s(a);if(n){WH.Tooltip.show(e.target,n,false,false,"q2")}}}],onBeforeShow:r}});let u=Menu.getItemOptions(c);u.extraActions[0].tooltipText=s.bind(null,c);if(!l&&t!==o.id){u.className="q10";let e=n("languageNotAvailable_format",o.id,true);if(e){u.attributes={"data-simple-tooltip":WH.ce("span",{className:"q10",innerHTML:e}).outerHTML}}}i.push(c)}));return i};this.getProfilerMenu=function(){if(!g_user.lists){return null}var e=[];var t=[["refresh",WH.TERMS.refreshcharacterlist,"/account=battlenet",null,{icon:WH.staticUrl+"/images/icons/battlenet.png"}]];var i=[],a=[],n=[],s=[];g_user.lists.sort((function(e,t){return WH.stringCompare(e.realm,t.realm)||WH.stringCompare(e.name,t.name)}));var r=false;$.each(g_user.lists,(function(e,t){if(t.mode==1){if(t.pinned>0){i.push(WH.Profiler.getMenuItem(t,true))}if(r&&r!=t.realm){if(a.length){a.unshift([undefined,r])}a.push([undefined,t.realm])}r=t.realm;a.push(WH.Profiler.getMenuItem(t))}else{s.push(WH.Profiler.getMenuItem(t))}}));var o=0,l,c,u;var d=function(e,t){var i=0+t;return function(t){if(t){return}for(var a=0;a<e.length;a++){if(e[a][0]==i){e.splice(a--,1)}}}};if(g_user.battlenetChars&&g_user.battlenetChars.length){g_user.battlenetChars.sort((function(e,t){return WH.stringCompare(e.region,t.region)||WH.stringCompare(e.realm,t.realm)||WH.stringCompare(e.name,t.name)}));r=false;for(var f=0;f<g_user.battlenetChars.length;f++){c=g_user.battlenetChars[f];if(c.level<10){continue}l=WH.Strings.slug(c.region+" "+c.realm+" "+c.name,true);u=false;for(var h=0;h<g_user.lists.length;h++){if(g_user.lists[h].url==l){u=true;break}}if(u){continue}if(r&&r!=c.realm){if(n.length){n.unshift([undefined,r])}n.push([undefined,c.realm])}r=c.realm;o--;n.push([o,c.name,"/list/"+l+"?private",null,{className:"listmanager-mode1"}]);WH.BlizzardApi.characterExists(c.region,c.realm,c.name,d(n,o))}}var p=0;if(a.length)p++;if(n.length)p++;if(s.length)p++;if(a.length+n.length+s.length<=12||p<=1){if(a.length){e.push([undefined,WH.TERMS.profiles]);e.push.apply(e,a)}if(n.length){e.push([undefined,WH.TERMS["import"]]);e.push.apply(e,t.concat(n))}if(s.length){e.push([undefined,WH.TERMS.customlists]);e.push.apply(e,s)}}else{if(i.length){Menu.sort(i);e.push([undefined,WH.TERMS.pinnedprofiles]);e.push.apply(e,i);e.push([undefined,WH.TERMS.goal])}if(a.length){e.push([1,WH.TERMS.profiles,null,a])}if(n.length){e.push([1,WH.TERMS["import"],null,t.concat(n)])}if(s.length){e.push([1,WH.TERMS.customlists,null,s])}}return e};this.getUserMenu=function(){if(i.userMenu){return i.userMenu}let e=[];var t=["user-page",WH.TERMS.userpage,"/user="+g_user.name,null,{checkedUrl:new RegExp("user="+g_user.name+"$","i"),fontIcon:"user"}];e.push(t);var a=["settings",WH.TERMS.settings,"/account",null,{fontIcon:"cog",checkedUrl:/account(?!=premium|\/guides)/i}];e.push(a);if(WH.Notifications.browserSupportsNotifications()){e.push(["notifications",WH.TERMS.notificationSettings,"/notifications/settings",null,{fontIcon:"bell",checkedUrl:/^notifications\/settings/i}])}if(WH.User.isPremium()){e.push(["premium",WH.TERMS.premiumsettings,"/account=premium",null,{checkedUrl:/account=premium/i,fontIcon:"star"}])}else{e.push(["premium-upgrade",WH.TERMS.premiumsettings,"/premium",null,{className:"premium-upgrade",checkedUrl:/premium/i,fontIcon:"star"}])}var r=WH.TERMS.reputation;if(g_user.reputation){r=WH.Strings.sprintf(WH.TERMS.parens_format,WH.TERMS.reputation,WH.Strings.formatNumber(g_user.reputation))}var o=["reputation",r,"/reputation",null,{fontIcon:"trophy"}];e.push(o);let l=n();if(l){e.push(l)}var c=s();if(c){e.push(c)}e.push(["sign-out",WH.TERMS.signout,"/account=signout"]);e.push(["sign-out-global",WH.TERMS.logOutEverywhere,"/account=signout?global"]);i.userMenu=e;return e};this.init=function(){var t=WH.qs(".header");if(!t){return}var i=WH.ce("div",{className:"header-user"});WH.ae(t,i);if(WH.User.isLoggedIn()){r(i)}else{o(i)}let n=a(i,"fullscreen",WH.Layout.getFullscreenMode()?WH.TERMS.exitFullscreen:WH.TERMS.fullscreen);WH.aE(n,"click",WH.Layout.toggleFullscreenMode);if(!WH.Theme.isClassicType()){WH.Tooltip.simple(n,(function(){let e=WH.Layout.getFullscreenMode()?WH.TERMS.exitFullscreenMode:WH.TERMS.enterFullscreenMode;return WH.ce("div",{className:"no-wrap"},WH.ct(e)).outerHTML}),"q2")}if((!WH.Theme.isClassicType()||!WH.User.isLoggedIn())&&WH.Notifications.browserSupportsNotifications()){let e=a(i,"notifications",WH.TERMS.notifications,"/notifications/settings");let t=WH.qs("span",e);if(!t||window.getComputedStyle(t).display==="none"){WH.Tooltip.simpleNonTouch(e,WH.TERMS.notificationSettings,"q2")}}var s=a(i,"feedback",WH.TERMS.feedback);WH.aE(s,"click",ContactTool.show.bind(ContactTool,undefined));var l=WH.qs("span",s);if(!l||window.getComputedStyle(l).display==="none"){WH.Tooltip.simpleNonTouch(s,WH.TERMS.feedback,"q2")}var c=a(i,"lang",Locale.getDescription());Menu.add(c,e.getLocaleMenu(),{padded:true})};function a(e,t,i,a){var n=WH.ce("a",{className:"header-user-"+t});if(i){WH.ae(n,WH.ce("span",undefined,WH.ct(i)))}n.href=a||"javascript:";WH.ae(e,n);return n}function n(){let e=WH.getPageData("guide.myRecent");if(!e||!e.count){return}let t=[];e.list.forEach((function(e){let i={extraActions:[{fontIcon:"pencil",url:"/guide=edit&id="+e.id,tooltipText:WH.TERMS.edit}]};if(!e["public"]){i.rel="np"}if(e.classId){i.className="c"+e.classId;if(e.specId){i.tinyIcon=WH.Wow.PlayerClass.Specialization.getIconName(e.specId)}else{i.tinyIcon=WH.Wow.PlayerClass.getIconName(e.classId)}}t.push(Menu.createItem({crumb:e.id,label:e.name,url:e.url,options:i}))}));return Menu.createItem({crumb:"guides",label:WH.TERMS.myguides,url:"/account/guides",submenu:t,options:{fontIcon:"book",checkedUrl:/account\/guides/i}})}function s(){if(!g_user.lists||!g_user.lists.length){return null}var t={onBeforeShow:function(t){Menu.setSubmenu(t,e.getProfilerMenu())},zulGetMobileMenu:function(){return Menu.prepareForZul(e.getProfilerMenu())},zulHref:function(e,t,i,a){return i?false:"/user="+g_user.name},fontIcon:"users"};for(var i=0;i<g_user.lists.length;i++){if(g_user.lists[i].thumbnail){delete t.icon;t.armory=WH.BlizzardApi.getCharacterThumbnailUrl(g_user.lists[i].region,g_user.lists[i].thumbnail)}}return["lists",WH.TERMS.myprofiles,"/user="+g_user.name+"#lists",null,t]}function r(t){if(WH.User.hasRole(U_GROUP_STAFF)){a(t,"staff",WH.TERMS.staffemployees)}a(t,"favorites",WH.TERMS.favorites);WH.Favorites.refreshMenu();var i=WH.Profiler.getFavorite();if(i){var n=WH.Profiler.getAvatarUrl(i);if(n){var s=a(t,"profile",undefined,WH.Profiler.getPath(i));s.style.background="url("+n+")";var r=e.getProfilerMenu();if(r&&r.length){Menu.add(s,r,{padded:true})}}}var o=WH.User.getUsername();var l=WH.User.getReputation();if(l){o=WH.Strings.sprintf(WH.TERMS.parens_format,o,WH.Strings.formatNumber(l))}var c=a(t,"user",o,WH.User.getPath());Menu.add(c,e.getUserMenu(),{padded:true})}function o(e){var i=WH.ce("a",{className:"header-user-text",href:WH.Url.getLoginPath()},WH.ce("span",undefined,WH.ct(WH.TERMS.login+WH.TERMS.colon_punct)));WH.ae(e,i);var n="/account=battlenet?r=1";var s=a(e,"bnet btn btn-blizzard",WH.TERMS.battlenet,n);WH.aE(s,"click",(function(){WH.visitUrlWithPostData("/account=battlenet",{r:1});return false}));var r="/account=signin";var o=(location.pathname+location.search).substr(1);if(o&&o.indexOf("account=signin")===0){o=WH.getGets().next||""}if(o){r+="?next="+encodeURIComponent(o)}var l=a(e,"fanbyte btn btn-fanbyte",WH.TERMS.fanbyte,r);WH.Tooltip.simpleNonTouch(l,WH.TERMS.fanbyteNameChange_tip,undefined,undefined,true);var c="btn btn-site fa fa-user-plus fa-fw";a(e,"register "+c,WH.TERMS.register,t.getRegistrationPath())}};Listview.Filters=function(e){const t=this;const i=WH.DOM;const a="all";const n="any";const s=a;const r=[a,n];const o=1;const l=2;const c=3;const u=4;const d=5;const f=6;const h=7;const p={">":o,"=":l,"<":c,">=":u,"<=":d};const m={};m[o]=">";m[l]="=";m[c]="<";m[u]=">=";m[d]="<=";m[f]=WH.TERMS.min+"-"+WH.TERMS.max;m[h]=WH.TERMS.text;const g={};g["default"]=[{type:o,text:m[o]},{type:u,text:m[u]},{type:l,text:m[l]},{type:d,text:m[d]},{type:c,text:m[c]},{type:f,text:m[f]}];g[Listview.COLUMN_TYPE_TEXT]=[{type:h,text:m[h]},{type:o,text:m[o]},{type:u,text:m[u]},{type:l,text:m[l]},{type:d,text:m[d]},{type:c,text:m[c]},{type:f,text:m[f]}];const H={NUMBER:/(>|=|<|>=|<=)\s*(-?[0-9.]+)/,RANGE:/(-?[0-9.]+)\s*-\s*(-?[0-9.]+)/};const W=[Listview.COLUMN_ID_COMPLETION,Listview.COLUMN_ID_DEBUG_ID,Listview.COLUMN_ID_POPULARITY];const v={};v[o]=function(e,t){return t>e};v[l]=function(e,t){return t==e};v[c]=function(e,t){return t<e};v[u]=function(e,t){return t>=e};v[d]=function(e,t){return t<=e};v[f]=function(e,t){return e.min<=t&&t<=e.max};const _={};_[o]=function(e,t){return t.max>e};_[l]=function(e,t){return t.min<=e&&e<=t.max};_[c]=function(e,t){return t.min<e};_[u]=function(e,t){return t.max>=e};_[d]=function(e,t){return t.min<=e};_[f]=function(e,t){return e.min<=t.max&&t.min<=e.max};const T={elements:{columnFilters:undefined,container:undefined,match:{all:undefined,any:undefined,container:undefined},reset:undefined,tableFilter:undefined,tableFilterIcon:undefined,tableFilterClear:undefined},filters:[],hasFilterableColumns:false,listview:undefined,matchType:s};this.apply=function(){WH.Tooltip.hide();he();t.applyDataOnly();fe();T.listview.validatePage();T.listview.updateNav();T.listview.refreshRows();T.listview.updateBrowseSession();T.listview.writeHash()};this.focus=function(){se();if(T.listview.searchable&&T.elements.tableFilter){WH.safeFocus(T.elements.tableFilter)}};this.reset=function(){while(T.filters.length){let e=T.filters.pop();if(e.column){S(e.column)}}if(T.elements.columnFilters){WH.ee(T.elements.columnFilters)}if(T.elements.tableFilter){T.elements.tableFilter.value=""}T.matchType=s;if(T.elements.match[s]){T.elements.match[s].checked=true}T.listview.resetRowVisibility();t.apply()};this.resetAndFocus=function(){requestAnimationFrame(X)};this.applyDataOnly=function(){T.listview.resetRowVisibility(true);if(!T.filters.length&&!T.listview.customFilter&&!T.listview.classFilter){return}let e=[];let t=C();for(let i=0,a;a=t[T.listview.visibility[i]];i++){if(!W.includes(a.id)&&q(a)){e.push(a)}}let i=0;let a=T.matchType===n?ce:le;for(let t=0,n=T.listview.data.length;t<n;t++){let n=T.listview.data[t];n.__hidden=true;if(T.listview.customFilter&&!T.listview.customFilter(n,t)){continue}if(T.listview.customFilter2&&!T.listview.customFilter2(n,t)){continue}if(T.listview.classFilter&&!T.listview.classFilter(n,t)){continue}if(n.__alwaysvisible||!T.filters.length||a(n,e)){n.__hidden=false;i++}}T.listview.filtered=i<T.listview.data.length;T.listview.nRowsVisible=i};this.getColumnTooltipAdditions=function(e){let t=T.filters.filter((function(t){return(t.column||{}).id===e.id}));if(!t.length){return null}t.sort((function(e,t){WH.stringCompare(e.invert,t.invert)}));let i=WH.ce("div","no-wrap");for(let e=0,a;a=t[e];e++){WH.ae(i,WH.ce("div",undefined,WH.ct((a.invert?WH.TERMS.invertedFilter_stc:WH.TERMS.filter)+WH.TERMS.colon_punct+P(a,true))))}return i};this.getHashParts=function(){let e=[];let t=[];let i=[];for(let e=0,a;a=T.filters[e];e++){if(!a.enabled){continue}let e=encodeURIComponent(P(a));if(a.column){i.push(a.column.id+"="+e)}else{t.push("q="+e)}}let a=t.length+i.length>1;if(t=t.join(";")){e.push(t)}if(i=i.join(";")){e.push(i)}if(a&&T.matchType!==s){e.push("match"+WH.ucfirst(T.matchType))}return e};this.getOptionsToggle=function(){if(T.listview.searchable||T.hasFilterableColumns){let e=WH.ce("a",{className:"listview-option-button listview-option-button-filters fa fa-filter",href:"javascript:"});WH.aE(e,"click",z);WH.Tooltip.simpleNonTouch(e,x,"q2");return e}else{return null}};this.isColumnFiltered=function(e){for(let t=0,i;i=T.filters[t];t++){if(i.column.id===e.id&&i.enabled){return true}}return false};this.readHashPart=function(e){let t=e.match(/^q=(.*)$/);if(t){if(T.listview.searchable){te(decodeURIComponent(t[1]),{skipApply:true})}return}e.split(",").forEach((function(e){let t=e.match(/^([A-Za-z0-9_]+)=(.+)$/);if(t){let e=decodeURIComponent(t[1]);let i=decodeURIComponent(t[2]);let a=C();for(let t=0,n;n=a[t];t++){if(n.id===e&&T.listview.isColumnVisible(n)&&q(n)){te(i,{column:n,skipApply:true,allowDuplicateColumns:true});break}}return}let i=e.match(/^match([A-Za-z]+)$/);if(i){ae(i[1].toLowerCase(),true)}}))};function b(){return!!T.listview.container.dataset.filters}function E(){let e=WH.ce("div",{className:"listview-filters"});if(T.listview.searchable){let t=T.listview._truncated?WH.TERMS.searchwithindisplayedresults_ellipsis:WH.TERMS.searchAllColumns_ellipsis;let i=WH.ce("div",{className:"listview-filters-table"});if(T.listview.tabClick){WH.aE(i,"click",T.listview.tabClick)}T.elements.tableFilterIcon=WH.ce("span",{className:i.className+"-search-icon fa fa-search"});WH.ae(i,T.elements.tableFilterIcon);let a=WH.ce("input",{placeholder:t,style:{width:T.listview._truncated?"20em":"16em"},type:"text"});T.elements.tableFilter=a;for(let e=0,t;t=T.filters[e];e++){if(!t.column){a.value=t.invert+P(t);break}}WH.aE(a,"keyup",he);WH.onAfterTyping(a,K.bind(a),T.listview.searchDelay);WH.aE(a,"blur",(function(){if(this.value&&this.value.trim()===""){this.value=""}}));WH.aE(a,"keypress",T.listview.submitSearch.bind(this));WH.ae(i,a);T.elements.tableFilterClear=WH.ce("a",{className:i.className+"-clear fa fa-times-circle",href:"javascript:",style:{display:"none"}});WH.aE(T.elements.tableFilterClear,"click",(function(){a.value="";a.placeholder=t;K.call(a)}));WH.ae(i,T.elements.tableFilterClear);WH.ae(e,i)}T.elements.columnFilters=WH.ce("div",{className:"listview-filters-columns"});WH.ae(e,T.elements.columnFilters);let t=WH.ce("div",{className:"listview-filters-actions"});WH.ae(e,t);let i=WH.ce("a",{className:"fa fa-plus",href:"javascript:"},WH.ct(WH.TERMS.addColumnFilter_ellipsis));Menu.add(i,R,{showAtElement:true});WH.ae(t,i);T.elements.match.container=WH.ce("div",undefined,WH.ct(WH.TERMS.match+WH.TERMS.colon_punct));WH.ae(t,T.elements.match.container);let s="listview-match-"+WH.Strings.guid();let r=WH.ce("label",undefined,WH.ct(WH.TERMS.all));T.elements.match.all=WH.ce("input",{name:s,type:"radio"});WH.aef(r,T.elements.match.all);WH.ae(T.elements.match.container,r);let o=WH.ce("label",undefined,WH.ct(WH.TERMS.any));T.elements.match.any=WH.ce("input",{name:s,type:"radio"});WH.aef(o,T.elements.match.any);WH.ae(T.elements.match.container,o);T.elements.match[T.matchType].checked=true;WH.aE(T.elements.match.all,"change",(function(){ae(a)}));WH.aE(T.elements.match.any,"change",(function(){ae(n)}));T.elements.reset=WH.ce("a",{className:"fa fa-times",href:"javascript:"},WH.ct(WH.TERMS.reset));WH.aE(T.elements.reset,"click",X);WH.ae(t,T.elements.reset);return e}function y(e,i){e.enabled=false;if(!t.isColumnFiltered(e.column)){S(e.column)}if(i){e.elements.wrapper.dataset.showError="true";WH.st(e.elements.error,i)}else{delete e.elements.wrapper.dataset.showError}t.apply()}function S(e){if(e.__th){e.__th.firstChild.firstChild.classList.remove("q5")}}function w(e){if(e.__th){e.__th.firstChild.firstChild.classList.add("q5")}}function I(e){se();e.elements.text.focus()}function N(e,a){const n="listview-filters-columns-filter";let s=WH.ce("div",{className:n});let r=WH.ce("a",{className:n+"-remove",href:"javascript:"});WH.aE(r,"click",V.bind(r,s));WH.Tooltip.simpleNonTouch(r,WH.TERMS.removefilter_stc,"q10",true);WH.ae(s,r);let o=i.createImitationSelect({text:M(e)});o.classList.add(n+"-name");Menu.add(o,R.bind(undefined,s,o),{showAtElement:true});WH.ae(s,o);let l=i.createImitationSelect({text:WH.TERMS.error});l.classList.add(n+"-operator");Menu.add(l,A.bind(undefined,s,l),{showAtElement:true});WH.ae(s,l);let c=WH.ce("div",{className:n+"-text-wrapper"});WH.ae(s,c);let u=WH.ce("input",{className:n+"-text",type:"text"});WH.onAfterTyping(u,$.bind(u,s,u),T.listview.searchDelay);WH.ae(c,u);let d=WH.ce("div",{className:n+"-range"},WH.ct("-"));WH.ae(c,d);let f=WH.ce("input",{className:n+"-text2",type:"text"});WH.onAfterTyping(f,$.bind(f,s,f),T.listview.searchDelay);WH.ae(c,f);let p=WH.ce("input",{className:n+"-invert",type:"checkbox"});let m=WH.ce("label",{className:n+"-invert-label",href:"javascript:"},p);WH.ae(m,WH.ct(WH.TERMS.invert));WH.aE(p,"change",F.bind(p,s,p));WH.ae(s,m);let g=WH.ce("span",{className:n+"-error"});WH.ae(s,g);if(a){WH.st(o,M(a.column));ne(l,s,a.operator);u.value=a.text;f.value=a.text2;p.checked=!!a.invert}else{if(e.type===Listview.COLUMN_TYPE_TEXT){a={column:e,elements:undefined,enabled:false,invert:"",operator:h,test:undefined,text:"",text2:""};ne(l,s,a.operator);T.filters.push(a);fe()}else{let i=false;try{a=D(">0",e)}catch(e){WH.error(e.message||e);i=true}if(!a||i){let t="Could not create empty numeric filter.";WH.error(t,e.id,e);alert(t);throw new Error(t)}T.filters.push(a);w(a.column);ne(l,s,a.operator);u.value=a.text;f.value=a.text2;t.apply()}}s.__listviewFilter=a;a.elements={error:g,operator:l,text:u,text2:f,wrapper:s};return s}function R(e,t){let i=[];let a;let n;if(e){i.push(Menu.createHeading({label:WH.TERMS.changeColumn_ellipsis}));let s=k(e);a=B.bind(undefined,s,t);n=s.column.id}else{a=G.bind(undefined)}let s=C();for(let e=0,t;t=s[T.listview.visibility[e]];e++){if(!q(t)){continue}if(t.id===Listview.COLUMN_ID_DEBUG_ID){let e=Menu.createItem({label:WH.Strings.sprintf(WH.TERMS.parens_format,M(t),WH.TERMS.staffonly_stc),url:a.bind(undefined,t)});e.checked=t.id===n;i.push(e);continue}let e=Menu.createItem({label:M(t),url:a.bind(undefined,t)});e.checked=t.id===n;i.push(e)}return i}function M(e){return e.tooltip||e.name||e.id}function A(e,t){let i=[];let a=k(e);let n=g[a.column.type]||g["default"];for(let e=0,s;s=n[e];e++){let e=Menu.createItem({label:s.text,url:Y.bind(undefined,a,t,s)});e.checked=s.type===a.operator;i.push(e)}return i}function k(e){return e.__listviewFilter}function C(){return T.listview.sortOptions||T.listview.columns||[]}function L(e,t){let i=T.listview.template.getVisibleText?(""+T.listview.template.getVisibleText(e)).trim():"";if(t.getVisibleText){return i+t.getVisibleText(e)}if(t.getValue){return i+t.getValue.call(T.listview,e)}if(t.value){return i+e[t.value]}if(t.compute){return i+t.compute.call(T.listview,e,WH.ce("td"),WH.ce("tr"),t.__index)}return""}function O(e){return e?e.type||Listview.COLUMN_TYPE_NUMBER:Listview.COLUMN_TYPE_TEXT}function D(e,t){e=e.replace(/\s+/g," ").trim();let i={elements:undefined,enabled:true,invert:"",test:undefined,text:"",text2:""};if(t){i.column=t}let a=O(t);if(e){if(e.charAt(0)==="!"||a===Listview.COLUMN_TYPE_TEXT&&e.charAt(0)==="-"){i.invert="!";e=e.substr(1)}let t;if(e.match(H.NUMBER)){t=ee(RegExp.$2);if(!Q(t)){i.operator=p[RegExp.$1];i.value=t;i.text=""+t}}else if(e.match(H.RANGE)){t={min:ee(RegExp.$1),max:ee(RegExp.$2)};if(!Q(t.min)&&!Q(t.max)){if(t.min===t.max){i.operator=l;i.value=t.min;i.text=""+t.min}else{if(t.min>t.max){let e=t.min;t.min=t.max;t.max=e}i.operator=f;i.value=t;i.text=""+t.min;i.text2=""+t.max}}}else{let n=e.toLowerCase().split(" ");if(a===Listview.COLUMN_TYPE_TEXT){i.operator=h;i.text=e;if(i.invert){i.regExp=WH.createOrRegex(e)}else{i.words=n}}else if(n.length===1&&!Q(t=ee(n[0]))&&""+t===n[0]){i.operator=l;i.value=t;i.text=""+t}}}if(e&&!i.operator){throw new Error(WH.TERMS.invalidfilter_stc)}if(!i.text){return null}ie(i);return i}function x(){return WH.ce("div",{className:"no-wrap"},WH.ct(b()?WH.TERMS.hidefilteroptions_stc:WH.TERMS.filterTheseResults_stc)).outerHTML}function P(e,t){let i=t?"":e.invert;switch(e.operator){case f:return i+e.text+"-"+e.text2;case h:return i+e.text;default:if(!m[e.operator]){let t="Could not generate simple filter text for unsupported filter operator.";WH.error(t,e.operator);alert(t);throw new Error(t)}return i+m[e.operator]+e.text}}function U(e){T.listview=e;if(T.listview.filtrable){let e=C();for(let t=0,i;i=e[t];++t){if(!q(i)){continue}if(!T.hasFilterableColumns&&T.listview.isColumnVisible(i)){T.hasFilterableColumns=true}if(i.actions){i.actions.unshift({action:j.bind(undefined,i),name:WH.TERMS.filter,tooltipText:WH.TERMS.rightClickToFilter_stc})}}}}function q(e){return e.id&&(e.filtrable==null||e.filtrable)}function F(e,t){let i=k(e);i.invert=this.checked?"!":"";let a=Z(i);if(!a.success){y(i,a.error)}}function $(e,t){let i=k(e);let a=t.value.trim();let n=t.className.indexOf("text2")===-1?"text":"text2";if(i[n]===a){return}if(i.enabled){if(a){if(i[n]!==a){i[n]=a;let e=Z(i);if(!e.success){y(i,e.error)}}}else{i[n]=a;y(i)}}else{if(a){i[n]=a;let e=Z(i);if(!e.success){y(i,e.error)}}else{delete i.elements.wrapper.dataset.showError}}}function B(e,i,a){if(e.column.id===a.id){t.apply();return}let n=e.column;e.column=a;WH.st(i,M(a));let s=Z(e);if(!s.success){y(e,s.error)}if(!t.isColumnFiltered(n)){S(n)}I(e)}function G(e){let t=N(e);WH.ae(T.elements.columnFilters,t);I(k(t))}function Y(e,i,a){if(e.operator===a.type){t.apply();return}let n=e.operator;e.operator=a.type;ne(i,e.elements.wrapper,e.operator);if(a.type===f){if(n===h){let t=ee(e.text);if(!Q(t)){e.text=""+t;e.value=t;e.elements.text.value=e.text}else{e.text="0";e.value=0;e.elements.text.value=e.text}}if(!e.text2||e.text2===e.text){e.text2=(e.value||0)+1;e.elements.text2.value=e.text2}}let s=Z(e);if(!s.success){y(e,s.error)}I(e)}function z(e){if(!T.listview.container.dataset.filters){se();if(T.listview.searchable&&T.elements.tableFilter){T.elements.tableFilter.focus()}}else{delete T.listview.container.dataset.filters}if(!Platform.isTouch()){WH.Tooltip.showAtCursor(e,x(),undefined,undefined,"q2")}}function V(e){let i=k(e);WH.de(e);let a=T.filters.indexOf(i);if(a!==-1){T.filters.splice(a,1);if(!t.isColumnFiltered(i.column)){S(i.column)}t.apply()}Menu.hide(true);WH.Tooltip.hide()}function j(e){for(let t=0,i;i=T.filters[t];t++){if(i.column&&i.column.id===e.id){I(i);return}}let t=e.type===Listview.COLUMN_TYPE_TEXT?WH.TERMS.examplefilter_tip:WH.TERMS.examplefilter2_tip;let i=prompt(WH.sprintf(WH.TERMS.columnfilter_format+"\n\n"+t,M(e)));if(i!==null){let t=te(i,{column:e});if(t){I(t)}}}function K(){te(this.value)}function Z(e){let t={success:false};try{let i=D(P(e),e.column);if(i){J(e,i);ne(i.elements.operator,i.elements.wrapper,i.operator);let a=i.elements.text;let n=i.elements.text2;if(i.operator===f){if(i.text===e.text2||i.text2===e.text){a.value=i.text;n.value=i.text2;if(document.activeElement===a){n.focus()}else if(document.activeElement===n){a.focus()}}if(document.activeElement!==a&&document.activeElement!==n){a.focus()}}else{a.focus()}delete i.elements.wrapper.dataset.showError;t.success=true}}catch(e){t.error=e.message||e}return t}function J(e,i){let a=T.filters.indexOf(e);if(a!==-1){T.filters.splice(a,1,i)}else{T.filters.push(i)}i.elements=e.elements;i.elements.wrapper.__listviewFilter=i;w(i.column);t.apply()}function X(){t.reset();t.focus()}function Q(e){return typeof e==="number"&&isNaN(e)}function ee(e){let t=parseFloat(e);if(Number.isInteger(t)&&!Number.isSafeInteger(t)){t=BigInt(e)}return t}function te(e,i){i=i||{};let a;try{a=D(e,i.column)}catch(e){alert(e.message||e);return null}let n=false;let s=false;if(!i.allowDuplicateColumns){for(let e=T.filters.length-1;e>=0;e--){if(i.column&&T.filters[e].column&&T.filters[e].column.id===i.column.id||!i.column&&!T.filters[e].column){if(T.filters[e].elements){WH.de(T.filters[e].elements.wrapper)}if(a){T.filters.splice(e,1,a);n=true}else{T.filters.splice(e,1)}s=true}}}if(a){if(!n){T.filters.push(a);n=true}se();if(i.column){WH.ae(T.elements.columnFilters,N(i.column,a))}else if(T.listview.searchable&&T.elements.tableFilter){let e=P(a);if(e!==T.elements.tableFilter.value.trim()){T.elements.tableFilter.value=e}}}if(i.column){if(n&&!s){w(i.column)}else if(s&&!n&&!t.isColumnFiltered(i.column)){S(i.column)}}if((n||s)&&!i.skipApply){t.apply()}return a}function ie(e){if(!e.enabled){delete e.test;return}let t=O(e.column);if(t===Listview.COLUMN_TYPE_TEXT&&e.operator!==h){t=Listview.COLUMN_TYPE_NUMBER}switch(t){case Listview.COLUMN_TYPE_TEXT:e.test=e.invert?de.bind(null,e):ue.bind(null,e);break;case Listview.COLUMN_TYPE_RANGE:let i=_[e.operator].bind(null,e.value);e.test=oe.bind(null,e,i);break;case Listview.COLUMN_TYPE_NUMBER:let a=v[e.operator].bind(null,e.value);e.test=re.bind(null,e,a);break;default:let n="Unknown column type cannot be filtered.";WH.error(n,t,e.column.id);throw new Error(n)}}function ae(e,i){if(!r.includes(e)){return}T.matchType=e;se();T.elements.match[e].checked=true;if(!i){t.apply()}}function ne(e,t,i){WH.st(e,m[i]);t.dataset.type=i===h?"string":"number";if(i===f){t.dataset.useRange="true"}else{delete t.dataset.useRange}}function se(){if(!T.listview.searchable&&!T.hasFilterableColumns){return}if(!T.elements.container){T.elements.container=E();let e=T.listview.noteTop||T.listview.noteIndicators||T.listview.navTop;T.listview.bandTop.insertBefore(T.elements.container,e.nextSibling)}T.listview.container.dataset.filters="visible"}function re(e,t,i,a){let n=ee(i.getValue?i.getValue(a):a[i.value]);if(Q(n)){return false}return e.invert?!t(n):t(n)}function oe(e,t,i,a){return e.invert?!t({min:i.getMinValue(a),max:i.getMaxValue(a)},e.value):t({min:i.getMinValue(a),max:i.getMaxValue(a)},e.value)}function le(e,t){let i=0;for(let a=0,n;n=T.filters[a];a++){if(!n.enabled){i++;continue}if(n.column){if(n.test(n.column,e)){i++}else{break}}else{let a=false;for(let i=0,s;s=t[i];i++){if(n.test(s,e)){a=true;break}}if(a){i++}else{break}}}return i===T.filters.length}function ce(e,t){for(let i=0,a;a=T.filters[i];i++){if(!a.enabled){continue}if(a.column){if(a.test(a.column,e)){return true}}else{for(let i=0,n;n=t[i];i++){if(a.test(n,e)){return true}}}}return false}function ue(e,t,i,a){let n=false;let s=L(i,t);if(s){s=s.toString().toLowerCase();n=true;for(let t=0,i=e.words.length;t<i;t++){if(s.indexOf(e.words[t])===-1){n=false;break}}}return n}function de(e,t,i,a){let n=false;let s=L(i,t);if(s){s=s.toString().toLowerCase();n=s.match(e.regExp)!=null}return!n}function fe(){if(!T.elements.reset){return}let e=0;for(let t=0,i;i=T.filters[t];t++){if(i.enabled||i.column){e++}}switch(e){case 0:WH.displayNone(T.elements.match.container);WH.displayNone(T.elements.reset);break;case 1:WH.displayNone(T.elements.match.container);WH.displayBlock(T.elements.reset);break;default:WH.displayBlock(T.elements.match.container);WH.displayBlock(T.elements.reset)}}function he(){if(T.listview.searchable&&T.elements.tableFilter){if(T.elements.tableFilter.value.trim()){T.elements.tableFilterIcon.style.display="none";T.elements.tableFilterClear.style.display=""}else{T.elements.tableFilterIcon.style.display="";T.elements.tableFilterClear.style.display="none"}}}U(e)};Listview.Filters.resetAndFocus=function(){this.Filters.resetAndFocus()};WH.Tools.Bloodmallet=new function(){var e=false;this.loadCharts=function(){if(typeof window.Highcharts!=="object"){WH.error("Can't load Bloodmallet charts because the Highcharts library isn't available.");return}if(typeof window.bloodmallet_charts!=="object"){if(!e){e=true;$.ajax({url:WH.staticUrl+"/js/3rd-party/bloodmallet_chart_import.js?2021-07-20",dataType:"script",success:t,cache:true})}}else{t()}};this.updateChartsSizes=function(e){var t=[];$(e).find(".bloodmallet_chart[data-highcharts-chart]").each((function(){t.push(this.getAttribute("data-highcharts-chart"))}));if(t.length>0){WH.Tools.Highcharts.updateSizes(t)}};function t(){$(".bloodmallet_chart").each((function(){if(typeof $(this).attr("data-highcharts-chart")==="undefined"){bloodmallet_chart_import();return false}}));setTimeout(i,9);$(window).resize(WH.Tools.Highcharts.updateSizes)}function i(){var e=0;var t=[];$(".bloodmallet_chart").each((function(){var i=this.getAttribute("data-highcharts-chart");if(i!==""){t.push(i)}else{e++}}));if(t.length>0){WH.Tools.Highcharts.updateSizes(t)}if(e>0){setTimeout(i,9*e)}}};WH.Tools.Highcharts=new function(){var e=[];var t=false;var i={};var a=50;this.loadScript=function(i){if(i){e.push(i)}if(typeof window.Highcharts!=="object"){if(!t){t=true;$.ajax({url:WH.staticUrl+"/js/3rd-party/highcharts.js",dataType:"script",cache:true,success:n})}}else{n()}};this.updateSizes=function(e){if(typeof Highcharts==="undefined"||!Array.isArray(Highcharts.charts)){return 0}var t=0;if(Array.isArray(e)){for(var i=0,a;a=e[i];i++){if(Highcharts.charts[a]){s(Highcharts.charts[a]);t++}}}else{for(var n=0,r;r=Highcharts.charts[n];n++){s(r);t++}}return t};function n(){while(e.length){e.pop()()}}function s(e){clearTimeout(i[e.index]);i[e.index]=setTimeout((function(){e.setSize(null,null)}),a)}};WH.Wow.Achievement=new function(){const e=this;this.SIDE_BOTH=-1;this.SIDE_HORDE=0;this.SIDE_ALLIANCE=1;this.convertSide=function(t){switch(t){case e.SIDE_BOTH:return WH.Wow.SIDE_BOTH;case e.SIDE_ALLIANCE:return WH.Wow.SIDE_ALLIANCE;case e.SIDE_HORDE:return WH.Wow.SIDE_HORDE}return undefined}};WH.Wow.Area=new function(){const e=this;const t={names:undefined};this.getName=function(t){return e.getNameList()[t]||null};this.getNameList=function(){if(!t.names){t.names=WH.getPageData("wow.area.names")||{}}return t.names}};WH.Wow.BattlePet=new function(){const e={families:undefined};this.getFamilyName=function(t){e.families=e.families||WH.getPageData("wow.battlePet.families")||{};return e.families[t]}};WH.Wow.BattlePetAbility=new function(){const e={types:undefined};this.getTypeName=function(t){e.types=e.types||WH.getPageData("wow.battlePetAbility.types")||{};return e.types[t]}};var g_artifact_knowledge_max_level=55;const g_file_races={10:"bloodelf",11:"draenei",3:"dwarf",7:"gnome",1:"human",4:"nightelf",2:"orc",6:"tauren",8:"troll",5:"scourge",9:"goblin",22:"worgen",24:"pandaren",25:"pandaren",26:"pandaren",27:"nightborne",28:"highmountaintauren",29:"voidelf",30:"lightforgeddraenei",31:"zandalaritroll",32:"kultiran",34:"darkirondwarf",36:"magharorc",12:"felorc",13:"naga",14:"broken",15:"skeleton",16:"vrykul",17:"tuskarr",18:"foresttroll",19:"taunka",20:"northrendskeleton",21:"icetroll",23:"gilnean",33:"thinhuman",35:"vulpera",37:"mechagnome"};var g_file_classes={6:"deathknight",12:"demonhunter",11:"druid",3:"hunter",8:"mage",10:"monk",2:"paladin",5:"priest",4:"rogue",7:"shaman",9:"warlock",1:"warrior"};const g_file_genders={0:"male",1:"female"};var g_file_factions={1:"alliance",2:"horde"};var g_file_racefactions={10:2,11:1,3:1,7:1,1:1,4:1,2:2,6:2,8:2,5:2,9:2,22:1,24:3,25:1,26:2,27:2,28:2,29:1,30:1,31:2,32:1,34:1,35:2,36:2,37:1};var g_npc_races=[12,13,14,15,16,17,18,19,20,21,23,33];var g_race_genders={12:0,14:0,15:0,16:0,17:0,18:0,19:0,20:0,21:0,33:0};var g_file_race_upright={2:{0:"uprightorc"},36:{0:"uprightmagharorc"}};var g_class_forums={6:18,12:29,11:3,3:4,8:6,10:28,2:7,5:8,4:5,7:9,9:10,1:11};var g_file_gems={1:"meta",2:"red",4:"yellow",6:"orange",8:"blue",10:"purple",12:"green",14:"prismatic",16:"hydraulic",32:"cogwheel"};var g_chr_specs_by_class={12:["577","581"],6:["250","251","252"],11:["102","103","104","105"],3:["253","254","255"],8:["62","63","64"],10:["268","270","269"],2:["65","66","70"],5:["256","257","258"],4:["259","260","261"],7:["262","263","264"],9:["265","266","267"],1:["71","72","73"]};if(WH.isClassicTree()||WH.isTbcTree()){g_chr_specs_by_class={11:["283","281","282"],3:["361","363","362"],8:["81","41","61"],2:["382","383","381"],5:["201","202","203"],4:["182","181","183"],7:["261","263","262"],9:["302","303","301"],1:["161","164","163"]}}var g_battlepet_types={1:"humanoid",2:"dragonkin",3:"flying",4:"undead",5:"critter",6:"magic",7:"elemental",8:"beast",9:"aquatic",10:"mechanical"};var g_battlepet_passives={1:238,2:245,3:239,4:242,5:236,6:243,7:241,8:237,9:240,10:244};var g_skill_recipe_subclass={171:6,164:4,185:5,333:8,202:3,356:9,773:11,755:10,165:1,186:12,197:2};if(WH.isClassicTree()){g_skill_recipe_subclass[129]=7;delete g_skill_recipe_subclass[773];delete g_skill_recipe_subclass[755]}if(WH.isTbcTree()){g_skill_recipe_subclass[129]=7;delete g_skill_recipe_subclass[773]}var g_skill_recipe_subclass_url={171:"alchemy",164:"blacksmithing",185:"cooking",333:"enchanting",202:"engineering",356:"fishing",773:"inscription",755:"jewelcrafting",165:"leatherworking",186:"mining",197:"tailoring"};if(WH.isClassicTree()){g_skill_recipe_subclass_url[129]="first-aid";delete g_skill_recipe_subclass_url[773];delete g_skill_recipe_subclass_url[755]}if(WH.isTbcTree()){g_skill_recipe_subclass_url[129]="first-aid";delete g_skill_recipe_subclass_url[773]}var g_world_bosses={71953:true,62346:true,60491:true,72057:true,69099:true,69161:true,71952:true,71954:true,71955:true};var g_grayedOutStats={3:[250,251,252,102,105,62,63,64,270,65,66,70,256,257,258,262,264,265,266,267,71,72,73],4:[102,103,104,105,253,254,255,62,63,64,268,270,269,65,256,257,258,259,260,261,262,263,264,265,266,267],5:[71,72,73,259,260,261,253,254,255,103,104,250,251,252,66,70,263,268,269],6:[250,251,252,102,103,104,253,254,255,62,63,64,268,269,66,70,258,259,260,261,262,263,265,266,267,71,72,73],50:[251,252,102,103,105,253,254,255,62,63,64,270,269,65,70,256,257,258,259,260,261,262,263,264,265,266,267,71,72]};if(WH.isClassicTree()||WH.isTbcTree()){g_grayedOutStats={}}var g_specPrimaryStatOrders={62:[5,3,4],63:[5,3,4],64:[5,3,4],65:[5,4,3],66:[4,3,5],70:[4,3,5],71:[4,3,5],72:[4,3,5],73:[4,3,5],102:[5,3,4],103:[3,4,5],104:[3,4,5],105:[5,3,4],250:[4,3,5],251:[4,3,5],252:[4,3,5],253:[3,5,4],254:[3,5,4],255:[3,5,4],256:[5,3,4],257:[5,3,4],258:[5,3,4],259:[3,4,5],260:[3,4,5],261:[3,4,5],262:[5,3,4],263:[3,5,4],264:[5,3,4],265:[5,3,4],266:[5,3,4],267:[5,3,4],268:[3,5,4],269:[3,5,4],270:[5,3,4],577:[3,5,4],581:[3,5,4]};var g_spec_to_role={62:2,63:2,64:2,65:1,66:0,70:2,71:2,72:2,73:0,74:2,79:2,81:0,102:2,103:2,104:0,105:1,250:0,251:2,252:2,253:2,254:2,255:2,256:1,257:1,258:2,259:2,260:2,261:2,262:2,263:2,264:1,265:2,266:2,267:2,268:0,269:2,270:1,535:2,536:2,537:0,577:2,581:0};var g_item_slots_to_character_slots={1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:[11,12],12:[13,14],13:[16,17],14:17,15:16,16:15,17:16,18:null,19:19,20:5,21:16,22:17,23:17,24:null,25:null,26:16,27:null,28:null};var g_character_slots_data=[{id:1,name:"head",itemSlots:[1]},{id:2,name:"neck",itemSlots:[2],noModel:1},{id:3,name:"shoulder",itemSlots:[3]},{id:15,name:"back",itemSlots:[16],iconName:"chest"},{id:5,name:"chest",itemSlots:[5,20]},{id:4,name:"shirt",itemSlots:[4]},{id:19,name:"tabard",itemSlots:[19]},{id:9,name:"wrists",itemSlots:[9]},{id:10,name:"hands",itemSlots:[10]},{id:6,name:"waist",itemSlots:[6]},{id:7,name:"legs",itemSlots:[7]},{id:8,name:"feet",itemSlots:[8]},{id:11,name:"finger",itemSlots:[11],noModel:1,simCraftName:"finger1"},{id:12,name:"finger",itemSlots:[11],noModel:1,simCraftName:"finger2"},{id:13,name:"trinket",itemSlots:[12],noModel:1,simCraftName:"trinket1"},{id:14,name:"trinket",itemSlots:[12],noModel:1,simCraftName:"trinket2"},{id:16,name:"mainhand",itemSlots:[21,13,17,15,25,26],simCraftName:"main_hand"},{id:17,name:"offhand",itemSlots:[22,13,17,23,14],simCraftName:"off_hand"}];var g_classes_allowed_armor={6:[1,2,3,4,5],12:[1,2,5],11:[1,2,5],3:[1,2,3,5],8:[1,5],10:[1,2,5],2:[1,2,3,4,5,6],5:[1,5],4:[1,2,5],7:[1,2,3,5,6],9:[1,5],1:[1,2,3,4,5,6]};var g_classes_allowed_weapon={6:[0,1,4,5,6,7,8,20],12:[0,7,9,13,15,20],11:[4,5,6,10,13,15,20],3:[2,3,6,10,18,20],8:[7,10,15,19,20],10:[0,4,6,7,10,13,20],2:[0,1,4,5,6,7,8,20],5:[4,10,15,19,20],4:[0,2,3,4,7,13,15,18,20],7:[0,1,4,5,6,10,13,15,20],9:[7,10,15,19,20],1:[0,1,2,3,4,5,6,7,8,10,13,15,18,20]};if(WH.isClassicTree()||WH.isTbcTree()){g_character_slots_data[g_character_slots_data.length-2].itemSlots=[21,13,17];g_character_slots_data[g_character_slots_data.length-1].itemSlots=[22,13,23,14];g_character_slots_data.push({id:18,name:"ranged",itemSlots:[15,25,26,28]});g_item_slots_to_character_slots[15]=18;g_item_slots_to_character_slots[25]=18;g_item_slots_to_character_slots[26]=18;g_item_slots_to_character_slots[28]=18;g_classes_allowed_armor[2].push(7);g_classes_allowed_armor[7].push(9);g_classes_allowed_armor[11].push(8);g_classes_allowed_weapon={11:[4,5,10,13,15,20],3:[0,1,2,3,6,7,8,10,13,15,16,18,20],8:[7,10,15,19,20],2:[0,1,4,5,6,7,8,20],5:[4,10,15,19,20],4:[2,3,4,7,13,15,16,18,20],7:[0,1,4,5,10,13,15,20],9:[7,10,15,19,20],1:[0,1,2,3,4,5,6,7,8,10,13,15,16,18,20]}}WH.getRaceSideSortString=function(e){var t=parseInt(e.side||g_file_racefactions[e.id]);if(t===1){return"alliance"}else if(t===2){return"horde"}else if(t===3){return"both"}return"npc"};WH.getSpecIndexFromSpecId=function(e){e=e.toString();for(var t in g_chr_specs_by_class){if(g_chr_specs_by_class.hasOwnProperty(t)&&g_chr_specs_by_class[t].indexOf(e)>-1){return g_chr_specs_by_class[t].indexOf(e)+1}}return null};WH.Wow.Covenant=new function(){this.KYRIAN=1;this.NECROLORD=4;this.NIGHT_FAE=3;this.VENTHYR=2;const e={};e[this.KYRIAN]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_kyrian.jpg";e[this.NECROLORD]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_necrolord.jpg";e[this.NIGHT_FAE]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_night_fae.jpg";e[this.VENTHYR]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_venthyr.jpg";const t={};t[this.KYRIAN]="ui_sigil_kyrian";t[this.NECROLORD]="ui_sigil_necrolord";t[this.NIGHT_FAE]="ui_sigil_nightfae";t[this.VENTHYR]="ui_sigil_venthyr";this.getArmoryBackgroundImageUrl=function(t){return e[t]};this.getIcon=function(e){return t[e]}};WH.Wow.Currency=new function(){this.ID_CONQUEST=390;this.ID_HONOR=392;this.ID_JUSTICE=395;this.ID_VALOR=396;const e=WH.getPageData("wow.currency.categories")||{};const t=WH.getPageData("wow.currency.namesAndIcons")||{};this.getCategoryName=function(t){return e[t]||null};this.getIcon=function(e){return t[e]&&t[e].icon||null};this.getName=function(e){return t[e]&&t[e].name||null}};var g_achievements={};var g_affixes={};var g_azeriteEssences={};var g_azeriteEssencePowers={};var g_bfa_champions={};var g_buildings={};var g_champions={};var g_classes={};var g_factions={};var g_followers={};var g_gatheredcurrencies={};var g_gatheredzones={};var g_gearsets={};var g_guides={};var g_holidays={};var g_icons={};var g_items={};var g_itemsets={};var g_mission_abilities={};var g_missions={};var g_npcs={};var g_objects={};var g_orderadvancements={};var g_outfits={};var g_petabilities={};var g_pets={};var g_quests={};var g_races={};var g_resources={};var g_ships={};var g_skills={};var g_sounds={};var g_spells={};var g_storylines={};var g_threats={};var g_titles={};var g_transmogsets={};var g_bluetweets={};var g_charts={};var g_types={1:"npc",2:"object",3:"item",4:"item-set",5:"quest",6:"spell",7:"zone",8:"faction",9:"pet",10:"achievement",11:"title",12:"event",13:"class",14:"race",15:"skill",17:"currency",19:"sound",20:"building",21:"follower",22:"mission-ability",23:"mission",25:"ship",26:"threat",27:"resource",28:"champion",29:"icon",30:"order-advancement",31:"follower_a",32:"follower_h",33:"ship_a",34:"ship_h",35:"champion_a",36:"champion_h",37:"item",38:"bfa-champion",39:"bfa-champion_a",40:"affix",41:"bfa-champion_h",42:"azerite-essence-power",43:"azerite-essence",44:"storyline",46:"adventure-combatant-ability",47:"encounter",100:"guide",101:"transmog-set",110:"outfit",111:"gear-set",150:"gallery",200:"pet-ability"};window.g_gathered_types={};g_gathered_types[WH.Types.ACHIEVEMENT]=g_achievements;g_gathered_types[WH.Types.ADVENTURE_COMBATANT_ABILITY]={};g_gathered_types[WH.Types.AFFIX]=g_affixes;g_gathered_types[WH.Types.AZERITE_ESSENCE]=g_azeriteEssences;g_gathered_types[WH.Types.AZERITE_ESSENCE_POWER]=g_azeriteEssencePowers;g_gathered_types[WH.Types.BFA_CHAMPION]=g_bfa_champions;g_gathered_types[WH.Types.BFA_CHAMPION_A]=g_bfa_champions;g_gathered_types[WH.Types.BFA_CHAMPION_H]=g_bfa_champions;g_gathered_types[WH.Types.BUILDING]=g_buildings;g_gathered_types[WH.Types.CHAMPION]=g_champions;g_gathered_types[WH.Types.CHAMPION_A]=g_champions;g_gathered_types[WH.Types.CHAMPION_H]=g_champions;g_gathered_types[WH.Types.CLASS]=g_classes;g_gathered_types[WH.Types.COVENANT]={};g_gathered_types[WH.Types.CURRENCY]=g_gatheredcurrencies;g_gathered_types[WH.Types.ENCOUNTER]={};g_gathered_types[WH.Types.EVENT]=g_holidays;g_gathered_types[WH.Types.FACTION]=g_factions;g_gathered_types[WH.Types.FOLLOWER]=g_followers;g_gathered_types[WH.Types.FOLLOWER_A]=g_followers;g_gathered_types[WH.Types.FOLLOWER_H]=g_followers;g_gathered_types[WH.Types.ICON]=g_icons;g_gathered_types[WH.Types.ITEM]=g_items;g_gathered_types[WH.Types.ITEM_SET]=g_itemsets;g_gathered_types[WH.Types.MISSION]=g_missions;g_gathered_types[WH.Types.MISSION_ABILITY]=g_mission_abilities;g_gathered_types[WH.Types.NPC]=g_npcs;g_gathered_types[WH.Types.OBJECT]=g_objects;g_gathered_types[WH.Types.ORDER_ADVANCEMENT]=g_orderadvancements;g_gathered_types[WH.Types.PET]=g_pets;g_gathered_types[WH.Types.PET_ABILITY]=g_petabilities;g_gathered_types[WH.Types.QUEST]=g_quests;g_gathered_types[WH.Types.RACE]=g_races;g_gathered_types[WH.Types.RESOURCE]=g_resources;g_gathered_types[WH.Types.SHIP]=g_ships;g_gathered_types[WH.Types.SHIP_A]=g_ships;g_gathered_types[WH.Types.SHIP_H]=g_ships;g_gathered_types[WH.Types.SKILL]=g_skills;g_gathered_types[WH.Types.SOULBIND]={};g_gathered_types[WH.Types.SOUND]=g_sounds;g_gathered_types[WH.Types.SPELL]=g_spells;g_gathered_types[WH.Types.STORYLINE]=g_storylines;g_gathered_types[WH.Types.THREAT]=g_threats;g_gathered_types[WH.Types.TITLE]=g_titles;g_gathered_types[WH.Types.ZONE]=g_gatheredzones;g_gathered_types[WH.Types.GEAR_SET]=g_gearsets;g_gathered_types[WH.Types.GUIDE]=g_guides;g_gathered_types[WH.Types.OUTFIT]=g_outfits;g_gathered_types[WH.Types.TRANSMOG_SET]=g_transmogsets;g_gathered_types[WH.Types.GUIDE_IMAGE]={};g_gathered_types[WH.Types.LISTVIEW]={};g_gathered_types[WH.Types.SCREENSHOT]={};g_gathered_types[WH.Types.SURVEY_COVENANTS]={};var g_completion_categories={1:[12],3:[2,4,9,"15-2","15-5"],6:[-5,-6,9,11]};WH.cO(g_items,{add:function(e,t){var i={};i[e]=t;WH.Gatherer.addData(WH.Types.ITEM,WH.getDataEnv(),i)},getIcon:function(e,t,i,a){var n=WH.Gatherer.get(WH.Types.ITEM,e,a);var s=Icon.questionMarkIcon;if(n!=null&&n.icon){s=n.icon}var r=g_items.getAppearance(e,t,i,a);if(r!=null&&r[1]){s=r[1]}return s},getAppearance:function(e,t,i,a){var n=null;var s=WH.Gatherer.get(WH.Types.ITEM,e,a);var r=-1;var o=s&&s.appearances?s.appearances:s&&s.jsonequip&&s.jsonequip.appearances?s.jsonequip.appearances:null;if(i&&o&&o[i]){n=o[i]}else{if(WH.isSet("g_itembonuses")&&t&&t.length>0){for(var l in t){var c=t[l];if(c>0&&g_itembonuses[c]){WH.arrayWalk(g_itembonuses[c],(function(e){if(e[0]==7){r=e[1]}}))}if(r!=-1&&o&&o[r]){n=o[r];break}}}}return n},createIcon:function(e,t,i,a,n){var s={};if(n&&n.length>0){s.bonus=n.join(":")}return Icon.create(g_items.getIcon(e,n),t,null,WH.Entity.getPath(WH.Types.ITEM,e,null,s),i,a)}});WH.cO(g_spells,{WH_IDS:1e6,add:function(e,t){if(g_spells[e]!=null){WH.cO(g_spells[e],t)}else{g_spells[e]=t}},getIcon:function(e){if(g_spells[e]!=null&&g_spells[e].icon){return g_spells[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,i,a){return Icon.create(g_spells.getIcon(e),t,null,WH.Entity.getPath(WH.Types.SPELL,e),i,a)}});WH.cO(g_petabilities,{add:function(e,t){if(g_petabilities[e]!=null){WH.cO(g_petabilities[e],t)}else{g_petabilities[e]=t}},getIcon:function(e){if(g_petabilities[e]!=null&&g_petabilities[e].icon){return g_petabilities[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,i,a){return Icon.create(g_petabilities.getIcon(e),t,null,WH.Entity.getPath(WH.Types.PET_ABILITY,e),i,a)}});WH.cO(g_achievements,{getIcon:function(e){if(g_achievements[e]!=null&&g_achievements[e].icon){return g_achievements[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,i,a){return Icon.create(g_achievements.getIcon(e),t,null,WH.Entity.getPath(WH.Types.ACHIEVEMENT,e),i,a)}});WH.cO(g_classes,{getIcon:function(e){if(g_file_classes[e]){return"class_"+g_file_classes[e]}else{return Icon.questionMarkIcon}},createIcon:function(e,t,i,a){return Icon.create(g_classes.getIcon(e),t,null,WH.Entity.getPath(WH.Types.CLASS,e),i,a)}});WH.cO(g_races,{getIcon:function(e,t){if(t===undefined){t=0}if(g_file_races[e]&&g_file_genders[t]){return"race_"+g_file_races[e]+"_"+g_file_genders[t]}else{return Icon.questionMarkIcon}},createIcon:function(e,t,i,a){return Icon.create(g_races.getIcon(e),t,null,WH.Entity.getPath(WH.Types.RACE,e),i,a)}});WH.cO(g_skills,{getIcon:function(e){if(g_skills[e]!=null&&g_skills[e].icon){return g_skills[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,i,a){return Icon.create(g_skills.getIcon(e),t,null,WH.Entity.getPath(WH.Types.SKILL,e),i,a)}});WH.cO(g_gatheredcurrencies,{getIcon:function(e){if(g_gatheredcurrencies[e]!=null&&g_gatheredcurrencies[e].icon){return g_gatheredcurrencies[e].icon}return WH.Icon.UNKNOWN},createIcon:function(e,t,i,a){return Icon.create(g_gatheredcurrencies.getIcon(e),t,null,WH.Entity.getPath(WH.Types.CURRENCY,e),Math.abs(i),a)}});WH.cO(g_holidays,{getIcon:function(e){if(g_holidays[e]!=null&&g_holidays[e].icon){return g_holidays[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,i,a){return Icon.create(g_holidays.getIcon(e),t,null,WH.Entity.getPath(WH.Types.EVENT,e),i,a)}});WH.cO(g_mission_abilities,{getIcon:function(e){if(g_mission_abilities[e]!=null&&g_mission_abilities[e].icon){return g_mission_abilities[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,i,a){var n=Icon.create(g_mission_abilities.getIcon(e),t,null,WH.Entity.getPath(WH.Types.MISSION_ABILITY,e),i,a);n.className+=" garrison-ability";return n}});WH.Wow.Difficulty=new function(){const e=this;this.ID_NONE=0;this.ID_DUNGEON_NORMAL=1;this.ID_DUNGEON_HEROIC=2;this.ID_LEGACY_10_PLAYER=3;this.ID_LEGACY_25_PLAYER=4;this.ID_LEGACY_10_PLAYER_HEROIC=5;this.ID_LEGACY_25_PLAYER_HEROIC=6;this.ID_LEGACY_RAID_FINDER=7;this.ID_DUNGEON_CHALLENGE=8;this.ID_RAID_40_PLAYER=9;this.ID_SCENARIO=11;this.ID_SCENARIO_HEROIC=12;this.ID_RAID_NORMAL=14;this.ID_RAID_HEROIC=15;this.ID_RAID_MYTHIC=16;this.ID_RAID_FINDER=17;this.ID_RAID_EVENT=18;this.ID_DUNGEON_EVENT=19;this.ID_SCENARIO_EVENT=20;this.ID_DUNGEON_MYTHIC=23;this.ID_DUNGEON_TIMEWALKING=24;this.ID_CLASSIC_RAID_20_PLAYER=148;this.ID_TBC_DUNGEON_NORMAL=173;this.ID_TBC_DUNGEON_HEROIC=174;this.ID_TBC_10_PLAYER=175;this.ID_TBC_25_PLAYER=176;this.ID_SEASON_OF_MASTERY_DUNGEON=184;this.ID_SEASON_OF_MASTERY_20_PLAYER=185;this.ID_SEASON_OF_MASTERY_40_PLAYER=186;this.GROUP_NONE=1;this.GROUP_DUNGEON=2;this.GROUP_LEGACY_RAID=3;this.GROUP_RAID=4;this.GROUPS={};this.GROUPS[this.GROUP_RAID]=[this.ID_RAID_NORMAL,this.ID_RAID_HEROIC,this.ID_RAID_MYTHIC,this.ID_RAID_FINDER];this.GROUPS[this.GROUP_LEGACY_RAID]=[this.ID_LEGACY_10_PLAYER,this.ID_LEGACY_25_PLAYER,this.ID_LEGACY_10_PLAYER_HEROIC,this.ID_LEGACY_25_PLAYER_HEROIC,this.ID_LEGACY_RAID_FINDER,this.ID_SEASON_OF_MASTERY_40_PLAYER,this.ID_SEASON_OF_MASTERY_20_PLAYER,this.ID_RAID_40_PLAYER,this.ID_CLASSIC_RAID_20_PLAYER,this.ID_TBC_10_PLAYER,this.ID_TBC_25_PLAYER,this.ID_RAID_NORMAL];this.GROUPS[this.GROUP_DUNGEON]=[this.ID_DUNGEON_NORMAL,this.ID_DUNGEON_HEROIC,this.ID_DUNGEON_MYTHIC,this.ID_DUNGEON_TIMEWALKING,this.ID_TBC_DUNGEON_NORMAL,this.ID_TBC_DUNGEON_HEROIC,this.ID_SEASON_OF_MASTERY_DUNGEON];this.GROUPS[this.GROUP_NONE]=[this.ID_NONE];this.SORT_ORDER=[this.ID_NONE,this.ID_DUNGEON_NORMAL,this.ID_DUNGEON_HEROIC,this.ID_DUNGEON_MYTHIC,this.ID_DUNGEON_CHALLENGE,this.ID_DUNGEON_EVENT,this.ID_DUNGEON_TIMEWALKING,this.ID_TBC_DUNGEON_NORMAL,this.ID_TBC_DUNGEON_HEROIC,this.ID_SEASON_OF_MASTERY_DUNGEON,this.ID_LEGACY_RAID_FINDER,this.ID_LEGACY_10_PLAYER,this.ID_LEGACY_10_PLAYER_HEROIC,this.ID_LEGACY_25_PLAYER,this.ID_LEGACY_25_PLAYER_HEROIC,this.ID_CLASSIC_RAID_20_PLAYER,this.ID_SEASON_OF_MASTERY_20_PLAYER,this.ID_RAID_40_PLAYER,this.ID_SEASON_OF_MASTERY_40_PLAYER,this.ID_TBC_10_PLAYER,this.ID_TBC_25_PLAYER,this.ID_RAID_FINDER,this.ID_RAID_NORMAL,this.ID_RAID_HEROIC,this.ID_RAID_MYTHIC,this.ID_RAID_EVENT,this.ID_SCENARIO,this.ID_SCENARIO_HEROIC,this.ID_SCENARIO_EVENT];const t=-2;const i=-1;const a=1;const n=2;const s=3;const r=4;const o=5;const l={};l[i]=this.ID_DUNGEON_NORMAL;l[t]=this.ID_DUNGEON_HEROIC;l[o]=this.ID_LEGACY_RAID_FINDER;l[a]=this.ID_LEGACY_10_PLAYER;l[n]=this.ID_LEGACY_25_PLAYER;l[s]=this.ID_LEGACY_10_PLAYER_HEROIC;l[r]=this.ID_LEGACY_25_PLAYER_HEROIC;this.comparator=function(t,i){var a=e.SORT_ORDER.indexOf(parseInt(t));var n=e.SORT_ORDER.indexOf(parseInt(i));if(a<0){if(n<0){return 0}return 1}if(n<0){return-1}return Math.sign(a-n)};this.convertLegacyDropDifficulty=function(e){return l[e]||e};this.getIds=function(){var e=[];for(var t in this){if(!this.hasOwnProperty(t)||typeof this[t]!="number"){continue}if(t.substr(0,3)==="ID_"){e.push(this[t])}}return e};this.getIconClass=function(e){let t=undefined;switch(e){case this.ID_DUNGEON_HEROIC:case this.ID_LEGACY_10_PLAYER_HEROIC:case this.ID_LEGACY_25_PLAYER_HEROIC:case this.ID_RAID_HEROIC:case this.ID_TBC_DUNGEON_HEROIC:t="icon-heroic";break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:t="icon-mythic";break}return t};this.getName=function(e){var t="";switch(e){case this.ID_NONE:case this.ID_DUNGEON_NORMAL:case this.ID_RAID_NORMAL:case this.ID_TBC_DUNGEON_NORMAL:t=WH.TERMS.normal;break;case this.ID_DUNGEON_HEROIC:case this.ID_RAID_HEROIC:case this.ID_TBC_DUNGEON_HEROIC:t=WH.TERMS.heroic;break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:t=WH.TERMS.mythic;break;case this.ID_DUNGEON_TIMEWALKING:t=WH.TERMS.timewalking;break;case this.ID_RAID_FINDER:case this.ID_LEGACY_RAID_FINDER:t=WH.TERMS.raidfinder;break;case this.ID_LEGACY_10_PLAYER:case this.ID_TBC_10_PLAYER:t=WH.sprintf(WH.TERMS.normal_format,10);break;case this.ID_LEGACY_25_PLAYER:case this.ID_TBC_25_PLAYER:t=WH.sprintf(WH.TERMS.normal_format,25);break;case this.ID_LEGACY_10_PLAYER_HEROIC:t=WH.sprintf(WH.TERMS.heroic_format,10);break;case this.ID_LEGACY_25_PLAYER_HEROIC:t=WH.sprintf(WH.TERMS.heroic_format,25);break;case this.ID_RAID_40_PLAYER:t=WH.GlobalStrings.RAID_DIFFICULTY_40PLAYER;break;case this.ID_CLASSIC_RAID_20_PLAYER:t=WH.GlobalStrings.RAID_DIFFICULTY_20PLAYER;break;case this.ID_SEASON_OF_MASTERY_DUNGEON:t=WH.TERMS.seasonOfMastery;break;case this.ID_SEASON_OF_MASTERY_20_PLAYER:t=WH.TERMS.player20SeasonOfMastery;break;case this.ID_SEASON_OF_MASTERY_40_PLAYER:t=WH.TERMS.player40SeasonOfMastery;break}return t||"["+e+"]"};this.getNameAbbrev=function(e){var t="";switch(e){case this.ID_NONE:case this.ID_DUNGEON_NORMAL:case this.ID_RAID_NORMAL:case this.ID_TBC_DUNGEON_NORMAL:t=WH.TERMS.normal_abbrev;break;case this.ID_DUNGEON_HEROIC:case this.ID_RAID_HEROIC:case this.ID_TBC_DUNGEON_HEROIC:t=WH.TERMS.heroic_abbrev;break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:t=WH.TERMS.mythic_abbrev;break;case this.ID_DUNGEON_TIMEWALKING:t=WH.TERMS.timewalking_abbrev;break;case this.ID_RAID_FINDER:case this.ID_LEGACY_RAID_FINDER:t=WH.TERMS.lookingforraid_abbrev;break;case this.ID_LEGACY_10_PLAYER:t="10"+WH.TERMS.normal_abbrev;break;case this.ID_TBC_10_PLAYER:t="10"+WH.TERMS.player.substr(0,1);break;case this.ID_LEGACY_25_PLAYER:t="25"+WH.TERMS.normal_abbrev;break;case this.ID_TBC_25_PLAYER:t="25"+WH.TERMS.player.substr(0,1);break;case this.ID_LEGACY_10_PLAYER_HEROIC:t="10"+WH.TERMS.heroic_abbrev;break;case this.ID_LEGACY_25_PLAYER_HEROIC:t="25"+WH.TERMS.heroic_abbrev;break;case this.ID_RAID_40_PLAYER:t="40";break;case this.ID_CLASSIC_RAID_20_PLAYER:t="20";break;case this.ID_SEASON_OF_MASTERY_DUNGEON:case this.ID_SEASON_OF_MASTERY_20_PLAYER:case this.ID_SEASON_OF_MASTERY_40_PLAYER:t=WH.TERMS.seasonOfMastery_abbrev;break}return t||"["+e+"]"};this.getNameShorthand=function(t){let i="";switch(t){case this.ID_NONE:case this.ID_DUNGEON_NORMAL:case this.ID_RAID_NORMAL:case this.ID_LEGACY_10_PLAYER:case this.ID_LEGACY_25_PLAYER:case this.ID_TBC_DUNGEON_NORMAL:i=WH.TERMS.normal;break;case this.ID_DUNGEON_HEROIC:case this.ID_RAID_HEROIC:case this.ID_LEGACY_10_PLAYER_HEROIC:case this.ID_LEGACY_25_PLAYER_HEROIC:case this.ID_TBC_DUNGEON_HEROIC:i=WH.TERMS.heroic;break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:i=WH.TERMS.mythic;break;case this.ID_DUNGEON_TIMEWALKING:i=WH.TERMS.timewalking;break;case this.ID_RAID_FINDER:case this.ID_LEGACY_RAID_FINDER:i=WH.TERMS.lookingforraid_abbrev;break;case this.ID_RAID_40_PLAYER:i=WH.GlobalStrings.RAID_DIFFICULTY_40PLAYER;break;case this.ID_CLASSIC_RAID_20_PLAYER:i=WH.GlobalStrings.RAID_DIFFICULTY_20PLAYER;break;case this.ID_TBC_10_PLAYER:case this.ID_TBC_25_PLAYER:i=e.getNameAbbrev(t);break;case this.ID_SEASON_OF_MASTERY_DUNGEON:i=WH.TERMS.seasonOfMastery_abbrev;break;case this.ID_SEASON_OF_MASTERY_20_PLAYER:i=WH.TERMS.seasonOfMastery_abbrev+WH.TERMS.wordspace_punct+"20";break;case this.ID_SEASON_OF_MASTERY_40_PLAYER:i=WH.TERMS.seasonOfMastery_abbrev+WH.TERMS.wordspace_punct+"40";break}return i||"["+t+"]"}};WH.Wow.Event=new function(){this.getNextEvent=function(e,t){t=t||new Date;for(let i in e){let a=e[i];if(new Date(a.end)>=t){return a}}return null}};WH.Wow.Expansion=new function(){const e=this;this.CLASSIC=0;this.TBC=1;this.WOTLK=2;this.CATA=3;this.MOP=4;this.WOD=5;this.LEGION=6;this.BFA=7;this.SL=8;this.LEVEL_CAP_RETAIL_CLASSIC=30;this.LEVEL_CAP_RETAIL_TBC=30;this.LEVEL_CAP_RETAIL_WOTLK=30;this.LEVEL_CAP_RETAIL_CATA=35;this.LEVEL_CAP_RETAIL_MOP=35;this.LEVEL_CAP_RETAIL_WOD=40;this.LEVEL_CAP_RETAIL_LEGION=45;this.LEVEL_CAP_RETAIL_BFA=50;this.LEVEL_CAP_RETAIL_SL=60;this.LEVEL_START_RETAIL_CATA=30;this.LEVEL_START_RETAIL_EXPANSION=10;const t={};const i={};i[this.CLASSIC]="";i[this.TBC]="tbc";i[this.WOTLK]="wotlk";i[this.CATA]="cata";i[this.MOP]="mop";i[this.WOD]="wod";i[this.LEGION]="legion";i[this.BFA]="bfa";i[this.SL]="sl";var a={0:[WH.TERMS.classic],1:[WH.TERMS.theburningcrusade_short,WH.TERMS.burningcrusade_abbrev],2:[WH.TERMS.wrathofthelichking_short,WH.TERMS.wrathofthelichking_abbrev],3:[WH.TERMS.cataclysm_short,WH.TERMS.cataclysm_abbrev],4:[WH.TERMS.mistsofpandaria_short,WH.TERMS.mistsofpandaria_abbrev],5:[WH.TERMS.warlordsofdraenor_short,WH.TERMS.warlordsofdraenor_abbrev],6:[WH.TERMS.legion_abbrev],7:[WH.TERMS.battleforazeroth_short,WH.TERMS.battleforazeroth_abbrev]};const n={};n[this.CLASSIC]="classic";n[this.TBC]="theburningcrusade";n[this.WOTLK]="wrathofthelichking";n[this.CATA]="cataclysm";n[this.MOP]="mistsofpandaria";n[this.WOD]="warlordsofdraenor";n[this.LEGION]="legion_expansion";n[this.BFA]="battleforazeroth";n[this.SL]="shadowlands_expansion";const s={};s[this.CLASSIC]="classic_abbrev";s[this.TBC]="theburningcrusade_short";s[this.WOTLK]="wrathofthelichking_abbrev";s[this.CATA]="cataclysm_abbrev";s[this.MOP]="mistsofpandaria_abbrev";s[this.WOD]="warlordsofdraenor_abbrev";s[this.LEGION]="legion_abbrev";s[this.BFA]="battleforazeroth_abbrev";s[this.SL]="shadowlands_abbrev";const r={};r[this.CLASSIC]="classic";r[this.TBC]="theburningcrusade_short";r[this.WOTLK]="wrathofthelichking_short";r[this.CATA]="cataclysm_short";r[this.MOP]="mistsofpandaria_short";r[this.WOD]="warlordsofdraenor_short";r[this.LEGION]="legion_expansion";r[this.BFA]="battleforazeroth_short";r[this.SL]="shadowlands_short";this.available=function(t,i){return e.get(i)>=t};this.get=function(e){e=e||WH.getDataEnv();if(t[e]){return t[e]}let i=o(WH.Wow.getVersionString(e));if(i===undefined){let t="Could not get expansion for data env. ["+e+"]";WH.error(t);throw t}t[e]=i;return i};this.getAbbreviation=function(e){return WH.TERMS[s[e]]||WH.TERMS.unknown};this.getAllAvailable=function(t){let i=e.get(t);let a=[];for(let e=0;e<=i;e++){a.push(e)}return a};this.getIconClass=function(e){if(!i[e]){return null}return"icon-"+i[e]};this.getName=function(e){return WH.TERMS[n[e]]||WH.TERMS.unknown};this.getRightIconClass=function(t){let i=e.getIconClass(t);return i?i+"-right":null};this.getSearchText=function(e){var t=a[e]||[];for(var i=1;i<t.length;i++){if(t[i-1]===t[i]){t.splice(i--,1)}}return t};this.getShortName=function(e){return WH.TERMS[r[e]]||WH.TERMS.unknown};function o(e){let t=parseInt(e.substr(0,e.indexOf(".")));if(isNaN(t)){return undefined}return t-1}};WH.Wow.Faction=new function(){this.REP_LEVEL_REVERED=63e3;this.REP_RANK_HATED=0;this.REP_RANK_HOSTILE=1;this.REP_RANK_UNFRIENDLY=2;this.REP_RANK_NEUTRAL=3;this.REP_RANK_FRIENDLY=4;this.REP_RANK_HONORED=5;this.REP_RANK_REVERED=6;this.REP_RANK_EXALTED=7;this.getCategoryName=function(e){return g_faction_categories[e]};this.getRankName=function(e){return g_reputation_standings[e]}};WH.Wow.Follower=new function(){this.FOLLOWER_TYPE_FOLLOWER=1;this.FOLLOWER_TYPE_SHIP=2;this.FOLLOWER_TYPE_LEGION_CHAMPION=4;this.FOLLOWER_TYPE_BFA_CHAMPION=22;this.FOLLOWER_TYPE_ADVENTURE_COMBATANT=123};WH.Wow.Item=new function(){const e=this;const t=WH.Wow.Difficulty;const i=WH.Wow.Expansion;this.CLASS_WEAPON=2;this.CLASS_GEM=3;this.CLASS_ARMOR=4;this.CLASS_QUEST=12;this.ARMOR_SUBCLASS_MISC=0;this.ARMOR_SUBCLASS_CLOTH=1;this.ARMOR_SUBCLASS_LEATHER=2;this.ARMOR_SUBCLASS_MAIL=3;this.ARMOR_SUBCLASS_PLATE=4;this.ARMOR_SUBCLASS_COSMETIC=5;this.ARMOR_SUBCLASS_SHIELDS=6;this.ARMOR_SUBCLASS_RINGS=-2;this.ARMOR_SUBCLASS_AMULETS=-3;this.ARMOR_SUBCLASS_TRINKETS=-4;this.ARMOR_SUBCLASS_OFF_HAND_FRILLS=-5;this.ARMOR_SUBCLASS_CLOAKS=-6;this.ARMOR_SUBCLASS_TABARDS=-7;this.ARMOR_SUBCLASS_SHIRTS=-8;this.WEAPON_SUBCLASS_ONE_HANDED_AXE=0;this.WEAPON_SUBCLASS_TWO_HANDED_AXE=1;this.WEAPON_SUBCLASS_BOW=2;this.WEAPON_SUBCLASS_GUN=3;this.WEAPON_SUBCLASS_ONE_HANDED_MACE=4;this.WEAPON_SUBCLASS_TWO_HANDED_MACE=5;this.WEAPON_SUBCLASS_POLEARM=6;this.WEAPON_SUBCLASS_ONE_HANDED_SWORD=7;this.WEAPON_SUBCLASS_TWO_HANDED_SWORD=8;this.WEAPON_SUBCLASS_WARGLAIVE=9;this.WEAPON_SUBCLASS_STAFF=10;this.WEAPON_SUBCLASS_FIST_WEAPON=13;this.WEAPON_SUBCLASS_MISCELLANEOUS=14;this.WEAPON_SUBCLASS_DAGGER=15;this.WEAPON_SUBCLASS_THROWN=16;this.WEAPON_SUBCLASS_CROSSBOW=18;this.WEAPON_SUBCLASS_WAND=19;this.WEAPON_SUBCLASS_FISHING_POLE=20;this.INVENTORY_TYPE_HEAD=1;this.INVENTORY_TYPE_NECK=2;this.INVENTORY_TYPE_SHOULDERS=3;this.INVENTORY_TYPE_SHIRT=4;this.INVENTORY_TYPE_CHEST=5;this.INVENTORY_TYPE_WAIST=6;this.INVENTORY_TYPE_LEGS=7;this.INVENTORY_TYPE_FEET=8;this.INVENTORY_TYPE_WRISTS=9;this.INVENTORY_TYPE_HANDS=10;this.INVENTORY_TYPE_FINGER=11;this.INVENTORY_TYPE_TRINKET=12;this.INVENTORY_TYPE_ONE_HAND=13;this.INVENTORY_TYPE_SHIELD=14;this.INVENTORY_TYPE_RANGED=15;this.INVENTORY_TYPE_BACK=16;this.INVENTORY_TYPE_TWO_HAND=17;this.INVENTORY_TYPE_BAG=18;this.INVENTORY_TYPE_TABARD=19;this.INVENTORY_TYPE_ROBE=20;this.INVENTORY_TYPE_MAIN_HAND=21;this.INVENTORY_TYPE_OFF_HAND=22;this.INVENTORY_TYPE_HELD_IN_OFF_HAND=23;this.INVENTORY_TYPE_PROJECTILE=24;this.INVENTORY_TYPE_THROWN=25;this.INVENTORY_TYPE_RANGED_RIGHT=26;this.INVENTORY_TYPE_QUIVER=27;this.INVENTORY_TYPE_RELIC=28;this.INV_TYPES=[this.INVENTORY_TYPE_HEAD,this.INVENTORY_TYPE_NECK,this.INVENTORY_TYPE_SHOULDERS,this.INVENTORY_TYPE_SHIRT,this.INVENTORY_TYPE_CHEST,this.INVENTORY_TYPE_WAIST,this.INVENTORY_TYPE_LEGS,this.INVENTORY_TYPE_FEET,this.INVENTORY_TYPE_WRISTS,this.INVENTORY_TYPE_HANDS,this.INVENTORY_TYPE_FINGER,this.INVENTORY_TYPE_TRINKET,this.INVENTORY_TYPE_ONE_HAND,this.INVENTORY_TYPE_SHIELD,this.INVENTORY_TYPE_RANGED,this.INVENTORY_TYPE_BACK,this.INVENTORY_TYPE_TWO_HAND,this.INVENTORY_TYPE_BAG,this.INVENTORY_TYPE_TABARD,this.INVENTORY_TYPE_ROBE,this.INVENTORY_TYPE_MAIN_HAND,this.INVENTORY_TYPE_OFF_HAND,this.INVENTORY_TYPE_HELD_IN_OFF_HAND,this.INVENTORY_TYPE_PROJECTILE,this.INVENTORY_TYPE_THROWN,this.INVENTORY_TYPE_RANGED_RIGHT,this.INVENTORY_TYPE_QUIVER,this.INVENTORY_TYPE_RELIC];this.QUALITY_DEFAULT="";this.QUALITY_POOR=0;this.QUALITY_COMMON=1;this.QUALITY_UNCOMMON=2;this.QUALITY_RARE=3;this.QUALITY_EPIC=4;this.QUALITY_LEGENDARY=5;this.QUALITY_ARTIFACT=6;this.QUALITY_HEIRLOOM=7;this.QUALITY_WOW_TOKEN=8;this.QUALITY_GLYPH=9;this.QUALITY_FAIL=10;this.QUALITY_SET_BONUSES=13;const a=[this.INVENTORY_TYPE_HEAD,this.INVENTORY_TYPE_SHOULDERS,this.INVENTORY_TYPE_SHIRT,this.INVENTORY_TYPE_CHEST,this.INVENTORY_TYPE_WAIST,this.INVENTORY_TYPE_LEGS,this.INVENTORY_TYPE_FEET,this.INVENTORY_TYPE_WRISTS,this.INVENTORY_TYPE_HANDS,this.INVENTORY_TYPE_ROBE];const n=[e.ARMOR_SUBCLASS_CLOTH,e.ARMOR_SUBCLASS_LEATHER,e.ARMOR_SUBCLASS_MAIL,e.ARMOR_SUBCLASS_PLATE];const s={};const r=WH.getPageData("wow.item.slotToInvTypes");var o={default:{"":"ffd100",0:"9d9d9d",1:"ffffff",2:"1eff00",3:"0070dd",4:"a335ee",5:"ff8000",6:"e5cc80",7:"00ccff",8:"00ccff",9:"71d5ff",10:"ff4040",13:"ffff98"},thottbot:{"":"e5c017",0:"777777",1:"000000",2:"00bb00",3:"0070dd",4:"a335ee",5:"ff8000",6:"998856",7:"00ccff",8:"00ccff",9:"4f95b3",10:"ff4040",13:"99995c"}};var l={"":"default",0:"poor",1:"common",2:"uncommon",3:"rare",4:"epic",5:"legendary",6:"artifact",7:"heirloom",8:"wowtoken",9:"glyph",10:"error",13:"setbonuses"};const c=[e.WEAPON_SUBCLASS_BOW,e.WEAPON_SUBCLASS_GUN,e.WEAPON_SUBCLASS_THROWN,e.WEAPON_SUBCLASS_CROSSBOW,e.WEAPON_SUBCLASS_WAND];const u={nameDescriptions:undefined};this.getArmorSubclasses=function(){let t=n.slice();if(i.available(i.MOP)){t.push(e.ARMOR_SUBCLASS_COSMETIC)}return t};this.getClassName=function(e,t){if(t!=null){return(g_item_subclasses[e]||{})[t]}else{return g_item_classes[e]}};this.getSlotsToInvTypes=function(){return r[WH.getDataEnv()]||r[WH.getRootEnv()]};this.getInvTypeSlots=function(e){let t=WH.getDataEnv();if(!s[t]){s[t]={};let e=r[t]||r[WH.getRootEnv()];for(let i in e){if(!e.hasOwnProperty(i)){continue}for(let a=0,n;n=e[i][a];a++){if(!s[t][n]){s[t][n]=[]}s[t][n].push(parseInt(i))}}}return s[t][e]||[]};this.getNameDescription=function(e){return(d()[e]||{}).name||null};this.getNameDescriptionColor=function(e){return(d()[e]||{}).color||null};this.getPath=function(e,t,i){return WH.Entity.getPath(WH.Types.ITEM,e,t,i)};this.getQualityColor=function(t,i){var a=i?o["default"]:o[WH.Theme.getTheme()]||o["default"];var n=a[t]||a[e.QUALITY_DEFAULT];return"#"+n};this.getQualityName=function(e){return WH.TERMS[l[e]]||WH.TERMS.unknown};this.getSourceCategory=function(e,t){switch(e){case 2:if(t.bd){return WH.TERMS.bossdrop}if(t.z){return WH.TERMS.zonedrop}break;case 4:return WH.TERMS.quests;case 5:return WH.TERMS.vendors}return g_sources[e]||""};this.getSourceDescription=function(e,i){switch(e){case 3:if(i.p&&g_sources_pvp[i.p]){return{text:g_sources_pvp[i.p]}}break}switch(i.t||0){case 0:case 1:case 2:if(i.z){var a={url:WH.Entity.getPath(WH.Types.ZONE,i.z,WH.Wow.Area.getName(i.z)),text:WH.Wow.Area.getName(i.z)};if(i.t&&e==5){a.pretext=WH.TERMS.vendorin}if(i.dd){let e=t.getNameAbbrev(t.convertLegacyDropDifficulty(i.dd));a.posttext=WH.Strings.sprintf(WH.TERMS.parens_format,"",e)}return a}break;case 5:return{url:"/quests="+i.c2+"."+i.c,text:WH.Wow.Quest.getCategoryName(i.c)};break;case 6:if(i.c&&i.s){return{url:"/spells="+i.c+"."+i.s,text:WH.Wow.Skill.getName(i.s)}}else{return{url:"/spells=0",text:"??"}}break}};this.getThumbUrl=function(e,t,i){return WH.staticUrl+WH.ModelViewer.getStaticBase(WH.getRootEnv(i))+"/webthumbs/item/"+(e&255)+"/"+e+(t?"-"+t:"")+WH.WebP.getImageExtension()};this.getTypeNameAndUrl=function(e,t,i){if(g_item_subsubclasses.hasOwnProperty(e)&&g_item_subsubclasses[e].hasOwnProperty(t)&&g_item_subsubclasses[e][t].hasOwnProperty(i)){return{url:"/items="+e+"."+t+"."+i,text:g_item_subsubclasses[e][t][i]}}if(g_item_subclasses.hasOwnProperty(e)&&g_item_subclasses[e].hasOwnProperty(t)){return{url:"/items="+e+"."+t,text:g_item_subclasses[e][t]}}if(g_item_classes.hasOwnProperty(e)){return{url:"/items="+e,text:g_item_classes[e]}}WH.error("Could not find item class name for: "+JSON.stringify({itemClass:e,itemSubClass:t,itemSubSubClass:i}));return{url:"/items",text:WH.TERMS.unknown}};this.getWeaponSubclasses=function(){let t=WH.cOr({},g_item_subclasses[WH.Wow.Item.CLASS_WEAPON]);if(!i.available(i.LEGION)){delete t[e.WEAPON_SUBCLASS_WARGLAIVE]}if(i.available(i.MOP)){delete t[e.WEAPON_SUBCLASS_THROWN]}let a=Object.keys(t).map(Number);a.sort((function(e,t){return e-t}));e.getWeaponSubclasses=function(e){return e}.bind(this,a);return a};this.isArmorInvType=function(e){return a.includes(e)};this.isBodyArmor=function(t,i){return t===e.CLASS_ARMOR&&n.includes(i)};this.isRangedWeaponSubclass=function(e){return c.includes(e)};this.tooltipHasSpecStats=function(e){const t=WH.Wow.Item.Stat;let i=/<span[^>]*?><!--stat(\d+)-->([-+][\d\.,]+(?:-[\d\.,]+)?\D*?)<\/span>/gi;let a=i.exec(e);while(a!=null){if(g_grayedOutStats.hasOwnProperty(a[1])||[t.ID_AGI_STR_INT,t.ID_AGI_STR,t.ID_AGI_INT,t.ID_STR_INT].includes(parseInt(a[1]))){return true}a=i.exec(e)}return e.indexOf("\x3c!--traitspec")>0};function d(){return u.nameDescriptions=u.nameDescriptions||WH.getPageData("wow.item.bonusNameDescriptions")||{}}};WH.Wow.ItemSet=new function(){this.getThumbUrl=function(e,t,i,a){return WH.staticUrl+WH.ModelViewer.getStaticBase(WH.getRootEnv(a))+"/webthumbs/item-set/"+t+"/"+i+"/"+(Math.abs(e)&255)+"/"+e+WH.WebP.getImageExtension()}};WH.Wow.Models=new function(){this.getRaceIdFromMask=function(e){return e?Math.round(Math.log2(e&-e)+1):null};this.isPepeEnabled=function(){return WH.isRetailTree()}};WH.Wow.Npc=new function(){this.getThumbUrl=function(e,t){return WH.staticUrl+WH.ModelViewer.getStaticBase(t)+"/webthumbs/npc/"+(e&255)+"/"+e+WH.WebP.getImageExtension()}};WH.Wow.Pet=new function(){const e=WH.getPageData("wow.pet.names")||{};this.getName=function(t){return e[t]||null}};WH.Wow.PlayerClass=new function(){const e=this;const t=WH.Wow.Item;this.DEATH_KNIGHT=6;this.DEMON_HUNTER=12;this.DRUID=11;this.HUNTER=3;this.MAGE=8;this.MONK=10;this.PALADIN=2;this.PRIEST=5;this.ROGUE=4;this.SHAMAN=7;this.WARLOCK=9;this.WARRIOR=1;const i=WH.getPageData("wow.playerClass.raceIds")||{};const a={};a[WH.dataEnv.CLASSIC]=[this.DRUID,this.HUNTER,this.MAGE,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR];a[WH.dataEnv.TBC]=[this.DRUID,this.HUNTER,this.MAGE,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR];a[WH.dataEnv.MAIN]=[this.DEATH_KNIGHT,this.DEMON_HUNTER,this.DRUID,this.HUNTER,this.MAGE,this.MONK,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR];const n={};n[this.DEATH_KNIGHT]="deathknight";n[this.DEMON_HUNTER]="demonhunter";n[this.DRUID]="druid";n[this.HUNTER]="hunter";n[this.MAGE]="mage";n[this.MONK]="monk";n[this.PALADIN]="paladin";n[this.PRIEST]="priest";n[this.ROGUE]="rogue";n[this.SHAMAN]="shaman";n[this.WARLOCK]="warlock";n[this.WARRIOR]="warrior";const s=WH.getPageData("wow.playerClass.names")||{};const r={};r[t.ARMOR_SUBCLASS_CLOTH]=[e.MAGE,e.PRIEST,e.WARLOCK];r[t.ARMOR_SUBCLASS_LEATHER]=[e.DEMON_HUNTER,e.DRUID,e.MONK,e.ROGUE];r[t.ARMOR_SUBCLASS_MAIL]=[e.HUNTER,e.SHAMAN];r[t.ARMOR_SUBCLASS_PLATE]=[e.DEATH_KNIGHT,e.PALADIN,e.WARRIOR];const o={[WH.dataEnv.CLASSIC]:{[this.DRUID]:"druid",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"},[WH.dataEnv.TBC]:{[this.DRUID]:"druid",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"},[WH.dataEnv.MAIN]:{[this.DEATH_KNIGHT]:"death-knight",[this.DEMON_HUNTER]:"demon-hunter",[this.DRUID]:"druid",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.MONK]:"monk",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"}};this.canBeRace=function(t,a){if(!i[t]){WH.error("Class not available in current data env.",e.getName(t)||t,WH.getDataEnvKey());return false}return i[t].indexOf(a)>-1};this.getAll=function(){let e=WH.getDataEnv();let t=a[e]||a[WH.getRootEnv()];if(!t){WH.error("No classes defined for "+WH.getDataEnvKey()+".");return[]}return t.slice()};this.getBySlug=function(e){let t=l();for(let i in t){if(t[i]===e){return parseInt(i)}}return undefined};this.getBySpec=function(e){let t=""+e;for(let e in g_chr_specs_by_class){if(g_chr_specs_by_class.hasOwnProperty(e)&&g_chr_specs_by_class[e].includes(t)){return parseInt(e)}}return undefined};this.getIconName=function(e){return"class_"+n[e]};this.getIdString=function(e){return n[e]};this.getName=function(e){return s[e]||null};this.getPreferredArmorSubclass=function(e){for(let t in r){if(r[t].includes(e)){return parseInt(t)}}return undefined};this.getSlug=function(e){return l()[e]};this.removeClasses=function(e){let t=/^c1?\d$/;e.classList.forEach((function(e,i,a){if(t.test(e)){a.remove(e)}}))};function l(){return o[WH.Game.getEnv()]||o[WH.Game.getRoot()]}function c(){for(let t in a){a.hasOwnProperty(t)&&a[t].sort((function(t,i){return(e.getName(t)||"").localeCompare(e.getName(i)||"")}))}}c()};WH.Wow.Quest=new function(){const e=WH.getPageData("wow.quest.types")||{};this.getCategoryName=function(e){return g_quest_sorts[e]};this.getTypeName=function(t){return e[t]||null};this.roundQuestXp=function(e){if(e==undefined){return e}let t=e<1e3?10:50;return Math.round(e/t)*t}};WH.Wow.Race=new function(){const e=this;const t=WH.Wow;this.ID_BLOOD_ELF=10;this.ID_DARK_IRON_DWARF=34;this.ID_DRAENEI=11;this.ID_DWARF=3;this.ID_GNOME=7;this.ID_GOBLIN=9;this.ID_HIGHMOUNTAIN_TAUREN=28;this.ID_HUMAN=1;this.ID_KUL_TIRAN=32;this.ID_LIGHTFORGED_DRAENEI=30;this.ID_MAGHAR_ORC=36;this.ID_MECHAGNOME=37;this.ID_NIGHT_ELF=4;this.ID_NIGHTBORNE=27;this.ID_ORC=2;this.ID_PANDAREN_ALLIANCE=25;this.ID_PANDAREN_HORDE=26;this.ID_PANDAREN_NEUTRAL=24;this.ID_TAUREN=6;this.ID_TROLL=8;this.ID_UNDEAD=5;this.ID_VOID_ELF=29;this.ID_VULPERA=35;this.ID_WORGEN=22;this.ID_ZANDALARI_TROLL=31;var i={1:"human",2:"orc",3:"dwarf",4:"nightelf",5:"scourge",6:"tauren",7:"gnome",8:"troll",9:"goblin",10:"bloodelf",11:"draenei",12:"felorc",13:"naga",14:"broken",15:"skeleton",16:"vrykul",17:"tuskarr",18:"foresttroll",19:"taunka",20:"northrendskeleton",21:"icetroll",22:"worgen",23:"gilnean",24:"pandaren",25:"pandaren",26:"pandaren",27:"nightborne",28:"highmountaintauren",29:"voidelf",30:"lightforgeddraenei",31:"zandalaritroll",32:"kultiran",33:"thinhuman",34:"darkirondwarf",35:"vulpera",36:"magharorc",37:"mechagnome"};const a=1101;const n=690;const s=a|n;const r=[e.ID_DRAENEI,e.ID_DARK_IRON_DWARF,e.ID_DWARF,e.ID_GNOME,e.ID_HUMAN,e.ID_KUL_TIRAN,e.ID_LIGHTFORGED_DRAENEI,e.ID_MECHAGNOME,e.ID_NIGHT_ELF,e.ID_PANDAREN_ALLIANCE,e.ID_VOID_ELF,e.ID_WORGEN];const o=[e.ID_BLOOD_ELF,e.ID_GOBLIN,e.ID_HIGHMOUNTAIN_TAUREN,e.ID_MAGHAR_ORC,e.ID_NIGHTBORNE,e.ID_ORC,e.ID_PANDAREN_HORDE,e.ID_TAUREN,e.ID_TROLL,e.ID_UNDEAD,e.ID_VULPERA,e.ID_ZANDALARI_TROLL];var l={};l[WH.dataTree.RETAIL]={11:"draenei",34:"dark-iron-dwarf",3:"dwarf",7:"gnome",1:"human",32:"kul-tiran",30:"lightforged-draenei",37:"mechagnome",4:"night-elf",25:"alliance-pandaren",29:"void-elf",22:"worgen",10:"blood-elf",9:"goblin",28:"highmountain-tauren",36:"maghar-orc",27:"nightborne",2:"orc",26:"horde-pandaren",6:"tauren",8:"troll",5:"undead",35:"vulpera",31:"zandalari-troll",24:"pandaren"};l[WH.dataTree.CLASSIC]={3:"dwarf",7:"gnome",1:"human",4:"night-elf",2:"orc",6:"tauren",8:"troll",5:"undead"};l[WH.dataTree.TBC]={11:"draenei",3:"dwarf",7:"gnome",1:"human",4:"night-elf",10:"blood-elf",2:"orc",6:"tauren",8:"troll",5:"undead"};const c={localeSortedIds:undefined,localeSortedIdsAll:undefined};this.exists=function(e){if(WH.isClassicTree()){return e>=1&&e<=9}if(WH.isTbcTree()){return e>=1&&e<=11}return i[e]!==undefined};this.getAll=function(){let e=[];let t=l[WH.getDataTree()];for(let i in t){if(t.hasOwnProperty(i)){e.push(parseInt(i))}}return e};this.getIcon=function(i,a){if(!e.isPlayableRace(i)){return undefined}let n=e.getString(i);if(!n){return undefined}let s=t.getGenderString(a)||t.getGenderString(t.GENDER_MALE);return"race_"+n+"_"+s};this.getIdFromSlug=function(e){var t=l[WH.getDataTree()];for(var i in t){if(!t.hasOwnProperty(i)){continue}if(t[i]===e){return parseInt(i)}}return undefined};this.getIdsFromMask=function(t){let i=[];if(t<0){WH.error("Race mask expected to be non-negative.",t);return i}if(window.BigInt){let a=BigInt(t);let n=BigInt(1);let s=1;while(a>0){if(e.exists(s)&&(a&n)===n){i.push(s)}a=a>>n;s++}}else{let a=1;while(a<=32){if(e.exists(a)&&(t&1)===1){i.push(a)}t=t>>>1;a++}}return i.sort(((t,i)=>e.getName(t).localeCompare(e.getName(i))))};this.getIdString=function(e){return i[e]};this.getName=function(e){return g_chr_races[e]};this.getPlayableRaceIds=function(t){var i=t?"localeSortedIdsAll":"localeSortedIds";if(c[i]){return c[i]}var a=[];var n=l[WH.getDataTree()];for(var s in n){if(n.hasOwnProperty(s)&&(t===true||s!=e.ID_PANDAREN_ALLIANCE&&s!=e.ID_PANDAREN_HORDE)){a.push(parseInt(s))}}a.sort((function(t,i){return WH.stringCompare(e.getName(t),e.getName(i))}));c[i]=a;return a};this.getSide=function(e){if((e&s)===a){return t.SIDE_ALLIANCE}else if((e&s)===n){return t.SIDE_HORDE}return undefined};this.getSideByRaceId=function(e){if(r.includes(e)){return t.SIDE_ALLIANCE}if(o.includes(e)){return t.SIDE_HORDE}};this.getSlug=function(e){return l[WH.getDataTree()][e]};this.getString=function(e){return g_file_races[e]};this.getUnique=function(){return e.getAll().filter((function(t){return![e.ID_PANDAREN_ALLIANCE,e.ID_PANDAREN_HORDE].includes(t)}))};this.isPlayableRace=function(t){return e.getSlug(t)!==undefined}};WH.Wow.Realm=new function(){const e={callbacks:[],dataRequested:false};this.fetchData=function(i){if(window["g_bnet_realms"]){window.requestAnimationFrame(i);return}if(e.dataRequested){e.callbacks.push(i);return}let a=WH.ajaxIshRequest(WH.Url.getDataPageUrl("realms"));if(a){WH.aE(a,"load",t);if(i){e.callbacks.push(i)}}e.dataRequested=true};this.getAll=function(){return window["g_bnet_realms"]||null};this.getSlugByName=function(e,t){var i=this.getAll();if(!i){return null}i=i[e.toUpperCase()];if(!i){return null}var a="name_"+Locale.getName();t=t.toLocaleLowerCase();for(var n in i){if(!i.hasOwnProperty(n)){continue}var s=i[n];if(s.name.toLocaleLowerCase()===t){return s.slug}if(s[a]&&s[a].toLocaleLowerCase()===t){return s.slug}}return null};function t(){if(!window["g_bnet_realms"]){WH.error("The realm data failed to load.");return}while(e.callbacks.length){var t=e.callbacks.shift();try{t()}catch(e){WH.error("Realm data loading callback error:",e)}}}};WH.Wow.Skill=new function(){this.CATEGORY_TALENTS=-2;this.ID_DEFENSE=95;this.ID_RIDING=762;this.ID_AXES=44;this.ID_BOWS=45;this.ID_CROSSBOWS=226;this.ID_DAGGERS=173;this.ID_FIST_WEAPONS=473;this.ID_GUNS=46;this.ID_MACES=54;this.ID_POLEARMS=229;this.ID_STAVES=136;this.ID_SWORDS=43;this.ID_THROWN=176;this.ID_TWO_HANDED_AXES=172;this.ID_TWO_HANDED_MACES=160;this.ID_TWO_HANDED_SWORDS=55;this.ID_UNARMED=162;this.ID_WANDS=228;const e=WH.getPageData("wow.skill.names")||{};this.getName=function(t){return e[t]||null}};WH.Wow.Spell=new function(){this.AURA_EFFECT_MOD_RESISTANCE=22;this.AURA_EFFECT_MOD_SKILL_TEMPORARY=30;this.AURA_EFFECT_MOD_PARRY_PCT=47;this.AURA_EFFECT_MOD_DODGE_PCT=49;this.AURA_EFFECT_MOD_BLOCK_PCT=51;this.AURA_EFFECT_MOD_MELEE_RANGED_CRIT_PCT=52;this.AURA_EFFECT_MOD_MELEE_RANGED_HIT_CHANCE_PCT=54;this.AURA_EFFECT_MOD_SPELL_HIT_CHANCE_PCT=55;this.AURA_EFFECT_MOD_SPELL_CRIT_PCT=57;this.AURA_EFFECT_MOD_SPELL_CRIT_PCT2=71;this.AURA_EFFECT_MOD_SKILL=98;this.AURA_EFFECT_ADD_MODIFIER_FLAT=107;this.AURA_EFFECT_REDUCE_TARGET_RESISTANCES_FLAT=123;this.AURA_EFFECT_MOD_INCREASE_MAXIMUM_POWER_PCT=132;this.AURA_EFFECT_MOD_INCREASE_MAXIMUM_HEALTH_PCT=133;this.AURA_EFFECT_ALLOW_PCT_OF_MANA_REGENERATION_TO_CONTINUE_IN_COMBAT=134;this.AURA_EFFECT_MOD_STAT_PCT2=137;this.AURA_EFFECT_MOD_BASE_RESISTANCE_PCT=142;this.AURA_EFFECT_MOD_BLOCK_VALUE_PCT=150;this.AURA_EFFECT_MOD_MELEE_ATTACK_POWER_PCT=166;this.AURA_EFFECT_MOD_RANGED_ATTACK_POWER_PCT=167;this.AURA_EFFECT_MOD_SPELL_POWER_BY_PCT_OF_STAT=174;this.AURA_EFFECT_MOD_HEALING_POWER_BY_PCT_OF_STAT=175;this.AURA_EFFECT_MOD_RESISTANCE_BY_PCT_OF_STAT=182;this.AURA_EFFECT_MOD_ATTACKER_MELEE_HIT_CHANCE_PCT=184;this.AURA_EFFECT_MOD_ATTACKER_RANGED_HIT_CHANCE_PCT=185;this.AURA_EFFECT_MOD_ATTACKER_MELEE_CRIT_CHANCE_PCT=187;this.AURA_EFFECT_MOD_ATTACKER_RANGED_CRIT_CHANCE_PCT=188;this.AURA_EFFECT_MOD_SPELL_HIT_CHANCE_PCT2=199;this.AURA_EFFECT_MOD_RANGED_ATTACK_POWER_BY_PCT_OF_STAT=212;this.AURA_EFFECT_ADD_MODIFIER_FLAT_LABEL=219;this.AURA_EFFECT_MOD_SPELL_POWER_BY_PCT_OF_ATTACK_POWER=237;this.AURA_EFFECT_MOD_HEALING_POWER_BY_PCT_OF_ATTACK_POWER=238;this.AURA_EFFECT_MOD_EXPERTISE=240;this.FLAGS4_REQUIRES_OFFHAND_WEAPON=16777216;this.ID_EXOTIC_BEASTS=53270;this.OPTIONAL_REAGENT_ICON_PATH="/images/wow/interface/GuildFrame/communities-icon-addgroupplus.png";const e=[15,25,30,35,40,45,50];this.get=function(e){return WH.Gatherer.get(WH.Types.SPELL,e)||null};this.getName=function(e){return WH.Gatherer.getName(WH.Types.SPELL,e)};this.getPath=function(e,t){return WH.Entity.getPath(WH.Types.SPELL,e,t)};this.getTalentLevels=function(){return e}};WH.Wow.TransmogSet=new function(){this.getCompletionAmount=function(e,t){if(!e||!g_completion.wardrobe||!(t in g_completion.wardrobe)){return null}let i=g_completion.wardrobe[t]||[];let a=Object.keys(e);if(a.length===0){return 0}let n=0;a.forEach((function(t){let a=e[t];for(let e=0;e<a.length;e++){if(i.includes(t+"|"+a[e])){n++;return}}}));return n/a.length};this.getThumbUrl=function(e,t,i,a){return WH.staticUrl+WH.ModelViewer.getStaticBase(WH.getRootEnv(a))+"/webthumbs/transmog/"+t+"/"+i+"/"+(e&255)+"/"+e+WH.WebP.getImageExtension()}};WH.Wow.UiMap=new function(){const e=this;this.clickToCopyCoordinates=function(e,t,a){a=a||{};let n=typeof t==="function"?t:function(){return t};e.style.cursor="pointer";WH.Tooltip.simple(e,(function(){let e=WH.ce("div",undefined,WH.ct(n().join(WH.TERMS.comma_punct)));WH.ae(e,WH.ce("div",{className:"q2",style:{marginTop:"10px"}},WH.ct(WH.TERMS.clickToCopy)));return e.innerHTML}),"q",true,true,true);WH.aE(e,"click",i.bind(e,n,a))};this.generateInGamePinLinkCommand=function(e,t,i,a){let n;if(a){n="\\124A:Waypoint-MapPin-ChatIcon:13:13:0:0\\124a "+WH.term("mapPin_format",a).replace(/:+$/,"").replace(/"/g,'\\"')}else{n=WH.GlobalStrings.MAP_PIN_HYPERLINK.replace(/\|/g,"\\124")}return'/script DEFAULT_CHAT_FRAME:AddMessage("'+"\\124cffffff00\\124Hworldmap:"+e+":"+t+":"+i+"\\124h["+n+"]\\124h\\124r"+'");'};this.generateTomTomCommand=function(e,t){let i=t.uiMapId?" #"+t.uiMapId:t.uiMapName?" "+t.uiMapName:"";let a="/way"+i+" "+e[0]+" "+e[1];if(t.name&&t.name!==t.uiMapName){a+=" "+t.name}return a};function t(e,t){return{x:parseFloat(e[0])*100,y:parseFloat(e[1])*100,name:t.name&&t.uiMapName?WH.term("parens_format",t.name,t.uiMapName):t.name||t.uiMapName}}function i(i,a){let n=i();let s=a.getAllCoords?a.getAllCoords():null;if(s&&s.length<=1){s=null}let r=a.getAllInGameMapPins?a.getAllInGameMapPins():null;if(r&&r.length<=1){r=null}let o=a.getAllTomTomCommands?a.getAllTomTomCommands():null;if(o&&o.length<=1){o=null}let l=[Menu.createHeading({label:WH.TERMS.copy_clipboard})];let c=s||o?[Menu.createHeading({label:WH.TERMS.copyAll})]:null;l.push(Menu.createItem({label:WH.TERMS.coordinates,url:function(e){WH.copyToClipboard(n.join(" "),e)}}));if(s){c.push(Menu.createItem({label:WH.TERMS.coordinates,url:function(e){let t=[];s.forEach((function(e){t.push(e.join(" "))}));WH.copyToClipboard(t.join("\n"),e)}}))}if(a.uiMapId){l.push(Menu.createItem({label:WH.TERMS.inGameMapPin,url:function(i){let s=t(n,a);let r=e.generateInGamePinLinkCommand(a.uiMapId,s.x,s.y,s.name);WH.copyToClipboard(r,i)}}));if(r){c.push(Menu.createItem({label:WH.TERMS.inGameMapPin,url:function(e){WH.copyToClipboard(r.join("\n"),e)}}))}else if(s){c.push(Menu.createItem({label:WH.TERMS.inGameMapPin,url:function(i){let n=[];s.forEach((function(i){let s=t(i,a);n.push(e.generateInGamePinLinkCommand(a.uiMapId,s.x,s.y,s.name))}));WH.copyToClipboard(n.join("\n"),i)}}))}}if(a.includeTomTom||a.uiMapId||a.uiMapName){l.push(Menu.createItem({label:WH.TERMS.tomTomCommand,url:function(t){WH.copyToClipboard(e.generateTomTomCommand(n,a),t)}}));if(o){c.push(Menu.createItem({label:WH.TERMS.tomTomCommand,url:function(e){WH.copyToClipboard(o.join("\n"),e)}}))}else if(s){c.push(Menu.createItem({label:WH.TERMS.tomTomCommand,url:function(t){let i=[];s.forEach((function(t){i.push(e.generateTomTomCommand(t,a))}));WH.copyToClipboard(i.join("\n"),t)}}))}}let u=c?l.concat(c):l;if(u.length===2){u[1][Menu.ITEM_URL]();return}Menu.show(u,this)}};WH.Wow.Item.Gems=new function(){const e=this;this.MASK_META=1;this.MASK_RED=2;this.MASK_YELLOW=4;this.MASK_BLUE=8;this.MASK_ORANGE=this.MASK_RED|this.MASK_YELLOW;this.MASK_PURPLE=this.MASK_RED|this.MASK_BLUE;this.MASK_GREEN=this.MASK_YELLOW|this.MASK_BLUE;this.MASK_PRISMATIC=this.MASK_RED|this.MASK_YELLOW|this.MASK_BLUE;this.SOCKET_META=1;this.SOCKET_RED=2;this.SOCKET_YELLOW=3;this.SOCKET_BLUE=4;this.SOCKET_SHA_TOUCHED=5;this.SOCKET_COGWHEEL=6;this.SOCKET_PRISMATIC=7;this.SOCKET_RELIC_IRON=8;this.SOCKET_RELIC_BLOOD=9;this.SOCKET_RELIC_SHADOW=10;this.SOCKET_RELIC_FEL=11;this.SOCKET_RELIC_ARCANE=12;this.SOCKET_RELIC_FROST=13;this.SOCKET_RELIC_FIRE=14;this.SOCKET_RELIC_WATER=15;this.SOCKET_RELIC_LIFE=16;this.SOCKET_RELIC_STORM=17;this.SOCKET_RELIC_HOLY=18;this.SOCKET_PUNCHCARD_RED=19;this.SOCKET_PUNCHCARD_YELLOW=20;this.SOCKET_PUNCHCARD_BLUE=21;this.SOCKET_DOMINATION=22;const t=[];const i={};i[this.MASK_META]="meta";i[this.MASK_RED]="red";i[this.MASK_YELLOW]="yellow";i[this.MASK_ORANGE]="orange";i[this.MASK_BLUE]="blue";i[this.MASK_PURPLE]="purple";i[this.MASK_GREEN]="green";i[this.MASK_PRISMATIC]="prismatic";const a={};a[this.SOCKET_META]=this.MASK_META;a[this.SOCKET_RED]=this.MASK_RED;a[this.SOCKET_YELLOW]=this.MASK_YELLOW;a[this.SOCKET_BLUE]=this.MASK_BLUE;a[this.SOCKET_PRISMATIC]=this.MASK_PRISMATIC;this.getGemMaskFromType=function(e){return a[e]};this.getGemMaskString=function(e){return i[e]};this.getGemColorName=function(e){return g_gem_colors[e]};this.getGemColors=function(){if(WH.isClassicTree()){return[]}if(!t.length){let i=[e.MASK_META,e.MASK_RED,e.MASK_ORANGE,e.MASK_YELLOW,e.MASK_GREEN,e.MASK_BLUE,e.MASK_PURPLE,e.MASK_PRISMATIC];let a=Object.keys(g_gem_colors);a.sort((function(t,a){t=parseInt(t);a=parseInt(a);let n=i.indexOf(t);let s=i.indexOf(a);if(n<0){if(s<0){return e.getGemColorName(t).localeCompare(e.getGemColorName(a))}return 1}else{if(s<0){return-1}return n-s}}));a.forEach((function(i){let a=parseInt(i);t.push({id:a,name:e.getGemColorName(a)})}))}return JSON.parse(JSON.stringify(t))};this.getSocketTypeName=function(e){return g_gem_types[e]}};WH.Wow.Item.Stat=new function(){const e=this;this.ID_MANA=0;this.ID_HEALTH=1;this.ID_ENDURANCE=2;this.ID_AGILITY=3;this.ID_STRENGTH=4;this.ID_INTELLECT=5;this.ID_SPIRIT=6;this.ID_STAMINA=7;this.ID_ENERGY=8;this.ID_RAGE=9;this.ID_FOCUS=10;this.ID_WEAPON_SKILL_RATING=11;this.ID_DEFENSE_SKILL_RATING=12;this.ID_DODGE_RATING=13;this.ID_PARRY_RATING=14;this.ID_BLOCK_RATING=15;this.ID_HIT_MELEE_RATING=16;this.ID_HIT_RANGED_RATING=17;this.ID_HIT_SPELL_RATING=18;this.ID_CRIT_MELEE_RATING=19;this.ID_CRIT_RANGED_RATING=20;this.ID_CRIT_SPELL_RATING=21;this.ID_CRAFTING_STAT_1=24;this.ID_CRAFTING_STAT_2=25;this.ID_HASTE_MELEE_RATING=28;this.ID_HASTE_RANGED_RATING=29;this.ID_HASTE_SPELL_RATING=30;this.ID_HIT_RATING=31;this.ID_CRIT_RATING=32;this.ID_RESILIENCE_RATING=35;this.ID_HASTE_RATING=36;this.ID_EXPERTISE_RATING=37;this.ID_ATTACK_POWER=38;this.ID_RANGED_ATTACK_POWER=39;this.ID_VERSATILITY_RATING=40;this.ID_SPELL_HEALING_DONE=41;this.ID_SPELL_DAMAGE_DONE=42;this.ID_MANA_REGENERATION=43;this.ID_ARMOR_PENETRATION_RATING=44;this.ID_SPELL_POWER=45;this.ID_HEALTH_REGENERATION=46;this.ID_SPELL_PENETRATION=47;this.ID_BLOCK_VALUE=48;this.ID_MASTERY_RATING=49;this.ID_ARMOR=50;this.ID_FIRE_RESISTANCE=51;this.ID_FROST_RESISTANCE=52;this.ID_HOLY_RESISTANCE=53;this.ID_SHADOW_RESISTANCE=54;this.ID_NATURE_RESISTANCE=55;this.ID_ARCANE_RESISTANCE=56;this.ID_SPEED_RATING=61;this.ID_LEECH_RATING=62;this.ID_AVOIDANCE_RATING=63;this.ID_AGI_STR_INT=71;this.ID_AGI_STR=72;this.ID_AGI_INT=73;this.ID_STR_INT=74;this.CRAFTING_STAT_FROM=[this.ID_CRAFTING_STAT_1,this.ID_CRAFTING_STAT_2];this.CRAFTING_STAT_TO=[this.ID_CRIT_RATING,this.ID_HASTE_RATING,this.ID_VERSATILITY_RATING,this.ID_MASTERY_RATING,this.ID_SPEED_RATING,this.ID_LEECH_RATING,this.ID_AVOIDANCE_RATING];const t={agi:WH.TERMS.agility_abbrev,amplify:WH.TERMS.amplify_abbrev,arcres:WH.TERMS.arcaneresist_abbrev,arcsplpwr:WH.TERMS.arcanepower_abbrev,armor:WH.TERMS.armor,armorbonus:WH.TERMS.additionalarmor_abbrev,armorpenrtng:WH.TERMS.penetration_abbrev,atkpwr:WH.TERMS.attackpower_abbrev,avoidance:WH.TERMS.avoidance_abbrev,block:WH.TERMS.blockvalue_abbrev,blockrtng:WH.TERMS.block,cleave:WH.TERMS.cleave_abbrev,corruption:WH.TERMS.corruption_abbrev,corruptionres:WH.TERMS.corruptionResistance_abbrev,critstrkrtng:WH.TERMS.crit,defrtng:WH.TERMS.defense_abbrev,dmg:WH.TERMS.damage_abbrev,dmgmax1:WH.TERMS.maximum_abbrev,dmgmin1:WH.TERMS.minimum_abbrev,dodgertng:WH.TERMS.dodge,dps:WH.TERMS.dps,exprtng:WH.TERMS.expertise_abbrev,firres:WH.TERMS.fireresist_abbrev,firsplpwr:WH.TERMS.firepower_abbrev,frores:WH.TERMS.frostresist_abbrev,frosplpwr:WH.TERMS.frostpower_abbrev,hastertng:WH.TERMS.haste,health:WH.TERMS.health_abbrev,healthrgn:WH.TERMS.healthregen_abbrev,hitrtng:WH.TERMS.hit,holres:WH.TERMS.holyresist_abbrev,holsplpwr:WH.TERMS.holypower_abbrev,int:WH.TERMS.intellect_abbrev,level:WH.TERMS.level_abbrev,lifesteal:WH.TERMS.leech_abbrev,mana:WH.TERMS.mana,manargn:WH.TERMS.manaregen_abbrev,mastrtng:WH.TERMS.mastery_abbrev,mleatkpwr:WH.TERMS.attackpower_abbrev,mlecritstrkrtng:WH.TERMS.crit,mledmgmax:WH.TERMS.maximum_abbrev,mledmgmin:WH.TERMS.minimum_abbrev,mledps:WH.TERMS.dps,mlehastertng:WH.TERMS.haste,mlehitrtng:WH.TERMS.hit,mlespeed:WH.TERMS.speed,multistrike:WH.TERMS.multistrike_abbrev,natres:WH.TERMS.natureresist_abbrev,natsplpwr:WH.TERMS.naturepower_abbrev,nsockets:WH.TERMS.socket_abbrev,parryrtng:WH.TERMS.parry,pvppower:WH.TERMS.pvppower_abbrev,readiness:WH.TERMS.readiness_abbrev,reqarenartng:WH.TERMS.rating,reqlevel:WH.TERMS.level,resirtng:WH.TERMS.resilience_abbrev,rgdatkpwr:WH.TERMS.rangedap_abbrev,rgdcritstrkrtng:WH.TERMS.crit,rgddmgmax:WH.TERMS.maximum_abbrev,rgddmgmin:WH.TERMS.minimum_abbrev,rgddps:WH.TERMS.dps,rgdhastertng:WH.TERMS.haste,rgdhitrtng:WH.TERMS.hit,rgdspeed:WH.TERMS.speed,shares:WH.TERMS.shadowresist_abbrev,shasplpwr:WH.TERMS.shadowpower_abbrev,speed:WH.TERMS.speed,speedbonus:WH.TERMS.speedbonus_abbrev,spi:WH.TERMS.spirit_abbrev,splcritstrkrtng:WH.TERMS.crit,spldmg:WH.TERMS.damage_abbrev,splhastertng:WH.TERMS.haste,splheal:WH.TERMS.heal,splhitrtng:WH.TERMS.hit,splpen:WH.TERMS.penetration_abbrev,splpwr:WH.TERMS.spellpower_abbrev,sta:WH.TERMS.stamina_abbrev,str:WH.TERMS.strength_abbrev,sturdiness:WH.TERMS.indestructible_abbrev,versatility:WH.TERMS.versatility_abbrev};const i=0;const a=1;const n=2;const s=3;const r=4;const o={};o[i]=e.ID_STRENGTH;o[a]=e.ID_AGILITY;o[n]=e.ID_STAMINA;o[s]=e.ID_INTELLECT;o[r]=e.ID_SPIRIT;const l={agi:WH.TERMS.agility,amplify:WH.TERMS.amplifyrating_stc,arcres:WH.TERMS.arcaneresistance_stc,arcsplpwr:WH.TERMS.arcanespellpower_stc,armor:WH.TERMS.armor,armorbonus:WH.TERMS.additionalarmor_stc,armorpenrtng:WH.TERMS.armorpenetrationrating_stc,atkpwr:WH.TERMS.attackpower_stc,avoidance:WH.TERMS.avoidancerating_stc,block:WH.TERMS.blockvalue_stc,blockrtng:WH.TERMS.blockrating_stc,cleave:WH.TERMS.cleaverating_stc,corruption:WH.TERMS.corruption,corruptionres:WH.TERMS.corruptionResistance_stc,critstrkrtng:WH.TERMS.criticalstrikerating_stc,defrtng:WH.TERMS.defenserating_stc,dmg:WH.TERMS.weapondamage_stc,dmgmax1:WH.TERMS.maximumdamage_stc,dmgmin1:WH.TERMS.minimumdamage_stc,dodgertng:WH.TERMS.dodgerating_stc,dps:WH.TERMS.damagepersecond_stc,exprtng:WH.TERMS.expertiserating_stc,firres:WH.TERMS.fireresistance_stc,firsplpwr:WH.TERMS.firespellpower_stc,frores:WH.TERMS.frostresistance_stc,frosplpwr:WH.TERMS.frostspellpower_stc,hastertng:WH.TERMS.hasterating_stc,health:WH.TERMS.health,healthrgn:WH.TERMS.healthregeneration_stc,hitrtng:WH.TERMS.hitrating_stc,holres:WH.TERMS.holyresistance_stc,holsplpwr:WH.TERMS.holyspellpower_stc,int:WH.TERMS.intellect,level:WH.TERMS.level,lifesteal:WH.TERMS.leechrating_stc,mana:WH.TERMS.mana,manargn:WH.TERMS.manaregeneration_stc,mastrtng:WH.TERMS.masteryrating_stc,mleatkpwr:WH.TERMS.meleeattackpower_stc,mlecritstrkrtng:WH.TERMS.meleecriticalstrikerating_stc,mledmgmax:WH.TERMS.meleemaximumdamage_stc,mledmgmin:WH.TERMS.meleeminimumdamage_stc,mledps:WH.TERMS.meleedps,mlehastertng:WH.TERMS.meleehasterating_stc,mlehitrtng:WH.TERMS.meleehitrating_stc,mlespeed:WH.TERMS.meleespeed_stc,multistrike:WH.TERMS.multistrikerating_stc,natres:WH.TERMS.natureresistance_stc,natsplpwr:WH.TERMS.naturespellpower_stc,nsockets:WH.TERMS.numberofsockets_stc,parryrtng:WH.TERMS.parryrating_stc,pvppower:WH.TERMS.pvppower,readiness:WH.TERMS.readinessrating_stc,reqarenartng:WH.TERMS.requiredpersonalandteamarenarating_stc,reqlevel:WH.TERMS.requiredlevel_stc,resirtng:WH.TERMS.resiliencerating_stc,rgdatkpwr:WH.TERMS.rangedattackpower_stc,rgdcritstrkrtng:WH.TERMS.rangedcriticalstrikerating_stc,rgddmgmax:WH.TERMS.rangedmaximumdamage_stc,rgddmgmin:WH.TERMS.rangedminimumdamage_stc,rgddps:WH.TERMS.rangeddps,rgdhastertng:WH.TERMS.rangedhasterating_stc,rgdhitrtng:WH.TERMS.rangedhitrating_stc,rgdspeed:WH.TERMS.rangedspeed_stc,shares:WH.TERMS.shadowresistance_stc,shasplpwr:WH.TERMS.shadowspellpower_stc,speed:WH.TERMS.speed,speedbonus:WH.TERMS.speedbonus,spi:WH.TERMS.spirit,splcritstrkrtng:WH.TERMS.spellcriticalstrikerating_stc,spldmg:WH.TERMS.damagedonebyspells_stc,splhastertng:WH.TERMS.spellhasterating_stc,splheal:WH.TERMS.healingdonebyspells_stc,splhitrtng:WH.TERMS.spellhitrating_stc,splpen:WH.TERMS.spellpenetration_stc,splpwr:WH.TERMS.spellpower_stc,sta:WH.TERMS.stamina,str:WH.TERMS.strength,sturdiness:WH.TERMS.indestructiblerating_stc,versatility:WH.TERMS.versatilityrating_stc};const c={agi:WH.TERMS.agility,amplify:WH.TERMS.amplify,arcres:WH.TERMS.arcaneresist,arcsplpwr:WH.TERMS.arcanepower,armor:WH.TERMS.armor,armorbonus:WH.TERMS.bonusarmor,armorpenrtng:WH.TERMS.armorpen,atkpwr:WH.TERMS.attackpower_abbrev,avoidance:WH.TERMS.avoidance,block:WH.TERMS.blockvalue,blockrtng:WH.TERMS.block,cleave:WH.TERMS.cleave,corruption:WH.TERMS.corruption,corruptionres:WH.TERMS.corruptionResist,critstrkrtng:WH.TERMS.crit,defrtng:WH.TERMS.defense,dmg:WH.TERMS.damage,dmgmax1:WH.TERMS.maxdamage,dmgmin1:WH.TERMS.mindamage,dodgertng:WH.TERMS.dodge,dps:WH.TERMS.dps,exprtng:WH.TERMS.expertise,firres:WH.TERMS.fireresist,firsplpwr:WH.TERMS.firepower,frores:WH.TERMS.frostresist,frosplpwr:WH.TERMS.frostpower,hastertng:WH.TERMS.haste,health:WH.TERMS.health,healthrgn:WH.TERMS.healthregen_abbrev,hitrtng:WH.TERMS.hit,holres:WH.TERMS.holyresist,holsplpwr:WH.TERMS.holypower,int:WH.TERMS.intellect,level:WH.TERMS.level,lifesteal:WH.TERMS.leech,mana:WH.TERMS.mana,manargn:WH.TERMS.manaregen_abbrev,mastrtng:WH.TERMS.mastery,mleatkpwr:WH.TERMS.meleeap,mlecritstrkrtng:WH.TERMS.meleecrit,mledmgmax:WH.TERMS.meleemaxdamage,mledmgmin:WH.TERMS.meleemindamage,mledps:WH.TERMS.meleedps,mlehastertng:WH.TERMS.meleehaste,mlehitrtng:WH.TERMS.meleehit,mlespeed:WH.TERMS.meleespeed,multistrike:WH.TERMS.multistrike,natres:WH.TERMS.natureresist,natsplpwr:WH.TERMS.naturepower,nsockets:WH.TERMS.sockets,parryrtng:WH.TERMS.parry,pvppower:WH.TERMS.pvppower_abbrev,readiness:WH.TERMS.readiness,reqarenartng:WH.TERMS.reqrating,reqlevel:WH.TERMS.reqlevel,resirtng:WH.TERMS.resilience,rgdatkpwr:WH.TERMS.rangedap,rgdcritstrkrtng:WH.TERMS.rangedcrit,rgddmgmax:WH.TERMS.rangedmaxdamage,rgddmgmin:WH.TERMS.rangedmindamage,rgddps:WH.TERMS.rangeddps,rgdhastertng:WH.TERMS.rangedhaste,rgdhitrtng:WH.TERMS.rangedhit,rgdspeed:WH.TERMS.rangedspeed,shares:WH.TERMS.shadowresist,shasplpwr:WH.TERMS.shadowpower,speed:WH.TERMS.speed,speedbonus:WH.TERMS.speedbonus,spi:WH.TERMS.spirit,splcritstrkrtng:WH.TERMS.spellcrit,spldmg:WH.TERMS.spelldamage,splhastertng:WH.TERMS.spellhaste,splheal:WH.TERMS.healing,splhitrtng:WH.TERMS.spellhit,splpen:WH.TERMS.spellpen,splpwr:WH.TERMS.spellpower,sta:WH.TERMS.stamina,str:WH.TERMS.strength,sturdiness:WH.TERMS.indestructible,versatility:WH.TERMS.versatility};this.convertBaseIndex=function(e){return o[e]};this.jsonToAbbr=function(e){return t[e]};this.jsonToDesc=function(e){return l[e]};this.jsonToName=function(e){return c[e]}};WH.Wow.PlayerClass.Specialization=new function(){const e=this;const t=WH.Icon;const i=WH.Wow.PlayerClass;this.ID_DEATH_KNIGHT_BLOOD=250;this.ID_DEATH_KNIGHT_FROST=251;this.ID_DEATH_KNIGHT_UNHOLY=252;this.ID_DEMON_HUNTER_HAVOC=577;this.ID_DEMON_HUNTER_VENGEANCE=581;this.ID_DRUID_BALANCE=102;this.ID_DRUID_FERAL=103;this.ID_DRUID_GUARDIAN=104;this.ID_DRUID_RESTORATION=105;this.ID_HUNTER_BEAST_MASTERY=253;this.ID_HUNTER_MARKSMANSHIP=254;this.ID_HUNTER_SURVIVAL=255;this.ID_MAGE_ARCANE=62;this.ID_MAGE_FIRE=63;this.ID_MAGE_FROST=64;this.ID_MONK_BREWMASTER=268;this.ID_MONK_MISTWEAVER=270;this.ID_MONK_WINDWALKER=269;this.ID_PALADIN_HOLY=65;this.ID_PALADIN_PROTECTION=66;this.ID_PALADIN_RETRIBUTION=70;this.ID_PRIEST_DISCIPLINE=256;this.ID_PRIEST_HOLY=257;this.ID_PRIEST_SHADOW=258;this.ID_ROGUE_ASSASSINATION=259;this.ID_ROGUE_OUTLAW=260;this.ID_ROGUE_SUBTLETY=261;this.ID_SHAMAN_ELEMENTAL=262;this.ID_SHAMAN_ENHANCEMENT=263;this.ID_SHAMAN_RESTORATION=264;this.ID_WARLOCK_AFFLICTION=265;this.ID_WARLOCK_DEMONOLOGY=266;this.ID_WARLOCK_DESTRUCTION=267;this.ID_WARRIOR_ARMS=71;this.ID_WARRIOR_FURY=72;this.ID_WARRIOR_PROTECTION=73;this.ID_CLASSIC_DRUID_BALANCE=283;this.ID_CLASSIC_DRUID_FERAL_COMBAT=281;this.ID_CLASSIC_DRUID_RESTORATION=282;this.ID_CLASSIC_HUNTER_BEAST_MASTERY=361;this.ID_CLASSIC_HUNTER_MARKSMANSHIP=363;this.ID_CLASSIC_HUNTER_SURVIVAL=362;this.ID_CLASSIC_MAGE_ARCANE=81;this.ID_CLASSIC_MAGE_FIRE=41;this.ID_CLASSIC_MAGE_FROST=61;this.ID_CLASSIC_PALADIN_HOLY=382;this.ID_CLASSIC_PALADIN_PROTECTION=383;this.ID_CLASSIC_PALADIN_RETRIBUTION=381;this.ID_CLASSIC_PRIEST_DISCIPLINE=201;this.ID_CLASSIC_PRIEST_HOLY=202;this.ID_CLASSIC_PRIEST_SHADOW=203;this.ID_CLASSIC_ROGUE_ASSASSINATION=182;this.ID_CLASSIC_ROGUE_COMBAT=181;this.ID_CLASSIC_ROGUE_SUBTLETY=183;this.ID_CLASSIC_SHAMAN_ELEMENTAL=261;this.ID_CLASSIC_SHAMAN_ENHANCEMENT=263;this.ID_CLASSIC_SHAMAN_RESTORATION=262;this.ID_CLASSIC_WARLOCK_AFFLICTION=302;this.ID_CLASSIC_WARLOCK_DEMONOLOGY=303;this.ID_CLASSIC_WARLOCK_DESTRUCTION=301;this.ID_CLASSIC_WARRIOR_ARMS=161;this.ID_CLASSIC_WARRIOR_FURY=164;this.ID_CLASSIC_WARRIOR_PROTECTION=163;const a={};a[WH.dataEnv.CLASSIC]={};a[WH.dataEnv.CLASSIC][i.DRUID]=[this.ID_CLASSIC_DRUID_BALANCE,this.ID_CLASSIC_DRUID_FERAL_COMBAT,this.ID_CLASSIC_DRUID_RESTORATION];a[WH.dataEnv.CLASSIC][i.HUNTER]=[this.ID_CLASSIC_HUNTER_BEAST_MASTERY,this.ID_CLASSIC_HUNTER_MARKSMANSHIP,this.ID_CLASSIC_HUNTER_SURVIVAL];a[WH.dataEnv.CLASSIC][i.MAGE]=[this.ID_CLASSIC_MAGE_ARCANE,this.ID_CLASSIC_MAGE_FIRE,this.ID_CLASSIC_MAGE_FROST];a[WH.dataEnv.CLASSIC][i.PALADIN]=[this.ID_CLASSIC_PALADIN_HOLY,this.ID_CLASSIC_PALADIN_PROTECTION,this.ID_CLASSIC_PALADIN_RETRIBUTION];a[WH.dataEnv.CLASSIC][i.PRIEST]=[this.ID_CLASSIC_PRIEST_DISCIPLINE,this.ID_CLASSIC_PRIEST_HOLY,this.ID_CLASSIC_PRIEST_SHADOW];a[WH.dataEnv.CLASSIC][i.ROGUE]=[this.ID_CLASSIC_ROGUE_ASSASSINATION,this.ID_CLASSIC_ROGUE_COMBAT,this.ID_CLASSIC_ROGUE_SUBTLETY];a[WH.dataEnv.CLASSIC][i.SHAMAN]=[this.ID_CLASSIC_SHAMAN_ELEMENTAL,this.ID_CLASSIC_SHAMAN_ENHANCEMENT,this.ID_CLASSIC_SHAMAN_RESTORATION];a[WH.dataEnv.CLASSIC][i.WARLOCK]=[this.ID_CLASSIC_WARLOCK_AFFLICTION,this.ID_CLASSIC_WARLOCK_DEMONOLOGY,this.ID_CLASSIC_WARLOCK_DESTRUCTION];a[WH.dataEnv.CLASSIC][i.WARRIOR]=[this.ID_CLASSIC_WARRIOR_ARMS,this.ID_CLASSIC_WARRIOR_FURY,this.ID_CLASSIC_WARRIOR_PROTECTION];a[WH.dataEnv.TBC]=a[WH.dataEnv.CLASSIC];a[WH.dataEnv.MAIN]={};a[WH.dataEnv.MAIN][i.DEATH_KNIGHT]=[this.ID_DEATH_KNIGHT_BLOOD,this.ID_DEATH_KNIGHT_FROST,this.ID_DEATH_KNIGHT_UNHOLY];a[WH.dataEnv.MAIN][i.DEMON_HUNTER]=[this.ID_DEMON_HUNTER_HAVOC,this.ID_DEMON_HUNTER_VENGEANCE];a[WH.dataEnv.MAIN][i.DRUID]=[this.ID_DRUID_BALANCE,this.ID_DRUID_FERAL,this.ID_DRUID_GUARDIAN,this.ID_DRUID_RESTORATION];a[WH.dataEnv.MAIN][i.HUNTER]=[this.ID_HUNTER_BEAST_MASTERY,this.ID_HUNTER_MARKSMANSHIP,this.ID_HUNTER_SURVIVAL];a[WH.dataEnv.MAIN][i.MAGE]=[this.ID_MAGE_ARCANE,this.ID_MAGE_FIRE,this.ID_MAGE_FROST];a[WH.dataEnv.MAIN][i.MONK]=[this.ID_MONK_BREWMASTER,this.ID_MONK_MISTWEAVER,this.ID_MONK_WINDWALKER];a[WH.dataEnv.MAIN][i.PALADIN]=[this.ID_PALADIN_HOLY,this.ID_PALADIN_PROTECTION,this.ID_PALADIN_RETRIBUTION];a[WH.dataEnv.MAIN][i.PRIEST]=[this.ID_PRIEST_DISCIPLINE,this.ID_PRIEST_HOLY,this.ID_PRIEST_SHADOW];a[WH.dataEnv.MAIN][i.ROGUE]=[this.ID_ROGUE_ASSASSINATION,this.ID_ROGUE_OUTLAW,this.ID_ROGUE_SUBTLETY];a[WH.dataEnv.MAIN][i.SHAMAN]=[this.ID_SHAMAN_ELEMENTAL,this.ID_SHAMAN_ENHANCEMENT,this.ID_SHAMAN_RESTORATION];a[WH.dataEnv.MAIN][i.WARLOCK]=[this.ID_WARLOCK_AFFLICTION,this.ID_WARLOCK_DEMONOLOGY,this.ID_WARLOCK_DESTRUCTION];a[WH.dataEnv.MAIN][i.WARRIOR]=[this.ID_WARRIOR_ARMS,this.ID_WARRIOR_FURY,this.ID_WARRIOR_PROTECTION];const n={};n[WH.dataEnv.CLASSIC]={};n[WH.dataEnv.CLASSIC][i.DRUID]={};n[WH.dataEnv.CLASSIC][i.DRUID][this.ID_CLASSIC_DRUID_BALANCE]="balance";n[WH.dataEnv.CLASSIC][i.DRUID][this.ID_CLASSIC_DRUID_FERAL_COMBAT]="feral-combat";n[WH.dataEnv.CLASSIC][i.DRUID][this.ID_CLASSIC_DRUID_RESTORATION]="restoration";n[WH.dataEnv.CLASSIC][i.HUNTER]={};n[WH.dataEnv.CLASSIC][i.HUNTER][this.ID_CLASSIC_HUNTER_BEAST_MASTERY]="beast-mastery";n[WH.dataEnv.CLASSIC][i.HUNTER][this.ID_CLASSIC_HUNTER_MARKSMANSHIP]="marksmanship";n[WH.dataEnv.CLASSIC][i.HUNTER][this.ID_CLASSIC_HUNTER_SURVIVAL]="survival";n[WH.dataEnv.CLASSIC][i.MAGE]={};n[WH.dataEnv.CLASSIC][i.MAGE][this.ID_CLASSIC_MAGE_ARCANE]="arcane";n[WH.dataEnv.CLASSIC][i.MAGE][this.ID_CLASSIC_MAGE_FIRE]="fire";n[WH.dataEnv.CLASSIC][i.MAGE][this.ID_CLASSIC_MAGE_FROST]="frost";n[WH.dataEnv.CLASSIC][i.PALADIN]={};n[WH.dataEnv.CLASSIC][i.PALADIN][this.ID_CLASSIC_PALADIN_HOLY]="holy";n[WH.dataEnv.CLASSIC][i.PALADIN][this.ID_CLASSIC_PALADIN_PROTECTION]="protection";n[WH.dataEnv.CLASSIC][i.PALADIN][this.ID_CLASSIC_PALADIN_RETRIBUTION]="retribution";n[WH.dataEnv.CLASSIC][i.PRIEST]={};n[WH.dataEnv.CLASSIC][i.PRIEST][this.ID_CLASSIC_PRIEST_DISCIPLINE]="discipline";n[WH.dataEnv.CLASSIC][i.PRIEST][this.ID_CLASSIC_PRIEST_HOLY]="holy";n[WH.dataEnv.CLASSIC][i.PRIEST][this.ID_CLASSIC_PRIEST_SHADOW]="shadow";n[WH.dataEnv.CLASSIC][i.ROGUE]={};n[WH.dataEnv.CLASSIC][i.ROGUE][this.ID_CLASSIC_ROGUE_ASSASSINATION]="assassination";n[WH.dataEnv.CLASSIC][i.ROGUE][this.ID_CLASSIC_ROGUE_COMBAT]="combat";n[WH.dataEnv.CLASSIC][i.ROGUE][this.ID_CLASSIC_ROGUE_SUBTLETY]="subtlety";n[WH.dataEnv.CLASSIC][i.SHAMAN]={};n[WH.dataEnv.CLASSIC][i.SHAMAN][this.ID_CLASSIC_SHAMAN_ELEMENTAL]="elemental";n[WH.dataEnv.CLASSIC][i.SHAMAN][this.ID_CLASSIC_SHAMAN_ENHANCEMENT]="enhancement";n[WH.dataEnv.CLASSIC][i.SHAMAN][this.ID_CLASSIC_SHAMAN_RESTORATION]="restoration";n[WH.dataEnv.CLASSIC][i.WARLOCK]={};n[WH.dataEnv.CLASSIC][i.WARLOCK][this.ID_CLASSIC_WARLOCK_AFFLICTION]="affliction";n[WH.dataEnv.CLASSIC][i.WARLOCK][this.ID_CLASSIC_WARLOCK_DEMONOLOGY]="demonology";n[WH.dataEnv.CLASSIC][i.WARLOCK][this.ID_CLASSIC_WARLOCK_DESTRUCTION]="destruction";n[WH.dataEnv.CLASSIC][i.WARRIOR]={};n[WH.dataEnv.CLASSIC][i.WARRIOR][this.ID_CLASSIC_WARRIOR_ARMS]="arms";n[WH.dataEnv.CLASSIC][i.WARRIOR][this.ID_CLASSIC_WARRIOR_FURY]="fury";n[WH.dataEnv.CLASSIC][i.WARRIOR][this.ID_CLASSIC_WARRIOR_PROTECTION]="protection";n[WH.dataEnv.TBC]=n[WH.dataEnv.CLASSIC];n[WH.dataEnv.MAIN]={};n[WH.dataEnv.MAIN][i.DEATH_KNIGHT]={};n[WH.dataEnv.MAIN][i.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_BLOOD]="blood";n[WH.dataEnv.MAIN][i.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_FROST]="frost";n[WH.dataEnv.MAIN][i.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_UNHOLY]="unholy";n[WH.dataEnv.MAIN][i.DEMON_HUNTER]={};n[WH.dataEnv.MAIN][i.DEMON_HUNTER][this.ID_DEMON_HUNTER_HAVOC]="havoc";n[WH.dataEnv.MAIN][i.DEMON_HUNTER][this.ID_DEMON_HUNTER_VENGEANCE]="vengeance";n[WH.dataEnv.MAIN][i.DRUID]={};n[WH.dataEnv.MAIN][i.DRUID][this.ID_DRUID_BALANCE]="balance";n[WH.dataEnv.MAIN][i.DRUID][this.ID_DRUID_FERAL]="feral";n[WH.dataEnv.MAIN][i.DRUID][this.ID_DRUID_GUARDIAN]="guardian";n[WH.dataEnv.MAIN][i.DRUID][this.ID_DRUID_RESTORATION]="restoration";n[WH.dataEnv.MAIN][i.HUNTER]={};n[WH.dataEnv.MAIN][i.HUNTER][this.ID_HUNTER_BEAST_MASTERY]="beast-mastery";n[WH.dataEnv.MAIN][i.HUNTER][this.ID_HUNTER_MARKSMANSHIP]="marksmanship";n[WH.dataEnv.MAIN][i.HUNTER][this.ID_HUNTER_SURVIVAL]="survival";n[WH.dataEnv.MAIN][i.MAGE]={};n[WH.dataEnv.MAIN][i.MAGE][this.ID_MAGE_ARCANE]="arcane";n[WH.dataEnv.MAIN][i.MAGE][this.ID_MAGE_FIRE]="fire";n[WH.dataEnv.MAIN][i.MAGE][this.ID_MAGE_FROST]="frost";n[WH.dataEnv.MAIN][i.MONK]={};n[WH.dataEnv.MAIN][i.MONK][this.ID_MONK_BREWMASTER]="brewmaster";n[WH.dataEnv.MAIN][i.MONK][this.ID_MONK_MISTWEAVER]="mistweaver";n[WH.dataEnv.MAIN][i.MONK][this.ID_MONK_WINDWALKER]="windwalker";n[WH.dataEnv.MAIN][i.PALADIN]={};n[WH.dataEnv.MAIN][i.PALADIN][this.ID_PALADIN_HOLY]="holy";n[WH.dataEnv.MAIN][i.PALADIN][this.ID_PALADIN_PROTECTION]="protection";n[WH.dataEnv.MAIN][i.PALADIN][this.ID_PALADIN_RETRIBUTION]="retribution";n[WH.dataEnv.MAIN][i.PRIEST]={};n[WH.dataEnv.MAIN][i.PRIEST][this.ID_PRIEST_DISCIPLINE]="discipline";n[WH.dataEnv.MAIN][i.PRIEST][this.ID_PRIEST_HOLY]="holy";n[WH.dataEnv.MAIN][i.PRIEST][this.ID_PRIEST_SHADOW]="shadow";n[WH.dataEnv.MAIN][i.ROGUE]={};n[WH.dataEnv.MAIN][i.ROGUE][this.ID_ROGUE_ASSASSINATION]="assassination";n[WH.dataEnv.MAIN][i.ROGUE][this.ID_ROGUE_OUTLAW]="outlaw";n[WH.dataEnv.MAIN][i.ROGUE][this.ID_ROGUE_SUBTLETY]="subtlety";n[WH.dataEnv.MAIN][i.SHAMAN]={};n[WH.dataEnv.MAIN][i.SHAMAN][this.ID_SHAMAN_ELEMENTAL]="elemental";n[WH.dataEnv.MAIN][i.SHAMAN][this.ID_SHAMAN_ENHANCEMENT]="enhancement";n[WH.dataEnv.MAIN][i.SHAMAN][this.ID_SHAMAN_RESTORATION]="restoration";n[WH.dataEnv.MAIN][i.WARLOCK]={};n[WH.dataEnv.MAIN][i.WARLOCK][this.ID_WARLOCK_AFFLICTION]="affliction";n[WH.dataEnv.MAIN][i.WARLOCK][this.ID_WARLOCK_DEMONOLOGY]="demonology";n[WH.dataEnv.MAIN][i.WARLOCK][this.ID_WARLOCK_DESTRUCTION]="destruction";n[WH.dataEnv.MAIN][i.WARRIOR]={};n[WH.dataEnv.MAIN][i.WARRIOR][this.ID_WARRIOR_ARMS]="arms";n[WH.dataEnv.MAIN][i.WARRIOR][this.ID_WARRIOR_FURY]="fury";n[WH.dataEnv.MAIN][i.WARRIOR][this.ID_WARRIOR_PROTECTION]="protection";const s={icons:WH.getPageData("wow.playerClass.specialization.icons"),names:WH.getPageData("wow.playerClass.specialization.names")};this.getAll=function(){let t=[];i.getAll().forEach((function(i){t=t.concat(e.getByClass(i)||[])}));return t};this.getByClass=function(t){let i=r();if(!i[t]){return undefined}let a=i[t].slice();a.sort((function(t,i){e.getName(t).localeCompare(e.getName(i))}));return a};this.getByIndex=function(e,t){let i=r();return i[e]&&i[e][t]||undefined};this.getBySlug=function(e,t){let a=o();let n=i.getBySlug(e);if(a[n]){for(let e in a[n]){if(a[n][e]===t){return parseInt(e)}}}return undefined};this.getIconName=function(e){return s.icons[e]};this.getIconUrl=function(i,a){return t.getIconUrl(e.getIconName(i),a)};this.getId=function(e,t){let i=r();if(i[e]){for(let a=0,n;n=i[e][a];a++){if(a+1===t){return n}}}else{WH.error("Tried to get a specialization ID from a non-existent class.",e,t)}WH.error("Could not get a specialization ID for this class and spec.",e,t);return undefined};this.getName=function(e){return s.names[e]};this.getNameWithClass=function(t){return WH.Strings.sprintf(WH.TERMS.specclass_format,e.getName(t),i.getName(i.getBySpec(t)))};this.getNumber=function(e,t){let i=r();if(i[e]){for(let a=0;a<i[e].length;a++){if(t===i[e][a]){return a+1}}}WH.error("Could not get a specialization number for this class and spec.",e,t);return undefined};this.getSlug=function(e,t){return(o()[e]||{})[t]};function r(){return a[WH.getDataEnv()]||a[WH.getRootEnv()]}function o(){return n[WH.Game.getEnv()]||n[WH.Game.getRoot()]}};WH.ModelViewer=new function(){const e=this;const t=WH.Gatherer;const i=WH.Icon;const a=WH.Wow.Item;const n=WH.Wow.PlayerClass.Specialization;const s=WH.Tooltip;const r=WH.Types;const o=WH.Url;this.ANIMATION_CHARACTER_CREATE="DressingRoom";this.LOCAL_STORAGE_LAST_MODEL="lastViewedModel";this.UNSHEATHED_DEFAULT=-1;var l=[181581];var c={};c[a.INVENTORY_TYPE_ONE_HAND]=a.INVENTORY_TYPE_MAIN_HAND;c[a.INVENTORY_TYPE_TWO_HAND]=a.INVENTORY_TYPE_MAIN_HAND;c[a.INVENTORY_TYPE_THROWN]=a.INVENTORY_TYPE_MAIN_HAND;c[a.INVENTORY_TYPE_RANGED_RIGHT]=a.INVENTORY_TYPE_MAIN_HAND;c[a.INVENTORY_TYPE_RANGED]=a.INVENTORY_TYPE_OFF_HAND;c[a.INVENTORY_TYPE_HELD_IN_OFF_HAND]=a.INVENTORY_TYPE_OFF_HAND;var u=[a.INVENTORY_TYPE_HEAD,a.INVENTORY_TYPE_SHOULDERS,a.INVENTORY_TYPE_SHIRT,a.INVENTORY_TYPE_CHEST,a.INVENTORY_TYPE_WAIST,a.INVENTORY_TYPE_LEGS,a.INVENTORY_TYPE_FEET,a.INVENTORY_TYPE_WRISTS,a.INVENTORY_TYPE_HANDS,a.INVENTORY_TYPE_ONE_HAND,a.INVENTORY_TYPE_SHIELD,a.INVENTORY_TYPE_RANGED,a.INVENTORY_TYPE_BACK,a.INVENTORY_TYPE_TWO_HAND,a.INVENTORY_TYPE_TABARD,a.INVENTORY_TYPE_ROBE,a.INVENTORY_TYPE_MAIN_HAND,a.INVENTORY_TYPE_OFF_HAND,a.INVENTORY_TYPE_HELD_IN_OFF_HAND,a.INVENTORY_TYPE_THROWN,a.INVENTORY_TYPE_RANGED_RIGHT];const d=20;const f=76;var h=1;var p=2;var m=4;var g=8;var H=16;var W=32;var v=64;var _=128;var T=256;var b=512;var E=1024;var y=[1819228];const S="WH.ModelViewer.sheathed";var w=[{name:WH.TERMS.hd,value:"true"},{name:WH.TERMS.sd,value:"false"}];const I={animationsLoaded:false,canTakeScreenshots:false,elements:{animationSelect:undefined,definition:undefined,gender:undefined,lightboxContent:undefined,race:undefined,screen:undefined},library:{},libraryLoadedCallbacks:{},ratio:16/9,resizeEventBound:false,shouldersOverride:undefined,shown:false};var N,R,M=[],A,k,C,L,O,D,x,P;this.applyDataEnv=function(e,t){e.env=e.dataEnv=e.gameDataEnv=WH.getDataEnvKey(t)};this.canTakeScreenshots=function(){return!!I.canTakeScreenshots};this.getBackgroundFilename=function(){if(WH.Theme.isThottbot()){return"background-classic-ddd.png"}if(WH.Theme.isClassic()){return"background-classic-181818.png"}return"background-181818.png"};this.getBackgroundUrl=function(t){return WH.staticUrl+e.getStaticBase(t)+"/"+e.getBackgroundFilename()};this.getContentPath=function(t){return""+(WH.isDev()?"https://wow.zamimg.com":WH.staticUrl)+e.getStaticBase(t)+"/"};this.getEffectiveInventoryType=function(e){return c[e]||e};this.getLibrary=function(e){if(e===undefined){e=WH.getDataEnv()}return I.library[e]};this.getSheathTypes=function(i,a){let n={mainhand:e.UNSHEATHED_DEFAULT,offhand:e.UNSHEATHED_DEFAULT};if(i){let a=t.get(r.ITEM,i);if(a&&a.jsonequip){n.mainhand=a.jsonequip.sheathtype||e.UNSHEATHED_DEFAULT}}if(a){let i=t.get(r.ITEM,a);if(i&&i.jsonequip){n.offhand=i.jsonequip.sheathtype||e.UNSHEATHED_DEFAULT;if(i.jsonequip.sheathtype===4){n.offhand=9}else if(i.jsonequip.sheathtype===undefined){n.offhand=3}}}return n};this.getStaticBase=function(e){return"/modelviewer/"+WH.getDataEnvKey(e)};this.grabScreenshot=function(e,t){if(!t){t="screenshot";if(g_pageInfo){if(g_pageInfo.name){t=g_pageInfo.name}else{if(g_pageInfo.type&&g_types[g_pageInfo.type]){t=g_types[g_pageInfo.type];if(g_pageInfo.typeId){t+=" "+g_pageInfo.typeId}}}}}var i=$(e.renderer.canvas)[0];var a="fullscreenchange";var n;var s=function(i){if(i){document.removeEventListener(a,n,false)}window.requestAnimationFrame((function(){e.renderer.makeDataURL=["image/png",1];window.requestAnimationFrame((function(){var i=e.renderer.screenshotDataURL;var a=WH.ce("a");a.download=t+".png";a.href=i;a.style.display="none";WH.ae(document.body,a);a.click();if(document.exitFullscreen){document.exitFullscreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}}))}))};if(i.requestFullscreen){document.addEventListener(a,n=s.bind(this,true),false);i.requestFullscreen()}else if(i.webkitRequestFullscreen){a="webkit"+a;document.addEventListener(a,n=s.bind(this,true),false);i.webkitRequestFullscreen()}else if(i.mozRequestFullScreen){a="moz"+a;document.addEventListener(a,n=s.bind(this,true),false);i.mozRequestFullScreen()}else{s(false)}};this.isLibraryLoaded=function(t){return e.getLibrary(t)!==undefined};this.loadLibrary=function(t,i){if(i===undefined){i=WH.getDataEnv()}if(e.isLibraryLoaded(i)){if(t){window.requestAnimationFrame(t)}return}var a=!!I.libraryLoadedCallbacks[i];if(!a){I.libraryLoadedCallbacks[i]=[]}if(t){if(I.libraryLoadedCallbacks[i].length>100){WH.error("Too many callbacks waiting for ZamModelViewer!")}else{I.libraryLoadedCallbacks[i].push(t)}}if(a){return}var n=WH.ce("script");n.src=e.getContentPath(i)+"viewer/viewer.min.js";WH.aE(n,"load",(function(){if(window.ZamModelViewer){I.library[i]=window.ZamModelViewer;delete window.ZamModelViewer}if(!e.isLibraryLoaded(i)){WH.error("Model viewer script file was loaded, but ZamModelViewer is still undefined!");return}while(I.libraryLoadedCallbacks[i].length){I.libraryLoadedCallbacks[i].shift()()}}));WH.aE(n,"error",(function(){WH.error("Failed to load ZamModelViewer JS")}));WH.ae(WH.qs("head"),n)};this.showLightbox=function(e){L=e;Lightbox.show("modelviewer",{onShow:ie,onHide:te},e)};this.supportsEnchantVisual=function(t){switch(e.getEffectiveInventoryType(t)){case a.INVENTORY_TYPE_MAIN_HAND:case a.INVENTORY_TYPE_OFF_HAND:return true}return false};this.supportsInventoryType=function(e){return u.indexOf(parseInt(e))>=0};function U(){let t=false;let i=false;let n=function(){return t?WH.TERMS.sheathed:WH.TERMS.unsheathed};let r=WH.ce("a",{className:"fa fa-hand-"+(t?"paper":"rock")+"-o",href:"javascript:"});s.simple(r,n,"q2",true);WH.aE(r,"click",(function(){t=!t;let o;let l;if(t){(P.itemData||[]).forEach((function(e){let t=a.getInvTypeSlots(e[2]);if(t.includes(WH.Wow.INVENTORY_SLOT_MAIN_HAND)){o=e[0]}else if(t.includes(WH.Wow.INVENTORY_SLOT_OFF_HAND)){l=e[0]}}))}let c=e.getSheathTypes(o,l);P.characterData.sheathMain=c.mainhand;P.characterData.sheathOff=c.offhand;if(O){if(!WH.isClassicTree()){O.method("setSheath",[c.mainhand,c.offhand])}else{O.method("setAppearance",[P.characterData.hairstyle,P.characterData.haircolor,P.characterData.facetype,P.characterData.skincolor,P.characterData.features,P.characterData.haircolor,P.characterData.hornstyle,P.characterData.blindfolds,P.characterData.tattoos,c.mainhand,c.offhand])}}r.classList.toggle("fa-hand-rock-o");r.classList.toggle("fa-hand-paper-o");if(i){s.show(r,n(),undefined,undefined,"q2")}WH.LocalStorage.jsonSet(S,t)}));if(WH.LocalStorage.jsonGet(S)===true){r.click()}i=true;return r}function q(){I.canTakeScreenshots=(g_user.roles&U_GROUP_STAFF)>0;I.canTakeScreenshots=I.canTakeScreenshots||y.indexOf(g_user.id)>=0;Object.defineProperty(e,"canTakeScreenshots",{writable:false});WH.onLoad(B)}function F(e,t){return WH.inArray([a.INVENTORY_TYPE_SHIRT,a.INVENTORY_TYPE_CHEST,a.INVENTORY_TYPE_WAIST,a.INVENTORY_TYPE_LEGS,a.INVENTORY_TYPE_FEET,a.INVENTORY_TYPE_WRISTS,a.INVENTORY_TYPE_HANDS,a.INVENTORY_TYPE_BACK,a.INVENTORY_TYPE_TABARD,a.INVENTORY_TYPE_ROBE],e)!==-1||l.indexOf(t)!==-1}function B(){if(location.hash&&location.hash.indexOf("#modelviewer")==0){var t=location.hash.split(":");if(t.length>=3){t.shift();var i=parseInt(t.shift());var a={type:i,extendedHash:true};switch(i){case WH.Types.NPC:a.displayId=parseInt(t.shift());var n=parseInt(t.shift());if(n==1){a.humanoid=1}break;case WH.Types.OBJECT:a.displayId=parseInt(t.shift());break;case WH.Types.ITEM:a.displayId=parseInt(t.shift());a.slot=parseInt(t.shift());break;case WH.Types.ITEM_SET:var s=t.shift();a.equipList=s.split(";");break}if(a.displayId||a.equipList){e.showLightbox(a)}}else{var r=WH.ge("wh-mv-view-in-3d-button");if(r){r.click()}}}}function G(){if(!I.shown){return}let e;let t;if(window.innerWidth<WH.Responsive.BREAKPOINTS.MOBILE_MODE){e=I.elements.lightboxContent.offsetWidth;t=I.elements.lightboxContent.offsetHeight;I.elements.screen.style.width="100%";I.elements.screen.style.height="100%"}else{e=window.innerWidth-Lightbox.BLEED_SIZE-d;t=window.innerHeight-Lightbox.BLEED_SIZE-f;let i=Math.round(t*(16/9));let a=Math.round(e*(9/16));if(e>i){e=i}else if(t>a){t=a}I.elements.screen.style.width=e+"px";I.elements.screen.style.height=t+"px"}if(e&&t){I.ratio=e/t;if(O&&O.renderer.onResize){O.renderer.onResize(e,t,I.ratio)}}}function Y(){return{race:I.elements.race.selectedIndex>=0?I.elements.race.options[I.elements.race.selectedIndex].value:"",gender:I.elements.gender.selectedIndex>=0?I.elements.gender.options[I.elements.gender.selectedIndex].value:0}}function z(e,t){return WH.Wow.Race.exists(e)&&(t===0||t===1)}function V(){var t=L.dataEnv;if(!e.isLibraryLoaded(t)){e.loadLibrary(V.bind(this),t);return}var i=Y();var a=i.race;var n=i.gender;if(O)O.destroy();var s={type:e.getLibrary(t).WOW,contentPath:e.getContentPath(t),container:$(I.elements.screen),aspect:I.ratio,background:e.getBackgroundFilename(),models:{type:R,id:N}};if(P.hasOwnProperty("characterData")){if(P.characterData.race==a&&P.characterData.gender==n){if(!WH.isClassicTree()){s.charCustomization={race:P.characterData.race,gender:P.characterData.gender,options:P.characterData.charCustomization||[]}}else{s.sk=P.characterData.skincolor;s.ha=P.characterData.hairstyle;s.hc=P.characterData.haircolor;s.fa=P.characterData.facetype;s.fh=P.characterData.features;s.fc=P.characterData.haircolor;s.ep=P.characterData.blindfolds;s.ho=P.characterData.hornstyle;s.ta=P.characterData.tattoos}s.cls=P.characterData.charClass}if(WH.LocalStorage.jsonGet(S)===true){if(!WH.isClassicTree()){s.charCustomization=s.charCustomization||{};if(P.characterData.hasOwnProperty("sheathMain")){s.charCustomization.sheathMain=P.characterData.sheathMain}if(P.characterData.hasOwnProperty("sheathOff")){s.charCustomization.sheathOff=P.characterData.sheathOff}}else{if(P.characterData.hasOwnProperty("sheathMain")){s.sheathMain=P.characterData.sheathMain}if(P.characterData.hasOwnProperty("sheathOff")){s.sheathOff=P.characterData.sheathOff}}}}if((R==g||R==W||R==H)&&M.length){var r=[];M=[].concat.apply([],M);for(var o=0;o<M.length;o+=2){r.push([M[o],M[o+1]])}s.items=r}if(I.shouldersOverride){s.shouldersOverride=I.shouldersOverride}if(A)s.link=A;if(k)s.label=k;if(WH.isClassicTree()||WH.isTbcTree()){s.hd=false}else{s.hd=true}if(e.canTakeScreenshots()&&WH.getGets().modelViewerTransparency!==undefined){s.transparent=true;delete s.background;I.elements.screen.style.backgroundImage='url("'+e.getBackgroundUrl(t)+'")'}e.applyDataEnv(s,t);WH.debug("Creating ZamModelViewer with these options:",JSON.stringify(s),s);e.viewer=O=new(e.getLibrary(t))(s);if(e.viewer.setAdaptiveMode){e.viewer.setAdaptiveMode(true);if(!I.resizeEventBound){WH.aE(window,"resize",G);I.resizeEventBound=true}}G();if(!L.noPound){var l="#modelviewer";if(L.extendedHash||!WH.ge("wh-mv-view-in-3d-button")){switch(L.type){case WH.Types.NPC:l+=":"+L.type+":"+L.displayId+":"+(L.humanoid|0);break;case WH.Types.OBJECT:l+=":"+L.type+":"+L.displayId;break;case WH.Types.ITEM:l+=":"+L.type+":"+L.displayId+":"+(L.slot|0);break;case WH.Types.ITEM_SET:l+=":"+L.type+":"+M.join(";");break;case WH.Types.TRANSMOG_SET:case WH.Types.OUTFIT:case WH.Types.GEAR_SET:l+=":"+L.type+":"+M.join(";");break}}if(a&&n){l+=":"+a+"+"+n}else{l+=":"}WH.ee(I.elements.animationSelect);WH.ae(I.elements.animationSelect,WH.ce("option",{value:0},WH.ct(WH.TERMS.loading_ellipsis)));I.animationsLoaded=false;Z();location.replace(WH.rtrim(l,":"))}}function j(){var e=Y();var t=e.race;var i=e.gender;if(!t){if(I.elements.gender.style.display==="none"){return}WH.displayNone(I.elements.gender);N=M[1];switch(L.slot){case 1:R=p;break;case 3:R=m;break;default:R=h}}else{if(I.elements.gender.style.display==="none"){WH.displayInline(I.elements.gender)}var a=WH.Wow.Race.getIdString(t);var n=WH.Wow.getGenderString(i);if(a&&n){N=a+n;R=H}WH.LocalStorage.set("defaultModel",JSON.stringify({race:parseInt(t),gender:parseInt(i)}))}Q();V()}function K(){let e=I.elements.animationSelect.value;if(e&&O&&O.method("isLoaded")){WH.debug("Setting model viewer animation to:",e);O.method("setAnimation",e)}}function Z(){if(I.animationsLoaded){return}if(!O||!O.method("isLoaded")){setTimeout((function(){Z()}),100);return}WH.ee(I.elements.animationSelect);let e=[];let t=O.method("getNumAnimations");for(let i=0;i<t;i++){let t=O.method("getAnimation",i);if(t&&!e.includes(t)){e.push(t)}}e.sort();e.forEach((function(e){WH.ae(I.elements.animationSelect,WH.ce("option",{value:e},WH.ct(e)))}));I.animationsLoaded=true}function J(e,t,i,a){WH.arrayWalk(e,(function(e){e.checked=false;if(e){var t=Menu.getSubmenu(e);if(t){WH.arrayWalk(t,(function(e){e.checked=false}))}}}));t.checked=true;i.checked=true;M[1]=a;N=a;if(Y().race){j()}else{V()}}function X(e,t,i,a,n){N=i;C=t[Menu.ITEM_CRUMB];$(a).text(n);V()}function Q(){var t=[];switch(P.type){case WH.Types.ITEM_SET:case WH.Types.TRANSMOG_SET:case WH.Types.OUTFIT:case WH.Types.GEAR_SET:if(P.itemData){for(var i in P.itemData){t.push({itemId:P.itemData[i][0],itemBonus:P.itemData[i][1],slot:P.itemData[i][2]})}}break}if(t.length>0){if(P.characterData){let e=$.extend({},P.characterData);e.date=(new Date).getTime();if(!e["class"]&&e.charClass){e["class"]=e.charClass;delete e.charClass}if(Array.isArray(e.charCustomization)){e.charCustomization.forEach((function(t){if(t.optionSlug){e[t.optionSlug]=t.choiceId}}));delete e.charCustomization}t.push(e)}else{var a=Y();a.date=(new Date).getTime();t.push(a)}WH.LocalStorage.set(e.LOCAL_STORAGE_LAST_MODEL,JSON.stringify(t))}}function ee(e,t){var i=-1;var a=-1;if(t.race!=null&&t.gender!=null){i=t.race;a=t.gender;D.hide();e=false}else{D.show()}if(t.hasOwnProperty("characterData")&&t.characterData.hasOwnProperty("race")){i=t.characterData.race}if(t.hasOwnProperty("characterData")&&t.characterData.hasOwnProperty("gender")){a=t.characterData.gender}if(i===-1&&a===-1){if(location.hash){var n=location.hash.match(/modelviewer:.*?([0-9]+)\+([0-9]+)/);if(n){if(z(n[1],n[2])){i=n[1];a=n[2];WH.displayInline(I.elements.gender)}}}}I.elements.race.options[0].hidden=!e;I.elements.race.options[0].disabled=!e;if(e){I.elements.race.selectedIndex=0;if(a===-1){WH.displayNone(I.elements.gender)}}else{if(i===-1&&a===-1){var s=WH.Wow.Race.ID_HUMAN;var r=WH.Wow.GENDER_MALE;if(g_user&&g_user.settings&&g_user.settings.defaultModel){s=g_user.settings.defaultModel.race;r=g_user.settings.defaultModel.gender-1}else{var o=WH.LocalStorage.get("defaultModel");if(o){o=JSON.parse(o);if(o.race){s=o.race;r=o.gender}}}s=t.defaultRace||s;if(z(s,r)){i=s;a=r}else{i=WH.Wow.Race.ID_HUMAN;a=WH.Wow.GENDER_MALE}}WH.displayInline(I.elements.gender)}if(a!==-1){I.elements.gender.selectedIndex=a}if(i!==-1&&a!==-1){var l=WH.Wow.Race.getIdString(i);var c=WH.Wow.getGenderString(a);if(l&&c){N=l+c;R=H;for(var u,d=0;u=I.elements.race.options[d];d++){if(u.value==i){I.elements.race.selectedIndex=d}}for(var u,d=0;u=I.elements.gender.options[d];d++){if(u.value==a){I.elements.gender.selectedIndex=d}}}}}function te(){I.shown=false;if(!L.noPound){if(!L.fromTag&&x&&x.indexOf("modelviewer")==-1)WH.setHash(x);else WH.clearHash()}if(O)O.destroy();if(L.onHide)L.onHide()}function ie(t,r,l){P=l;I.shown=true;if(r){t=$(t);t.addClass("has-lightbox-caption modelviewer");I.elements.screen=WH.ce("div",{className:"modelviewer-screen"});I.elements.lightboxContent=WH.ce("div",{className:"lightbox-content modelviewer-modelbg"});WH.ae(I.elements.lightboxContent,I.elements.screen);t.append(I.elements.lightboxContent);let r=WH.ce("a",{className:"fa fa-arrows-alt",href:"javascript:"});WH.aE(r,"click",(function(){O.setFullscreen(true)}));s.simple(r,WH.TERMS.fullscreen,"q2",true);WH.ae(I.elements.screen,r);let h=WH.ce("a",{className:"fa fa-pause",href:"javascript:"});WH.aE(h,"click",(function(){O.method("setAnimPaused",this.classList.contains("fa-pause"));this.classList.toggle("fa-play");this.classList.toggle("fa-pause");let e=this.classList.contains("fa-pause")?WH.TERMS.pause:WH.TERMS.play;s.show(this,e,undefined,undefined,"q2")}));s.simple(h,(function(){return this.classList.contains("fa-pause")?WH.TERMS.pause:WH.TERMS.play}),"q2",true);WH.ae(I.elements.screen,h);if(P.itemData&&P.itemData.length){for(let e=0,t;t=P.itemData[e];e++){let e=a.getInvTypeSlots(t[2]);if(e.includes(WH.Wow.INVENTORY_SLOT_MAIN_HAND)||e.includes(WH.Wow.INVENTORY_SLOT_OFF_HAND)){WH.ae(I.elements.screen,U());break}}}G();let p=WH.ce("div",{className:"modelviewer-animation"});WH.ae(p,WH.ce("var",undefined,WH.ct(WH.TERMS.animation)));I.elements.animationSelect=WH.ce("select");WH.ae(I.elements.animationSelect,WH.ce("option",{value:0},WH.ct(WH.TERMS.loading_ellipsis)));WH.aE(I.elements.animationSelect,"change",K);WH.ae(p,I.elements.animationSelect);Z();t.append(p);t.append($("<a/>",{class:"dialog-option fa fa-times",href:"javascript:",click:Lightbox.hide,text:WH.TERMS.close}));t.append($("<a/>",{class:"dialog-option fa fa-question",href:"/help=modelviewer",target:"_blank",text:WH.TERMS.help}));if(e.canTakeScreenshots()){t.append($("<a/>",{class:"dialog-option fa fa-camera",href:"javascript:",click:function(){e.grabScreenshot(O)},text:WH.TERMS.screenshot}));let i=WH.ce("a",{className:"dialog-option fa"},WH.ct("Transparency"));t.append(i);if(WH.getGets().modelViewerTransparency===undefined){i.classList.add("fa-square");WH.aE(i,"click",(function(){location.href=o.getModifiedPageQuery((function(e){e.modelViewerTransparency=""}))}))}else{i.classList.add("fa-check-square","fa-color-white");WH.aE(i,"click",(function(){location.href=o.getModifiedPageQuery((function(e){delete e.modelViewerTransparency}))}))}}if(l.modelTileUrl){t.append($("<a/>",{class:"dialog-option fa fa-th-large",href:l.modelTileUrl,text:"Tile"}))}if(l.itemData){let e=WH.ce("div",{className:"modelviewer-slots"});let t=WH.ce("div",{className:"modelviewer-slots-left"});let a=WH.ce("div",{className:"modelviewer-slots-right"});let n=WH.ce("div",{className:"modelviewer-slots-bottom"});WH.ae(e,t);WH.ae(e,a);WH.ae(e,n);WH.ae(I.elements.screen,e);I.elements.screen.dataset.dressingRoomButton="true";WH.ae(e,WH.ce("a",{className:"btn btn-site btn-small modelviewer-dressing-room-link fa fa-male",href:"/dressing-room",text:WH.TERMS.openindressingroom}));let s={};for(let e=0,r;r=g_character_slots_data[e];++e){let o=r.name==="back"?"chest":r.name;s[r.id]=i.create("inventoryslot_"+o,i.MEDIUM,"javascript:");s[r.id].classList.add("modelviewer-slots-noicon");if(r.noModel){s[r.id].style.visibility="hidden"}WH.ae(e<8?t:e<16?a:n,s[r.id])}let r;for(let e=0,t;t=l.itemData[e];e++){if(r=s[t[2]]){i.setName(r,i.MEDIUM,g_items.getIcon(t[0],t[1]).toLowerCase());r.classList.remove("modelviewer-slots-noicon");r.style.visibility=""}}}D=$("<div/>",{class:"modelviewer-model"});var c=WH.Wow.Race.getPlayableRaceIds();I.elements.race=WH.ce("select");D.append(I.elements.race);WH.aE(I.elements.race,"change",j);WH.ae(I.elements.race,WH.ce("option"));for(let e=0,t=c.length;e<t;++e){WH.ae(I.elements.race,WH.ce("option",{value:c[e],text:WH.Wow.Race.getName(c[e])}))}I.elements.gender=WH.ce("select");D.append(I.elements.gender);WH.aE(I.elements.gender,"change",j);WH.ae(I.elements.gender,WH.ce("option",{value:0,text:WH.Wow.getGenderName(0)}));WH.ae(I.elements.gender,WH.ce("option",{value:1,text:WH.Wow.getGenderName(1)}));WH.displayNone(I.elements.gender);var u=P.artifact&&!$.isEmptyObject(P.artifact);var d=$("<a>"+WH.TERMS.artifactappearances+"</a>");d.get(0).style.marginLeft="5px";if(u){var f=g_items[P.typeId];var H=[];for(let e in P.artifact){var _=P.artifact[e];if(!$.isEmptyObject(_)){var b=[e,_["1"]?_["1"].setname:""];var E=[];var y=false;for(let e in _){var S=_[e].mod;if(f.appearances&&f.appearances[S]&&f.appearances[S][0]){var w=_[e].swatchrgb;var L=WH.ce("span");L.className="artifact-appearance";L.style.backgroundColor="rgba("+WH.sprintf("$1,$2,$3,1",w>>16&255,w>>8&255,w&255)+")";var q=[e,L];q[Menu.ITEM_URL]=J.bind(this,H,b,q,f.appearances[S][0]);E.push(q);if(f.appearances[S][0]==l.displayId){E[E.length-1].checked=true;y=true}}}Menu.setSubmenu(b,E);b.checked=y;H.push(b)}}Menu.add(d,H)}var B=P.specVariants&&!$.isEmptyObject(P.specVariants);var Y=$("<a>",{text:WH.TERMS.specializationvariants});Y.get(0).style.marginLeft="5px";if(B){var H=[];for(let e in P.specVariants){var z=P.specVariants[e];var te=WH.ce("span");te.className="spec-variant";te.innerHTML=z.specName;var ie=[e,te];ie[Menu.ITEM_URL]=X.bind(this,H,ie,z.modelId,Y,z.specName);ie[Menu.ITEM_OPTIONS]={tinyIcon:WH.staticUrl+"/images/wow/icons/tiny/"+n.getIconName(z.specId)+".gif",checkedFunc:function(e){return e[Menu.ITEM_CRUMB]==C}};if(z.modelId==l.displayId){$(Y).text(z.specName);C=e}H.push(ie)}Menu.add(Y,H)}if(u){D.append("<br>");D.append(d)}t.append(D);if(B){t.append("<br>");t.append(Y)}var L=$("<div/>",{class:"modelviewer-instructions"});L.append(WH.TERMS.modelviewercontrols_tip);t.append(L);var ae=$("<div/>",{id:"modelviewer-msg",class:"sub",css:{display:"none","margin-top":"-6px",color:"#ccc","font-size":"13px"}});t.append(ae);if(WH.isSet("g_user")&&g_user.id)$.ajax({url:"/website-achievement-explored",data:{trigger:"modelviewer"},success:function(){AchievementCheck()},type:"POST"})}I.shouldersOverride=undefined;switch(l.type){case WH.Types.NPC:D.hide();if(l.humanoid){R=W}else{R=g}if(l.equipList){M=l.equipList}N=l.displayId;break;case WH.Types.OBJECT:D.hide();R=v;N=l.displayId;break;case WH.Types.ITEM:case WH.Types.ITEM_SET:case WH.Types.TRANSMOG_SET:case WH.Types.OUTFIT:case WH.Types.GEAR_SET:if(l.type==WH.Types.ITEM){M=[l.slot,l.displayId]}else{M=l.equipList}if(l.shouldersOverride&&l.shouldersOverride.length===2){I.shouldersOverride=l.shouldersOverride}if(M.length>2||F(M[0],M[1])||WH.inArray([WH.Types.TRANSMOG_SET,WH.Types.OUTFIT,WH.Types.GEAR_SET],l.type)>=0&&M.length>1){ee(false,l)}else{switch(M[0]){case 1:R=p;break;case 3:R=m;break;default:R=h}N=M[1];ee(true,l)}break}if(l.fileId){D.hide();R=T;N=l.fileId}setTimeout(V,1);var ne=$("#modelviewer-msg");if(l.message&&ne.length>0){ne.html(l.message);ne.show()}else ne.hide();if(l.link)A=l.link;if(l.label)k=l.label;var se="";if(l.fromTag){se+="Custom ";switch(l.type){case WH.Types.NPC:se+="NPC "+l.displayId+(l.humanoid?" humanoid":"");break;case WH.Types.OBJECT:se+="Object "+l.displayId;break;case WH.Types.ITEM:se+="Item "+l.displayId+" Slot "+(l.slot|0);break;case WH.Types.ITEM_SET:se+="Item set "+M.join(".");break;case WH.Types.TRANSMOG_SET:se+="Transmog set "+M.join(".");break;case WH.Types.OUTFIT:se+="Outfit "+M.join(".");break;case WH.Types.GEAR_SET:se+="Gear set "+M.join(".");break}}else{switch(l.type){case WH.Types.NPC:se+="NPC "+(l.typeId?l.typeId:" DisplayID "+l.displayId);break;case WH.Types.OBJECT:se+="Object "+l.typeId;break;case WH.Types.ITEM:se+="Item "+l.typeId;break;case WH.Types.ITEM_SET:se+="Item set "+M.join(".");break;case WH.Types.TRANSMOG_SET:se+="Transmog set "+M.join(".");break;case WH.Types.OUTFIT:se+="Outfit "+M.join(".");break;case WH.Types.GEAR_SET:se+="Gear set "+M.join(".");break}}WH.Track.interactiveEvent("Model Viewer","Show",WH.Strings.slug(se));x=location.hash;Q()}q()};